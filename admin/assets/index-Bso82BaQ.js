import{i as G_,a as xx}from"./iobroker_javascript__mf_v__runtimeInit__mf_v__-NaHOKE6N.js";import{j as f,c as ni,g as ET,r as kT,_ as q_,P as ze}from"./createSvgIcon-ByQqvc2z.js";import{R as Le,i as ve,r as Dx}from"./iobroker_javascript__loadShare__react__loadShare__-DUkAVpOM.js";import{i as IT,R as Ox,y as Rx,_ as Ax,a as Nx,S as E0,T as k0}from"./inheritsLoose-CiRWdEQi.js";import{g as Mx,a as aa,c as ei}from"./_commonjsHelpers-C4iS2aBk.js";import{i as D,I as ol,a as la,b as Lx,C as Bx,c as K_,_ as Px,D as xT,S as Fx,d as jx,L as zx,Q as Ux}from"./index-oVT5vxvl.js";import{_ as Hx}from"./preload-helper-D6kgxu3v.js";function Wx(o,n){for(var s=0;s<n.length;s++){const i=n[s];if(typeof i!="string"&&!Array.isArray(i)){for(const a in i)if(a!=="default"&&!(a in o)){const c=Object.getOwnPropertyDescriptor(i,a);c&&Object.defineProperty(o,a,c.get?c:{enumerable:!0,get:()=>i[a]})}}}return Object.freeze(Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}))}(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const c of a)if(c.type==="childList")for(const h of c.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&i(h)}).observe(document,{childList:!0,subtree:!0});function s(a){const c={};return a.integrity&&(c.integrity=a.integrity),a.referrerPolicy&&(c.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?c.credentials="include":a.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function i(a){if(a.ep)return;a.ep=!0;const c=s(a);fetch(a.href,c)}})();const Vx=Wx({__proto__:null,default:Ox},[IT]),Gx=Mx(Vx);var DT,I0=Gx;DT=I0.createRoot,I0.hydrateRoot;var OT={exports:{}},Mn={};/** @license React v17.0.2
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ay=60103,ly=60106,gm=60107,fm=60108,mm=60114,bm=60109,$m=60110,vm=60112,ym=60113,jw=60120,_m=60115,wm=60116,RT=60121,AT=60122,NT=60117,MT=60129,LT=60131;if(typeof Symbol=="function"&&Symbol.for){var qs=Symbol.for;ay=qs("react.element"),ly=qs("react.portal"),gm=qs("react.fragment"),fm=qs("react.strict_mode"),mm=qs("react.profiler"),bm=qs("react.provider"),$m=qs("react.context"),vm=qs("react.forward_ref"),ym=qs("react.suspense"),jw=qs("react.suspense_list"),_m=qs("react.memo"),wm=qs("react.lazy"),RT=qs("react.block"),AT=qs("react.server.block"),NT=qs("react.fundamental"),MT=qs("react.debug_trace_mode"),LT=qs("react.legacy_hidden")}function _o(o){if(typeof o=="object"&&o!==null){var n=o.$$typeof;switch(n){case ay:switch(o=o.type,o){case gm:case mm:case fm:case ym:case jw:return o;default:switch(o=o&&o.$$typeof,o){case $m:case vm:case wm:case _m:case bm:return o;default:return n}}case ly:return n}}}var qx=bm,Kx=ay,Jx=vm,Yx=gm,Xx=wm,Zx=_m,Qx=ly,e1=mm,t1=fm,n1=ym;Mn.ContextConsumer=$m;Mn.ContextProvider=qx;Mn.Element=Kx;Mn.ForwardRef=Jx;Mn.Fragment=Yx;Mn.Lazy=Xx;Mn.Memo=Zx;Mn.Portal=Qx;Mn.Profiler=e1;Mn.StrictMode=t1;Mn.Suspense=n1;Mn.isAsyncMode=function(){return!1};Mn.isConcurrentMode=function(){return!1};Mn.isContextConsumer=function(o){return _o(o)===$m};Mn.isContextProvider=function(o){return _o(o)===bm};Mn.isElement=function(o){return typeof o=="object"&&o!==null&&o.$$typeof===ay};Mn.isForwardRef=function(o){return _o(o)===vm};Mn.isFragment=function(o){return _o(o)===gm};Mn.isLazy=function(o){return _o(o)===wm};Mn.isMemo=function(o){return _o(o)===_m};Mn.isPortal=function(o){return _o(o)===ly};Mn.isProfiler=function(o){return _o(o)===mm};Mn.isStrictMode=function(o){return _o(o)===fm};Mn.isSuspense=function(o){return _o(o)===ym};Mn.isValidElementType=function(o){return typeof o=="string"||typeof o=="function"||o===gm||o===mm||o===MT||o===fm||o===ym||o===jw||o===LT||typeof o=="object"&&o!==null&&(o.$$typeof===wm||o.$$typeof===_m||o.$$typeof===bm||o.$$typeof===$m||o.$$typeof===vm||o.$$typeof===NT||o.$$typeof===RT||o[0]===AT)};Mn.typeOf=_o;OT.exports=Mn;var s1=OT.exports;function Cv(o,n){const s=getComputedStyle(n);if(!s)return;let i=o===Pn.Horizontal?n.clientWidth:n.clientHeight;return i!==0?(o===Pn.Horizontal?i-=parseFloat(s.paddingLeft)+parseFloat(s.paddingRight):i-=parseFloat(s.paddingTop)+parseFloat(s.paddingBottom),i):void 0}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function G$(o,n,s=[],i={condition:!0}){const{condition:a}=i,c=function(h,g){var b={};for(var $ in h)Object.prototype.hasOwnProperty.call(h,$)&&g.indexOf($)<0&&(b[$]=h[$]);if(h!=null&&typeof Object.getOwnPropertySymbols=="function"){var y=0;for($=Object.getOwnPropertySymbols(h);y<$.length;y++)g.indexOf($[y])<0&&Object.prototype.propertyIsEnumerable.call(h,$[y])&&(b[$[y]]=h[$[y]])}return b}(i,["condition"]);ve.useEffect(()=>(a&&window.addEventListener(o,n,c),()=>{a&&window.removeEventListener(o,n)}),[o,n,a,...s])}(function(o,n){n===void 0&&(n={});var s=n.insertAt;if(typeof document<"u"){var i=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css",s==="top"&&i.firstChild?i.insertBefore(a,i.firstChild):i.appendChild(a),a.styleSheet?a.styleSheet.cssText=o:a.appendChild(document.createTextNode(o))}})(`/* === Main Container === */
.__dbk__container {
  height: 100%;
  width: 100%;

  display: flex;
  overflow: hidden;
}

.__dbk__container.Horizontal {
  flex-direction: row;
}

.__dbk__container.Vertical {
  flex-direction: column;
}
/* ====== */

/* === Wrapper for each child element === */
.__dbk__child-wrapper {
  height: 100%;
  width: 100%;
}
/* ====== */

/* === Gutter === */
.__dbk__gutter {
  display: flex;
  align-items: center;
  justify-content: center;
}
/* .__dbk__gutter > div {
  background: red;
} */
.__dbk__gutter.Horizontal {
  height: 100%;
  padding: 0 2px;
  flex-direction: column;
}
.__dbk__gutter.Horizontal:hover {
  cursor: col-resize;
}

.__dbk__gutter.Vertical {
  width: 100%;
  padding: 2px 0;
  flex-direction: row;
}
.__dbk__gutter.Vertical:hover {
  cursor: row-resize;
}

.__dbk__gutter.Light {
  background: #EDF0EF;
}
.__dbk__gutter.Light:hover > .__dbk__dragger {
  background: #76747B;
}

.__dbk__gutter.Dark {
  background: #020203;
}
.__dbk__gutter.Dark:hover > .__dbk__dragger {
  background: #9995A3;
}
/* ====== */

/* === Gutter's Dragger === */
.__dbk__dragger {
  border-radius: 2px;
}

.__dbk__dragger.Horizontal {
  width: 4px;
  height: 24px;  
}

.__dbk__dragger.Vertical {
  width: 24px;
  height: 4px;  
}

.__dbk__dragger.Light {
  background: #A6ACB5;
}

.__dbk__dragger.Dark {
  background: #434252;
}
/* ====== */`);const r1=Le.forwardRef(({className:o,theme:n,draggerClassName:s,direction:i=Pn.Vertical,onDragging:a},c)=>{const h=`__dbk__gutter ${i} ${o||n}`,g=`__dbk__dragger ${i} ${s||n}`;return f.jsx("div",Object.assign({className:h,ref:c,dir:i,onMouseDown:a,onTouchStart:lv?a:void 0},{children:f.jsx("div",{className:g},void 0)}),void 0)});var Bi;function J_(o,n,s){let i,a;return n?(i=o/2,a=o):s?(i=o,a=o/2):(i=o,a=o),{aGutterSize:i,bGutterSize:a}}function i1(o,n){switch(n.type){case Bi.SetIsReadyToCompute:return Object.assign(Object.assign({},o),{isReady:n.payload.isReady});case Bi.CreatePairs:{const{direction:s,children:i,gutters:a}=n.payload,c=i[0].parentNode;if(!c)throw new Error("Cannot create pairs - parent is undefined.");const h=Cv(s,c);if(h===void 0)throw new Error(`Cannot create pairs - parent has undefined or zero size: ${h}.`);const g=[];return i.forEach((b,$)=>{if($>0){const y=i[$-1],w=i[$],C=a[$-1],S=s===Pn.Horizontal?y.getBoundingClientRect().left:y.getBoundingClientRect().top,k=s===Pn.Horizontal?w.getBoundingClientRect().right:w.getBoundingClientRect().bottom,E=s===Pn.Horizontal?y.getBoundingClientRect().width+C.getBoundingClientRect().width+w.getBoundingClientRect().width:y.getBoundingClientRect().height+C.getBoundingClientRect().height+w.getBoundingClientRect().height,R=s===Pn.Horizontal?C.getBoundingClientRect().width:C.getBoundingClientRect().height,F={idx:$-1,a:y,b:w,gutter:C,parent:c,start:S,end:k,size:E,gutterSize:R,aSizePct:100/i.length,bSizePct:100/i.length};g.push(F)}}),Object.assign(Object.assign({},o),{pairs:g})}case Bi.StartDragging:{const{gutterIdx:s}=n.payload;return Object.assign(Object.assign({},o),{isDragging:!0,draggingIdx:s})}case Bi.StopDragging:return Object.assign(Object.assign({},o),{isDragging:!1});case Bi.CalculateSizes:{const{direction:s,gutterIdx:i}=n.payload,a=o.pairs[i],c=Cv(s,a.parent);if(!c)throw new Error("Cannot calculate sizes - 'pair.parent' has undefined or zero size.");const h=a.gutter[s===Pn.Horizontal?"clientWidth":"clientHeight"],g=i===0,b=i===o.pairs.length-1,{aGutterSize:$,bGutterSize:y}=J_(h,g,b);let w,C,S,k,E;return s===Pn.Horizontal?(w=a.a.getBoundingClientRect().left,C=a.b.getBoundingClientRect().right,k=(a.a.getBoundingClientRect().width+$)/c*100,E=(a.b.getBoundingClientRect().width+y)/c*100,S=a.a.getBoundingClientRect().width+$+y+a.b.getBoundingClientRect().width):(w=a.a.getBoundingClientRect().top,C=a.b.getBoundingClientRect().bottom,k=(a.a.getBoundingClientRect().height+$)/c*100,E=(a.b.getBoundingClientRect().height+y)/c*100,S=a.a.getBoundingClientRect().height+$+y+a.b.getBoundingClientRect().height),o.pairs[i]=Object.assign(Object.assign({},a),{start:w,end:C,size:S,aSizePct:k,bSizePct:E,gutterSize:h}),Object.assign({},o)}default:return o}}function BT(o,n=0,s=[]){return ve.Children.toArray(o).reduce((i,a,c)=>(s1.isFragment(a)?i.push.apply(i,BT(a.props.children,n+1,s.concat(a.key||c))):ve.isValidElement(a)?i.push(ve.cloneElement(a,{key:s.concat(String(a.key)).join(".")})):typeof a!="string"&&typeof a!="number"||i.push(a),i),[])}(function(o){o[o.SetIsReadyToCompute=0]="SetIsReadyToCompute",o[o.CreatePairs=1]="CreatePairs",o[o.CalculateSizes=2]="CalculateSizes",o[o.StartDragging=3]="StartDragging",o[o.StopDragging=4]="StopDragging"})(Bi||(Bi={}));const x0=o=>"changedTouches"in o;var Pn,Y_;(function(o){o.Horizontal="Horizontal",o.Vertical="Vertical"})(Pn||(Pn={})),function(o){o.Light="Light",o.Dark="Dark"}(Y_||(Y_={}));const lv=typeof window<"u"&&"ontouchstart"in window;function Qy(o){return o===Pn.Horizontal?"col-resize":"row-resize"}const o1={isReady:!1,isDragging:!1,pairs:[]};function Tv({direction:o=Pn.Horizontal,minWidths:n=[],minHeights:s=[],initialSizes:i,gutterTheme:a=Y_.Dark,gutterClassName:c,draggerClassName:h,children:g,onResizeStarted:b,onResizeFinished:$,classes:y=[]}){const w=BT(g),[C,S]=ve.useReducer(i1,o1),k=ve.useRef(null),E=ve.useRef([]),R=ve.useRef([]);E.current=[],R.current=[];const F=Le.useCallback(he=>{S({type:Bi.SetIsReadyToCompute,payload:{isReady:he}})},[]),M=Le.useCallback((he,q)=>{S({type:Bi.StartDragging,payload:{gutterIdx:q}});const re=C.pairs[q];b==null||b(re.idx),re.a.style.userSelect="none",re.b.style.userSelect="none",re.gutter.style.cursor=Qy(he),re.parent.style.cursor=Qy(he),document.body.style.cursor=Qy(he)},[C.pairs]),L=Le.useCallback(()=>{S({type:Bi.StopDragging});const he=[];for(let re=0;re<C.pairs.length;re++){const De=C.pairs[re],ee=Cv(o,De.parent);if(ee===void 0)throw new Error("Cannot call the 'onResizeFinished' callback - parentSize is undefined");if(De.gutterSize===void 0)throw new Error("Cannot call 'onResizeFinished' callback - gutterSize is undefined");const Fe=re===0,Ce=re===C.pairs.length-1,Ze=De.a.getBoundingClientRect()[o===Pn.Horizontal?"width":"height"],{aGutterSize:pe,bGutterSize:Te}=J_(De.gutterSize,Fe,Ce),ke=(Ze+pe)/ee*100;if(he.push(ke),Ce){const Xe=(De.b.getBoundingClientRect()[o===Pn.Horizontal?"width":"height"]+Te)/ee*100;he.push(Xe)}}if(C.draggingIdx===void 0)throw new Error("Could not reset cursor and user-select because 'state.draggingIdx' is undefined");const q=C.pairs[C.draggingIdx];$==null||$(q.idx,he),q.a.style.userSelect="",q.b.style.userSelect="",q.gutter.style.cursor="",q.parent.style.cursor="",document.body.style.cursor=""},[C.draggingIdx,C.pairs,o]),T=Le.useCallback((he,q)=>{S({type:Bi.CalculateSizes,payload:{direction:he,gutterIdx:q}})},[]),V=Le.useCallback((he,q,re)=>{S({type:Bi.CreatePairs,payload:{direction:he,children:q,gutters:re}})},[]),K=Le.useCallback((he,q,re,De)=>{const ee=q[0].parentNode;if(!ee)throw new Error("Cannot set initial sizes - parent is undefined");if(Cv(he,ee)===void 0)throw new Error("Cannot set initial sizes - parent has undefined size");q.forEach((Fe,Ce)=>{const Ze=Ce===0,pe=Ce===q.length-1;let Te,ke=0;q.length>1&&(ke=re[pe?Ce-1:Ce].getBoundingClientRect()[he===Pn.Horizontal?"width":"height"],ke=Ze||pe?ke/2:ke),Te=De&&Ce<De.length?`calc(${De[Ce]}% - ${ke}px)`:`calc(${100/q.length}% - ${ke}px)`,he===Pn.Horizontal?(Fe.style.width=Te,Fe.style.height="100%"):(Fe.style.height=Te,Fe.style.width="100%")})},[]),Y=Le.useCallback((he,q)=>{if(C.draggingIdx===void 0)throw new Error("Cannot adjust size - 'draggingIdx' is undefined");const re=C.pairs[C.draggingIdx];if(re.size===void 0)throw new Error("Cannot adjust size - 'pair.size' is undefined");if(re.gutterSize===void 0)throw new Error("Cannot adjust size - 'pair.gutterSize' is undefined");const De=re.aSizePct+re.bSizePct,ee=q/re.size*De,Fe=De-q/re.size*De,Ce=C.draggingIdx===0,Ze=C.draggingIdx===C.pairs.length-1,{aGutterSize:pe,bGutterSize:Te}=J_(re.gutterSize,Ce,Ze),ke=`calc(${ee}% - ${pe}px)`,Xe=`calc(${Fe}% - ${Te}px)`;he===Pn.Horizontal?(re.a.style.width=ke,re.b.style.width=Xe):(re.a.style.height=ke,re.b.style.height=Xe)},[C.draggingIdx,C.pairs,o]),te=Le.useCallback((he,q,re)=>{if(!C.isDragging)return;if(C.draggingIdx===void 0)throw new Error("Cannot drag - 'draggingIdx' is undefined");const De=C.pairs[C.draggingIdx];if(De.start===void 0)throw new Error("Cannot drag - 'pair.start' is undefined");if(De.size===void 0)throw new Error("Cannot drag - 'pair.size' is undefined");if(De.gutterSize===void 0)throw new Error("Cannot drag - 'pair.gutterSize' is undefined");let ee=function(Ze,pe){const Te=x0(pe)?pe.changedTouches[0]:pe;return Ze===Pn.Horizontal?Te.clientX:Te.clientY}(q,he)-De.start,Fe=16,Ce=16;re.length>C.draggingIdx&&(Fe=re[C.draggingIdx]),re.length>=C.draggingIdx+1&&(Ce=re[C.draggingIdx+1]),ee<De.gutterSize+Fe&&(ee=De.gutterSize+Fe),ee>=De.size-(De.gutterSize+Ce)&&(ee=De.size-(De.gutterSize+Ce)),Y(q,ee)},[C.isDragging,C.draggingIdx,C.pairs,Y]),J=()=>{if(C.isDragging){if(C.draggingIdx===void 0)throw new Error("Cannot calculate sizes after dragging = 'state.draggingIdx' is undefined");T(o,C.draggingIdx),L()}},ne=he=>{C.isDragging&&(x0(he)&&he.preventDefault(),te(he,o,o===Pn.Horizontal?n:s))};function Q(he,q){if(!he.current)throw new Error("Can't add element to ref object - ref isn't initialized");q&&!he.current.includes(q)&&he.current.push(q)}return G$("mouseup",J,[C.isDragging,L]),G$("mousemove",ne,[o,C.isDragging,te,n,s]),G$("touchend",J,[C.isDragging,L],{condition:lv}),G$("touchmove",ne,[o,C.isDragging,te,n,s],{condition:lv,passive:!lv}),ve.useEffect(function(){if(!k.current)return;const he=k.current.parentElement;if(!he)return;const q=new ResizeObserver(()=>{const re=getComputedStyle(he),De=o===Pn.Horizontal?he.clientWidth:he.clientHeight;F(!!re&&!!De)});return q.observe(he),()=>{q.disconnect()}},[k.current,o]),ve.useEffect(function(){if(C.isReady&&(!E.current||E.current[0].offsetParent)){if(!E.current||!R.current)throw new Error("Cannot create pairs - either variable 'childRefs' or 'gutterRefs' is undefined");w.length<=1?K(o,E.current,R.current,i):(K(o,E.current,R.current,i),V(o,E.current,R.current))}},[g,C.isReady,o,K,V,i]),f.jsx("div",Object.assign({className:`__dbk__container ${o}`,ref:k},{children:C.isReady&&w.map((he,q)=>f.jsxs(Le.Fragment,{children:[f.jsx("div",Object.assign({ref:re=>Q(E,re),className:"__dbk__child-wrapper "+(q<y.length?y[q]:"")},{children:he}),void 0),q<w.length-1&&f.jsx(r1,{ref:re=>Q(R,re),className:c,theme:a,draggerClassName:h,direction:o,onDragging:()=>{return T(o,re=q),void M(o,re);var re}},void 0)]},q))}),void 0)}const{loadShare:a1}=G_,{initPromise:l1}=xx,c1=l1.then(o=>a1("@iobroker/adapter-react-v5",{customShareInfo:{shareConfig:{singleton:!0,strictVersion:!1,requiredVersion:"*"}}})),u1=await c1.then(o=>o());var I=u1,PT={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},D0=Le.createContext&&Le.createContext(PT),d1=["attr","size","title"];function h1(o,n){if(o==null)return{};var s=p1(o,n),i,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(o);for(a=0;a<c.length;a++)i=c[a],!(n.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(o,i)&&(s[i]=o[i])}return s}function p1(o,n){if(o==null)return{};var s={};for(var i in o)if(Object.prototype.hasOwnProperty.call(o,i)){if(n.indexOf(i)>=0)continue;s[i]=o[i]}return s}function Ev(){return Ev=Object.assign?Object.assign.bind():function(o){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(o[i]=s[i])}return o},Ev.apply(this,arguments)}function O0(o,n){var s=Object.keys(o);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(o);n&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(o,a).enumerable})),s.push.apply(s,i)}return s}function kv(o){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?O0(Object(s),!0).forEach(function(i){g1(o,i,s[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(s)):O0(Object(s)).forEach(function(i){Object.defineProperty(o,i,Object.getOwnPropertyDescriptor(s,i))})}return o}function g1(o,n,s){return n=f1(n),n in o?Object.defineProperty(o,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):o[n]=s,o}function f1(o){var n=m1(o,"string");return typeof n=="symbol"?n:n+""}function m1(o,n){if(typeof o!="object"||!o)return o;var s=o[Symbol.toPrimitive];if(s!==void 0){var i=s.call(o,n||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(o)}function FT(o){return o&&o.map((n,s)=>Le.createElement(n.tag,kv({key:s},n.attr),FT(n.child)))}function kt(o){return n=>Le.createElement(b1,Ev({attr:kv({},o.attr)},n),FT(o.child))}function b1(o){var n=s=>{var{attr:i,size:a,title:c}=o,h=h1(o,d1),g=a||s.size||"1em",b;return s.className&&(b=s.className),o.className&&(b=(b?b+" ":"")+o.className),Le.createElement("svg",Ev({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},s.attr,i,h,{className:b,style:kv(kv({color:o.color||s.color},s.style),o.style),height:g,width:g,xmlns:"http://www.w3.org/2000/svg"}),c&&Le.createElement("title",null,c),o.children)};return D0!==void 0?Le.createElement(D0.Consumer,null,s=>n(s)):n(PT)}function Hf(o){return kt({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M20 8h-2.81a5.985 5.985 0 0 0-1.82-1.96L17 4.41 15.59 3l-2.17 2.17C12.96 5.06 12.49 5 12 5c-.49 0-.96.06-1.41.17L8.41 3 7 4.41l1.62 1.63C7.88 6.55 7.26 7.22 6.81 8H4v2h2.09c-.05.33-.09.66-.09 1v1H4v2h2v1c0 .34.04.67.09 1H4v2h2.81c1.04 1.79 2.97 3 5.19 3s4.15-1.21 5.19-3H20v-2h-2.09c.05-.33.09-.66.09-1v-1h2v-2h-2v-1c0-.34-.04-.67-.09-1H20V8zm-6 8h-4v-2h4v2zm0-4h-4v-2h4v2z"},child:[]}]})(o)}function $1(o){return kt({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z",clipRule:"evenodd"},child:[]},{tag:"path",attr:{d:"m22.7 19-9.1-9.1c.9-2.3.4-5-1.5-6.9-2-2-5-2.4-7.4-1.3L9 6 6 9 1.6 4.7C.4 7.1.9 10.1 2.9 12.1c1.9 1.9 4.6 2.4 6.9 1.5l9.1 9.1c.4.4 1 .4 1.4 0l2.3-2.3c.5-.4.5-1.1.1-1.4z"},child:[]}]})(o)}function jT(o){return kt({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"},child:[]},{tag:"path",attr:{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zm2.46-7.12 1.41-1.41L12 12.59l2.12-2.12 1.41 1.41L13.41 14l2.12 2.12-1.41 1.41L12 15.41l-2.12 2.12-1.41-1.41L10.59 14l-2.13-2.12zM15.5 4l-1-1h-5l-1 1H5v2h14V4z"},child:[]}]})(o)}function cv(o){return kt({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"},child:[]}]})(o)}function v1(o){return kt({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M21 4H11l-1-3H3c-1.1 0-2 .9-2 2v15c0 1.1.9 2 2 2h8l1 3h9c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zM7 16c-2.76 0-5-2.24-5-5s2.24-5 5-5c1.35 0 2.48.5 3.35 1.3L9.03 8.57c-.38-.36-1.04-.78-2.03-.78-1.74 0-3.15 1.44-3.15 3.21S5.26 14.21 7 14.21c2.01 0 2.84-1.44 2.92-2.41H7v-1.71h4.68c.07.31.12.61.12 1.02C11.8 13.97 9.89 16 7 16zm6.17-5.42h3.7c-.43 1.25-1.11 2.43-2.05 3.47-.31-.35-.6-.72-.86-1.1l-.79-2.37zm8.33 9.92c0 .55-.45 1-1 1H14l2-2.5-1.04-3.1 3.1 3.1.92-.92-3.3-3.25.02-.02c1.13-1.25 1.93-2.69 2.4-4.22H20v-1.3h-4.53V8h-1.29v1.29h-1.44L11.46 5.5h9.04c.55 0 1 .45 1 1v14z"},child:[]},{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0zm0 0h24v24H0z"},child:[]}]})(o)}function zT(o){return kt({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M21 3.01H3c-1.1 0-2 .9-2 2V9h2V4.99h18v14.03H3V15H1v4.01c0 1.1.9 1.98 2 1.98h18c1.1 0 2-.88 2-1.98v-14a2 2 0 0 0-2-2zM11 16l4-4-4-4v3H1v2h10v3z"},child:[]}]})(o)}function y1(o){return kt({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"},child:[]}]})(o)}function _1(o){return kt({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M16 17.01V10h-2v7.01h-3L15 21l4-3.99h-3zM9 3 5 6.99h3V14h2V6.99h3L9 3z"},child:[]}]})(o)}function w1(o){return kt({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0zm0 0h24v24H0zm0 0h24v24H0zm0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7zM2 4.27l2.28 2.28.46.46A11.804 11.804 0 0 0 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3 2 4.27zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2zm4.31-.78 3.15 3.15.02-.16c0-1.66-1.34-3-3-3l-.17.01z"},child:[]}]})(o)}function S1(o){return kt({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"},child:[]}]})(o)}function C1(o){return kt({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"},child:[]}]})(o)}function Xf(o){return kt({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M6 19h4V5H6v14zm8-14v14h4V5h-4z"},child:[]}]})(o)}function Iv(o){return kt({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M8 5v14l11-7z"},child:[]}]})(o)}function R0(o){return kt({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M3 10h11v2H3zM3 6h11v2H3zM3 14h7v2H3zM20.59 11.93l-4.25 4.24-2.12-2.12-1.41 1.41L16.34 19 22 13.34z"},child:[]}]})(o)}function T1(o){return kt({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M5 13h14v-2H5v2zm-2 4h14v-2H3v2zM7 7v2h14V7H7z"},child:[]}]})(o)}function cy(o){return kt({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"},child:[]}]})(o)}function zw(o){return kt({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"},child:[]}]})(o)}function A0(o){return kt({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M17 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm3-10H5V5h10v4z"},child:[]}]})(o)}function E1(o){return kt({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3A8.994 8.994 0 0 0 13 3.06V1h-2v2.06A8.994 8.994 0 0 0 3.06 11H1v2h2.06A8.994 8.994 0 0 0 11 20.94V23h2v-2.06A8.994 8.994 0 0 0 20.94 13H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"},child:[]}]})(o)}function k1(o){return kt({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M3.27 5 2 6.27l6.97 6.97L6.5 19h3l1.57-3.66L16.73 21 18 19.73 3.55 5.27 3.27 5zM6 5v.18L8.82 8h2.4l-.72 1.68 2.1 2.1L14.21 8H20V5H6z"},child:[]}]})(o)}function UT(o){return kt({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M16 13h-3V3h-2v10H8l4 4 4-4zM4 19v2h16v-2H4z"},child:[]}]})(o)}function I1(o){return kt({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"},child:[]},{tag:"path",attr:{d:"M20 6h-8l-2-2H4c-1.11 0-1.99.89-1.99 2L2 18c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm-1 8h-3v3h-2v-3h-3v-2h3V9h2v3h3v2z"},child:[]}]})(o)}function HT(o){return kt({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M9 16h6v-6h4l-7-7-7 7h4zm-4 2h14v2H5z"},child:[]}]})(o)}function x1(o){return kt({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69zM12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6c3.31 0 6 2.69 6 6s-2.69 6-6 6z"},child:[]}]})(o)}function D1(o){return kt({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04a.996.996 0 0 0 0-1.41l-2.34-2.34a.996.996 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"},child:[]}]})(o)}function O1(o){return kt({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M12 2C6.49 2 2 6.49 2 12s4.49 10 10 10a2.5 2.5 0 0 0 2.5-2.5c0-.61-.23-1.2-.64-1.67a.528.528 0 0 1-.13-.33c0-.28.22-.5.5-.5H16c3.31 0 6-2.69 6-6 0-4.96-4.49-9-10-9zm5.5 11c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zm-3-4c-.83 0-1.5-.67-1.5-1.5S13.67 6 14.5 6s1.5.67 1.5 1.5S15.33 9 14.5 9zM5 11.5c0-.83.67-1.5 1.5-1.5s1.5.67 1.5 1.5S7.33 13 6.5 13 5 12.33 5 11.5zm6-4c0 .83-.67 1.5-1.5 1.5S8 8.33 8 7.5 8.67 6 9.5 6s1.5.67 1.5 1.5z"},child:[]}]})(o)}function R1(o){return kt({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"},child:[]}]})(o)}function A1(o){return kt({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"},child:[]},{tag:"path",attr:{d:"m20 12-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8 8-8z"},child:[]}]})(o)}function N1(o){return kt({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"m12 4-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8z"},child:[]}]})(o)}function M1(o){return kt({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"},child:[]},{tag:"path",attr:{d:"m4 12 1.41 1.41L11 7.83V20h2V7.83l5.58 5.59L20 12l-8-8-8 8z"},child:[]}]})(o)}function uy(o){return kt({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z"},child:[]}]})(o)}function X_(o){return kt({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M9 16.17 4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"},child:[]}]})(o)}function Uh(o){return kt({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"},child:[]}]})(o)}function L1(o){return kt({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"},child:[]}]})(o)}function B1(o){return kt({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"},child:[]}]})(o)}function WT(o){return kt({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M17.65 6.35A7.958 7.958 0 0 0 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08A5.99 5.99 0 0 1 12 18c-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"},child:[]}]})(o)}function P1(o){return kt({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M7.41 18.59 8.83 20 12 16.83 15.17 20l1.41-1.41L12 14l-4.59 4.59zm9.18-13.18L15.17 4 12 7.17 8.83 4 7.41 5.41 12 10l4.59-4.59z"},child:[]}]})(o)}function F1(o){return kt({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M12 5.83 15.17 9l1.41-1.41L12 3 7.41 7.59 8.83 9 12 5.83zm0 12.34L8.83 15l-1.41 1.41L12 21l4.59-4.59L15.17 15 12 18.17z"},child:[]}]})(o)}const VT=ve.createContext({dragDropManager:void 0});function om(o){"@babel/helpers - typeof";return om=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},om(o)}function j1(o,n){if(om(o)!="object"||!o)return o;var s=o[Symbol.toPrimitive];if(s!==void 0){var i=s.call(o,n||"default");if(om(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(o)}function z1(o){var n=j1(o,"string");return om(n)=="symbol"?n:n+""}function U1(o,n,s){return(n=z1(n))in o?Object.defineProperty(o,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):o[n]=s,o}function Ni(o){return"Minified Redux error #"+o+"; visit https://redux.js.org/Errors?code="+o+" for the full message or use the non-minified dev environment for full errors. "}var N0=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}(),e_=function(){return Math.random().toString(36).substring(7).split("").join(".")},M0={INIT:"@@redux/INIT"+e_(),REPLACE:"@@redux/REPLACE"+e_(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+e_()}};function H1(o){if(typeof o!="object"||o===null)return!1;for(var n=o;Object.getPrototypeOf(n)!==null;)n=Object.getPrototypeOf(n);return Object.getPrototypeOf(o)===n}function GT(o,n,s){var i;if(typeof n=="function"&&typeof s=="function"||typeof s=="function"&&typeof arguments[3]=="function")throw new Error(Ni(0));if(typeof n=="function"&&typeof s>"u"&&(s=n,n=void 0),typeof s<"u"){if(typeof s!="function")throw new Error(Ni(1));return s(GT)(o,n)}if(typeof o!="function")throw new Error(Ni(2));var a=o,c=n,h=[],g=h,b=!1;function $(){g===h&&(g=h.slice())}function y(){if(b)throw new Error(Ni(3));return c}function w(E){if(typeof E!="function")throw new Error(Ni(4));if(b)throw new Error(Ni(5));var R=!0;return $(),g.push(E),function(){if(R){if(b)throw new Error(Ni(6));R=!1,$();var M=g.indexOf(E);g.splice(M,1),h=null}}}function C(E){if(!H1(E))throw new Error(Ni(7));if(typeof E.type>"u")throw new Error(Ni(8));if(b)throw new Error(Ni(9));try{b=!0,c=a(c,E)}finally{b=!1}for(var R=h=g,F=0;F<R.length;F++){var M=R[F];M()}return E}function S(E){if(typeof E!="function")throw new Error(Ni(10));a=E,C({type:M0.REPLACE})}function k(){var E,R=w;return E={subscribe:function(M){if(typeof M!="object"||M===null)throw new Error(Ni(11));function L(){M.next&&M.next(y())}L();var T=R(L);return{unsubscribe:T}}},E[N0]=function(){return this},E}return C({type:M0.INIT}),i={dispatch:C,subscribe:w,getState:y,replaceReducer:S},i[N0]=k,i}function Mt(o,n,...s){if(W1()&&n===void 0)throw new Error("invariant requires an error message argument");if(!o){let i;if(n===void 0)i=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{let a=0;i=new Error(n.replace(/%s/g,function(){return s[a++]})),i.name="Invariant Violation"}throw i.framesToPop=1,i}}function W1(){return typeof process<"u"&&!0}function V1(o,n,s){return n.split(".").reduce((i,a)=>i&&i[a]?i[a]:s,o)}function G1(o,n){return o.filter(s=>s!==n)}function qT(o){return typeof o=="object"}function q1(o,n){const s=new Map,i=c=>{s.set(c,s.has(c)?s.get(c)+1:1)};o.forEach(i),n.forEach(i);const a=[];return s.forEach((c,h)=>{c===1&&a.push(h)}),a}function K1(o,n){return o.filter(s=>n.indexOf(s)>-1)}const Uw="dnd-core/INIT_COORDS",dy="dnd-core/BEGIN_DRAG",Hw="dnd-core/PUBLISH_DRAG_SOURCE",hy="dnd-core/HOVER",py="dnd-core/DROP",gy="dnd-core/END_DRAG";function L0(o,n){return{type:Uw,payload:{sourceClientOffset:n||null,clientOffset:o||null}}}const J1={type:Uw,payload:{clientOffset:null,sourceClientOffset:null}};function Y1(o){return function(s=[],i={publishSource:!0}){const{publishSource:a=!0,clientOffset:c,getSourceClientOffset:h}=i,g=o.getMonitor(),b=o.getRegistry();o.dispatch(L0(c)),X1(s,g,b);const $=eD(s,g);if($==null){o.dispatch(J1);return}let y=null;if(c){if(!h)throw new Error("getSourceClientOffset must be defined");Z1(h),y=h($)}o.dispatch(L0(c,y));const C=b.getSource($).beginDrag(g,$);if(C==null)return;Q1(C),b.pinSource($);const S=b.getSourceType($);return{type:dy,payload:{itemType:S,item:C,sourceId:$,clientOffset:c||null,sourceClientOffset:y||null,isSourcePublic:!!a}}}}function X1(o,n,s){Mt(!n.isDragging(),"Cannot call beginDrag while dragging."),o.forEach(function(i){Mt(s.getSource(i),"Expected sourceIds to be registered.")})}function Z1(o){Mt(typeof o=="function","When clientOffset is provided, getSourceClientOffset must be a function.")}function Q1(o){Mt(qT(o),"Item must be an object.")}function eD(o,n){let s=null;for(let i=o.length-1;i>=0;i--)if(n.canDragSource(o[i])){s=o[i];break}return s}function tD(o,n,s){return n in o?Object.defineProperty(o,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):o[n]=s,o}function nD(o){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{},i=Object.keys(s);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(s).filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable}))),i.forEach(function(a){tD(o,a,s[a])})}return o}function sD(o){return function(s={}){const i=o.getMonitor(),a=o.getRegistry();rD(i),aD(i).forEach((h,g)=>{const b=iD(h,g,a,i),$={type:py,payload:{dropResult:nD({},s,b)}};o.dispatch($)})}}function rD(o){Mt(o.isDragging(),"Cannot call drop while not dragging."),Mt(!o.didDrop(),"Cannot call drop twice during one drag operation.")}function iD(o,n,s,i){const a=s.getTarget(o);let c=a?a.drop(i,o):void 0;return oD(c),typeof c>"u"&&(c=n===0?{}:i.getDropResult()),c}function oD(o){Mt(typeof o>"u"||qT(o),"Drop result must either be an object or undefined.")}function aD(o){const n=o.getTargetIds().filter(o.canDropOnTarget,o);return n.reverse(),n}function lD(o){return function(){const s=o.getMonitor(),i=o.getRegistry();cD(s);const a=s.getSourceId();return a!=null&&(i.getSource(a,!0).endDrag(s,a),i.unpinSource()),{type:gy}}}function cD(o){Mt(o.isDragging(),"Cannot call endDrag while not dragging.")}function Z_(o,n){return n===null?o===null:Array.isArray(o)?o.some(s=>s===n):o===n}function uD(o){return function(s,{clientOffset:i}={}){dD(s);const a=s.slice(0),c=o.getMonitor(),h=o.getRegistry(),g=c.getItemType();return pD(a,h,g),hD(a,c,h),gD(a,c,h),{type:hy,payload:{targetIds:a,clientOffset:i||null}}}}function dD(o){Mt(Array.isArray(o),"Expected targetIds to be an array.")}function hD(o,n,s){Mt(n.isDragging(),"Cannot call hover while not dragging."),Mt(!n.didDrop(),"Cannot call hover after drop.");for(let i=0;i<o.length;i++){const a=o[i];Mt(o.lastIndexOf(a)===i,"Expected targetIds to be unique in the passed array.");const c=s.getTarget(a);Mt(c,"Expected targetIds to be registered.")}}function pD(o,n,s){for(let i=o.length-1;i>=0;i--){const a=o[i],c=n.getTargetType(a);Z_(c,s)||o.splice(i,1)}}function gD(o,n,s){o.forEach(function(i){s.getTarget(i).hover(n,i)})}function fD(o){return function(){if(o.getMonitor().isDragging())return{type:Hw}}}function mD(o){return{beginDrag:Y1(o),publishDragSource:fD(o),hover:uD(o),drop:sD(o),endDrag:lD(o)}}class bD{receiveBackend(n){this.backend=n}getMonitor(){return this.monitor}getBackend(){return this.backend}getRegistry(){return this.monitor.registry}getActions(){const n=this,{dispatch:s}=this.store;function i(c){return(...h)=>{const g=c.apply(n,h);typeof g<"u"&&s(g)}}const a=mD(this);return Object.keys(a).reduce((c,h)=>{const g=a[h];return c[h]=i(g),c},{})}dispatch(n){this.store.dispatch(n)}constructor(n,s){this.isSetUp=!1,this.handleRefCountChange=()=>{const i=this.store.getState().refCount>0;this.backend&&(i&&!this.isSetUp?(this.backend.setup(),this.isSetUp=!0):!i&&this.isSetUp&&(this.backend.teardown(),this.isSetUp=!1))},this.store=n,this.monitor=s,n.subscribe(this.handleRefCountChange)}}function $D(o,n){return{x:o.x+n.x,y:o.y+n.y}}function KT(o,n){return{x:o.x-n.x,y:o.y-n.y}}function vD(o){const{clientOffset:n,initialClientOffset:s,initialSourceClientOffset:i}=o;return!n||!s||!i?null:KT($D(n,i),s)}function yD(o){const{clientOffset:n,initialClientOffset:s}=o;return!n||!s?null:KT(n,s)}const Zf=[],Ww=[];Zf.__IS_NONE__=!0;Ww.__IS_ALL__=!0;function _D(o,n){return o===Zf?!1:o===Ww||typeof n>"u"?!0:K1(n,o).length>0}class wD{subscribeToStateChange(n,s={}){const{handlerIds:i}=s;Mt(typeof n=="function","listener must be a function."),Mt(typeof i>"u"||Array.isArray(i),"handlerIds, when specified, must be an array of strings.");let a=this.store.getState().stateId;const c=()=>{const h=this.store.getState(),g=h.stateId;try{g===a||g===a+1&&!_D(h.dirtyHandlerIds,i)||n()}finally{a=g}};return this.store.subscribe(c)}subscribeToOffsetChange(n){Mt(typeof n=="function","listener must be a function.");let s=this.store.getState().dragOffset;const i=()=>{const a=this.store.getState().dragOffset;a!==s&&(s=a,n())};return this.store.subscribe(i)}canDragSource(n){if(!n)return!1;const s=this.registry.getSource(n);return Mt(s,`Expected to find a valid source. sourceId=${n}`),this.isDragging()?!1:s.canDrag(this,n)}canDropOnTarget(n){if(!n)return!1;const s=this.registry.getTarget(n);if(Mt(s,`Expected to find a valid target. targetId=${n}`),!this.isDragging()||this.didDrop())return!1;const i=this.registry.getTargetType(n),a=this.getItemType();return Z_(i,a)&&s.canDrop(this,n)}isDragging(){return!!this.getItemType()}isDraggingSource(n){if(!n)return!1;const s=this.registry.getSource(n,!0);if(Mt(s,`Expected to find a valid source. sourceId=${n}`),!this.isDragging()||!this.isSourcePublic())return!1;const i=this.registry.getSourceType(n),a=this.getItemType();return i!==a?!1:s.isDragging(this,n)}isOverTarget(n,s={shallow:!1}){if(!n)return!1;const{shallow:i}=s;if(!this.isDragging())return!1;const a=this.registry.getTargetType(n),c=this.getItemType();if(c&&!Z_(a,c))return!1;const h=this.getTargetIds();if(!h.length)return!1;const g=h.indexOf(n);return i?g===h.length-1:g>-1}getItemType(){return this.store.getState().dragOperation.itemType}getItem(){return this.store.getState().dragOperation.item}getSourceId(){return this.store.getState().dragOperation.sourceId}getTargetIds(){return this.store.getState().dragOperation.targetIds}getDropResult(){return this.store.getState().dragOperation.dropResult}didDrop(){return this.store.getState().dragOperation.didDrop}isSourcePublic(){return!!this.store.getState().dragOperation.isSourcePublic}getInitialClientOffset(){return this.store.getState().dragOffset.initialClientOffset}getInitialSourceClientOffset(){return this.store.getState().dragOffset.initialSourceClientOffset}getClientOffset(){return this.store.getState().dragOffset.clientOffset}getSourceClientOffset(){return vD(this.store.getState().dragOffset)}getDifferenceFromInitialOffset(){return yD(this.store.getState().dragOffset)}constructor(n,s){this.store=n,this.registry=s}}const B0=typeof global<"u"?global:self,JT=B0.MutationObserver||B0.WebKitMutationObserver;function YT(o){return function(){const s=setTimeout(a,0),i=setInterval(a,50);function a(){clearTimeout(s),clearInterval(i),o()}}}function SD(o){let n=1;const s=new JT(o),i=document.createTextNode("");return s.observe(i,{characterData:!0}),function(){n=-n,i.data=n}}const CD=typeof JT=="function"?SD:YT;class TD{enqueueTask(n){const{queue:s,requestFlush:i}=this;s.length||(i(),this.flushing=!0),s[s.length]=n}constructor(){this.queue=[],this.pendingErrors=[],this.flushing=!1,this.index=0,this.capacity=1024,this.flush=()=>{const{queue:n}=this;for(;this.index<n.length;){const s=this.index;if(this.index++,n[s].call(),this.index>this.capacity){for(let i=0,a=n.length-this.index;i<a;i++)n[i]=n[i+this.index];n.length-=this.index,this.index=0}}n.length=0,this.index=0,this.flushing=!1},this.registerPendingError=n=>{this.pendingErrors.push(n),this.requestErrorThrow()},this.requestFlush=CD(this.flush),this.requestErrorThrow=YT(()=>{if(this.pendingErrors.length)throw this.pendingErrors.shift()})}}class ED{call(){try{this.task&&this.task()}catch(n){this.onError(n)}finally{this.task=null,this.release(this)}}constructor(n,s){this.onError=n,this.release=s,this.task=null}}class kD{create(n){const s=this.freeTasks,i=s.length?s.pop():new ED(this.onError,a=>s[s.length]=a);return i.task=n,i}constructor(n){this.onError=n,this.freeTasks=[]}}const XT=new TD,ID=new kD(XT.registerPendingError);function xD(o){XT.enqueueTask(ID.create(o))}const Vw="dnd-core/ADD_SOURCE",Gw="dnd-core/ADD_TARGET",qw="dnd-core/REMOVE_SOURCE",fy="dnd-core/REMOVE_TARGET";function DD(o){return{type:Vw,payload:{sourceId:o}}}function OD(o){return{type:Gw,payload:{targetId:o}}}function RD(o){return{type:qw,payload:{sourceId:o}}}function AD(o){return{type:fy,payload:{targetId:o}}}function ND(o){Mt(typeof o.canDrag=="function","Expected canDrag to be a function."),Mt(typeof o.beginDrag=="function","Expected beginDrag to be a function."),Mt(typeof o.endDrag=="function","Expected endDrag to be a function.")}function MD(o){Mt(typeof o.canDrop=="function","Expected canDrop to be a function."),Mt(typeof o.hover=="function","Expected hover to be a function."),Mt(typeof o.drop=="function","Expected beginDrag to be a function.")}function Q_(o,n){if(n&&Array.isArray(o)){o.forEach(s=>Q_(s,!1));return}Mt(typeof o=="string"||typeof o=="symbol",n?"Type can only be a string, a symbol, or an array of either.":"Type can only be a string or a symbol.")}var Li;(function(o){o.SOURCE="SOURCE",o.TARGET="TARGET"})(Li||(Li={}));let LD=0;function BD(){return LD++}function PD(o){const n=BD().toString();switch(o){case Li.SOURCE:return`S${n}`;case Li.TARGET:return`T${n}`;default:throw new Error(`Unknown Handler Role: ${o}`)}}function P0(o){switch(o[0]){case"S":return Li.SOURCE;case"T":return Li.TARGET;default:throw new Error(`Cannot parse handler ID: ${o}`)}}function F0(o,n){const s=o.entries();let i=!1;do{const{done:a,value:[,c]}=s.next();if(c===n)return!0;i=!!a}while(!i);return!1}class FD{addSource(n,s){Q_(n),ND(s);const i=this.addHandler(Li.SOURCE,n,s);return this.store.dispatch(DD(i)),i}addTarget(n,s){Q_(n,!0),MD(s);const i=this.addHandler(Li.TARGET,n,s);return this.store.dispatch(OD(i)),i}containsHandler(n){return F0(this.dragSources,n)||F0(this.dropTargets,n)}getSource(n,s=!1){return Mt(this.isSourceId(n),"Expected a valid source ID."),s&&n===this.pinnedSourceId?this.pinnedSource:this.dragSources.get(n)}getTarget(n){return Mt(this.isTargetId(n),"Expected a valid target ID."),this.dropTargets.get(n)}getSourceType(n){return Mt(this.isSourceId(n),"Expected a valid source ID."),this.types.get(n)}getTargetType(n){return Mt(this.isTargetId(n),"Expected a valid target ID."),this.types.get(n)}isSourceId(n){return P0(n)===Li.SOURCE}isTargetId(n){return P0(n)===Li.TARGET}removeSource(n){Mt(this.getSource(n),"Expected an existing source."),this.store.dispatch(RD(n)),xD(()=>{this.dragSources.delete(n),this.types.delete(n)})}removeTarget(n){Mt(this.getTarget(n),"Expected an existing target."),this.store.dispatch(AD(n)),this.dropTargets.delete(n),this.types.delete(n)}pinSource(n){const s=this.getSource(n);Mt(s,"Expected an existing source."),this.pinnedSourceId=n,this.pinnedSource=s}unpinSource(){Mt(this.pinnedSource,"No source is pinned at the time."),this.pinnedSourceId=null,this.pinnedSource=null}addHandler(n,s,i){const a=PD(n);return this.types.set(a,s),n===Li.SOURCE?this.dragSources.set(a,i):n===Li.TARGET&&this.dropTargets.set(a,i),a}constructor(n){this.types=new Map,this.dragSources=new Map,this.dropTargets=new Map,this.pinnedSourceId=null,this.pinnedSource=null,this.store=n}}const jD=(o,n)=>o===n;function zD(o,n){return!o&&!n?!0:!o||!n?!1:o.x===n.x&&o.y===n.y}function UD(o,n,s=jD){if(o.length!==n.length)return!1;for(let i=0;i<o.length;++i)if(!s(o[i],n[i]))return!1;return!0}function HD(o=Zf,n){switch(n.type){case hy:break;case Vw:case Gw:case fy:case qw:return Zf;case dy:case Hw:case gy:case py:default:return Ww}const{targetIds:s=[],prevTargetIds:i=[]}=n.payload,a=q1(s,i);if(!(a.length>0||!UD(s,i)))return Zf;const h=i[i.length-1],g=s[s.length-1];return h!==g&&(h&&a.push(h),g&&a.push(g)),a}function WD(o,n,s){return n in o?Object.defineProperty(o,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):o[n]=s,o}function VD(o){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{},i=Object.keys(s);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(s).filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable}))),i.forEach(function(a){WD(o,a,s[a])})}return o}const j0={initialSourceClientOffset:null,initialClientOffset:null,clientOffset:null};function GD(o=j0,n){const{payload:s}=n;switch(n.type){case Uw:case dy:return{initialSourceClientOffset:s.sourceClientOffset,initialClientOffset:s.clientOffset,clientOffset:s.clientOffset};case hy:return zD(o.clientOffset,s.clientOffset)?o:VD({},o,{clientOffset:s.clientOffset});case gy:case py:return j0;default:return o}}function qD(o,n,s){return n in o?Object.defineProperty(o,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):o[n]=s,o}function Ih(o){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{},i=Object.keys(s);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(s).filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable}))),i.forEach(function(a){qD(o,a,s[a])})}return o}const KD={itemType:null,item:null,sourceId:null,targetIds:[],dropResult:null,didDrop:!1,isSourcePublic:null};function JD(o=KD,n){const{payload:s}=n;switch(n.type){case dy:return Ih({},o,{itemType:s.itemType,item:s.item,sourceId:s.sourceId,isSourcePublic:s.isSourcePublic,dropResult:null,didDrop:!1});case Hw:return Ih({},o,{isSourcePublic:!0});case hy:return Ih({},o,{targetIds:s.targetIds});case fy:return o.targetIds.indexOf(s.targetId)===-1?o:Ih({},o,{targetIds:G1(o.targetIds,s.targetId)});case py:return Ih({},o,{dropResult:s.dropResult,didDrop:!0,targetIds:[]});case gy:return Ih({},o,{itemType:null,item:null,sourceId:null,dropResult:null,didDrop:!1,isSourcePublic:null,targetIds:[]});default:return o}}function YD(o=0,n){switch(n.type){case Vw:case Gw:return o+1;case qw:case fy:return o-1;default:return o}}function XD(o=0){return o+1}function ZD(o,n,s){return n in o?Object.defineProperty(o,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):o[n]=s,o}function QD(o){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{},i=Object.keys(s);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(s).filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable}))),i.forEach(function(a){ZD(o,a,s[a])})}return o}function eO(o={},n){return{dirtyHandlerIds:HD(o.dirtyHandlerIds,{type:n.type,payload:QD({},n.payload,{prevTargetIds:V1(o,"dragOperation.targetIds",[])})}),dragOffset:GD(o.dragOffset,n),refCount:YD(o.refCount,n),dragOperation:JD(o.dragOperation,n),stateId:XD(o.stateId)}}function tO(o,n=void 0,s={},i=!1){const a=nO(i),c=new wD(a,new FD(a)),h=new bD(a,c),g=o(h,n,s);return h.receiveBackend(g),h}function nO(o){const n=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION__;return GT(eO,o&&n&&n({name:"dnd-core",instanceId:"dnd-core"}))}function sO(o,n){if(o==null)return{};var s=rO(o,n),i,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(o);for(a=0;a<c.length;a++)i=c[a],!(n.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(o,i)&&(s[i]=o[i])}return s}function rO(o,n){if(o==null)return{};var s={},i=Object.keys(o),a,c;for(c=0;c<i.length;c++)a=i[c],!(n.indexOf(a)>=0)&&(s[a]=o[a]);return s}let z0=0;const uv=Symbol.for("__REACT_DND_CONTEXT_INSTANCE__");var ZT=ve.memo(function(n){var{children:s}=n,i=sO(n,["children"]);const[a,c]=iO(i);return ve.useEffect(()=>{if(c){const h=QT();return++z0,()=>{--z0===0&&(h[uv]=null)}}},[]),f.jsx(VT.Provider,{value:a,children:s})});function iO(o){if("manager"in o)return[{dragDropManager:o.manager},!1];const n=oO(o.backend,o.context,o.options,o.debugMode),s=!o.context;return[n,s]}function oO(o,n=QT(),s,i){const a=n;return a[uv]||(a[uv]={dragDropManager:tO(o,n,s,i)}),a[uv]}function QT(){return typeof global<"u"?global:window}var aO=function o(n,s){if(n===s)return!0;if(n&&s&&typeof n=="object"&&typeof s=="object"){if(n.constructor!==s.constructor)return!1;var i,a,c;if(Array.isArray(n)){if(i=n.length,i!=s.length)return!1;for(a=i;a--!==0;)if(!o(n[a],s[a]))return!1;return!0}if(n.constructor===RegExp)return n.source===s.source&&n.flags===s.flags;if(n.valueOf!==Object.prototype.valueOf)return n.valueOf()===s.valueOf();if(n.toString!==Object.prototype.toString)return n.toString()===s.toString();if(c=Object.keys(n),i=c.length,i!==Object.keys(s).length)return!1;for(a=i;a--!==0;)if(!Object.prototype.hasOwnProperty.call(s,c[a]))return!1;for(a=i;a--!==0;){var h=c[a];if(!o(n[h],s[h]))return!1}return!0}return n!==n&&s!==s};const lO=aa(aO),Lu=typeof window<"u"?ve.useLayoutEffect:ve.useEffect;function eE(o,n,s){const[i,a]=ve.useState(()=>n(o)),c=ve.useCallback(()=>{const h=n(o);lO(i,h)||(a(h),s&&s())},[i,o,s]);return Lu(c),[i,c]}function cO(o,n,s){const[i,a]=eE(o,n,s);return Lu(function(){const h=o.getHandlerId();if(h!=null)return o.subscribeToStateChange(a,{handlerIds:[h]})},[o,a]),i}function tE(o,n,s){return cO(n,o||(()=>({})),()=>s.reconnect())}function nE(o,n){const s=[];return typeof o!="function"&&s.push(o),ve.useMemo(()=>typeof o=="function"?o():o,s)}function uO(o){return ve.useMemo(()=>o.hooks.dragSource(),[o])}function dO(o){return ve.useMemo(()=>o.hooks.dragPreview(),[o])}let t_=!1,n_=!1;class hO{receiveHandlerId(n){this.sourceId=n}getHandlerId(){return this.sourceId}canDrag(){Mt(!t_,"You may not call monitor.canDrag() inside your canDrag() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor");try{return t_=!0,this.internalMonitor.canDragSource(this.sourceId)}finally{t_=!1}}isDragging(){if(!this.sourceId)return!1;Mt(!n_,"You may not call monitor.isDragging() inside your isDragging() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor");try{return n_=!0,this.internalMonitor.isDraggingSource(this.sourceId)}finally{n_=!1}}subscribeToStateChange(n,s){return this.internalMonitor.subscribeToStateChange(n,s)}isDraggingSource(n){return this.internalMonitor.isDraggingSource(n)}isOverTarget(n,s){return this.internalMonitor.isOverTarget(n,s)}getTargetIds(){return this.internalMonitor.getTargetIds()}isSourcePublic(){return this.internalMonitor.isSourcePublic()}getSourceId(){return this.internalMonitor.getSourceId()}subscribeToOffsetChange(n){return this.internalMonitor.subscribeToOffsetChange(n)}canDragSource(n){return this.internalMonitor.canDragSource(n)}canDropOnTarget(n){return this.internalMonitor.canDropOnTarget(n)}getItemType(){return this.internalMonitor.getItemType()}getItem(){return this.internalMonitor.getItem()}getDropResult(){return this.internalMonitor.getDropResult()}didDrop(){return this.internalMonitor.didDrop()}getInitialClientOffset(){return this.internalMonitor.getInitialClientOffset()}getInitialSourceClientOffset(){return this.internalMonitor.getInitialSourceClientOffset()}getSourceClientOffset(){return this.internalMonitor.getSourceClientOffset()}getClientOffset(){return this.internalMonitor.getClientOffset()}getDifferenceFromInitialOffset(){return this.internalMonitor.getDifferenceFromInitialOffset()}constructor(n){this.sourceId=null,this.internalMonitor=n.getMonitor()}}let s_=!1;class pO{receiveHandlerId(n){this.targetId=n}getHandlerId(){return this.targetId}subscribeToStateChange(n,s){return this.internalMonitor.subscribeToStateChange(n,s)}canDrop(){if(!this.targetId)return!1;Mt(!s_,"You may not call monitor.canDrop() inside your canDrop() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drop-target-monitor");try{return s_=!0,this.internalMonitor.canDropOnTarget(this.targetId)}finally{s_=!1}}isOver(n){return this.targetId?this.internalMonitor.isOverTarget(this.targetId,n):!1}getItemType(){return this.internalMonitor.getItemType()}getItem(){return this.internalMonitor.getItem()}getDropResult(){return this.internalMonitor.getDropResult()}didDrop(){return this.internalMonitor.didDrop()}getInitialClientOffset(){return this.internalMonitor.getInitialClientOffset()}getInitialSourceClientOffset(){return this.internalMonitor.getInitialSourceClientOffset()}getSourceClientOffset(){return this.internalMonitor.getSourceClientOffset()}getClientOffset(){return this.internalMonitor.getClientOffset()}getDifferenceFromInitialOffset(){return this.internalMonitor.getDifferenceFromInitialOffset()}constructor(n){this.targetId=null,this.internalMonitor=n.getMonitor()}}function gO(o,n,s){const i=s.getRegistry(),a=i.addTarget(o,n);return[a,()=>i.removeTarget(a)]}function fO(o,n,s){const i=s.getRegistry(),a=i.addSource(o,n);return[a,()=>i.removeSource(a)]}function ew(o,n,s,i){let a;if(a!==void 0)return!!a;if(o===n)return!0;if(typeof o!="object"||!o||typeof n!="object"||!n)return!1;const c=Object.keys(o),h=Object.keys(n);if(c.length!==h.length)return!1;const g=Object.prototype.hasOwnProperty.bind(n);for(let b=0;b<c.length;b++){const $=c[b];if(!g($))return!1;const y=o[$],w=n[$];if(a=void 0,a===!1||a===void 0&&y!==w)return!1}return!0}function tw(o){return o!==null&&typeof o=="object"&&Object.prototype.hasOwnProperty.call(o,"current")}function mO(o){if(typeof o.type=="string")return;const n=o.type.displayName||o.type.name||"the component";throw new Error(`Only native element nodes can now be passed to React DnD connectors.You can either wrap ${n} into a <div>, or turn it into a drag source or a drop target itself.`)}function bO(o){return(n=null,s=null)=>{if(!ve.isValidElement(n)){const c=n;return o(c,s),c}const i=n;return mO(i),$O(i,s?c=>o(c,s):o)}}function sE(o){const n={};return Object.keys(o).forEach(s=>{const i=o[s];if(s.endsWith("Ref"))n[s]=o[s];else{const a=bO(i);n[s]=()=>a}}),n}function U0(o,n){typeof o=="function"?o(n):o.current=n}function $O(o,n){const s=o.ref;return Mt(typeof s!="string","Cannot connect React DnD to an element with an existing string ref. Please convert it to use a callback ref instead, or wrap it into a <span> or <div>. Read more: https://reactjs.org/docs/refs-and-the-dom.html#callback-refs"),s?ve.cloneElement(o,{ref:i=>{U0(s,i),U0(n,i)}}):ve.cloneElement(o,{ref:n})}class vO{receiveHandlerId(n){this.handlerId!==n&&(this.handlerId=n,this.reconnect())}get connectTarget(){return this.dragSource}get dragSourceOptions(){return this.dragSourceOptionsInternal}set dragSourceOptions(n){this.dragSourceOptionsInternal=n}get dragPreviewOptions(){return this.dragPreviewOptionsInternal}set dragPreviewOptions(n){this.dragPreviewOptionsInternal=n}reconnect(){const n=this.reconnectDragSource();this.reconnectDragPreview(n)}reconnectDragSource(){const n=this.dragSource,s=this.didHandlerIdChange()||this.didConnectedDragSourceChange()||this.didDragSourceOptionsChange();return s&&this.disconnectDragSource(),this.handlerId?n?(s&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragSource=n,this.lastConnectedDragSourceOptions=this.dragSourceOptions,this.dragSourceUnsubscribe=this.backend.connectDragSource(this.handlerId,n,this.dragSourceOptions)),s):(this.lastConnectedDragSource=n,s):s}reconnectDragPreview(n=!1){const s=this.dragPreview,i=n||this.didHandlerIdChange()||this.didConnectedDragPreviewChange()||this.didDragPreviewOptionsChange();if(i&&this.disconnectDragPreview(),!!this.handlerId){if(!s){this.lastConnectedDragPreview=s;return}i&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragPreview=s,this.lastConnectedDragPreviewOptions=this.dragPreviewOptions,this.dragPreviewUnsubscribe=this.backend.connectDragPreview(this.handlerId,s,this.dragPreviewOptions))}}didHandlerIdChange(){return this.lastConnectedHandlerId!==this.handlerId}didConnectedDragSourceChange(){return this.lastConnectedDragSource!==this.dragSource}didConnectedDragPreviewChange(){return this.lastConnectedDragPreview!==this.dragPreview}didDragSourceOptionsChange(){return!ew(this.lastConnectedDragSourceOptions,this.dragSourceOptions)}didDragPreviewOptionsChange(){return!ew(this.lastConnectedDragPreviewOptions,this.dragPreviewOptions)}disconnectDragSource(){this.dragSourceUnsubscribe&&(this.dragSourceUnsubscribe(),this.dragSourceUnsubscribe=void 0)}disconnectDragPreview(){this.dragPreviewUnsubscribe&&(this.dragPreviewUnsubscribe(),this.dragPreviewUnsubscribe=void 0,this.dragPreviewNode=null,this.dragPreviewRef=null)}get dragSource(){return this.dragSourceNode||this.dragSourceRef&&this.dragSourceRef.current}get dragPreview(){return this.dragPreviewNode||this.dragPreviewRef&&this.dragPreviewRef.current}clearDragSource(){this.dragSourceNode=null,this.dragSourceRef=null}clearDragPreview(){this.dragPreviewNode=null,this.dragPreviewRef=null}constructor(n){this.hooks=sE({dragSource:(s,i)=>{this.clearDragSource(),this.dragSourceOptions=i||null,tw(s)?this.dragSourceRef=s:this.dragSourceNode=s,this.reconnectDragSource()},dragPreview:(s,i)=>{this.clearDragPreview(),this.dragPreviewOptions=i||null,tw(s)?this.dragPreviewRef=s:this.dragPreviewNode=s,this.reconnectDragPreview()}}),this.handlerId=null,this.dragSourceRef=null,this.dragSourceOptionsInternal=null,this.dragPreviewRef=null,this.dragPreviewOptionsInternal=null,this.lastConnectedHandlerId=null,this.lastConnectedDragSource=null,this.lastConnectedDragSourceOptions=null,this.lastConnectedDragPreview=null,this.lastConnectedDragPreviewOptions=null,this.backend=n}}class yO{get connectTarget(){return this.dropTarget}reconnect(){const n=this.didHandlerIdChange()||this.didDropTargetChange()||this.didOptionsChange();n&&this.disconnectDropTarget();const s=this.dropTarget;if(this.handlerId){if(!s){this.lastConnectedDropTarget=s;return}n&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDropTarget=s,this.lastConnectedDropTargetOptions=this.dropTargetOptions,this.unsubscribeDropTarget=this.backend.connectDropTarget(this.handlerId,s,this.dropTargetOptions))}}receiveHandlerId(n){n!==this.handlerId&&(this.handlerId=n,this.reconnect())}get dropTargetOptions(){return this.dropTargetOptionsInternal}set dropTargetOptions(n){this.dropTargetOptionsInternal=n}didHandlerIdChange(){return this.lastConnectedHandlerId!==this.handlerId}didDropTargetChange(){return this.lastConnectedDropTarget!==this.dropTarget}didOptionsChange(){return!ew(this.lastConnectedDropTargetOptions,this.dropTargetOptions)}disconnectDropTarget(){this.unsubscribeDropTarget&&(this.unsubscribeDropTarget(),this.unsubscribeDropTarget=void 0)}get dropTarget(){return this.dropTargetNode||this.dropTargetRef&&this.dropTargetRef.current}clearDropTarget(){this.dropTargetRef=null,this.dropTargetNode=null}constructor(n){this.hooks=sE({dropTarget:(s,i)=>{this.clearDropTarget(),this.dropTargetOptions=i,tw(s)?this.dropTargetRef=s:this.dropTargetNode=s,this.reconnect()}}),this.handlerId=null,this.dropTargetRef=null,this.dropTargetOptionsInternal=null,this.lastConnectedHandlerId=null,this.lastConnectedDropTarget=null,this.lastConnectedDropTargetOptions=null,this.backend=n}}function Fu(){const{dragDropManager:o}=ve.useContext(VT);return Mt(o!=null,"Expected drag drop context"),o}function _O(o,n){const s=Fu(),i=ve.useMemo(()=>new vO(s.getBackend()),[s]);return Lu(()=>(i.dragSourceOptions=o||null,i.reconnect(),()=>i.disconnectDragSource()),[i,o]),Lu(()=>(i.dragPreviewOptions=n||null,i.reconnect(),()=>i.disconnectDragPreview()),[i,n]),i}function wO(){const o=Fu();return ve.useMemo(()=>new hO(o),[o])}class SO{beginDrag(){const n=this.spec,s=this.monitor;let i=null;return typeof n.item=="object"?i=n.item:typeof n.item=="function"?i=n.item(s):i={},i??null}canDrag(){const n=this.spec,s=this.monitor;return typeof n.canDrag=="boolean"?n.canDrag:typeof n.canDrag=="function"?n.canDrag(s):!0}isDragging(n,s){const i=this.spec,a=this.monitor,{isDragging:c}=i;return c?c(a):s===n.getSourceId()}endDrag(){const n=this.spec,s=this.monitor,i=this.connector,{end:a}=n;a&&a(s.getItem(),s),i.reconnect()}constructor(n,s,i){this.spec=n,this.monitor=s,this.connector=i}}function CO(o,n,s){const i=ve.useMemo(()=>new SO(o,n,s),[n,s]);return ve.useEffect(()=>{i.spec=o},[o]),i}function TO(o){return ve.useMemo(()=>{const n=o.type;return Mt(n!=null,"spec.type must be defined"),n},[o])}function EO(o,n,s){const i=Fu(),a=CO(o,n,s),c=TO(o);Lu(function(){if(c!=null){const[g,b]=fO(c,a,i);return n.receiveHandlerId(g),s.receiveHandlerId(g),b}},[i,n,s,a,c])}function rE(o,n){const s=nE(o);Mt(!s.begin,"useDrag::spec.begin was deprecated in v14. Replace spec.begin() with spec.item(). (see more here - https://react-dnd.github.io/react-dnd/docs/api/use-drag)");const i=wO(),a=_O(s.options,s.previewOptions);return EO(s,i,a),[tE(s.collect,i,a),uO(a),dO(a)]}function kO(o){const s=Fu().getMonitor(),[i,a]=eE(s,o);return ve.useEffect(()=>s.subscribeToOffsetChange(a)),ve.useEffect(()=>s.subscribeToStateChange(a)),i}function IO(o){return ve.useMemo(()=>o.hooks.dropTarget(),[o])}function xO(o){const n=Fu(),s=ve.useMemo(()=>new yO(n.getBackend()),[n]);return Lu(()=>(s.dropTargetOptions=o||null,s.reconnect(),()=>s.disconnectDropTarget()),[o]),s}function DO(){const o=Fu();return ve.useMemo(()=>new pO(o),[o])}function OO(o){const{accept:n}=o;return ve.useMemo(()=>(Mt(o.accept!=null,"accept must be defined"),Array.isArray(n)?n:[n]),[n])}class RO{canDrop(){const n=this.spec,s=this.monitor;return n.canDrop?n.canDrop(s.getItem(),s):!0}hover(){const n=this.spec,s=this.monitor;n.hover&&n.hover(s.getItem(),s)}drop(){const n=this.spec,s=this.monitor;if(n.drop)return n.drop(s.getItem(),s)}constructor(n,s){this.spec=n,this.monitor=s}}function AO(o,n){const s=ve.useMemo(()=>new RO(o,n),[n]);return ve.useEffect(()=>{s.spec=o},[o]),s}function NO(o,n,s){const i=Fu(),a=AO(o,n),c=OO(o);Lu(function(){const[g,b]=gO(c,a,i);return n.receiveHandlerId(g),s.receiveHandlerId(g),b},[i,n,a,s,c.map(h=>h.toString()).join("|")])}function Kw(o,n){const s=nE(o),i=DO(),a=xO(s.options);return NO(s,i,a),[tE(s.collect,i,a),IO(a)]}function iE(o){let n=null;return()=>(n==null&&(n=o()),n)}function MO(o,n){return o.filter(s=>s!==n)}function LO(o,n){const s=new Set,i=c=>s.add(c);o.forEach(i),n.forEach(i);const a=[];return s.forEach(c=>a.push(c)),a}class BO{enter(n){const s=this.entered.length,i=a=>this.isNodeInDocument(a)&&(!a.contains||a.contains(n));return this.entered=LO(this.entered.filter(i),[n]),s===0&&this.entered.length>0}leave(n){const s=this.entered.length;return this.entered=MO(this.entered.filter(this.isNodeInDocument),n),s>0&&this.entered.length===0}reset(){this.entered=[]}constructor(n){this.entered=[],this.isNodeInDocument=n}}class PO{initializeExposedProperties(){Object.keys(this.config.exposeProperties).forEach(n=>{Object.defineProperty(this.item,n,{configurable:!0,enumerable:!0,get(){return console.warn(`Browser doesn't allow reading "${n}" until the drop event.`),null}})})}loadDataTransfer(n){if(n){const s={};Object.keys(this.config.exposeProperties).forEach(i=>{const a=this.config.exposeProperties[i];a!=null&&(s[i]={value:a(n,this.config.matchesTypes),configurable:!0,enumerable:!0})}),Object.defineProperties(this.item,s)}}canDrag(){return!0}beginDrag(){return this.item}isDragging(n,s){return s===n.getSourceId()}endDrag(){}constructor(n){this.config=n,this.item={},this.initializeExposedProperties()}}const oE="__NATIVE_FILE__",aE="__NATIVE_URL__",lE="__NATIVE_TEXT__",cE="__NATIVE_HTML__",H0=Object.freeze(Object.defineProperty({__proto__:null,FILE:oE,HTML:cE,TEXT:lE,URL:aE},Symbol.toStringTag,{value:"Module"}));function r_(o,n,s){const i=n.reduce((a,c)=>a||o.getData(c),"");return i??s}const nw={[oE]:{exposeProperties:{files:o=>Array.prototype.slice.call(o.files),items:o=>o.items,dataTransfer:o=>o},matchesTypes:["Files"]},[cE]:{exposeProperties:{html:(o,n)=>r_(o,n,""),dataTransfer:o=>o},matchesTypes:["Html","text/html"]},[aE]:{exposeProperties:{urls:(o,n)=>r_(o,n,"").split(`
`),dataTransfer:o=>o},matchesTypes:["Url","text/uri-list"]},[lE]:{exposeProperties:{text:(o,n)=>r_(o,n,""),dataTransfer:o=>o},matchesTypes:["Text","text/plain"]}};function FO(o,n){const s=nw[o];if(!s)throw new Error(`native type ${o} has no configuration`);const i=new PO(s);return i.loadDataTransfer(n),i}function i_(o){if(!o)return null;const n=Array.prototype.slice.call(o.types||[]);return Object.keys(nw).filter(s=>{const i=nw[s];return i!=null&&i.matchesTypes?i.matchesTypes.some(a=>n.indexOf(a)>-1):!1})[0]||null}const jO=iE(()=>/firefox/i.test(navigator.userAgent)),uE=iE(()=>!!window.safari);class W0{interpolate(n){const{xs:s,ys:i,c1s:a,c2s:c,c3s:h}=this;let g=s.length-1;if(n===s[g])return i[g];let b=0,$=h.length-1,y;for(;b<=$;){y=Math.floor(.5*(b+$));const S=s[y];if(S<n)b=y+1;else if(S>n)$=y-1;else return i[y]}g=Math.max(0,$);const w=n-s[g],C=w*w;return i[g]+a[g]*w+c[g]*C+h[g]*w*C}constructor(n,s){const{length:i}=n,a=[];for(let S=0;S<i;S++)a.push(S);a.sort((S,k)=>n[S]<n[k]?-1:1);const c=[],h=[];let g,b;for(let S=0;S<i-1;S++)g=n[S+1]-n[S],b=s[S+1]-s[S],c.push(g),h.push(b/g);const $=[h[0]];for(let S=0;S<c.length-1;S++){const k=h[S],E=h[S+1];if(k*E<=0)$.push(0);else{g=c[S];const R=c[S+1],F=g+R;$.push(3*F/((F+R)/k+(F+g)/E))}}$.push(h[h.length-1]);const y=[],w=[];let C;for(let S=0;S<$.length-1;S++){C=h[S];const k=$[S],E=1/c[S],R=k+$[S+1]-C-C;y.push((C-k-R)*E),w.push(R*E*E)}this.xs=n,this.ys=s,this.c1s=$,this.c2s=y,this.c3s=w}}const zO=1;function dE(o){const n=o.nodeType===zO?o:o.parentElement;if(!n)return null;const{top:s,left:i}=n.getBoundingClientRect();return{x:i,y:s}}function q$(o){return{x:o.clientX,y:o.clientY}}function UO(o){var n;return o.nodeName==="IMG"&&(jO()||!(!((n=document.documentElement)===null||n===void 0)&&n.contains(o)))}function HO(o,n,s,i){let a=o?n.width:s,c=o?n.height:i;return uE()&&o&&(c/=window.devicePixelRatio,a/=window.devicePixelRatio),{dragPreviewWidth:a,dragPreviewHeight:c}}function WO(o,n,s,i,a){const c=UO(n),g=dE(c?o:n),b={x:s.x-g.x,y:s.y-g.y},{offsetWidth:$,offsetHeight:y}=o,{anchorX:w,anchorY:C}=i,{dragPreviewWidth:S,dragPreviewHeight:k}=HO(c,n,$,y),E=()=>{let K=new W0([0,.5,1],[b.y,b.y/y*k,b.y+k-y]).interpolate(C);return uE()&&c&&(K+=(window.devicePixelRatio-1)*k),K},R=()=>new W0([0,.5,1],[b.x,b.x/$*S,b.x+S-$]).interpolate(w),{offsetX:F,offsetY:M}=a,L=F===0||F,T=M===0||M;return{x:L?F:R(),y:T?M:E()}}let VO=class{get window(){if(this.globalContext)return this.globalContext;if(typeof window<"u")return window}get document(){var n;return!((n=this.globalContext)===null||n===void 0)&&n.document?this.globalContext.document:this.window?this.window.document:void 0}get rootElement(){var n;return((n=this.optionsArgs)===null||n===void 0?void 0:n.rootElement)||this.window}constructor(n,s){this.ownerDocument=null,this.globalContext=n,this.optionsArgs=s}};function GO(o,n,s){return n in o?Object.defineProperty(o,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):o[n]=s,o}function V0(o){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{},i=Object.keys(s);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(s).filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable}))),i.forEach(function(a){GO(o,a,s[a])})}return o}class qO{profile(){var n,s;return{sourcePreviewNodes:this.sourcePreviewNodes.size,sourcePreviewNodeOptions:this.sourcePreviewNodeOptions.size,sourceNodeOptions:this.sourceNodeOptions.size,sourceNodes:this.sourceNodes.size,dragStartSourceIds:((n=this.dragStartSourceIds)===null||n===void 0?void 0:n.length)||0,dropTargetIds:this.dropTargetIds.length,dragEnterTargetIds:this.dragEnterTargetIds.length,dragOverTargetIds:((s=this.dragOverTargetIds)===null||s===void 0?void 0:s.length)||0}}get window(){return this.options.window}get document(){return this.options.document}get rootElement(){return this.options.rootElement}setup(){const n=this.rootElement;if(n!==void 0){if(n.__isReactDndBackendSetUp)throw new Error("Cannot have two HTML5 backends at the same time.");n.__isReactDndBackendSetUp=!0,this.addEventListeners(n)}}teardown(){const n=this.rootElement;if(n!==void 0&&(n.__isReactDndBackendSetUp=!1,this.removeEventListeners(this.rootElement),this.clearCurrentDragSourceNode(),this.asyncEndDragFrameId)){var s;(s=this.window)===null||s===void 0||s.cancelAnimationFrame(this.asyncEndDragFrameId)}}connectDragPreview(n,s,i){return this.sourcePreviewNodeOptions.set(n,i),this.sourcePreviewNodes.set(n,s),()=>{this.sourcePreviewNodes.delete(n),this.sourcePreviewNodeOptions.delete(n)}}connectDragSource(n,s,i){this.sourceNodes.set(n,s),this.sourceNodeOptions.set(n,i);const a=h=>this.handleDragStart(h,n),c=h=>this.handleSelectStart(h);return s.setAttribute("draggable","true"),s.addEventListener("dragstart",a),s.addEventListener("selectstart",c),()=>{this.sourceNodes.delete(n),this.sourceNodeOptions.delete(n),s.removeEventListener("dragstart",a),s.removeEventListener("selectstart",c),s.setAttribute("draggable","false")}}connectDropTarget(n,s){const i=h=>this.handleDragEnter(h,n),a=h=>this.handleDragOver(h,n),c=h=>this.handleDrop(h,n);return s.addEventListener("dragenter",i),s.addEventListener("dragover",a),s.addEventListener("drop",c),()=>{s.removeEventListener("dragenter",i),s.removeEventListener("dragover",a),s.removeEventListener("drop",c)}}addEventListeners(n){n.addEventListener&&(n.addEventListener("dragstart",this.handleTopDragStart),n.addEventListener("dragstart",this.handleTopDragStartCapture,!0),n.addEventListener("dragend",this.handleTopDragEndCapture,!0),n.addEventListener("dragenter",this.handleTopDragEnter),n.addEventListener("dragenter",this.handleTopDragEnterCapture,!0),n.addEventListener("dragleave",this.handleTopDragLeaveCapture,!0),n.addEventListener("dragover",this.handleTopDragOver),n.addEventListener("dragover",this.handleTopDragOverCapture,!0),n.addEventListener("drop",this.handleTopDrop),n.addEventListener("drop",this.handleTopDropCapture,!0))}removeEventListeners(n){n.removeEventListener&&(n.removeEventListener("dragstart",this.handleTopDragStart),n.removeEventListener("dragstart",this.handleTopDragStartCapture,!0),n.removeEventListener("dragend",this.handleTopDragEndCapture,!0),n.removeEventListener("dragenter",this.handleTopDragEnter),n.removeEventListener("dragenter",this.handleTopDragEnterCapture,!0),n.removeEventListener("dragleave",this.handleTopDragLeaveCapture,!0),n.removeEventListener("dragover",this.handleTopDragOver),n.removeEventListener("dragover",this.handleTopDragOverCapture,!0),n.removeEventListener("drop",this.handleTopDrop),n.removeEventListener("drop",this.handleTopDropCapture,!0))}getCurrentSourceNodeOptions(){const n=this.monitor.getSourceId(),s=this.sourceNodeOptions.get(n);return V0({dropEffect:this.altKeyPressed?"copy":"move"},s||{})}getCurrentDropEffect(){return this.isDraggingNativeItem()?"copy":this.getCurrentSourceNodeOptions().dropEffect}getCurrentSourcePreviewNodeOptions(){const n=this.monitor.getSourceId(),s=this.sourcePreviewNodeOptions.get(n);return V0({anchorX:.5,anchorY:.5,captureDraggingState:!1},s||{})}isDraggingNativeItem(){const n=this.monitor.getItemType();return Object.keys(H0).some(s=>H0[s]===n)}beginDragNativeItem(n,s){this.clearCurrentDragSourceNode(),this.currentNativeSource=FO(n,s),this.currentNativeHandle=this.registry.addSource(n,this.currentNativeSource),this.actions.beginDrag([this.currentNativeHandle])}setCurrentDragSourceNode(n){this.clearCurrentDragSourceNode(),this.currentDragSourceNode=n;const s=1e3;this.mouseMoveTimeoutTimer=setTimeout(()=>{var i;return(i=this.rootElement)===null||i===void 0?void 0:i.addEventListener("mousemove",this.endDragIfSourceWasRemovedFromDOM,!0)},s)}clearCurrentDragSourceNode(){if(this.currentDragSourceNode){if(this.currentDragSourceNode=null,this.rootElement){var n;(n=this.window)===null||n===void 0||n.clearTimeout(this.mouseMoveTimeoutTimer||void 0),this.rootElement.removeEventListener("mousemove",this.endDragIfSourceWasRemovedFromDOM,!0)}return this.mouseMoveTimeoutTimer=null,!0}return!1}handleDragStart(n,s){n.defaultPrevented||(this.dragStartSourceIds||(this.dragStartSourceIds=[]),this.dragStartSourceIds.unshift(s))}handleDragEnter(n,s){this.dragEnterTargetIds.unshift(s)}handleDragOver(n,s){this.dragOverTargetIds===null&&(this.dragOverTargetIds=[]),this.dragOverTargetIds.unshift(s)}handleDrop(n,s){this.dropTargetIds.unshift(s)}constructor(n,s,i){this.sourcePreviewNodes=new Map,this.sourcePreviewNodeOptions=new Map,this.sourceNodes=new Map,this.sourceNodeOptions=new Map,this.dragStartSourceIds=null,this.dropTargetIds=[],this.dragEnterTargetIds=[],this.currentNativeSource=null,this.currentNativeHandle=null,this.currentDragSourceNode=null,this.altKeyPressed=!1,this.mouseMoveTimeoutTimer=null,this.asyncEndDragFrameId=null,this.dragOverTargetIds=null,this.lastClientOffset=null,this.hoverRafId=null,this.getSourceClientOffset=a=>{const c=this.sourceNodes.get(a);return c&&dE(c)||null},this.endDragNativeItem=()=>{this.isDraggingNativeItem()&&(this.actions.endDrag(),this.currentNativeHandle&&this.registry.removeSource(this.currentNativeHandle),this.currentNativeHandle=null,this.currentNativeSource=null)},this.isNodeInDocument=a=>!!(a&&this.document&&this.document.body&&this.document.body.contains(a)),this.endDragIfSourceWasRemovedFromDOM=()=>{const a=this.currentDragSourceNode;a==null||this.isNodeInDocument(a)||(this.clearCurrentDragSourceNode()&&this.monitor.isDragging()&&this.actions.endDrag(),this.cancelHover())},this.scheduleHover=a=>{this.hoverRafId===null&&typeof requestAnimationFrame<"u"&&(this.hoverRafId=requestAnimationFrame(()=>{this.monitor.isDragging()&&this.actions.hover(a||[],{clientOffset:this.lastClientOffset}),this.hoverRafId=null}))},this.cancelHover=()=>{this.hoverRafId!==null&&typeof cancelAnimationFrame<"u"&&(cancelAnimationFrame(this.hoverRafId),this.hoverRafId=null)},this.handleTopDragStartCapture=()=>{this.clearCurrentDragSourceNode(),this.dragStartSourceIds=[]},this.handleTopDragStart=a=>{if(a.defaultPrevented)return;const{dragStartSourceIds:c}=this;this.dragStartSourceIds=null;const h=q$(a);this.monitor.isDragging()&&(this.actions.endDrag(),this.cancelHover()),this.actions.beginDrag(c||[],{publishSource:!1,getSourceClientOffset:this.getSourceClientOffset,clientOffset:h});const{dataTransfer:g}=a,b=i_(g);if(this.monitor.isDragging()){if(g&&typeof g.setDragImage=="function"){const y=this.monitor.getSourceId(),w=this.sourceNodes.get(y),C=this.sourcePreviewNodes.get(y)||w;if(C){const{anchorX:S,anchorY:k,offsetX:E,offsetY:R}=this.getCurrentSourcePreviewNodeOptions(),L=WO(w,C,h,{anchorX:S,anchorY:k},{offsetX:E,offsetY:R});g.setDragImage(C,L.x,L.y)}}try{g==null||g.setData("application/json",{})}catch{}this.setCurrentDragSourceNode(a.target);const{captureDraggingState:$}=this.getCurrentSourcePreviewNodeOptions();$?this.actions.publishDragSource():setTimeout(()=>this.actions.publishDragSource(),0)}else if(b)this.beginDragNativeItem(b);else{if(g&&!g.types&&(a.target&&!a.target.hasAttribute||!a.target.hasAttribute("draggable")))return;a.preventDefault()}},this.handleTopDragEndCapture=()=>{this.clearCurrentDragSourceNode()&&this.monitor.isDragging()&&this.actions.endDrag(),this.cancelHover()},this.handleTopDragEnterCapture=a=>{if(this.dragEnterTargetIds=[],this.isDraggingNativeItem()){var c;(c=this.currentNativeSource)===null||c===void 0||c.loadDataTransfer(a.dataTransfer)}if(!this.enterLeaveCounter.enter(a.target)||this.monitor.isDragging())return;const{dataTransfer:g}=a,b=i_(g);b&&this.beginDragNativeItem(b,g)},this.handleTopDragEnter=a=>{const{dragEnterTargetIds:c}=this;if(this.dragEnterTargetIds=[],!this.monitor.isDragging())return;this.altKeyPressed=a.altKey,c.length>0&&this.actions.hover(c,{clientOffset:q$(a)}),c.some(g=>this.monitor.canDropOnTarget(g))&&(a.preventDefault(),a.dataTransfer&&(a.dataTransfer.dropEffect=this.getCurrentDropEffect()))},this.handleTopDragOverCapture=a=>{if(this.dragOverTargetIds=[],this.isDraggingNativeItem()){var c;(c=this.currentNativeSource)===null||c===void 0||c.loadDataTransfer(a.dataTransfer)}},this.handleTopDragOver=a=>{const{dragOverTargetIds:c}=this;if(this.dragOverTargetIds=[],!this.monitor.isDragging()){a.preventDefault(),a.dataTransfer&&(a.dataTransfer.dropEffect="none");return}this.altKeyPressed=a.altKey,this.lastClientOffset=q$(a),this.scheduleHover(c),(c||[]).some(g=>this.monitor.canDropOnTarget(g))?(a.preventDefault(),a.dataTransfer&&(a.dataTransfer.dropEffect=this.getCurrentDropEffect())):this.isDraggingNativeItem()?a.preventDefault():(a.preventDefault(),a.dataTransfer&&(a.dataTransfer.dropEffect="none"))},this.handleTopDragLeaveCapture=a=>{this.isDraggingNativeItem()&&a.preventDefault(),this.enterLeaveCounter.leave(a.target)&&(this.isDraggingNativeItem()&&setTimeout(()=>this.endDragNativeItem(),0),this.cancelHover())},this.handleTopDropCapture=a=>{if(this.dropTargetIds=[],this.isDraggingNativeItem()){var c;a.preventDefault(),(c=this.currentNativeSource)===null||c===void 0||c.loadDataTransfer(a.dataTransfer)}else i_(a.dataTransfer)&&a.preventDefault();this.enterLeaveCounter.reset()},this.handleTopDrop=a=>{const{dropTargetIds:c}=this;this.dropTargetIds=[],this.actions.hover(c,{clientOffset:q$(a)}),this.actions.drop({dropEffect:this.getCurrentDropEffect()}),this.isDraggingNativeItem()?this.endDragNativeItem():this.monitor.isDragging()&&this.actions.endDrag(),this.cancelHover()},this.handleSelectStart=a=>{const c=a.target;typeof c.dragDrop=="function"&&(c.tagName==="INPUT"||c.tagName==="SELECT"||c.tagName==="TEXTAREA"||c.isContentEditable||(a.preventDefault(),c.dragDrop()))},this.options=new VO(s,i),this.actions=n.getActions(),this.monitor=n.getMonitor(),this.registry=n.getRegistry(),this.enterLeaveCounter=new BO(this.isNodeInDocument)}}let K$;function KO(){return K$||(K$=new Image,K$.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="),K$}const hE=function(n,s,i){return new qO(n,s,i)};function JO(o){return kt({tag:"svg",attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M336 64h-80c0-35.3-28.7-64-64-64s-64 28.7-64 64H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48V112c0-26.5-21.5-48-48-48zM96 424c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm0-96c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm0-96c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm96-192c13.3 0 24 10.7 24 24s-10.7 24-24 24-24-10.7-24-24 10.7-24 24-24zm128 368c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16zm0-96c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16zm0-96c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16z"},child:[]}]})(o)}function YO(o){return kt({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256,8C119,8,8,119,8,256S119,504,256,504,504,393,504,256,393,8,256,8Zm92.49,313h0l-20,25a16,16,0,0,1-22.49,2.5h0l-67-49.72a40,40,0,0,1-15-31.23V112a16,16,0,0,1,16-16h32a16,16,0,0,1,16,16V256l58,42.5A16,16,0,0,1,348.49,321Z"},child:[]}]})(o)}function xv(o){return kt({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M384 121.9c0-6.3-2.5-12.4-7-16.9L279.1 7c-4.5-4.5-10.6-7-17-7H256v128h128zM571 308l-95.7-96.4c-10.1-10.1-27.4-3-27.4 11.3V288h-64v64h64v65.2c0 14.3 17.3 21.4 27.4 11.3L571 332c6.6-6.6 6.6-17.4 0-24zm-379 28v-32c0-8.8 7.2-16 16-16h176V160H248c-13.2 0-24-10.8-24-24V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V352H208c-8.8 0-16-7.2-16-16z"},child:[]}]})(o)}function sw(o){return kt({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M16 288c-8.8 0-16 7.2-16 16v32c0 8.8 7.2 16 16 16h112v-64zm489-183L407.1 7c-4.5-4.5-10.6-7-17-7H384v128h128v-6.1c0-6.3-2.5-12.4-7-16.9zm-153 31V0H152c-13.3 0-24 10.7-24 24v264h128v-65.2c0-14.3 17.3-21.4 27.4-11.3L379 308c6.6 6.7 6.6 17.4 0 24l-95.7 96.4c-10.1 10.1-27.4 3-27.4-11.3V352H128v136c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H376c-13.2 0-24-10.8-24-24z"},child:[]}]})(o)}function XO(o){return kt({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M243.2 189.9V258c26.1 5.9 49.3 15.6 73.6 22.3v-68.2c-26-5.8-49.4-15.5-73.6-22.2zm223.3-123c-34.3 15.9-76.5 31.9-117 31.9C296 98.8 251.7 64 184.3 64c-25 0-47.3 4.4-68 12 2.8-7.3 4.1-15.2 3.6-23.6C118.1 24 94.8 1.2 66.3 0 34.3-1.3 8 24.3 8 56c0 19 9.5 35.8 24 45.9V488c0 13.3 10.7 24 24 24h16c13.3 0 24-10.7 24-24v-94.4c28.3-12.1 63.6-22.1 114.4-22.1 53.6 0 97.8 34.8 165.2 34.8 48.2 0 86.7-16.3 122.5-40.9 8.7-6 13.8-15.8 13.8-26.4V95.9c.1-23.3-24.2-38.8-45.4-29zM169.6 325.5c-25.8 2.7-50 8.2-73.6 16.6v-70.5c26.2-9.3 47.5-15 73.6-17.4zM464 191c-23.6 9.8-46.3 19.5-73.6 23.9V286c24.8-3.4 51.4-11.8 73.6-26v70.5c-25.1 16.1-48.5 24.7-73.6 27.1V286c-27 3.7-47.9 1.5-73.6-5.6v67.4c-23.9-7.4-47.3-16.7-73.6-21.3V258c-19.7-4.4-40.8-6.8-73.6-3.8v-70c-22.4 3.1-44.6 10.2-73.6 20.9v-70.5c33.2-12.2 50.1-19.8 73.6-22v71.6c27-3.7 48.4-1.3 73.6 5.7v-67.4c23.7 7.4 47.2 16.7 73.6 21.3v68.4c23.7 5.3 47.6 6.9 73.6 2.7V143c27-4.8 52.3-13.6 73.6-22.5z"},child:[]}]})(o)}function ZO(o){return kt({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M572.694 292.093L500.27 416.248A63.997 63.997 0 0 1 444.989 448H45.025c-18.523 0-30.064-20.093-20.731-36.093l72.424-124.155A64 64 0 0 1 152 256h399.964c18.523 0 30.064 20.093 20.73 36.093zM152 224h328v-48c0-26.51-21.49-48-48-48H272l-64-64H48C21.49 64 0 85.49 0 112v278.046l69.077-118.418C86.214 242.25 117.989 224 152 224z"},child:[]}]})(o)}function QO(o){return kt({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M464 128H272l-64-64H48C21.49 64 0 85.49 0 112v288c0 26.51 21.49 48 48 48h416c26.51 0 48-21.49 48-48V176c0-26.51-21.49-48-48-48z"},child:[]}]})(o)}const eR=ni([f.jsx("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2M12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8"},"0"),f.jsx("path",{d:"M12.5 7H11v6l5.25 3.15.75-1.23-4.5-2.67z"},"1")],"AccessTime"),tR=ni(f.jsx("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m-2 10h-4v4h-2v-4H7v-2h4V7h2v4h4z"}),"AddBox"),nR=ni(f.jsx("path",{d:"M4 8h4V4H4zm6 12h4v-4h-4zm-6 0h4v-4H4zm0-6h4v-4H4zm6 0h4v-4h-4zm6-10v4h4V4zm-6 4h4V4h-4zm6 6h4v-4h-4zm0 6h4v-4h-4z"}),"Apps"),sR=ni(f.jsx("path",{d:"M9 2c-1.05 0-2.05.16-3 .46 4.06 1.27 7 5.06 7 9.54s-2.94 8.27-7 9.54c.95.3 1.95.46 3 .46 5.52 0 10-4.48 10-10S14.52 2 9 2"}),"Brightness3"),pE=ni(f.jsx("path",{d:"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm-1 4 6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2zm-1 7h5.5L14 6.5z"}),"FileCopy"),rR=ni(f.jsx("path",{d:"M7 2v11h3v9l7-12h-4l4-8z"}),"FlashOn"),iR=ni(f.jsx("path",{d:"M18 4H6v2l6.5 6L6 18v2h12v-3h-7l5-5-5-5h7z"}),"Functions"),Jw=ni(f.jsx("path",{d:"M11 18h2v-2h-2zm1-16C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8m0-14c-2.21 0-4 1.79-4 4h2c0-1.1.9-2 2-2s2 .9 2 2c0 2-3 1.75-3 5h2c0-2.25 3-2.5 3-5 0-2.21-1.79-4-4-4"}),"HelpOutline"),oR=ni(f.jsx("path",{d:"M6 19h4V5H6zm8-14v14h4V5z"}),"Pause"),aR=ni(f.jsx("path",{d:"M8 5v14l11-7z"}),"PlayArrow"),lR=ni(f.jsx("path",{d:"M11 5v5.59H7.5l4.5 4.5 4.5-4.5H13V5zm-5 9c0 3.31 2.69 6 6 6s6-2.69 6-6h-2c0 2.21-1.79 4-4 4s-4-1.79-4-4z"}),"PlayForWork"),cR=ni(f.jsx("path",{d:"M10.59 9.17 5.41 4 4 5.41l5.17 5.17zM14.5 4l2.04 2.04L4 18.59 5.41 20 17.96 7.46 20 9.5V4zm.33 9.41-1.41 1.41 3.13 3.13L14.5 20H20v-5.5l-2.04 2.04z"}),"Shuffle"),uR=ni(f.jsx("path",{d:"M2 20h20v-4H2zm2-3h2v2H4zM2 4v4h20V4zm4 3H4V5h2zm-4 7h20v-4H2zm2-3h2v2H4z"}),"Storage"),dR=ni(f.jsx("path",{d:"M14 17H4v2h10zm6-8H4v2h16zM4 15h16v-2H4zM4 5v2h16V5z"}),"Subject");class Yw extends Le.Component{isShowInstance;oldId;constructor(n){super(n),this.state={name:n.name,id:n.id,instance:n.instance||0,prefix:Yw.getPrefix(n.id)},this.isShowInstance=!n.folder&&!!n.instances&&(!!n.instance||!!n.instances[0]||n.instances.length>1),this.oldId=n.id}static getPrefix(n){const s=(n||"").split(".");return s.pop(),s.join(".")}getId(n){return n=(n||"").replace(/[\\/\][*,;'"`<>?\s]/g,"_"),`${this.state.prefix}.${n}`}handleCancel=()=>{this.props.onClose()};handleOk=()=>{this.props.onRename(this.oldId,this.state.id,this.state.name,this.state.instance===0?0:this.state.instance||void 0),this.props.onClose()};handleChange=n=>{this.setState({name:n,id:this.getId(n)})};render(){return f.jsxs(D.Dialog,{onClose:()=>!1,maxWidth:"md",fullWidth:!0,open:!0,"aria-labelledby":"confirmation-dialog-title",children:[f.jsx(D.DialogTitle,{id:"confirmation-dialog-title",children:I.I18n.t("Rename")}),f.jsx(D.DialogContent,{children:f.jsxs("form",{noValidate:!0,autoComplete:"off",children:[f.jsx(D.TextField,{variant:"standard",style:{width:"100%"},id:"standard-name",autoFocus:!0,label:I.I18n.t("Name"),value:this.state.name,onKeyUp:n=>{n.key==="Enter"&&(n.preventDefault(),setTimeout(()=>this.handleOk(),200))},onChange:n=>this.handleChange(n.target.value),margin:"normal"}),f.jsx(D.TextField,{variant:"standard",id:"standard-name-id",style:{width:"100%"},label:I.I18n.t("ID"),value:this.state.id,disabled:!0,margin:"normal"}),this.isShowInstance&&f.jsxs(D.FormControl,{variant:"standard",children:[f.jsx(D.InputLabel,{htmlFor:"instance",children:I.I18n.t("Instance")}),f.jsx(D.Select,{variant:"standard",value:this.state.instance,onChange:n=>this.setState({instance:parseInt(n.target.value,10)}),inputProps:{name:"instance",id:"instance"},children:this.props.instances.map(n=>f.jsx(D.MenuItem,{value:n,children:n||"0"},n))})]})]})}),f.jsxs(D.DialogActions,{children:[f.jsx(D.Button,{variant:"contained",onClick:this.handleOk,color:"primary",startIcon:f.jsx(ol,{}),children:I.I18n.t("Ok")}),f.jsx(D.Button,{color:"grey",variant:"contained",onClick:this.handleCancel,startIcon:f.jsx(la,{}),children:I.I18n.t("Cancel")})]})]})}}class hR extends Le.Component{constructor(n){super(n),this.state={name:n.name,id:n.id}}handleCancel=()=>{this.props.onClose()};handleOk=()=>{this.props.onDelete(this.state.id),this.props.onClose()};render(){return f.jsxs(D.Dialog,{onClose:()=>!1,maxWidth:"md",open:!0,"aria-labelledby":"confirmation-dialog-title",children:[f.jsx(D.DialogTitle,{id:"confirmation-dialog-title",children:I.I18n.t("Are you sure?")}),f.jsxs(D.DialogContent,{children:[f.jsx(Lx,{}),f.jsx("span",{style:{fontSize:14,fontWeight:"bold"},children:I.I18n.t("Delete %s",this.state.name)})]}),f.jsxs(D.DialogActions,{children:[f.jsx(D.Button,{variant:"contained",onClick:this.handleOk,color:"primary",startIcon:f.jsx(ol,{}),children:I.I18n.t("Ok")}),f.jsx(D.Button,{color:"grey",variant:"contained",onClick:this.handleCancel,startIcon:f.jsx(la,{}),children:I.I18n.t("Cancel")})]})]})}}const pR="./assets/tileJS.png",gR="./assets/tileTS.png",fR="./assets/tileBlockly.png",mR="./assets/tileRules.png",gr={card:{maxWidth:345,minWidth:250,display:"inline-block",margin:"0 10px 0 10px"},media:{height:122},text:{maxWidth:218,minHeight:30},complexity:{fontWeight:"bold",fontStyle:"italic",marginBottom:8}};class Hh extends Le.Component{handleCancel=()=>{this.props.onClose()};static openHtml(n){const s=I.I18n.getLanguage();!n.includes("javascript.md")&&(s==="de"||s==="ru")&&(n=n.replace(/\/en\//,`/${s}/`));const i=window.open(n,"_blank");i==null||i.focus()}getJSCard(){return f.jsxs(D.Card,{style:gr.card,children:[f.jsxs(D.CardActionArea,{onClick:()=>this.props.onClose&&this.props.onClose("Javascript/js"),children:[f.jsx(D.CardMedia,{style:gr.media,image:pR,title:"JavaScript"}),f.jsxs(D.CardContent,{children:[f.jsx("h2",{children:"JavaScript"}),f.jsx("div",{style:gr.complexity,children:I.I18n.t("for programmers")}),f.jsx("div",{style:gr.text,children:I.I18n.t("JS description")})]})]}),f.jsxs(D.CardActions,{children:[f.jsx(D.Button,{size:"small",color:"primary",variant:"contained",onClick:()=>this.props.onClose&&this.props.onClose("Javascript/js"),children:I.I18n.t("Add")}),f.jsx(D.Button,{size:"small",color:"secondary",onClick:()=>Hh.openHtml("https://github.com/ioBroker/ioBroker.javascript/blob/master/docs/en/javascript.md"),children:I.I18n.t("Learn More")})]})]})}getTSCard(){return f.jsxs(D.Card,{style:gr.card,children:[f.jsxs(D.CardActionArea,{onClick:()=>this.props.onClose&&this.props.onClose("TypeScript/ts"),children:[f.jsx(D.CardMedia,{style:gr.media,image:gR,title:"TypeScript"}),f.jsxs(D.CardContent,{children:[f.jsx("h2",{children:"TypeScript"}),f.jsx("div",{style:gr.complexity,children:I.I18n.t("for professionals")}),f.jsx("div",{style:gr.text,children:I.I18n.t("TS description")})]})]}),f.jsxs(D.CardActions,{children:[f.jsx(D.Button,{size:"small",color:"primary",variant:"contained",onClick:()=>this.props.onClose&&this.props.onClose("TypeScript/ts"),children:I.I18n.t("Add")}),f.jsx(D.Button,{size:"small",color:"secondary",onClick:()=>Hh.openHtml("https://github.com/ioBroker/ioBroker.javascript/blob/master/docs/en/javascript.md"),children:I.I18n.t("Learn More")})]})]})}getBlocklyCard(){return f.jsxs(D.Card,{style:gr.card,children:[f.jsxs(D.CardActionArea,{onClick:()=>this.props.onClose&&this.props.onClose("Blockly"),children:[f.jsx(D.CardMedia,{style:gr.media,image:fR,title:"Blockly"}),f.jsxs(D.CardContent,{children:[f.jsx("h2",{children:"Blockly"}),f.jsx("div",{style:gr.complexity,children:I.I18n.t("normal")}),f.jsx("div",{style:gr.text,children:I.I18n.t("Blockly description")})]})]}),f.jsxs(D.CardActions,{children:[f.jsx(D.Button,{size:"small",color:"primary",variant:"contained",onClick:()=>this.props.onClose&&this.props.onClose("Blockly"),children:I.I18n.t("Add")}),f.jsx(D.Button,{size:"small",color:"secondary",onClick:()=>Hh.openHtml("https://github.com/ioBroker/ioBroker.javascript/blob/master/docs/en/blockly.md"),children:I.I18n.t("Learn More")})]})]})}getRulesCard(){return f.jsxs(D.Card,{style:gr.card,children:[f.jsxs(D.CardActionArea,{onClick:()=>this.props.onClose&&this.props.onClose("Rules"),children:[f.jsx(D.CardMedia,{style:gr.media,image:mR,title:"Rules"}),f.jsxs(D.CardContent,{children:[f.jsx("h2",{children:"Rules"}),f.jsx("div",{style:gr.complexity,children:I.I18n.t("easy")}),f.jsx("div",{style:gr.text,children:I.I18n.t("Rules description")})]})]}),f.jsxs(D.CardActions,{children:[f.jsx(D.Button,{size:"small",color:"primary",variant:"contained",onClick:()=>this.props.onClose&&this.props.onClose("Rules"),children:I.I18n.t("Add")}),f.jsx(D.Button,{size:"small",color:"secondary",onClick:()=>Hh.openHtml("https://github.com/ioBroker/ioBroker.javascript/blob/master/docs/en/javascript.md"),children:I.I18n.t("Learn More")})]})]})}render(){return f.jsxs(D.Dialog,{onClose:()=>!1,maxWidth:"lg",fullWidth:!0,open:!0,"aria-labelledby":"confirmation-dialog-title",children:[f.jsx(D.DialogTitle,{id:"confirmation-dialog-title",children:I.I18n.t("Add new script")}),f.jsxs(D.DialogContent,{style:{textAlign:"center"},children:[this.getRulesCard(),this.getBlocklyCard(),this.getJSCard(),this.getTSCard()]}),f.jsx(D.DialogActions,{children:f.jsx(D.Button,{color:"grey",onClick:this.handleCancel,startIcon:f.jsx(la,{}),children:I.I18n.t("Cancel")})})]})}}class o_ extends Le.Component{isShowInstance;constructor(n){super(n),this.state={name:n.name||"Script",instance:n.instance||0,parent:n.parent,error:"",id:""},this.isShowInstance=!n.folder&&!!n.instances&&(!!n.instance||!!n.instances[0]||n.instances.length>1)}getId(n){return n=n||this.state.name||"",n=n.replace(/[\\/\][.*,;'"`<>?\s]/g,"_").trim().replace(/\.$/,"_"),`${this.state?this.state.parent:this.props.parent}.${n}`}handleOk=()=>{this.props.onAdd(this.getId(this.state.name),this.state.name,this.state.instance,this.props.type),this.props.onClose()};render(){var n;return console.log(this.state.name),f.jsxs(D.Dialog,{onClose:()=>!1,maxWidth:"md",fullWidth:!0,open:!0,"aria-labelledby":"confirmation-dialog-title",children:[f.jsx(D.DialogTitle,{id:"confirmation-dialog-title",children:this.props.title||I.I18n.t("Create new")}),f.jsx(D.DialogContent,{children:f.jsxs("form",{noValidate:!0,autoComplete:"off",children:[f.jsx(D.TextField,{variant:"standard",style:{width:"100%"},id:"standard-name",autoFocus:!0,error:!!this.state.error,label:I.I18n.t("Name"),value:this.state.name||"",helperText:this.state.error,slotProps:{input:{endAdornment:this.state.name?f.jsx(D.IconButton,{size:"small",onClick:()=>this.setState({name:""}),children:f.jsx(Bx,{})}):void 0}},onKeyUp:s=>{s.preventDefault(),s.key==="Enter"&&!this.state.error&&setTimeout(()=>this.handleOk(),200)},onChange:s=>{var c;const i=s.target.value,a=this.getId(i);i?(c=this.props.existingItems)!=null&&c.includes(a)?this.setState({name:i,id:a,error:I.I18n.t("Duplicate name")}):(console.log(`Set name: "${i}"`),this.setState({name:i,id:a,error:""})):this.setState({name:i,id:a,error:I.I18n.t("Empty name is not allowed")})},margin:"normal"}),f.jsxs(D.FormControl,{variant:"standard",style:{width:"100%"},children:[f.jsx(D.InputLabel,{htmlFor:"parent",children:I.I18n.t("Folder")}),f.jsx(D.Select,{variant:"standard",style:{width:"100%"},value:this.state.parent,onChange:s=>this.setState({parent:s.target.value}),inputProps:{name:"parent",id:"parent"},children:this.props.parents.map(s=>{const i=s.id.split(".");i.splice(0,2);const a=[];let c="script.js";return i.forEach(h=>{c+=`.${h}`;const g=this.props.parents.find(b=>b.id===c);g?a.push(g.name):a.push(h)}),a.length||a.push(s.name),f.jsx(D.MenuItem,{value:s.id,children:a.join(" / ")},s.id)})})]}),f.jsx(D.TextField,{variant:"standard",id:"standard-name-id",style:{width:"100%"},label:I.I18n.t("ID"),value:this.getId(),disabled:!0,margin:"normal"}),this.isShowInstance&&f.jsxs(D.FormControl,{variant:"standard",children:[f.jsx(D.InputLabel,{htmlFor:"instance",children:I.I18n.t("Instance")}),f.jsx(D.Select,{variant:"standard",value:this.state.instance,onChange:s=>this.setState({instance:parseInt(s.target.value,10)}),inputProps:{name:"instance",id:"instance"},children:(n=this.props.instances)==null?void 0:n.map(s=>f.jsx(D.MenuItem,{value:s,children:s||"0"},`instance${s}`))})]})]})}),f.jsxs(D.DialogActions,{children:[f.jsx(D.Button,{variant:"contained",onClick:this.handleOk,disabled:!!this.state.error,color:"primary",startIcon:f.jsx(ol,{}),children:I.I18n.t("Ok")}),f.jsx(D.Button,{color:"grey",variant:"contained",onClick:()=>this.props.onClose(),startIcon:f.jsx(la,{}),children:I.I18n.t("Cancel")})]})]})}}const bR={title:o=>({background:o.palette.error.main,color:o.palette.error.contrastText,"&>h2":{color:o.palette.error.contrastText}})};class Sm extends Le.Component{handleOk=()=>{this.props.onClose()};render(){return f.jsxs(D.Dialog,{open:!0,maxWidth:"sm",fullWidth:!0,onClose:()=>this.handleOk(),"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[f.jsx(D.DialogTitle,{sx:bR.title,id:"alert-dialog-title",children:this.props.title||I.I18n.t("Error")}),f.jsx(D.DialogContent,{children:f.jsx(D.DialogContentText,{id:"alert-dialog-description",children:this.props.text||I.I18n.t("Unknown error!")})}),f.jsx(D.DialogActions,{children:f.jsx(D.Button,{variant:"contained",onClick:()=>this.handleOk(),color:"primary",autoFocus:!0,startIcon:f.jsx(ol,{}),children:I.I18n.t("Ok")})})]})}}const Bf={buttonIcon:{marginRight:8},icon:{width:24,height:24},filter:{width:"100%"},filterWithButton:{width:"100%"},title:{fontWeight:"bold",marginTop:16}};class $R extends Le.Component{constructor(n){super(n),this.state={instances:[],filter:window.localStorage.getItem("javascript.debug.filter")||"",showAskForStop:!1,jsInstance:window.localStorage.getItem("javascript.debug.instance")||"",jsInstanceHost:"",adapterToDebug:window.localStorage.getItem("javascript.debug.adapter")||""}}componentDidMount(){this.props.socket.getAdapterInstances().then(n=>{const s=n.filter(g=>{var b;return g&&!((b=g.common)!=null&&b.onlyWWW)}).map(g=>{var y,w,C;const b=g._id.replace(/^system\.adapter\./,""),[$]=b.split(".");return{id:b,enabled:(y=g.common)==null?void 0:y.enabled,host:(w=g.common)==null?void 0:w.host,icon:(C=g.common)!=null&&C.icon?`../../adapter/${$}/${g.common.icon}`:""}});s.sort((g,b)=>g.id>b.id?1:g.id<b.id?-1:0);let i=this.state.jsInstance||"";const a=this.state.jsInstance?s.find(g=>g.id===this.state.jsInstance):null;let c;if(!this.state.jsInstance||!a){const g=s.find(b=>b.id.startsWith("javascript."));c=(g==null?void 0:g.host)||"",i=(g==null?void 0:g.id)||""}else c=(a==null?void 0:a.host)||"";let h=this.state.adapterToDebug||"";h&&!s.find(g=>g.id===h)&&(h=""),this.setState({instances:s,jsInstance:i,adapterToDebug:h,jsInstanceHost:c})})}handleOk=()=>{var n;if((n=this.state.instances.find(s=>s.id===this.state.adapterToDebug))!=null&&n.enabled){this.props.socket.getObject(`system.adapter.${this.state.adapterToDebug}`).then(s=>{s&&(s.common.enabled=!1,this.props.socket.setObject(s._id,s).then(()=>this.props.onDebug(this.state.jsInstance,this.state.adapterToDebug)))});return}this.props.onDebug(this.state.jsInstance,this.state.adapterToDebug)};renderJavascriptList(){const n=this.state.instances.filter(s=>s.id.startsWith("javascript."));return n.length<2?null:f.jsxs(D.Grid2,{children:[f.jsx("div",{style:Bf.title,children:I.I18n.t("Host")}),f.jsx(D.List,{component:"nav",children:n.map(s=>f.jsxs(D.ListItemButton,{component:"div",selected:this.state.jsInstance===s.id,onClick:()=>this.setState({jsInstance:s.id,jsInstanceHost:s.host}),children:[f.jsx(D.ListItemIcon,{children:f.jsx("img",{src:s.icon,alt:s.id,style:Bf.icon})}),f.jsx(D.ListItemText,{primary:s.id})]},s.id))})]})}renderInstances(){if(!this.state.jsInstance)return f.jsx(D.Grid2,{});const n=this.state.instances.filter(s=>s.id!==this.state.jsInstance&&s.host===this.state.jsInstanceHost&&(!this.state.filter||s.id.includes(this.state.filter.toLowerCase())));return f.jsxs(D.Grid2,{children:[f.jsx("div",{style:Bf.title,children:I.I18n.t("Instances")}),f.jsx(D.List,{component:"nav",children:n.map(s=>f.jsxs(D.ListItemButton,{selected:this.state.adapterToDebug===s.id,onDoubleClick:()=>this.setState({adapterToDebug:s.id},()=>this.handleOk()),onClick:()=>this.setState({adapterToDebug:s.id}),children:[f.jsx(D.ListItemIcon,{children:f.jsx("img",{src:s.icon,alt:s.id,style:Bf.icon})}),f.jsx(D.ListItemText,{primary:s.id})]},s.id))})]})}render(){return f.jsxs(D.Dialog,{maxWidth:"md",fullWidth:!1,open:!0,onClose:()=>!1,"aria-labelledby":"confirmation-dialog-title",children:[f.jsx(D.DialogTitle,{id:"confirmation-dialog-title",children:this.props.title||I.I18n.t("Debug instance")}),f.jsx(D.DialogContent,{children:f.jsxs(D.Grid2,{container:!0,direction:"column",children:[f.jsx(D.Grid2,{children:f.jsx(D.Input,{style:Bf.filterWithButton,value:this.state.filter,placeholder:I.I18n.t("Filter"),onChange:n=>{this.setState({filter:n.target.value}),window.localStorage.setItem("javascript.debug.filter",n.target.value)},endAdornment:f.jsx(D.InputAdornment,{position:"end",children:this.state.filter?f.jsx(D.IconButton,{size:"small","aria-label":"toggle password visibility",onClick:()=>this.setState({filter:""}),children:f.jsx(K_,{})}):""})})}),f.jsx(D.Grid2,{children:f.jsxs(D.Grid2,{container:!0,children:[this.renderJavascriptList(),this.renderInstances()]})})]})}),f.jsxs(D.DialogActions,{children:[f.jsx(D.Button,{variant:"contained",onClick:this.handleOk,disabled:!this.state.jsInstance||!this.state.adapterToDebug,color:"primary",startIcon:f.jsx(ol,{}),children:I.I18n.t("Start")}),f.jsx(D.Button,{color:"grey",variant:"contained",onClick:()=>this.props.onClose(),startIcon:f.jsx(la,{}),children:I.I18n.t("Close")})]})]})}}const G0="./assets/js.svg",vR="./assets/blockly.svg",yR="./assets/typescript.svg",_R="./assets/rules.svg",wR=48,q0=ET[400],K0=Rx[400],J0=kT[400],Qr="script.js",xh=`${Qr}.common`,el=`${Qr}.global`,Pf=350,SR=16,gE={background:"#164477",color:"white"},dt={drawerPaper:{position:"relative",width:"100%",height:"100%",overflow:"hidden"},toolbar:o=>({height:o.toolbar.height}),toolbarButtons:o=>({color:o.palette.mode==="dark"?"white !important":"black !important"}),iconButtonsDisabled:{filter:"grayscale(100%)",opacity:.5},toolbarSearch:{width:"calc(100% - 105px)",lineHeight:"34px",marginLeft:5},iconButtons:{width:32,height:32,padding:2},iconDropdownMenu:{paddingRight:5},iconOnTheRight:{position:"absolute",right:10,top:"calc(50% - 8px)"},menu:{width:"100%",height:"100%"},innerMenu:{width:"100%",height:"calc(100% - 76px)",overflowX:"hidden",overflowY:"auto"},listItemIcon:{minWidth:32},filterIcon:{width:18,height:18,borderRadius:2,marginRight:5},scriptIcon:{width:18,height:18,borderRadius:2,marginTop:4,marginBottom:4,marginLeft:8,marginRight:4},folder:{cursor:"pointer",padding:0,userSelect:"none"},folderReorder:{opacity:.3,transitionDuration:"0.5s",transitionProperty:"opacity"},folderIcon:{width:20,height:20},folderIconReorder:{paddingTop:4,paddingBottom:4,paddingLeft:8,paddingRight:4},folderIconNoReorder:{cursor:"pointer",paddingTop:4,paddingBottom:4,paddingLeft:8,paddingRight:4},script:{cursor:"pointer",padding:0,userSelect:"none"},scriptReorder:{opacity:1,transitionDuration:"0.5s",transitionProperty:"opacity"},reorder:{},expandButton:{width:37,height:37},selected:gE,instances:{color:"gray",fontSize:"smaller"},childrenCount:{fontSize:10,opacity:.4},footer:{height:24,display:"flex"},footerButtons:o=>({"& img":{color:o.palette.mode==="dark"?"#ffffff":"#111111",cursor:"pointer",mt:"1px",mr:"2px",height:22,width:22,"&:hover":{backgroundColor:"#dbdbdb"}},"& svg":{color:o.palette.mode==="dark"?"#ffffff":"#111111",cursor:"pointer",mt:"1px",mr:"2px",height:22,width:22,"&:hover":{backgroundColor:"#dbdbdb"}}}),footerButtonsRight:{float:"right"},mainList:{"& .js-folder-dragover>div>li>.folder-reorder":{background:"#40adff"},"& .js-folder-dragging .folder-reorder":{opacity:1},"& .js-folder-dragging .script-reorder":{opacity:.3}}},Dh={Blockly:vR,"Javascript/js":G0,def:G0,Rules:_R,"TypeScript/ts":yR};function rw(o,n,s){var i;return s=s||I.I18n.getLanguage(),(i=n==null?void 0:n.common)!=null&&i.name?typeof n.common.name=="object"?(n.common.name[s]||n.common.name.en||o.replace(/^script\.js./,"")).toString():n.common.name.toString():o.replace(/^script\.js./,"")}function Y0(o){var a;const n=[{id:Qr,depth:0,index:0,parent:null,title:"root",type:"folder",parentIndex:null}],s=Object.keys(o);for(let c=0;c<s.length;c++){const h=o[s[c]],g=s[c].split(".");g.pop(),h.type==="script"?n.push({id:s[c],title:rw(s[c],h),enabled:!!((a=h==null?void 0:h.common)!=null&&a.enabled),depth:g.length-1,type:h.common.engineType,parent:g.length>1?g.join("."):null,instance:h.common.engine?parseInt(h.common.engine.split(".").pop(),10)||0:null,index:0,parentIndex:0}):n.push({id:s[c],title:rw(s[c],h),depth:g.length-1,type:"folder",parent:g.length>1?g.join("."):null,index:0,parentIndex:null})}let i;do i=!1,n.forEach(c=>{if(c.parent&&!n.find(g=>g.id===c.parent)){const g=c.parent.split(".");g.pop(),n.push({id:c.parent,title:c.parent.split(".").pop()||"",depth:g.length-1,type:"folder",parent:g.length>1?g.join("."):null,index:0,parentIndex:null}),i=!0}});while(i);return n.sort((c,h)=>{const g=c.id.toLowerCase(),b=h.id.toLowerCase();return c.type==="folder"&&h.type!=="folder"?-1:h.type==="folder"&&c.type!=="folder"||g>b?1:g<b?-1:0}),n.forEach((c,h)=>c.index=h),n.forEach(c=>{if(c.parent){const h=n.find(g=>g.id===c.parent);h&&(c.parentIndex=h.index)}}),n}function CR(o){const{onDrop:n}=o,[{isOver:s,isOverAny:i},a]=Kw({accept:["script"],drop:c=>s?n(c):void 0,collect:c=>({isOver:c.isOver({shallow:!0}),isOverAny:c.isOver()})});return f.jsx("div",{ref:a,className:I.Utils.clsx(s&&"js-folder-dragover",i&&"js-folder-dragging"),children:o.children})}function X0(o){const{name:n}=o,[{opacity:s},i]=rE({type:"script",item:()=>({name:n}),collect:a=>({opacity:a.isDragging()?.3:1})});return f.jsx("div",{ref:i,style:{opacity:s,transform:"translate3d(0, 0, 0)"},children:o.children})}class rl extends Le.Component{inputRef;filterTimer;problems;problemsTimer;onProblemUpdatedBound;parent=null;constructor(n){super(n);const s=window.localStorage?window.localStorage.getItem("SideMenu.expanded"):"[]";let i;try{i=JSON.parse(s||"[]")||[]}catch{i=[]}this.inputRef=Le.createRef(),this.state={listItems:Y0(n.scripts||{}),expanded:i,problems:[],reorder:!1,themeName:this.props.themeName,selected:window.localStorage&&window.localStorage.getItem("SideMenu.selected")||null,creatingScript:null,creatingFolder:!1,copingScript:"",renaming:null,deleting:null,choosingType:!1,errorText:"",instances:n.instances||[],menuOpened:!1,menuAnchorEl:null,menuAnchorFilterEl:null,searchMode:!1,expertMode:this.props.expertMode,searchText:"",width:this.props.width||300,typeFilter:window.localStorage&&window.localStorage.getItem("SideMenu.typeFilter")||"",statusFilter:window.localStorage&&window.localStorage.getItem("SideMenu.statusFilter")||"",runningInstances:this.props.runningInstances||{},scriptsHash:n.scriptsHash,showAdapterDebug:!1,isAllZeroInstances:!1};const a=this.ensureSelectedIsVisible();a&&Object.assign(this.state,{expanded:a}),this.filterTimer=null,Object.assign(this.state,{isAllZeroInstances:this.getIsAllZeroInstances()}),this.problems=null,this.problemsTimer=null,this.onProblemUpdatedBound=this.onProblemUpdated.bind(this)}readProblems(n,s){var i,a;if(s||(s=Object.keys(this.props.scripts)),!s||!s.length)n&&n();else{const c=s.shift(),h=this.props.scripts[c];if(((i=this.props.scripts)==null?void 0:i[c].type)==="script"&&((a=h.common)!=null&&a.enabled)&&!c.match(/^script\.js\.global\./)){const g=h.common.engine.split(".").pop(),b=this,$=`javascript.${g}.scriptProblem.${c.substring(Qr.length+1)}`;this.props.socket.getState($).then(y=>{b.onProblemUpdated($,y),setTimeout(()=>b.readProblems(n,s),0)})}else setTimeout(()=>this.readProblems(n,s),0)}}componentDidMount(){this.readProblems(()=>{this.props.instances.forEach(n=>{this.props.socket.subscribeState(`javascript.${n}.scriptProblem.*`,this.onProblemUpdatedBound)})})}componentWillUnmount(){this.props.instances.forEach(n=>{this.props.socket.unsubscribeState(`javascript.${n}.scriptProblem.*`,this.onProblemUpdatedBound)})}onProblemUpdated(n,s){if(!s||!n)return;n=`${Qr}.${n.replace(/^javascript\.\d+\.scriptProblem\./,"")}`,this.problems||(this.problems=JSON.parse(JSON.stringify(this.state.problems))||[]);let i=!1;if(s.val)this.problems.includes(n)||(this.problems.push(n),i=!0);else{const a=this.problems.indexOf(n);a!==-1&&(this.problems.splice(a,1),i=!0)}i&&!this.problemsTimer&&(this.problemsTimer=setTimeout(()=>{this.problemsTimer=null,this.setState({problems:this.problems}),this.problems=null},300))}static filterListStatic(n,s,i,a,c){s=JSON.parse(JSON.stringify(s));let h=!1;const g={listItems:s};if(n&&i&&a){const b=a.toLowerCase();if(s.forEach($=>{var S;const y=$.title.toLowerCase();$.filteredPartly=!1;let w=y.includes(b);const C=(S=c==null?void 0:c[$.id])==null?void 0:S.common;if(!w&&(C!=null&&C.source))if(C.engineType==="Blockly"){const k=C.source.lastIndexOf("//");w=C.source.substring(0,k).toLowerCase().includes(b)}else w=C.source.toLowerCase().includes(b);w?$.filtered&&($.filtered=!1,h=!0):$.filtered||($.filtered=!0,h=!0)}),h)for(let $=s.length-1;$>=0;$--){const y=s[$];if(!y.filtered||y.filteredPartly){let w=y;do w!=null&&w.parent&&s[w.parentIndex]&&(h=!0,s[w.parentIndex].filteredPartly=!0),w=w!=null&&w.parent&&s[w.parentIndex]?s[w.parentIndex]:null;while(w)}}}else s.forEach(b=>{(b.filtered||b.filteredPartly)&&(b.filtered=!1,b.filteredPartly=!1,h=!0)}),n||(g.searchText="",g.searchMode=!1,h=!0);return h?g:null}filterList(n,s){const i=rl.filterListStatic(n,this.state.listItems,this.state.searchMode,this.state.searchText,this.props.scripts);i?this.setState(i,()=>s&&s()):s&&s()}static ensureSelectedIsVisibleStatic(n,s,i){s=JSON.parse(JSON.stringify(s));let a=!1,c=typeof n=="object"?n:i.find(h=>h.id===n);do{if(c!=null&&c.parent){const h=c.parent;c=i.find(g=>g.id===h)}else c=void 0;c&&(s.includes(c.id)||(s.push(c.id),a=!0))}while(c);return a?s:null}ensureSelectedIsVisible(n,s){return rl.ensureSelectedIsVisibleStatic(n||this.state.selected,s||this.state.expanded,this.state.listItems)}static getDerivedStateFromProps(n,s){const i={};let a=!1;if(s.expertMode!==n.expertMode&&(a=!0,i.expertMode=n.expertMode),s.scriptsHash!==n.scriptsHash&&n.scripts){const c=Y0(n.scripts||{});if(i.listItems=c,s.searchText){const b=rl.filterListStatic(!0,c,s.searchMode,s.searchText,n.scripts);b&&Object.assign(i,b)}const h=rl.getIsAllZeroInstancesStatic(c,n.instances||[]),g=rl.ensureSelectedIsVisibleStatic(s.selected,s.expanded,s.listItems);i.isAllZeroInstances=h,g&&(i.expanded=g),a=!0}if(s.width!==n.width&&(a=!0,i.width=n.width),s.themeName!==n.themeName&&(a=!0,i.themeName=n.themeName),n.selectId&&s.selected!==n.selectId){const c=s.listItems.find(h=>h.id===n.selectId);if(!s.reorder&&c){const h=rl.ensureSelectedIsVisibleStatic(c,s.expanded,s.listItems);i.selected=c.id,h&&(i.expanded=h),a=!0,window.localStorage&&window.localStorage.setItem("SideMenu.selected",c.id)}}return a?i:null}static getIsAllZeroInstancesStatic(n,s){let i=!s[0]&&s.length<=1;return i&&n.forEach(a=>{a.type!=="folder"&&a.instance!==0&&(i=!1)}),i}getIsAllZeroInstances(n,s){return n=n||this.state.listItems,s=s||this.state.instances,rl.getIsAllZeroInstancesStatic(n||this.state.listItems,s||this.state.instances)}saveExpanded(n){window.localStorage.setItem("SideMenu.expanded",JSON.stringify(n||this.state.expanded))}showError(n){this.setState({errorText:n})}onToggle(n,s){if(s==null||s.stopPropagation(),n===Qr)return;const i=[...this.state.expanded],a=i.indexOf(n);a!==-1?(i.splice(a,1),this.state.selected&&this.state.selected.startsWith(`${n}.`)&&window.localStorage&&window.localStorage.setItem("SideMenu.selected",n)):(i.push(n),i.sort()),this.setState({expanded:i}),this.saveExpanded(i)}renderItemButtonsOnEnd(n,s){if(this.state.reorder)return null;if(n.type!=="folder"){let i=n.enabled?q0:J0;return n.enabled&&this.state.problems.includes(n.id)&&(i=K0),[f.jsx(D.IconButton,{onClick:a=>{a.stopPropagation(),this.props.onEnableDisable&&this.props.onEnableDisable(n.id,!n.enabled)},title:n.enabled?I.I18n.t("Pause script"):I.I18n.t("Run script"),disabled:this.props.debugMode,style:{...dt.iconButtons,...this.props.debugMode?dt.iconButtonsDisabled:void 0,color:i},size:"medium",children:n.enabled?f.jsx(Xf,{}):f.jsx(Iv,{})},"startStop"),this.state.width>Pf?f.jsx(D.IconButton,{style:this.props.debugMode?dt.iconButtonsDisabled:void 0,title:I.I18n.t("Delete script"),disabled:n.id===el||n.id===xh||this.props.debugMode,onClick:a=>this.onDelete(n,a),size:"medium",children:f.jsx(cv,{})},"delete"):null,f.jsx(D.IconButton,{style:this.props.debugMode?dt.iconButtonsDisabled:void 0,disabled:this.props.debugMode,title:I.I18n.t("Edit script or just double click"),onClick:a=>this.onEdit(n,a),size:"medium",children:f.jsx(zT,{})},"openInEdit")]}return this.state.width>Pf&&n.id!==Qr&&n.id!==xh&&n.id!==el&&s!=null&&s.length?f.jsx(D.IconButton,{style:this.props.debugMode?dt.iconButtonsDisabled:void 0,title:I.I18n.t("Delete folder"),disabled:n.id===el||n.id===xh||this.props.debugMode,onClick:i=>this.onDelete(n,i),size:"medium",children:f.jsx(cv,{})},"delete"):null}onDelete(n,s){return s==null||s.stopPropagation(),new Promise(i=>{if(!n){i();return}typeof n!="object"?this.setState({deleting:n},()=>i()):this.setState({deleting:n.id},()=>i())})}onEdit(n,s){this.onClick(n,s),this.props.onEdit&&this.props.onEdit(n.id)}getTextStyle(n){return!this.state.reorder&&n.type!=="folder"?{width:`calc(100% - ${this.state.width>Pf?185:137}px)`,overflow:"hidden",whiteSpace:"nowrap",flex:"none",padding:"0 16px 0 0"}:{whiteSpace:"nowrap",padding:"0 16px 0 0"}}onClick(n,s){if(s==null||s.stopPropagation(),!this.state.reorder&&n){const i=this.ensureSelectedIsVisible(n),a={selected:n.id};i&&(a.expanded=i),this.setState(a),window.localStorage&&window.localStorage.setItem("SideMenu.selected",n.id)}}onDblClick(n,s){s==null||s.stopPropagation(),!this.state.reorder&&(n.type==="folder"?this.onToggle(n.id):this.onEdit(n))}isFilteredOut(n){return n.filtered&&!n.filteredPartly||this.state.typeFilter&&n.type!=="folder"&&n.type!==this.state.typeFilter||this.state.statusFilter&&n.type!=="folder"&&(this.state.statusFilter==="running"&&!n.enabled||this.state.statusFilter==="paused"&&n.enabled||this.state.statusFilter==="problems"&&(!n.enabled||this.state.problems.indexOf(n.id)===-1))?!0:n.id===el&&!this.state.expertMode}renderListItem(n,s,i){if(n.id===Qr&&!this.state.reorder)return null;const a=(this.state.reorder?n.depth:n.depth-1)*SR;let c=n.title;if(this.state.searchText){const C=c.toLowerCase().indexOf(this.state.searchText.toLowerCase());C!==-1&&(c=[f.jsx("span",{children:c.substring(0,C)},"first"),f.jsx("span",{style:{color:"orange"},children:c.substring(C,C+this.state.searchText.length)},"second"),f.jsx("span",{children:c.substring(C+this.state.searchText.length)},"third")])}!this.state.isAllZeroInstances&&n.type!=="folder"&&(c=[f.jsx("span",{children:c},"title"),f.jsxs("span",{title:I.I18n.t("Instance"),style:dt.instances,children:["[",n.instance,"]"]},"instance")]);const h=this.state.reorder&&!this.props.debugMode,g=Object.assign({marginLeft:a,cursor:n.type==="folder"&&h?"default":"inherit",width:`calc(100% - ${a}px)`},n.id===this.state.selected&&!h?gE:void 0);h||(g.opacity=n.filteredPartly?.5:1),n.id===el&&n.id!==this.state.selected&&(g.color="#00a200");let b=n.id===Qr;!b&&s&&(b=this.state.expanded.includes(n.id));let $;n.type==="folder"?$={...dt.folderIcon,...h?dt.folderIconReorder:dt.folderIconNoReorder}:$={...dt.scriptIcon},n.id===el?$.color="#356956":n.id===xh&&($.color="#4899e1");let y=null;(i&&i.length||s&&s.length)&&(y=f.jsx("span",{style:dt.childrenCount,children:i&&i.length!==s.length?`${i.length}(${s.length})`:s.length}));const w={...n.type==="folder"?dt.folder:dt.script,...h?dt.reorder:void 0,...h&&n.type!=="folder"?dt.scriptReorder:void 0,...h&&n.type==="folder"?dt.folderReorder:void 0,...g};return f.jsxs(D.ListItem,{style:w,className:I.Utils.clsx(h&&n.type==="folder"&&"folder-reorder",h&&n.type!=="folder"&&"script-reorder"),onClick:C=>this.onClick(n,C),onDoubleClick:C=>this.onDblClick(n,C),secondaryAction:this.renderItemButtonsOnEnd(n,s),children:[f.jsx(D.ListItemIcon,{style:dt.listItemIcon,children:n.type==="folder"?h||b?f.jsx(ZO,{style:$,onClick:C=>!h&&this.onToggle(n.id,C)}):f.jsx(QO,{style:$,onClick:C=>!h&&this.onToggle(n.id,C)}):f.jsx("img",{style:$,alt:n.type,src:Dh[n.type]||Dh.def})}),f.jsx(D.ListItemText,{sx:{"& .MuiListItemText-primary":n.id===this.state.selected&&!h?dt.selected:void 0},style:this.getTextStyle(n),primary:f.jsxs("span",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[c,y]})})]},n.id)}onDragFinish(n,s){let i=`${s}.${n.split(".").pop()}`;i!==n&&(this.state.listItems.find(a=>a.id===i)&&(i+=`_${I.I18n.t("copy")}`),this.props.onRename&&this.props.onRename(n,i))}renderOneItem(n,s){const i=this.state.statusFilter||this.state.typeFilter?n.filter($=>$.parent===s.id?!this.isFilteredOut($):!1):[],a=n.filter($=>$.parent===s.id);if(this.isFilteredOut(s)||s.type==="folder"&&(this.state.statusFilter||this.state.typeFilter)&&!i.length)return null;const c=this.state.reorder&&!this.props.debugMode,h=this.renderListItem(s,a,i),g=[];let b;return a&&(c||this.state.expanded.includes(s.id)||s.id===Qr)&&(b=a.map($=>this.renderOneItem(n,$))),c?s.type==="folder"?g.push(f.jsxs(CR,{onDrop:$=>this.onDragFinish($.name,s.id),children:[f.jsx(X0,{name:s.id,children:h},`draggable_${s.id}`),b||null]},`droppable_${s.id}`)):g.push(f.jsxs(X0,{name:s.id,children:[h,b||null]},`draggable_${s.id}`)):(g.push(h),b==null||b.forEach($=>g.push($))),g}renderAllItems(n){const s=n.filter(i=>!i.parent).map(i=>this.renderOneItem(n,i));return f.jsx(D.List,{dense:!0,disablePadding:!0,sx:dt.mainList,children:s})}onAddNew(n){n==null||n.stopPropagation();let s=this.state.listItems.find(a=>a.id===this.state.selected),i=Qr;for(;s&&s.type!=="folder";)s=this.state.listItems[s.parentIndex];s&&(i=s.id),this.parent=i,this.setState({choosingType:!0})}onCopy(n,s){n==null||n.stopPropagation();let i=this.state.listItems.find(c=>c.id===s),a=Qr;for(;i&&i.type!=="folder";)i=this.state.listItems[i.parentIndex];i&&(a=i.id),this.parent=a,this.setState({copingScript:s||""})}onRename(n){n==null||n.stopPropagation(),this.setState({renaming:this.state.selected})}getUniqueName(n){let s=1,i=`${I.I18n.t("Script")} `;if(n){const a=rw(n,this.props.scripts[n]),c=a.match(/\d+$/);c?(i=a.replace(/\d+$/,""),s=parseInt(c[0],10)+1):i=a}for(;this.state.listItems.find(a=>a.id===`${this.parent}.${i.replace(/\.\s/g,"_")}${s}`);)s++;return i+s}getUniqueFolderName(){let n=1;for(;this.state.listItems.find(s=>s.id===`${this.parent}.${I.I18n.t("Folder")}_${n}`);)n++;return`${I.I18n.t("Folder")} ${n}`}onCloseMenu(n){this.setState({menuOpened:!1,menuAnchorEl:null,menuAnchorFilterEl:null},n)}getMainMenu(n,s){return f.jsxs(D.Menu,{id:"long-menu",anchorEl:this.state.menuAnchorEl,open:this.state.menuOpened,onClose:()=>this.setState({menuOpened:!1,menuAnchorEl:null}),slotProps:{paper:{style:{maxHeight:wR*7.5}}},children:[this.state.width<=Pf?f.jsxs(D.MenuItem,{disabled:this.props.debugMode||!this.state.selected||this.state.selected===el||this.state.selected===xh||!!(n!=null&&n.length),onClick:i=>{if(i.stopPropagation(),i.preventDefault(),this.state.listItems.find(a=>a.parent===this.state.selected)){this.showError(I.I18n.t("Cannot delete non empty item!"));return}this.setState({menuOpened:!1,menuAnchorEl:null},()=>this.onDelete(this.state.selected).then(()=>{}))},children:[f.jsx(cv,{style:{...dt.iconDropdownMenu,color:"red"}}),I.I18n.t("Delete")]},"delete"):null,f.jsxs(D.MenuItem,{disabled:this.props.debugMode,selected:this.state.expertMode,onClick:i=>{i.stopPropagation(),i.preventDefault(),this.onCloseMenu(()=>this.props.onExpertModeChange&&this.props.onExpertModeChange(!this.state.expertMode))},children:[f.jsx(I.IconExpert,{style:{...dt.iconDropdownMenu,color:this.state.expertMode?"orange":"inherit"}}),I.I18n.t("Expert mode")]},"expertMode"),this.props.onExport&&f.jsxs(D.MenuItem,{onClick:i=>{i.stopPropagation(),i.preventDefault(),this.onCloseMenu(()=>this.props.onExport())},children:[f.jsx(xv,{style:dt.iconDropdownMenu}),I.I18n.t("Export all scripts")]},"exportAll"),this.props.onImport&&f.jsxs(D.MenuItem,{disabled:this.props.debugMode,onClick:i=>{i.stopPropagation(),i.preventDefault(),this.onCloseMenu(()=>this.props.onImport())},children:[f.jsx(sw,{style:dt.iconDropdownMenu}),I.I18n.t("Import scripts")]},"import"),this.props.onThemeChange&&f.jsxs(D.MenuItem,{onClick:()=>this.onCloseMenu(()=>{this.props.onThemeChange&&this.props.onThemeChange(I.Utils.toggleTheme(this.state.themeName))}),children:[f.jsx(O1,{style:dt.iconDropdownMenu}),I.I18n.t('Change theme (actual "%s")',this.state.themeName)]},"dark"),this.props.onAddNew&&f.jsxs(D.MenuItem,{disabled:!this.state.selected||!s||s.type==="folder",onClick:i=>{const a=this.state.selected;this.onCloseMenu(()=>this.onCopy(i,a))},children:[f.jsx(zw,{style:dt.iconDropdownMenu}),I.I18n.t("Copy script")]},"copy"),this.state.expertMode&&f.jsxs(D.MenuItem,{disabled:this.props.debugMode,onClick:i=>{i.stopPropagation(),i.preventDefault(),this.onCloseMenu(()=>this.setState({showAdapterDebug:!0}))},children:[f.jsx(Hf,{style:dt.iconDropdownMenu}),I.I18n.t("Debug instance")]},"debugInstance")]},"menu")}getToolbarButtons(){const n=[],s=this.state.reorder&&!this.props.debugMode;if(this.state.searchMode&&!this.props.debugMode)n.push(f.jsx(D.Input,{value:this.state.searchText,style:dt.toolbarSearch,ref:this.inputRef,autoFocus:!0,placeholder:I.I18n.t("Search..."),onChange:i=>{this.setState({searchText:i.target.value}),this.filterTimer&&clearTimeout(this.filterTimer),this.filterTimer=setTimeout(()=>{this.filterTimer=null,this.filterList(!0),this.props.onSearch&&this.props.onSearch(this.state.searchText)},400)}},"searchInput")),n.push(f.jsx(D.IconButton,{sx:dt.toolbarButtons,style:{float:"right"},title:I.I18n.t("End search mode"),onClick:i=>{i.stopPropagation(),this.filterList(!1,()=>this.props.onSearch&&this.props.onSearch(this.state.searchText))},size:"medium",children:f.jsx(k1,{})},"disableSearch")),this.state.searchText&&n.push(f.jsx(D.IconButton,{title:I.I18n.t("Clear search input"),sx:dt.toolbarButtons,style:{marginTop:7,float:"right"},onClick:i=>{i.stopPropagation(),this.setState({searchText:""},()=>{this.filterList(!0),this.props.onSearch&&this.props.onSearch(this.state.searchText)})},size:"medium",children:f.jsx(Uh,{fontSize:"small"})},"cleanSearch"));else{if(!s){n.push(f.jsx(D.IconButton,{"aria-label":"More","aria-owns":this.state.menuOpened?"long-menu":void 0,title:I.I18n.t("Menu"),"aria-haspopup":"true",onClick:c=>{c.stopPropagation(),c.preventDefault(),this.setState({menuOpened:!0,menuAnchorEl:c.currentTarget})},size:"medium",children:f.jsx(B1,{})},"menuButton"));const i=this.state.listItems.find(c=>c.id===this.state.selected);let a;i&&this.state.width<=Pf&&i.type==="folder"&&(a=this.state.listItems.filter(c=>c.parent===this.state.selected)),n.push(this.getMainMenu(a,i)),n.push(f.jsx(D.IconButton,{disabled:this.props.debugMode,title:I.I18n.t("Create new script"),sx:{...dt.toolbarButtons,...this.props.debugMode?dt.iconButtonsDisabled:void 0},style:{color:s?"red":"inherit"},onClick:c=>this.onAddNew(c),size:"medium",children:f.jsx(cy,{})},"new-script")),n.push(f.jsx(D.IconButton,{disabled:this.props.debugMode,title:I.I18n.t("Create new folder"),sx:{...dt.toolbarButtons,...this.props.debugMode?dt.iconButtonsDisabled:void 0},style:{color:s?"red":"inherit"},onClick:c=>this.onAddNew(c),size:"medium",children:f.jsx(I1,{})},"new-folder"))}n.push(f.jsx(D.IconButton,{disabled:s||this.props.debugMode,sx:{...dt.toolbarButtons,...this.props.debugMode?dt.iconButtonsDisabled:void 0},title:I.I18n.t("Search in scripts"),style:{float:"right",opacity:this.props.debugMode?.5:s?0:1},onClick:i=>{i.stopPropagation(),this.setState({searchMode:!0})},size:"medium",children:f.jsx(y1,{})},"search")),n.push(f.jsx(D.IconButton,{disabled:this.props.debugMode,title:I.I18n.t("Reorder scripts in folders"),sx:{...dt.toolbarButtons,...this.props.debugMode?dt.iconButtonsDisabled:void 0},style:{color:s?"red":"inherit",float:"right"},onClick:i=>{i.stopPropagation(),this.setState({reorder:!this.state.reorder})},size:"medium",children:f.jsx(_1,{})},"reorder")),!s&&this.state.selected&&this.state.selected!==el&&this.state.selected!==xh&&n.push(f.jsx(D.IconButton,{sx:{...dt.toolbarButtons,...this.props.debugMode?dt.iconButtonsDisabled:void 0},disabled:this.props.debugMode,title:I.I18n.t("Rename"),onClick:i=>this.onRename(i),size:"medium",children:f.jsx(D1,{})},"rename")),n.push(f.jsxs("span",{style:{opacity:.5,fontSize:10},children:["v",this.props.version]},"version"))}return n}getFolders(){const n=[{id:Qr,name:I.I18n.t("Root folder")}];return this.state.listItems.forEach(s=>{s.type==="folder"&&s.id!==Qr&&(!s.id.startsWith(el)||this.state.expertMode)&&n.push({id:s.id,name:s.title})}),n}onCollapseAll(){this.setState({expanded:[]}),this.saveExpanded([])}onExpandAll(){const n=[];this.state.listItems.forEach(s=>this.state.listItems.find(i=>i.parent===s.id)&&n.push(s.id)),this.setState({expanded:n}),this.saveExpanded(n)}getBottomButtons(){return this.state.reorder||this.props.debugMode?null:[f.jsx(D.Box,{sx:dt.footerButtons,children:f.jsx(Xf,{style:{color:q0,opacity:this.state.statusFilter==="running"?1:.3,background:this.state.statusFilter==="running"?"gray":"inherit"},title:I.I18n.t("Show only running scripts"),onClick:n=>{n.stopPropagation(),n.preventDefault();const s=this.state.statusFilter==="running"?"":"running";window.localStorage&&window.localStorage.setItem("SideMenu.statusFilter",s),this.setState({statusFilter:s})}})},"filterByRunning"),f.jsx(D.Box,{sx:dt.footerButtons,children:f.jsx(Iv,{title:I.I18n.t("Show only paused scripts"),style:{color:J0,opacity:this.state.statusFilter==="paused"?1:.3,background:this.state.statusFilter==="paused"?"gray":"inherit"},onClick:()=>{const n=this.state.statusFilter==="paused"?"":"paused";window.localStorage&&window.localStorage.setItem("SideMenu.statusFilter",n),this.setState({statusFilter:n})}})},"filterByPaused"),f.jsx(D.Box,{sx:dt.footerButtons,style:{marginRight:16},children:f.jsx(Xf,{title:I.I18n.t("Show only scripts with problems"),style:{color:K0,opacity:this.state.statusFilter==="problems"?1:.3,background:this.state.statusFilter==="problems"?"gray":"inherit"},onClick:()=>{const n=this.state.statusFilter==="problems"?"":"problems";window.localStorage&&window.localStorage.setItem("SideMenu.statusFilter",n),this.setState({statusFilter:n})}})},"filterByProblem"),f.jsx(D.Box,{sx:dt.footerButtons,children:f.jsx("img",{alt:"Blockly",style:{opacity:this.state.typeFilter==="Blockly"?1:.3,background:this.state.typeFilter==="Blockly"?"gray":"inherit"},src:Dh.Blockly,onClick:()=>{const n=this.state.typeFilter==="Blockly"?"":"Blockly";window.localStorage&&window.localStorage.setItem("SideMenu.typeFilter",n),this.setState({typeFilter:n})}})},"filterBlockly"),f.jsx(D.Box,{sx:dt.footerButtons,children:f.jsx("img",{alt:"Javascript",style:{opacity:this.state.typeFilter==="Javascript/js"?1:.3,background:this.state.typeFilter==="Javascript/js"?"gray":"inherit"},src:Dh["Javascript/js"],onClick:()=>{const n=this.state.typeFilter==="Javascript/js"?"":"Javascript/js";window.localStorage&&window.localStorage.setItem("SideMenu.typeFilter",n),this.setState({typeFilter:n})}})},"filterJS"),f.jsx(D.Box,{sx:dt.footerButtons,children:f.jsx("img",{alt:"TypeScript",style:{opacity:this.state.typeFilter==="TypeScript/ts"?1:.3,background:this.state.typeFilter==="TypeScript/ts"?"gray":"inherit"},src:Dh["TypeScript/ts"],onClick:()=>{const n=this.state.typeFilter==="TypeScript/ts"?"":"TypeScript/ts";window.localStorage&&window.localStorage.setItem("SideMenu.typeFilter",n),this.setState({typeFilter:n})}})},"filterTS"),f.jsx(D.Box,{sx:dt.footerButtons,children:f.jsx("img",{alt:"Rules",style:{opacity:this.state.typeFilter==="Rules"?1:.3,background:this.state.typeFilter==="Rules"?"gray":"inherit"},src:Dh.Rules,onClick:()=>{const n=this.state.typeFilter==="Rules"?"":"Rules";window.localStorage&&window.localStorage.setItem("SideMenu.typeFilter",n),this.setState({typeFilter:n})}})},"filterRules"),f.jsx("div",{style:{flexGrow:1}},"padding"),f.jsx(D.Box,{sx:dt.footerButtons,children:f.jsx(F1,{style:dt.footerButtonsRight,title:I.I18n.t("Expand all"),onClick:()=>this.onExpandAll()})},"expandAll"),this.state.expanded.length?f.jsx(D.Box,{sx:dt.footerButtons,children:f.jsx(P1,{style:dt.footerButtonsRight,title:I.I18n.t("Collapse all"),onClick:()=>this.onCollapseAll()})},"collapseAll"):f.jsx("div",{style:{height:22,width:24}})]}getAdapterDebugDialog(){return this.state.showAdapterDebug?f.jsx($R,{socket:this.props.socket,onClose:()=>this.setState({showAdapterDebug:!1}),onDebug:(n,s)=>this.setState({showAdapterDebug:!1},()=>this.props.onDebugInstance({instance:n,adapter:s}))},"debug"):null}render(){var i,a,c;const n=this.state.renaming?this.state.listItems.find(h=>h.id===this.state.renaming):void 0,s=this.state.copingScript&&this.props.scripts[this.state.copingScript].type==="script"?this.props.scripts[this.state.copingScript]:void 0;return[f.jsxs(D.Drawer,{variant:"permanent",style:dt.menu,sx:{"& .MuiDrawer-paper":dt.drawerPaper},anchor:"left",onClick:()=>this.onClick({id:""}),children:[f.jsx(D.Box,{sx:dt.toolbar,children:this.getToolbarButtons()}),f.jsx(D.Divider,{}),f.jsx(ZT,{backend:hE,children:f.jsx("div",{style:dt.innerMenu,children:this.renderAllItems(this.state.listItems)})}),f.jsx(D.Divider,{}),f.jsx("div",{style:dt.footer,children:this.getBottomButtons()})]},"drawer"),n?f.jsx(Yw,{name:n.title,id:this.state.renaming||"",folder:n.type==="folder",instance:n.instance,instances:this.props.instances,onClose:()=>this.setState({renaming:null}),onRename:(h,g,b,$)=>this.props.onRename&&this.props.onRename(h,g,b,$)},"dialog-rename"):null,this.state.deleting?f.jsx(hR,{name:this.state.listItems.find(h=>h.id===this.state.deleting).title,id:this.state.deleting,onClose:()=>this.setState({deleting:null}),onDelete:h=>this.props.onDelete&&this.props.onDelete(h)},"dialog-delete"):null,this.state.choosingType?f.jsx(Hh,{onClose:h=>{const g={choosingType:!1};h&&(g.creatingScript=h),this.setState(g)}},"dialog-script-type"):null,this.state.creatingScript?f.jsx(o_,{onClose:()=>this.setState({creatingScript:null}),title:I.I18n.t("Create new script"),name:this.getUniqueName(),parents:this.getFolders(),folder:!1,existingItems:this.state.listItems.map(h=>h.id),instance:this.props.instances[0]||0,instances:this.props.instances,type:this.state.creatingScript,parent:this.parent,onAdd:(h,g,b,$)=>this.props.onAddNew&&this.props.onAddNew(h,g,!1,b,$)},"dialog-new-script"):null,this.state.copingScript?f.jsx(o_,{onClose:()=>this.setState({copingScript:""}),title:I.I18n.t("Copy script"),name:this.getUniqueName(this.state.copingScript),parents:this.getFolders(),folder:!1,instance:parseInt((a=(i=s==null?void 0:s.common)==null?void 0:i.engine)==null?void 0:a.split(".").pop(),10)||0,instances:this.props.instances,type:((c=s==null?void 0:s.common)==null?void 0:c.engineType)||"Javascript/js",parent:this.parent,onAdd:(h,g,b,$)=>{var w;const y=this.state.copingScript&&this.props.scripts[this.state.copingScript].type==="script"?this.props.scripts[this.state.copingScript]:void 0;y!=null&&y.common&&(y.common.enabled=!1),this.props.onAddNew&&this.props.onAddNew(h,g,!1,b,$,(w=y==null?void 0:y.common)==null?void 0:w.source)}},"dialog-copy-script"):null,this.state.creatingFolder?f.jsx(o_,{onClose:()=>this.setState({creatingFolder:!1}),title:I.I18n.t("Create new folder"),parents:this.getFolders(),name:this.getUniqueFolderName(),parent:this.parent,onAdd:(h,g)=>this.props.onAddNew&&this.props.onAddNew(h,g,!0)},"dialog-new-folder"):null,this.state.errorText?f.jsx(Sm,{onClose:()=>this.setState({errorText:""}),text:this.state.errorText},"error"):null,this.getAdapterDebugDialog()]}}const TR="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgAQMAAADYVuV7AAAABlBMVEUAAAAzMzPI8eYgAAAAAXRSTlMAQObYZgAAACFJREFUeAFjAIJRwP////8PYIKWHCigNQdKj/pn1D+jAABTG16wVQqVpQAAAABJRU5ErkJggg==",ER="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgAQMAAADYVuV7AAAABlBMVEUAAAAzMzPI8eYgAAAAAXRSTlMAQObYZgAAABtJREFUeAFjAIJRwP8fCj7QkENn/4z6Z5QzCgBjbWaoyx1PqQAAAABJRU5ErkJggg==";function kR(o){let n,s=o.getHours();return s<10&&(s=`0${s.toString()}`),n=`${s}:`,s=o.getMinutes(),s<10&&(s=`0${s.toString()}`),n+=`${s}:`,s=o.getSeconds(),s<10&&(s=`0${s.toString()}`),n+=`${s}.`,s=o.getMilliseconds(),s<10?s=`00${s.toString()}`:s<100&&(s=`0${s.toString()}`),n+=s,n}const Z0=34,fr={logBox:{width:"100%",height:"100%",position:"relative",overflow:"hidden"},logBoxInner:o=>({display:"inline-block",color:o.palette.mode==="dark"?"white":"black",width:`calc(100% - ${Z0}px)`,height:"100%",overflow:"auto",position:"relative",verticalAlign:"top"}),info:o=>({background:o.palette.mode==="dark"?"darkgrey":"lightgrey",color:(o.palette.mode==="dark","black")}),error:o=>({background:"#FF0000",color:o.palette.mode==="dark"?"black":"white"}),warn:o=>({background:"#FF8000",color:o.palette.mode==="dark"?"black":"white"}),debug:o=>({background:"gray",opacity:.8,color:o.palette.mode==="dark"?"black":"white"}),silly:o=>({background:"gray",opacity:.6,color:o.palette.mode==="dark"?"black":"white"}),table:{fontFamily:"monospace",width:"100%"},toolbox:{width:Z0,height:"100%",boxShadow:"2px 0px 4px -1px rgba(0, 0, 0, 0.2), 4px 0px 5px 0px rgba(0, 0, 0, 0.14), 1px 0px 10px 0px rgba(0, 0, 0, 0.12)",display:"inline-block",verticalAlign:"top",overflow:"hidden"},trFrom:{width:90},trTime:{width:90},trSeverity:{width:40,fontWeight:"bold"},trPreMessage:{padding:0,margin:0},iconButtons:{width:32,height:32,padding:4},layoutIcon:o=>({"& img":{width:24,height:24,background:o.palette.mode==="dark"?"#9d9d9d":void 0,borderRadius:o.palette.mode==="dark"?"30px":void 0}})};function IR(o){return o<10?`00${o}`:o<100?`0${o}`:o.toString()}const Qo={};class Xw extends Le.Component{messagesEnd;constructor(n){super(n),this.state={lines:{},goBottom:!0,selected:null,editing:this.props.editing||[]},this.messagesEnd=Le.createRef()}static generateLine(n,s){let i=n.message||"";if(typeof i!="object"){const a=new RegExp(`${n.from.replace(".","\\.").replace(")","\\)").replace("(","\\(")} \\(\\d+\\) `,"g"),c=i.match(a);c?i=i.replace(c[0],""):i=i.replace(`${n.from} `,"")}return i.startsWith(`${s}: `)&&(i=i.substring(s.length+2)),f.jsxs(D.Box,{component:"tr",sx:fr[n.severity],children:[f.jsx("td",{style:fr.trFrom,children:n.from}),f.jsx("td",{style:fr.trTime,children:kR(new Date(n.ts))}),f.jsx("td",{style:fr.trSeverity,children:n.severity}),f.jsx("td",{children:f.jsx("pre",{style:fr.trPreMessage,children:i})})]},`tr_${n.ts}_${n.message.substring(n.message.length-10)}`)}scrollToBottom(){var n,s;(s=(n=this.messagesEnd)==null?void 0:n.current)==null||s.scrollIntoView({behavior:"smooth"})}logHandler=n=>{const s=this.state.lines,i=this.state.editing.filter($=>n.message.includes($));let a=null;if(!i.length||(i.length===1?a=i[0]:(i.sort(),a=i[i.length-1]),!a))return;const c=s[a]||[],h=Qo[a]||[];c.push(Xw.generateLine(n,a));let g=n.severity;(g==="info"||g==="warn")&&(g+=" ");const b=new Date(n.ts);h.push(`${b.toLocaleString()}.${IR(b.getMilliseconds())}	[${g}]: ${n.message}`),c.length>300&&(c.splice(0,c.length-300),h.splice(0,c.length-300)),Qo[a]=h,s[a]=c,this.setState({lines:s})};componentDidMount(){this.props.socket.registerLogHandler(this.logHandler)}componentWillUnmount(){this.props.socket.unregisterLogHandler(this.logHandler)}componentDidUpdate(){this.state.goBottom&&this.scrollToBottom()}static getDerivedStateFromProps(n,s){let i=!1;const a={};if(n.selected!==s.selected){const c=n.selected,h=s.lines;c&&(h[c]=h[c]||[],Qo[c]=Qo[c]||[]),a.selected=c,i=!0}if(JSON.stringify(n.editing)!==JSON.stringify(s.editing)){const c=JSON.parse(JSON.stringify(n.editing));i=!0;const h=s.lines;for(const g in Qo)Object.prototype.hasOwnProperty.call(Qo,g)&&(c.includes(g)||(delete Qo[g],delete h[g]));a.editing=c}return i?a:null}onCopy(){I.Utils.copyToClipboard((Qo[this.state.selected]||[]).join(`
`))}clearLog(){const n=this.state.lines;n[this.state.selected]&&(n[this.state.selected]=[]),Qo[this.state.selected]&&(Qo[this.state.selected]=[]),this.setState({lines:n})}renderLogList(n){return this.state.selected&&(n!=null&&n.length)?f.jsxs(D.Box,{sx:fr.logBoxInner,children:[f.jsx("table",{style:fr.table,children:f.jsx("tbody",{children:n})},"logTable"),f.jsx("div",{ref:this.messagesEnd,style:{float:"left",clear:"both"}},"logScrollPoint")]},"logList"):f.jsx(D.Box,{sx:fr.logBoxInner,style:{paddingLeft:10},children:I.I18n.t("Log outputs")},"logList")}render(){const n=this.state.selected?this.state.lines[this.state.selected]:null;return f.jsxs("div",{style:fr.logBox,children:[f.jsxs("div",{style:fr.toolbox,children:[f.jsx(D.IconButton,{style:fr.iconButtons,onClick:()=>this.setState({goBottom:!this.state.goBottom}),color:this.state.goBottom?"secondary":void 0,size:"medium",children:f.jsx(UT,{})}),n!=null&&n.length?f.jsx(D.IconButton,{style:fr.iconButtons,onClick:()=>this.clearLog(),size:"medium",children:f.jsx(jT,{})}):null,n!=null&&n.length?f.jsx(D.IconButton,{style:fr.iconButtons,onClick:()=>this.onCopy(),size:"medium",children:f.jsx(zw,{})}):null,this.props.onLayoutChange?f.jsx(D.IconButton,{style:fr.iconButtons,onClick:()=>this.props.onLayoutChange&&this.props.onLayoutChange(),title:I.I18n.t("Change layout"),size:"medium",sx:fr.layoutIcon,children:f.jsx("img",{alt:"split",src:this.props.verticalLayout?TR:ER})}):null,f.jsx(D.IconButton,{style:fr.iconButtons,onClick:()=>this.props.onHideLog(),title:I.I18n.t("Hide logs"),size:"medium",children:f.jsx(w1,{})})]},"toolbox"),this.renderLogList(n)]})}}var Q0="focus-outline-hidden";function fE(){var o=this;document.addEventListener("keydown",function(n){o.focusByKeyboard=!0},!0),document.addEventListener("mousedown",function(n){o.focusByKeyboard=!1},!0),document.addEventListener("focus",function(n){o.updateVisibility()},!0),document.addEventListener("focusout",function(n){window.setTimeout(function(){document.hasFocus()||(o.focusByKeyboard=!0,o.updateVisibility())},0)}),this.updateVisibility()}fE.prototype={focusByKeyboard:!0,updateVisibility:function(){this.hidden=!this.focusByKeyboard},set hidden(o){document.documentElement.classList.toggle(Q0,o)},get hidden(){return document.documentElement.classList.contains(Q0)}};new fE;var mE={exports:{}};/*!
  Copyright (c) 2018 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/(function(o){(function(){var n={}.hasOwnProperty;function s(){for(var i=[],a=0;a<arguments.length;a++){var c=arguments[a];if(c){var h=typeof c;if(h==="string"||h==="number")i.push(c);else if(Array.isArray(c)){if(c.length){var g=s.apply(null,c);g&&i.push(g)}}else if(h==="object")if(c.toString===Object.prototype.toString)for(var b in c)n.call(c,b)&&c[b]&&i.push(b);else i.push(c.toString())}}return i.join(" ")}o.exports?(s.default=s,o.exports=s):window.classNames=s})()})(mE);var xR=mE.exports;const eC=aa(xR);var iw={exports:{}},ow={exports:{}},ju={};Object.defineProperty(ju,"__esModule",{value:!0});var DR=ju.easeFunctions={linear:function(n){return n},easeInQuad:function(n){return n*n},easeOutQuad:function(n){return n*(2-n)},easeInOutQuad:function(n){return n<.5?2*n*n:-1+(4-2*n)*n},easeInCubic:function(n){return n*n*n},easeOutCubic:function(n){return--n*n*n+1},easeInOutCubic:function(n){return n<.5?4*n*n*n:(n-1)*(2*n-2)*(2*n-2)+1},easeInQuart:function(n){return n*n*n*n},easeOutQuart:function(n){return 1- --n*n*n*n},easeInOutQuart:function(n){return n<.5?8*n*n*n*n:1-8*--n*n*n*n},easeInQuint:function(n){return n*n*n*n*n},easeOutQuint:function(n){return 1+--n*n*n*n*n},easeInOutQuint:function(n){return n<.5?16*n*n*n*n*n:1+16*--n*n*n*n*n}},OR=ju.isNumeric=function(n){return!isNaN(parseFloat(n))&&isFinite(n)};ju.setPosition=function(n,s,i,a){var c=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"easeInOutCubic";return i>a?s:n+(s-n)*DR[c](i/a)};ju.calcEndPoint=function(n){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;if(OR(n))return parseInt(n)+i;var a=s===window||s===document.documentElement?window.pageYOffset:s.scrollTop-s.getBoundingClientRect().top,c=n.nodeName.toLowerCase()==="html"?-a:n.getBoundingClientRect().top+a;return c+i};(function(o,n){Object.defineProperty(n,"__esModule",{value:!0});var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},i=ju;n.default=function(a){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},h=c.duration,g=h===void 0?500:h,b=c.context,$=b===void 0?window:b,y=c.offset,w=y===void 0?0:y,C=c.ease,S=C===void 0?"easeInOutCubic":C,k=c.callback;if((typeof window>"u"?"undefined":s(window))==="object"){var E=$.scrollTop!==null&&$.scrollTop!==void 0?$.scrollTop:window.pageYOffset,R=(0,i.calcEndPoint)(a,$,w),F=performance.now(),M=window.requestAnimationFrame,L=function T(){var V=performance.now()-F,K=(0,i.setPosition)(E,R,V,g,S);$!==window?$.scrollTop=K:window.scroll(0,K),V>g?typeof k=="function"&&k(a):M(T)};L()}},o.exports=n.default})(ow,ow.exports);var bE=ow.exports,aw={exports:{}};(function(o,n){Object.defineProperty(n,"__esModule",{value:!0});var s=Object.assign||function(h){for(var g=1;g<arguments.length;g++){var b=arguments[g];for(var $ in b)Object.prototype.hasOwnProperty.call(b,$)&&(h[$]=b[$])}return h},i=bE,a=c(i);function c(h){return h&&h.__esModule?h:{default:h}}n.default=function(){var h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},g=h.query,b=g===void 0?'[href^="#"]:not([href="#"]':g,$=h.match,y=$===void 0?function(R){return document.getElementById(R.hash.substring(1))}:$,w=h.hashChange,C=w===void 0?!0:w,S=h.scrollSmoothConfig,k=document.querySelectorAll(b),E=function(F){F.preventDefault();var M=y(F.target);M&&(C&&history.replaceState(null,null,"#"+M.id),(0,a.default)(M,s({},S)))};Array.from(k).map(function(R){R.addEventListener("click",E,!1)})},o.exports=n.default})(aw,aw.exports);var RR=aw.exports,lw={exports:{}};(function(o,n){Object.defineProperty(n,"__esModule",{value:!0});function s(i){if(Array.isArray(i)){for(var a=0,c=Array(i.length);a<i.length;a++)c[a]=i[a];return c}else return Array.from(i)}n.default=function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},a=i.activeClass,c=a===void 0?"active":a,h=i.query,g=h===void 0?'[href^="#"]:not([href="#"]):not([href="#0"])':h,b=i.threshold,$=b===void 0?[.25,.5,.75]:b,y=i.detectType,w=y===void 0?"max":y,C={threshold:$},S=function(K){return K.classList.remove(c)},k=function(K){return K.classList.add(c)},E=function(){document.querySelectorAll("."+c).forEach(S)},R=function(K){E(),k(document.querySelector('a[href="#'+K.id+'"]'))},F=function(K){K.forEach(function(Y){Y.intersectionRatio>=Math[w].apply(Math,s($))&&R(Y.target)})},M=document.querySelectorAll(g),L=new IntersectionObserver(F,C),T=function(K){var Y=document.querySelector("#"+K.hash.slice(1));L.observe(Y)};M.forEach(T)},o.exports=n.default})(lw,lw.exports);var AR=lw.exports;(function(o,n){Object.defineProperty(n,"__esModule",{value:!0});var s=bE,i=$(s),a=ju,c=RR,h=$(c),g=AR,b=$(g);function $(y){return y&&y.__esModule?y:{default:y}}n.default={to:i.default,calcEndPoint:a.calcEndPoint,anchorScroll:h.default,observe:b.default},o.exports=n.default})(iw,iw.exports);var NR=iw.exports;const MR=aa(NR);var $E={exports:{}};(function(o){(function(n,s){o.exports?o.exports=s():n.Scrollparent=s()})(ei,function(){var n=/(auto|scroll)/,s=function(g,b){return g.parentNode===null?b:s(g.parentNode,b.concat([g]))},i=function(g,b){return getComputedStyle(g,null).getPropertyValue(b)},a=function(g){return i(g,"overflow")+i(g,"overflow-y")+i(g,"overflow-x")},c=function(g){return n.test(a(g))},h=function(g){if(g instanceof HTMLElement||g instanceof SVGElement){for(var b=s(g.parentNode,[]),$=0;$<b.length;$+=1)if(c(b[$]))return b[$];return document.scrollingElement||document.documentElement}};return h})})($E);var LR=$E.exports;const BR=aa(LR);var PR="Expected a function",tC=NaN,FR="[object Symbol]",jR=/^\s+|\s+$/g,zR=/^[-+]0x[0-9a-f]+$/i,UR=/^0b[01]+$/i,HR=/^0o[0-7]+$/i,WR=parseInt,VR=typeof ei=="object"&&ei&&ei.Object===Object&&ei,GR=typeof self=="object"&&self&&self.Object===Object&&self,qR=VR||GR||Function("return this")(),KR=Object.prototype,JR=KR.toString,YR=Math.max,XR=Math.min,a_=function(){return qR.Date.now()};function ZR(o,n,s){var i,a,c,h,g,b,$=0,y=!1,w=!1,C=!0;if(typeof o!="function")throw new TypeError(PR);n=nC(n)||0,cw(s)&&(y=!!s.leading,w="maxWait"in s,c=w?YR(nC(s.maxWait)||0,n):c,C="trailing"in s?!!s.trailing:C);function S(K){var Y=i,te=a;return i=a=void 0,$=K,h=o.apply(te,Y),h}function k(K){return $=K,g=setTimeout(F,n),y?S(K):h}function E(K){var Y=K-b,te=K-$,J=n-Y;return w?XR(J,c-te):J}function R(K){var Y=K-b,te=K-$;return b===void 0||Y>=n||Y<0||w&&te>=c}function F(){var K=a_();if(R(K))return M(K);g=setTimeout(F,E(K))}function M(K){return g=void 0,C&&i?S(K):(i=a=void 0,h)}function L(){g!==void 0&&clearTimeout(g),$=0,i=b=a=g=void 0}function T(){return g===void 0?h:M(a_())}function V(){var K=a_(),Y=R(K);if(i=arguments,a=this,b=K,Y){if(g===void 0)return k(b);if(w)return g=setTimeout(F,n),S(b)}return g===void 0&&(g=setTimeout(F,n)),h}return V.cancel=L,V.flush=T,V}function cw(o){var n=typeof o;return!!o&&(n=="object"||n=="function")}function QR(o){return!!o&&typeof o=="object"}function eA(o){return typeof o=="symbol"||QR(o)&&JR.call(o)==FR}function nC(o){if(typeof o=="number")return o;if(eA(o))return tC;if(cw(o)){var n=typeof o.valueOf=="function"?o.valueOf():o;o=cw(n)?n+"":n}if(typeof o!="string")return o===0?o:+o;o=o.replace(jR,"");var s=UR.test(o);return s||HR.test(o)?WR(o.slice(2),s?2:8):zR.test(o)?tC:+o}var tA=ZR;const nA=aa(tA);var uw="data-focus-lock",vE="data-focus-lock-disabled",sA="data-no-focus-lock",rA="data-autofocus-inside",iA="data-no-autofocus";function l_(o,n){return typeof o=="function"?o(n):o&&(o.current=n),o}function oA(o,n){var s=ve.useState(function(){return{value:o,callback:n,facade:{get current(){return s.value},set current(i){var a=s.value;a!==i&&(s.value=i,s.callback(i,a))}}}})[0];return s.callback=n,s.facade}var aA=typeof window<"u"?ve.useLayoutEffect:ve.useEffect,sC=new WeakMap;function lA(o,n){var s=oA(null,function(i){return o.forEach(function(a){return l_(a,i)})});return aA(function(){var i=sC.get(s);if(i){var a=new Set(i),c=new Set(o),h=s.current;a.forEach(function(g){c.has(g)||l_(g,null)}),c.forEach(function(g){a.has(g)||l_(g,h)})}sC.set(s,o)},[o]),s}var c_={width:"1px",height:"0px",padding:0,overflow:"hidden",position:"fixed",top:"1px",left:"1px"};function yE(o){return o}function _E(o,n){n===void 0&&(n=yE);var s=[],i=!1,a={read:function(){if(i)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return s.length?s[s.length-1]:o},useMedium:function(c){var h=n(c,i);return s.push(h),function(){s=s.filter(function(g){return g!==h})}},assignSyncMedium:function(c){for(i=!0;s.length;){var h=s;s=[],h.forEach(c)}s={push:function(g){return c(g)},filter:function(){return s}}},assignMedium:function(c){i=!0;var h=[];if(s.length){var g=s;s=[],g.forEach(c),h=s}var b=function(){var y=h;h=[],y.forEach(c)},$=function(){return Promise.resolve().then(b)};$(),s={push:function(y){h.push(y),$()},filter:function(y){return h=h.filter(y),s}}}};return a}function Zw(o,n){return n===void 0&&(n=yE),_E(o,n)}function cA(o){o===void 0&&(o={});var n=_E(null);return n.options=Px({async:!0,ssr:!1},o),n}var wE=Zw({},function(o){var n=o.target,s=o.currentTarget;return{target:n,currentTarget:s}}),SE=Zw(),uA=Zw(),dA=cA({async:!0,ssr:typeof document<"u"}),hA=ve.createContext(void 0),pA=[],Qw=ve.forwardRef(function(n,s){var i,a=ve.useState(),c=a[0],h=a[1],g=ve.useRef(),b=ve.useRef(!1),$=ve.useRef(null),y=ve.useState({}),w=y[1],C=n.children,S=n.disabled,k=S===void 0?!1:S,E=n.noFocusGuards,R=E===void 0?!1:E,F=n.persistentFocus,M=F===void 0?!1:F,L=n.crossFrame,T=L===void 0?!0:L,V=n.autoFocus,K=V===void 0?!0:V;n.allowTextSelection;var Y=n.group,te=n.className,J=n.whiteList,ne=n.hasPositiveIndices,Q=n.shards,he=Q===void 0?pA:Q,q=n.as,re=q===void 0?"div":q,De=n.lockProps,ee=De===void 0?{}:De,Fe=n.sideCar,Ce=n.returnFocus,Ze=Ce===void 0?!1:Ce,pe=n.focusOptions,Te=n.onActivation,ke=n.onDeactivation,Xe=ve.useState({}),Ke=Xe[0],at=ve.useCallback(function(Ot){var Lt=Ot.captureFocusRestore;if(!$.current){var vn,Ln=(vn=document)==null?void 0:vn.activeElement;$.current=Ln,Ln!==document.body&&($.current=Lt(Ln))}g.current&&Te&&Te(g.current),b.current=!0,w()},[Te]),Ue=ve.useCallback(function(){b.current=!1,ke&&ke(g.current),w()},[ke]),ut=ve.useCallback(function(Ot){var Lt=$.current;if(Lt){var vn=(typeof Lt=="function"?Lt():Lt)||document.body,Ln=typeof Ze=="function"?Ze(vn):Ze;if(Ln){var He=typeof Ln=="object"?Ln:void 0;$.current=null,Ot?Promise.resolve().then(function(){return vn.focus(He)}):vn.focus(He)}}},[Ze]),rt=ve.useCallback(function(Ot){b.current&&wE.useMedium(Ot)},[]),tt=SE.useMedium,It=ve.useCallback(function(Ot){g.current!==Ot&&(g.current=Ot,h(Ot))},[]),Yt=q_((i={},i[vE]=k&&"disabled",i[uw]=Y,i),ee),Ut=R!==!0,Fn=Ut&&R!=="tail",Xt=lA([s,It]),en=ve.useMemo(function(){return{observed:g,shards:he,enabled:!k,active:b.current}},[k,b.current,he,c]);return Le.createElement(ve.Fragment,null,Ut&&[Le.createElement("div",{key:"guard-first","data-focus-guard":!0,tabIndex:k?-1:0,style:c_}),ne?Le.createElement("div",{key:"guard-nearest","data-focus-guard":!0,tabIndex:k?-1:1,style:c_}):null],!k&&Le.createElement(Fe,{id:Ke,sideCar:dA,observed:c,disabled:k,persistentFocus:M,crossFrame:T,autoFocus:K,whiteList:J,shards:he,onActivation:at,onDeactivation:Ue,returnFocus:ut,focusOptions:pe,noFocusGuards:R}),Le.createElement(re,q_({ref:Xt},Yt,{className:te,onBlur:tt,onFocus:rt}),Le.createElement(hA.Provider,{value:en},C)),Fn&&Le.createElement("div",{"data-focus-guard":!0,tabIndex:k?-1:0,style:c_}))});Qw.propTypes={};function gA(o,n){function s(i){return i.displayName||i.name||"Component"}return function(a){var c=[],h;function g(){h=o(c.map(function($){return $.props})),n(h)}var b=function($){Ax(y,$);function y(){return $.apply(this,arguments)||this}y.peek=function(){return h};var w=y.prototype;return w.componentDidMount=function(){c.push(this),g()},w.componentDidUpdate=function(){g()},w.componentWillUnmount=function(){var S=c.indexOf(this);c.splice(S,1),g()},w.render=function(){return Le.createElement(a,this.props)},y}(ve.PureComponent);return U1(b,"displayName","SideEffect("+s(a)+")"),b}}var ca=function(o){for(var n=Array(o.length),s=0;s<o.length;++s)n[s]=o[s];return n},Bu=function(o){return Array.isArray(o)?o:[o]},CE=function(o){return Array.isArray(o)?o[0]:o},fA=function(o){if(o.nodeType!==Node.ELEMENT_NODE)return!1;var n=window.getComputedStyle(o,null);return!n||!n.getPropertyValue?!1:n.getPropertyValue("display")==="none"||n.getPropertyValue("visibility")==="hidden"},TE=function(o){return o.parentNode&&o.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o.parentNode.host:o.parentNode},EE=function(o){return o===document||o&&o.nodeType===Node.DOCUMENT_NODE},mA=function(o){return o.hasAttribute("inert")},bA=function(o,n){return!o||EE(o)||!fA(o)&&!mA(o)&&n(TE(o))},kE=function(o,n){var s=o.get(n);if(s!==void 0)return s;var i=bA(n,kE.bind(void 0,o));return o.set(n,i),i},$A=function(o,n){return o&&!EE(o)?_A(o)?n(TE(o)):!1:!0},IE=function(o,n){var s=o.get(n);if(s!==void 0)return s;var i=$A(n,IE.bind(void 0,o));return o.set(n,i),i},xE=function(o){return o.dataset},vA=function(o){return o.tagName==="BUTTON"},DE=function(o){return o.tagName==="INPUT"},OE=function(o){return DE(o)&&o.type==="radio"},yA=function(o){return!((DE(o)||vA(o))&&(o.type==="hidden"||o.disabled))},_A=function(o){var n=o.getAttribute(iA);return![!0,"true",""].includes(n)},eS=function(o){var n;return!!(o&&(!((n=xE(o))===null||n===void 0)&&n.focusGuard))},dw=function(o){return!eS(o)},wA=function(o){return!!o},SA=function(o,n){var s=Math.max(0,o.tabIndex),i=Math.max(0,n.tabIndex),a=s-i,c=o.index-n.index;if(a){if(!s)return 1;if(!i)return-1}return a||c},CA=function(o){return o.tabIndex<0&&!o.hasAttribute("tabindex")?0:o.tabIndex},tS=function(o,n,s){return ca(o).map(function(i,a){var c=CA(i);return{node:i,index:a,tabIndex:s&&c===-1?(i.dataset||{}).focusGuard?0:-1:c}}).filter(function(i){return!n||i.tabIndex>=0}).sort(SA)},TA=["button:enabled","select:enabled","textarea:enabled","input:enabled","a[href]","area[href]","summary","iframe","object","embed","audio[controls]","video[controls]","[tabindex]","[contenteditable]","[autofocus]"],nS=TA.join(","),EA="".concat(nS,", [data-focus-guard]"),RE=function(o,n){return ca((o.shadowRoot||o).children).reduce(function(s,i){return s.concat(i.matches(n?EA:nS)?[i]:[],RE(i))},[])},kA=function(o,n){var s;return o instanceof HTMLIFrameElement&&(!((s=o.contentDocument)===null||s===void 0)&&s.body)?tp([o.contentDocument.body],n):[o]},tp=function(o,n){return o.reduce(function(s,i){var a,c=RE(i,n),h=(a=[]).concat.apply(a,c.map(function(g){return kA(g,n)}));return s.concat(h,i.parentNode?ca(i.parentNode.querySelectorAll(nS)).filter(function(g){return g===i}):[])},[])},IA=function(o){var n=o.querySelectorAll("[".concat(rA,"]"));return ca(n).map(function(s){return tp([s])}).reduce(function(s,i){return s.concat(i)},[])},sS=function(o,n){return ca(o).filter(function(s){return kE(n,s)}).filter(function(s){return yA(s)})},rC=function(o,n){return n===void 0&&(n=new Map),ca(o).filter(function(s){return IE(n,s)})},rS=function(o,n,s){return tS(sS(tp(o,s),n),!0,s)},am=function(o,n){return tS(sS(tp(o),n),!1)},xA=function(o,n){return sS(IA(o),n)},Au=function(o,n){return o.shadowRoot?Au(o.shadowRoot,n):Object.getPrototypeOf(o).contains!==void 0&&Object.getPrototypeOf(o).contains.call(o,n)?!0:ca(o.children).some(function(s){var i;if(s instanceof HTMLIFrameElement){var a=(i=s.contentDocument)===null||i===void 0?void 0:i.body;return a?Au(a,n):!1}return Au(s,n)})},DA=function(o){for(var n=new Set,s=o.length,i=0;i<s;i+=1)for(var a=i+1;a<s;a+=1){var c=o[i].compareDocumentPosition(o[a]);(c&Node.DOCUMENT_POSITION_CONTAINED_BY)>0&&n.add(a),(c&Node.DOCUMENT_POSITION_CONTAINS)>0&&n.add(i)}return o.filter(function(h,g){return!n.has(g)})},AE=function(o){return o.parentNode?AE(o.parentNode):o},iS=function(o){var n=Bu(o);return n.filter(Boolean).reduce(function(s,i){var a=i.getAttribute(uw);return s.push.apply(s,a?DA(ca(AE(i).querySelectorAll("[".concat(uw,'="').concat(a,'"]:not([').concat(vE,'="disabled"])')))):[i]),s},[])},OA=function(o){try{return o()}catch{return}},lm=function(o){if(o===void 0&&(o=document),!(!o||!o.activeElement)){var n=o.activeElement;return n.shadowRoot?lm(n.shadowRoot):n instanceof HTMLIFrameElement&&OA(function(){return n.contentWindow.document})?lm(n.contentWindow.document):n}},RA=function(o,n){return o===n},AA=function(o,n){return!!ca(o.querySelectorAll("iframe")).some(function(s){return RA(s,n)})},NE=function(o,n){return n===void 0&&(n=lm(CE(o).ownerDocument)),!n||n.dataset&&n.dataset.focusGuard?!1:iS(o).some(function(s){return Au(s,n)||AA(s,n)})},NA=function(o){o===void 0&&(o=document);var n=lm(o);return n?ca(o.querySelectorAll("[".concat(sA,"]"))).some(function(s){return Au(s,n)}):!1},MA=function(o,n){return n.filter(OE).filter(function(s){return s.name===o.name}).filter(function(s){return s.checked})[0]||o},oS=function(o,n){return OE(o)&&o.name?MA(o,n):o},LA=function(o){var n=new Set;return o.forEach(function(s){return n.add(oS(s,o))}),o.filter(function(s){return n.has(s)})},iC=function(o){return o[0]&&o.length>1?oS(o[0],o):o[0]},oC=function(o,n){return o.indexOf(oS(n,o))},hw="NEW_FOCUS",BA=function(o,n,s,i,a){var c=o.length,h=o[0],g=o[c-1],b=eS(i);if(!(i&&o.indexOf(i)>=0)){var $=i!==void 0?s.indexOf(i):-1,y=a?s.indexOf(a):$,w=a?o.indexOf(a):-1;if($===-1)return w!==-1?w:hw;if(w===-1)return hw;var C=$-y,S=s.indexOf(h),k=s.indexOf(g),E=LA(s),R=i!==void 0?E.indexOf(i):-1,F=R-(a?E.indexOf(a):$);if(!C&&w>=0||n.length===0)return w;var M=oC(o,n[0]),L=oC(o,n[n.length-1]);if($<=S&&b&&Math.abs(C)>1)return L;if($>=k&&b&&Math.abs(C)>1)return M;if(C&&Math.abs(F)>1)return w;if($<=S)return L;if($>k)return M;if(C)return Math.abs(C)>1?w:(c+w+C)%c}},PA=function(o){return function(n){var s,i=(s=xE(n))===null||s===void 0?void 0:s.autofocus;return n.autofocus||i!==void 0&&i!=="false"||o.indexOf(n)>=0}},aC=function(o,n,s){var i=o.map(function(c){var h=c.node;return h}),a=rC(i.filter(PA(s)));return a&&a.length?iC(a):iC(rC(n))},pw=function(o,n){return n===void 0&&(n=[]),n.push(o),o.parentNode&&pw(o.parentNode.host||o.parentNode,n),n},u_=function(o,n){for(var s=pw(o),i=pw(n),a=0;a<s.length;a+=1){var c=s[a];if(i.indexOf(c)>=0)return c}return!1},ME=function(o,n,s){var i=Bu(o),a=Bu(n),c=i[0],h=!1;return a.filter(Boolean).forEach(function(g){h=u_(h||g,g)||h,s.filter(Boolean).forEach(function(b){var $=u_(c,b);$&&(!h||Au($,h)?h=$:h=u_($,h))})}),h},lC=function(o,n){return o.reduce(function(s,i){return s.concat(xA(i,n))},[])},FA=function(o,n){var s=new Map;return n.forEach(function(i){return s.set(i.node,i)}),o.map(function(i){return s.get(i)}).filter(wA)},jA=function(o,n){var s=lm(Bu(o).length>0?document:CE(o).ownerDocument),i=iS(o).filter(dw),a=ME(s||o,o,i),c=new Map,h=am(i,c),g=h.filter(function(k){var E=k.node;return dw(E)});if(g[0]){var b=am([a],c).map(function(k){var E=k.node;return E}),$=FA(b,g),y=$.map(function(k){var E=k.node;return E}),w=$.filter(function(k){var E=k.tabIndex;return E>=0}).map(function(k){var E=k.node;return E}),C=BA(y,w,b,s,n);if(C===hw){var S=aC(h,w,lC(i,c))||aC(h,y,lC(i,c));if(S)return{node:S};console.warn("focus-lock: cannot find any node to move focus into");return}return C===void 0?C:$[C]}},zA=function(o){var n=iS(o).filter(dw),s=ME(o,o,n),i=tS(tp([s],!0),!0,!0),a=tp(n,!1);return i.map(function(c){var h=c.node,g=c.index;return{node:h,index:g,lockItem:a.indexOf(h)>=0,guard:eS(h)}})},aS=function(o,n){o&&("focus"in o&&o.focus(n),"contentWindow"in o&&o.contentWindow&&o.contentWindow.focus())},d_=0,h_=!1,LE=function(o,n,s){s===void 0&&(s={});var i=jA(o,n);if(!h_&&i){if(d_>2){console.error("FocusLock: focus-fighting detected. Only one focus management system could be active. See https://github.com/theKashey/focus-lock/#focus-fighting"),h_=!0,setTimeout(function(){h_=!1},1);return}d_++,aS(i.node,s.focusOptions),d_--}};function Ff(o){if(!o)return null;if(typeof WeakRef>"u")return function(){return o||null};var n=o?new WeakRef(o):null;return function(){return(n==null?void 0:n.deref())||null}}var UA=function(o){if(!o)return null;for(var n=[],s=o;s&&s!==document.body;)n.push({current:Ff(s),parent:Ff(s.parentElement),left:Ff(s.previousElementSibling),right:Ff(s.nextElementSibling)}),s=s.parentElement;return{element:Ff(o),stack:n,ownerDocument:o.ownerDocument}},HA=function(o){var n,s,i,a,c;if(o)for(var h=o.stack,g=o.ownerDocument,b=new Map,$=0,y=h;$<y.length;$++){var w=y[$],C=(n=w.parent)===null||n===void 0?void 0:n.call(w);if(C&&g.contains(C)){for(var S=(s=w.left)===null||s===void 0?void 0:s.call(w),k=w.current(),E=C.contains(k)?k:void 0,R=(i=w.right)===null||i===void 0?void 0:i.call(w),F=rS([C],b),M=(c=(a=E??(S==null?void 0:S.nextElementSibling))!==null&&a!==void 0?a:R)!==null&&c!==void 0?c:S;M;){for(var L=0,T=F;L<T.length;L++){var V=T[L];if(M!=null&&M.contains(V.node))return V.node}M=M.nextElementSibling}if(F.length)return F[0].node}}},BE=function(o){var n=UA(o);return function(){return HA(n)}},WA=function(o,n,s){if(!o||!n)return console.error("no element or scope given"),{};var i=Bu(n);if(i.every(function(h){return!Au(h,o)}))return console.error("Active element is not contained in the scope"),{};var a=s?rS(i,new Map):am(i,new Map),c=a.findIndex(function(h){var g=h.node;return g===o});if(c!==-1)return{prev:a[c-1],next:a[c+1],first:a[0],last:a[a.length-1]}},VA=function(o,n){var s=n?rS(Bu(o),new Map):am(Bu(o),new Map);return{first:s[0],last:s[s.length-1]}},GA=function(o){return Object.assign({scope:document.body,cycle:!0,onlyTabbable:!0},o)},PE=function(o,n,s){n===void 0&&(n={});var i=GA(n),a=WA(o,i.scope,i.onlyTabbable);if(a){var c=s(a,i.cycle);c&&aS(c.node,i.focusOptions)}},qA=function(o,n){n===void 0&&(n={}),PE(o,n,function(s,i){var a=s.next,c=s.first;return a||i&&c})},KA=function(o,n){n===void 0&&(n={}),PE(o,n,function(s,i){var a=s.prev,c=s.last;return a||i&&c})},FE=function(o,n,s){var i,a=VA(o,(i=n.onlyTabbable)!==null&&i!==void 0?i:!0),c=a[s];c&&aS(c.node,n.focusOptions)},JA=function(o,n){n===void 0&&(n={}),FE(o,n,"first")},YA=function(o,n){n===void 0&&(n={}),FE(o,n,"last")};function lS(o){setTimeout(o,1)}var XA=function(n){return n&&"current"in n?n.current:n},jE=function(){return document&&document.activeElement===document.body},ZA=function(){return jE()||NA()},qh=null,Zr=null,cC=function(){return null},Kh=null,cm=!1,cS=!1,QA=function(){return!0},eN=function(n){return(qh.whiteList||QA)(n)},tN=function(n,s){Kh={observerNode:n,portaledElement:s}},nN=function(n){return Kh&&Kh.portaledElement===n};function uC(o,n,s,i){var a=null,c=o;do{var h=i[c];if(h.guard)h.node.dataset.focusAutoGuard&&(a=h);else if(h.lockItem){if(c!==o)return;a=null}else break}while((c+=s)!==n);a&&(a.node.tabIndex=0)}var sN=function(n){return n?!!cm:cm==="meanwhile"},rN=function o(n,s,i){return s&&(s.host===n&&(!s.activeElement||i.contains(s.activeElement))||s.parentNode&&o(n,s.parentNode,i))},iN=function(n,s){return s.some(function(i){return rN(n,i,i)})},zE=function(n){return am(n,new Map)},oN=function(n){return!zE([n.parentNode]).some(function(s){return s.node===n})},Dv=function(){var n=!1;if(qh){var s=qh,i=s.observed,a=s.persistentFocus,c=s.autoFocus,h=s.shards,g=s.crossFrame,b=s.focusOptions,$=s.noFocusGuards,y=i||Kh&&Kh.portaledElement;if(jE()&&Zr&&Zr!==document.body&&(!document.body.contains(Zr)||oN(Zr))){var w=cC();w&&w.focus()}var C=document&&document.activeElement;if(y){var S=[y].concat(h.map(XA).filter(Boolean)),k=function(){if(!sN(g)||!$||!Zr||cS)return!1;var L=zE(S),T=L.findIndex(function(V){var K=V.node;return K===Zr});return T===0||T===L.length-1};if((!C||eN(C))&&(a||k()||!ZA()||!Zr&&c)&&(y&&!(NE(S)||C&&iN(C,S)||nN(C))&&(document&&!Zr&&C&&!c?(C.blur&&C.blur(),document.body.focus()):(n=LE(S,Zr,{focusOptions:b}),Kh={})),Zr=document&&document.activeElement,Zr!==document.body&&(cC=BE(Zr)),cm=!1),document&&C!==document.activeElement&&document.querySelector("[data-focus-auto-guard]")){var E=document&&document.activeElement,R=zA(S),F=R.map(function(M){var L=M.node;return L}).indexOf(E);F>-1&&(R.filter(function(M){var L=M.guard,T=M.node;return L&&T.dataset.focusAutoGuard}).forEach(function(M){var L=M.node;return L.removeAttribute("tabIndex")}),uC(F,R.length,1,R),uC(F,-1,-1,R))}}}return n},UE=function(n){Dv()&&n&&(n.stopPropagation(),n.preventDefault())},uS=function(){return lS(Dv)},aN=function(n){var s=n.target,i=n.currentTarget;i.contains(s)||tN(i,s)},lN=function(){return null},HE=function(){cS=!0},WE=function(){cS=!1,cm="just",lS(function(){cm="meanwhile"})},cN=function(){document.addEventListener("focusin",UE),document.addEventListener("focusout",uS),window.addEventListener("focus",HE),window.addEventListener("blur",WE)},uN=function(){document.removeEventListener("focusin",UE),document.removeEventListener("focusout",uS),window.removeEventListener("focus",HE),window.removeEventListener("blur",WE)};function dN(o){return o.filter(function(n){var s=n.disabled;return!s})}var VE={moveFocusInside:LE,focusInside:NE,focusNextElement:qA,focusPrevElement:KA,focusFirstElement:JA,focusLastElement:YA,captureFocusRestore:BE};function hN(o){var n=o.slice(-1)[0];n&&!qh&&cN();var s=qh,i=s&&n&&n.id===s.id;qh=n,s&&!i&&(s.onDeactivation(),o.filter(function(a){var c=a.id;return c===s.id}).length||s.returnFocus(!n)),n?(Zr=null,(!i||s.observed!==n.observed)&&n.onActivation(VE),Dv(),lS(Dv)):(uN(),Zr=null)}wE.assignSyncMedium(aN);SE.assignMedium(uS);uA.assignMedium(function(o){return o(VE)});const pN=gA(dN,hN)(lN);var GE=ve.forwardRef(function(n,s){return Le.createElement(Qw,q_({sideCar:pN,ref:s},n))}),qE=Qw.propTypes||{};qE.sideCar;Nx(qE,["sideCar"]);GE.propTypes={};var $r=function(){return $r=Object.assign||function(n){for(var s,i=1,a=arguments.length;i<a;i++){s=arguments[i];for(var c in s)Object.prototype.hasOwnProperty.call(s,c)&&(n[c]=s[c])}return n},$r.apply(this,arguments)};function um(o,n,s){if(s||arguments.length===2)for(var i=0,a=n.length,c;i<a;i++)(c||!(i in n))&&(c||(c=Array.prototype.slice.call(n,0,i)),c[i]=n[i]);return o.concat(c||Array.prototype.slice.call(n))}var Hn="-ms-",Qf="-moz-",$n="-webkit-",KE="comm",my="rule",dS="decl",gN="@import",JE="@keyframes",fN="@layer",YE=Math.abs,hS=String.fromCharCode,gw=Object.assign;function mN(o,n){return Ps(o,0)^45?(((n<<2^Ps(o,0))<<2^Ps(o,1))<<2^Ps(o,2))<<2^Ps(o,3):0}function XE(o){return o.trim()}function il(o,n){return(o=n.exec(o))?o[0]:o}function Wt(o,n,s){return o.replace(n,s)}function dv(o,n,s){return o.indexOf(n,s)}function Ps(o,n){return o.charCodeAt(n)|0}function np(o,n,s){return o.slice(n,s)}function ia(o){return o.length}function ZE(o){return o.length}function Wf(o,n){return n.push(o),o}function bN(o,n){return o.map(n).join("")}function dC(o,n){return o.filter(function(s){return!il(s,n)})}var by=1,sp=1,QE=0,Pi=0,$s=0,cp="";function $y(o,n,s,i,a,c,h,g){return{value:o,root:n,parent:s,type:i,props:a,children:c,line:by,column:sp,length:h,return:"",siblings:g}}function cc(o,n){return gw($y("",null,null,"",null,null,0,o.siblings),o,{length:-o.length},n)}function Oh(o){for(;o.root;)o=cc(o.root,{children:[o]});Wf(o,o.siblings)}function $N(){return $s}function vN(){return $s=Pi>0?Ps(cp,--Pi):0,sp--,$s===10&&(sp=1,by--),$s}function yo(){return $s=Pi<QE?Ps(cp,Pi++):0,sp++,$s===10&&(sp=1,by++),$s}function Nu(){return Ps(cp,Pi)}function hv(){return Pi}function vy(o,n){return np(cp,o,n)}function fw(o){switch(o){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function yN(o){return by=sp=1,QE=ia(cp=o),Pi=0,[]}function _N(o){return cp="",o}function p_(o){return XE(vy(Pi-1,mw(o===91?o+2:o===40?o+1:o)))}function wN(o){for(;($s=Nu())&&$s<33;)yo();return fw(o)>2||fw($s)>3?"":" "}function SN(o,n){for(;--n&&yo()&&!($s<48||$s>102||$s>57&&$s<65||$s>70&&$s<97););return vy(o,hv()+(n<6&&Nu()==32&&yo()==32))}function mw(o){for(;yo();)switch($s){case o:return Pi;case 34:case 39:o!==34&&o!==39&&mw($s);break;case 40:o===41&&mw(o);break;case 92:yo();break}return Pi}function CN(o,n){for(;yo()&&o+$s!==57;)if(o+$s===84&&Nu()===47)break;return"/*"+vy(n,Pi-1)+"*"+hS(o===47?o:yo())}function TN(o){for(;!fw(Nu());)yo();return vy(o,Pi)}function EN(o){return _N(pv("",null,null,null,[""],o=yN(o),0,[0],o))}function pv(o,n,s,i,a,c,h,g,b){for(var $=0,y=0,w=h,C=0,S=0,k=0,E=1,R=1,F=1,M=0,L="",T=a,V=c,K=i,Y=L;R;)switch(k=M,M=yo()){case 40:if(k!=108&&Ps(Y,w-1)==58){dv(Y+=Wt(p_(M),"&","&\f"),"&\f",YE($?g[$-1]:0))!=-1&&(F=-1);break}case 34:case 39:case 91:Y+=p_(M);break;case 9:case 10:case 13:case 32:Y+=wN(k);break;case 92:Y+=SN(hv()-1,7);continue;case 47:switch(Nu()){case 42:case 47:Wf(kN(CN(yo(),hv()),n,s,b),b);break;default:Y+="/"}break;case 123*E:g[$++]=ia(Y)*F;case 125*E:case 59:case 0:switch(M){case 0:case 125:R=0;case 59+y:F==-1&&(Y=Wt(Y,/\f/g,"")),S>0&&ia(Y)-w&&Wf(S>32?pC(Y+";",i,s,w-1,b):pC(Wt(Y," ","")+";",i,s,w-2,b),b);break;case 59:Y+=";";default:if(Wf(K=hC(Y,n,s,$,y,a,g,L,T=[],V=[],w,c),c),M===123)if(y===0)pv(Y,n,K,K,T,c,w,g,V);else switch(C===99&&Ps(Y,3)===110?100:C){case 100:case 108:case 109:case 115:pv(o,K,K,i&&Wf(hC(o,K,K,0,0,a,g,L,a,T=[],w,V),V),a,V,w,g,i?T:V);break;default:pv(Y,K,K,K,[""],V,0,g,V)}}$=y=S=0,E=F=1,L=Y="",w=h;break;case 58:w=1+ia(Y),S=k;default:if(E<1){if(M==123)--E;else if(M==125&&E++==0&&vN()==125)continue}switch(Y+=hS(M),M*E){case 38:F=y>0?1:(Y+="\f",-1);break;case 44:g[$++]=(ia(Y)-1)*F,F=1;break;case 64:Nu()===45&&(Y+=p_(yo())),C=Nu(),y=w=ia(L=Y+=TN(hv())),M++;break;case 45:k===45&&ia(Y)==2&&(E=0)}}return c}function hC(o,n,s,i,a,c,h,g,b,$,y,w){for(var C=a-1,S=a===0?c:[""],k=ZE(S),E=0,R=0,F=0;E<i;++E)for(var M=0,L=np(o,C+1,C=YE(R=h[E])),T=o;M<k;++M)(T=XE(R>0?S[M]+" "+L:Wt(L,/&\f/g,S[M])))&&(b[F++]=T);return $y(o,n,s,a===0?my:g,b,$,y,w)}function kN(o,n,s,i){return $y(o,n,s,KE,hS($N()),np(o,2,-2),0,i)}function pC(o,n,s,i,a){return $y(o,n,s,dS,np(o,0,i),np(o,i+1,-1),i,a)}function ek(o,n,s){switch(mN(o,n)){case 5103:return $n+"print-"+o+o;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return $n+o+o;case 4789:return Qf+o+o;case 5349:case 4246:case 4810:case 6968:case 2756:return $n+o+Qf+o+Hn+o+o;case 5936:switch(Ps(o,n+11)){case 114:return $n+o+Hn+Wt(o,/[svh]\w+-[tblr]{2}/,"tb")+o;case 108:return $n+o+Hn+Wt(o,/[svh]\w+-[tblr]{2}/,"tb-rl")+o;case 45:return $n+o+Hn+Wt(o,/[svh]\w+-[tblr]{2}/,"lr")+o}case 6828:case 4268:case 2903:return $n+o+Hn+o+o;case 6165:return $n+o+Hn+"flex-"+o+o;case 5187:return $n+o+Wt(o,/(\w+).+(:[^]+)/,$n+"box-$1$2"+Hn+"flex-$1$2")+o;case 5443:return $n+o+Hn+"flex-item-"+Wt(o,/flex-|-self/g,"")+(il(o,/flex-|baseline/)?"":Hn+"grid-row-"+Wt(o,/flex-|-self/g,""))+o;case 4675:return $n+o+Hn+"flex-line-pack"+Wt(o,/align-content|flex-|-self/g,"")+o;case 5548:return $n+o+Hn+Wt(o,"shrink","negative")+o;case 5292:return $n+o+Hn+Wt(o,"basis","preferred-size")+o;case 6060:return $n+"box-"+Wt(o,"-grow","")+$n+o+Hn+Wt(o,"grow","positive")+o;case 4554:return $n+Wt(o,/([^-])(transform)/g,"$1"+$n+"$2")+o;case 6187:return Wt(Wt(Wt(o,/(zoom-|grab)/,$n+"$1"),/(image-set)/,$n+"$1"),o,"")+o;case 5495:case 3959:return Wt(o,/(image-set\([^]*)/,$n+"$1$`$1");case 4968:return Wt(Wt(o,/(.+:)(flex-)?(.*)/,$n+"box-pack:$3"+Hn+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+$n+o+o;case 4200:if(!il(o,/flex-|baseline/))return Hn+"grid-column-align"+np(o,n)+o;break;case 2592:case 3360:return Hn+Wt(o,"template-","")+o;case 4384:case 3616:return s&&s.some(function(i,a){return n=a,il(i.props,/grid-\w+-end/)})?~dv(o+(s=s[n].value),"span",0)?o:Hn+Wt(o,"-start","")+o+Hn+"grid-row-span:"+(~dv(s,"span",0)?il(s,/\d+/):+il(s,/\d+/)-+il(o,/\d+/))+";":Hn+Wt(o,"-start","")+o;case 4896:case 4128:return s&&s.some(function(i){return il(i.props,/grid-\w+-start/)})?o:Hn+Wt(Wt(o,"-end","-span"),"span ","")+o;case 4095:case 3583:case 4068:case 2532:return Wt(o,/(.+)-inline(.+)/,$n+"$1$2")+o;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(ia(o)-1-n>6)switch(Ps(o,n+1)){case 109:if(Ps(o,n+4)!==45)break;case 102:return Wt(o,/(.+:)(.+)-([^]+)/,"$1"+$n+"$2-$3$1"+Qf+(Ps(o,n+3)==108?"$3":"$2-$3"))+o;case 115:return~dv(o,"stretch",0)?ek(Wt(o,"stretch","fill-available"),n,s)+o:o}break;case 5152:case 5920:return Wt(o,/(.+?):(\d+)(\s*\/\s*(span)?\s*(\d+))?(.*)/,function(i,a,c,h,g,b,$){return Hn+a+":"+c+$+(h?Hn+a+"-span:"+(g?b:+b-+c)+$:"")+o});case 4949:if(Ps(o,n+6)===121)return Wt(o,":",":"+$n)+o;break;case 6444:switch(Ps(o,Ps(o,14)===45?18:11)){case 120:return Wt(o,/(.+:)([^;\s!]+)(;|(\s+)?!.+)?/,"$1"+$n+(Ps(o,14)===45?"inline-":"")+"box$3$1"+$n+"$2$3$1"+Hn+"$2box$3")+o;case 100:return Wt(o,":",":"+Hn)+o}break;case 5719:case 2647:case 2135:case 3927:case 2391:return Wt(o,"scroll-","scroll-snap-")+o}return o}function Ov(o,n){for(var s="",i=0;i<o.length;i++)s+=n(o[i],i,o,n)||"";return s}function IN(o,n,s,i){switch(o.type){case fN:if(o.children.length)break;case gN:case dS:return o.return=o.return||o.value;case KE:return"";case JE:return o.return=o.value+"{"+Ov(o.children,i)+"}";case my:if(!ia(o.value=o.props.join(",")))return""}return ia(s=Ov(o.children,i))?o.return=o.value+"{"+s+"}":""}function xN(o){var n=ZE(o);return function(s,i,a,c){for(var h="",g=0;g<n;g++)h+=o[g](s,i,a,c)||"";return h}}function DN(o){return function(n){n.root||(n=n.return)&&o(n)}}function ON(o,n,s,i){if(o.length>-1&&!o.return)switch(o.type){case dS:o.return=ek(o.value,o.length,s);return;case JE:return Ov([cc(o,{value:Wt(o.value,"@","@"+$n)})],i);case my:if(o.length)return bN(s=o.props,function(a){switch(il(a,i=/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":Oh(cc(o,{props:[Wt(a,/:(read-\w+)/,":"+Qf+"$1")]})),Oh(cc(o,{props:[a]})),gw(o,{props:dC(s,i)});break;case"::placeholder":Oh(cc(o,{props:[Wt(a,/:(plac\w+)/,":"+$n+"input-$1")]})),Oh(cc(o,{props:[Wt(a,/:(plac\w+)/,":"+Qf+"$1")]})),Oh(cc(o,{props:[Wt(a,/:(plac\w+)/,Hn+"input-$1")]})),Oh(cc(o,{props:[a]})),gw(o,{props:dC(s,i)});break}return""})}}var RN={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},gi={},rp=typeof process<"u"&&gi!==void 0&&(gi.REACT_APP_SC_ATTR||gi.SC_ATTR)||"data-styled",tk="active",nk="data-styled-version",yy="6.1.13",pS=`/*!sc*/
`,Rv=typeof window<"u"&&"HTMLElement"in window,AN=!!(typeof SC_DISABLE_SPEEDY=="boolean"?SC_DISABLE_SPEEDY:typeof process<"u"&&gi!==void 0&&gi.REACT_APP_SC_DISABLE_SPEEDY!==void 0&&gi.REACT_APP_SC_DISABLE_SPEEDY!==""?gi.REACT_APP_SC_DISABLE_SPEEDY!=="false"&&gi.REACT_APP_SC_DISABLE_SPEEDY:typeof process<"u"&&gi!==void 0&&gi.SC_DISABLE_SPEEDY!==void 0&&gi.SC_DISABLE_SPEEDY!==""&&gi.SC_DISABLE_SPEEDY!=="false"&&gi.SC_DISABLE_SPEEDY),NN={},_y=Object.freeze([]),ip=Object.freeze({});function sk(o,n,s){return s===void 0&&(s=ip),o.theme!==s.theme&&o.theme||n||s.theme}var rk=new Set(["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","track","u","ul","use","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"]),MN=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,LN=/(^-|-$)/g;function gC(o){return o.replace(MN,"-").replace(LN,"")}var BN=/(a)(d)/gi,J$=52,fC=function(o){return String.fromCharCode(o+(o>25?39:97))};function bw(o){var n,s="";for(n=Math.abs(o);n>J$;n=n/J$|0)s=fC(n%J$)+s;return(fC(n%J$)+s).replace(BN,"$1-$2")}var g_,ik=5381,Wh=function(o,n){for(var s=n.length;s;)o=33*o^n.charCodeAt(--s);return o},ok=function(o){return Wh(ik,o)};function ak(o){return bw(ok(o)>>>0)}function PN(o){return o.displayName||o.name||"Component"}function f_(o){return typeof o=="string"&&!0}var lk=typeof Symbol=="function"&&Symbol.for,ck=lk?Symbol.for("react.memo"):60115,FN=lk?Symbol.for("react.forward_ref"):60112,jN={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},zN={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},uk={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},UN=((g_={})[FN]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},g_[ck]=uk,g_);function mC(o){return("type"in(n=o)&&n.type.$$typeof)===ck?uk:"$$typeof"in o?UN[o.$$typeof]:jN;var n}var HN=Object.defineProperty,WN=Object.getOwnPropertyNames,bC=Object.getOwnPropertySymbols,VN=Object.getOwnPropertyDescriptor,GN=Object.getPrototypeOf,$C=Object.prototype;function dk(o,n,s){if(typeof n!="string"){if($C){var i=GN(n);i&&i!==$C&&dk(o,i,s)}var a=WN(n);bC&&(a=a.concat(bC(n)));for(var c=mC(o),h=mC(n),g=0;g<a.length;++g){var b=a[g];if(!(b in zN||s&&s[b]||h&&b in h||c&&b in c)){var $=VN(n,b);try{HN(o,b,$)}catch{}}}}return o}function op(o){return typeof o=="function"}function gS(o){return typeof o=="object"&&"styledComponentId"in o}function Ou(o,n){return o&&n?"".concat(o," ").concat(n):o||n||""}function $w(o,n){if(o.length===0)return"";for(var s=o[0],i=1;i<o.length;i++)s+=o[i];return s}function dm(o){return o!==null&&typeof o=="object"&&o.constructor.name===Object.name&&!("props"in o&&o.$$typeof)}function vw(o,n,s){if(s===void 0&&(s=!1),!s&&!dm(o)&&!Array.isArray(o))return n;if(Array.isArray(n))for(var i=0;i<n.length;i++)o[i]=vw(o[i],n[i]);else if(dm(n))for(var i in n)o[i]=vw(o[i],n[i]);return o}function fS(o,n){Object.defineProperty(o,"toString",{value:n})}function Cm(o){for(var n=[],s=1;s<arguments.length;s++)n[s-1]=arguments[s];return new Error("An error occurred. See https://github.com/styled-components/styled-components/blob/main/packages/styled-components/src/utils/errors.md#".concat(o," for more information.").concat(n.length>0?" Args: ".concat(n.join(", ")):""))}var qN=function(){function o(n){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=n}return o.prototype.indexOfGroup=function(n){for(var s=0,i=0;i<n;i++)s+=this.groupSizes[i];return s},o.prototype.insertRules=function(n,s){if(n>=this.groupSizes.length){for(var i=this.groupSizes,a=i.length,c=a;n>=c;)if((c<<=1)<0)throw Cm(16,"".concat(n));this.groupSizes=new Uint32Array(c),this.groupSizes.set(i),this.length=c;for(var h=a;h<c;h++)this.groupSizes[h]=0}for(var g=this.indexOfGroup(n+1),b=(h=0,s.length);h<b;h++)this.tag.insertRule(g,s[h])&&(this.groupSizes[n]++,g++)},o.prototype.clearGroup=function(n){if(n<this.length){var s=this.groupSizes[n],i=this.indexOfGroup(n),a=i+s;this.groupSizes[n]=0;for(var c=i;c<a;c++)this.tag.deleteRule(i)}},o.prototype.getGroup=function(n){var s="";if(n>=this.length||this.groupSizes[n]===0)return s;for(var i=this.groupSizes[n],a=this.indexOfGroup(n),c=a+i,h=a;h<c;h++)s+="".concat(this.tag.getRule(h)).concat(pS);return s},o}(),gv=new Map,Av=new Map,fv=1,Y$=function(o){if(gv.has(o))return gv.get(o);for(;Av.has(fv);)fv++;var n=fv++;return gv.set(o,n),Av.set(n,o),n},KN=function(o,n){fv=n+1,gv.set(o,n),Av.set(n,o)},JN="style[".concat(rp,"][").concat(nk,'="').concat(yy,'"]'),YN=new RegExp("^".concat(rp,'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)')),XN=function(o,n,s){for(var i,a=s.split(","),c=0,h=a.length;c<h;c++)(i=a[c])&&o.registerName(n,i)},ZN=function(o,n){for(var s,i=((s=n.textContent)!==null&&s!==void 0?s:"").split(pS),a=[],c=0,h=i.length;c<h;c++){var g=i[c].trim();if(g){var b=g.match(YN);if(b){var $=0|parseInt(b[1],10),y=b[2];$!==0&&(KN(y,$),XN(o,y,b[3]),o.getTag().insertRules($,a)),a.length=0}else a.push(g)}}},vC=function(o){for(var n=document.querySelectorAll(JN),s=0,i=n.length;s<i;s++){var a=n[s];a&&a.getAttribute(rp)!==tk&&(ZN(o,a),a.parentNode&&a.parentNode.removeChild(a))}};function QN(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:null}var hk=function(o){var n=document.head,s=o||n,i=document.createElement("style"),a=function(g){var b=Array.from(g.querySelectorAll("style[".concat(rp,"]")));return b[b.length-1]}(s),c=a!==void 0?a.nextSibling:null;i.setAttribute(rp,tk),i.setAttribute(nk,yy);var h=QN();return h&&i.setAttribute("nonce",h),s.insertBefore(i,c),i},eM=function(){function o(n){this.element=hk(n),this.element.appendChild(document.createTextNode("")),this.sheet=function(s){if(s.sheet)return s.sheet;for(var i=document.styleSheets,a=0,c=i.length;a<c;a++){var h=i[a];if(h.ownerNode===s)return h}throw Cm(17)}(this.element),this.length=0}return o.prototype.insertRule=function(n,s){try{return this.sheet.insertRule(s,n),this.length++,!0}catch{return!1}},o.prototype.deleteRule=function(n){this.sheet.deleteRule(n),this.length--},o.prototype.getRule=function(n){var s=this.sheet.cssRules[n];return s&&s.cssText?s.cssText:""},o}(),tM=function(){function o(n){this.element=hk(n),this.nodes=this.element.childNodes,this.length=0}return o.prototype.insertRule=function(n,s){if(n<=this.length&&n>=0){var i=document.createTextNode(s);return this.element.insertBefore(i,this.nodes[n]||null),this.length++,!0}return!1},o.prototype.deleteRule=function(n){this.element.removeChild(this.nodes[n]),this.length--},o.prototype.getRule=function(n){return n<this.length?this.nodes[n].textContent:""},o}(),nM=function(){function o(n){this.rules=[],this.length=0}return o.prototype.insertRule=function(n,s){return n<=this.length&&(this.rules.splice(n,0,s),this.length++,!0)},o.prototype.deleteRule=function(n){this.rules.splice(n,1),this.length--},o.prototype.getRule=function(n){return n<this.length?this.rules[n]:""},o}(),yC=Rv,sM={isServer:!Rv,useCSSOMInjection:!AN},Nv=function(){function o(n,s,i){n===void 0&&(n=ip),s===void 0&&(s={});var a=this;this.options=$r($r({},sM),n),this.gs=s,this.names=new Map(i),this.server=!!n.isServer,!this.server&&Rv&&yC&&(yC=!1,vC(this)),fS(this,function(){return function(c){for(var h=c.getTag(),g=h.length,b="",$=function(w){var C=function(F){return Av.get(F)}(w);if(C===void 0)return"continue";var S=c.names.get(C),k=h.getGroup(w);if(S===void 0||!S.size||k.length===0)return"continue";var E="".concat(rp,".g").concat(w,'[id="').concat(C,'"]'),R="";S!==void 0&&S.forEach(function(F){F.length>0&&(R+="".concat(F,","))}),b+="".concat(k).concat(E,'{content:"').concat(R,'"}').concat(pS)},y=0;y<g;y++)$(y);return b}(a)})}return o.registerId=function(n){return Y$(n)},o.prototype.rehydrate=function(){!this.server&&Rv&&vC(this)},o.prototype.reconstructWithOptions=function(n,s){return s===void 0&&(s=!0),new o($r($r({},this.options),n),this.gs,s&&this.names||void 0)},o.prototype.allocateGSInstance=function(n){return this.gs[n]=(this.gs[n]||0)+1},o.prototype.getTag=function(){return this.tag||(this.tag=(n=function(s){var i=s.useCSSOMInjection,a=s.target;return s.isServer?new nM(a):i?new eM(a):new tM(a)}(this.options),new qN(n)));var n},o.prototype.hasNameForId=function(n,s){return this.names.has(n)&&this.names.get(n).has(s)},o.prototype.registerName=function(n,s){if(Y$(n),this.names.has(n))this.names.get(n).add(s);else{var i=new Set;i.add(s),this.names.set(n,i)}},o.prototype.insertRules=function(n,s,i){this.registerName(n,s),this.getTag().insertRules(Y$(n),i)},o.prototype.clearNames=function(n){this.names.has(n)&&this.names.get(n).clear()},o.prototype.clearRules=function(n){this.getTag().clearGroup(Y$(n)),this.clearNames(n)},o.prototype.clearTag=function(){this.tag=void 0},o}(),rM=/&/g,iM=/^\s*\/\/.*$/gm;function pk(o,n){return o.map(function(s){return s.type==="rule"&&(s.value="".concat(n," ").concat(s.value),s.value=s.value.replaceAll(",",",".concat(n," ")),s.props=s.props.map(function(i){return"".concat(n," ").concat(i)})),Array.isArray(s.children)&&s.type!=="@keyframes"&&(s.children=pk(s.children,n)),s})}function oM(o){var n,s,i,a=ip,c=a.options,h=c===void 0?ip:c,g=a.plugins,b=g===void 0?_y:g,$=function(C,S,k){return k.startsWith(s)&&k.endsWith(s)&&k.replaceAll(s,"").length>0?".".concat(n):C},y=b.slice();y.push(function(C){C.type===my&&C.value.includes("&")&&(C.props[0]=C.props[0].replace(rM,s).replace(i,$))}),h.prefix&&y.push(ON),y.push(IN);var w=function(C,S,k,E){S===void 0&&(S=""),k===void 0&&(k=""),E===void 0&&(E="&"),n=E,s=S,i=new RegExp("\\".concat(s,"\\b"),"g");var R=C.replace(iM,""),F=EN(k||S?"".concat(k," ").concat(S," { ").concat(R," }"):R);h.namespace&&(F=pk(F,h.namespace));var M=[];return Ov(F,xN(y.concat(DN(function(L){return M.push(L)})))),M};return w.hash=b.length?b.reduce(function(C,S){return S.name||Cm(15),Wh(C,S.name)},ik).toString():"",w}var aM=new Nv,yw=oM(),gk=Le.createContext({shouldForwardProp:void 0,styleSheet:aM,stylis:yw});gk.Consumer;Le.createContext(void 0);function _w(){return ve.useContext(gk)}var lM=function(){function o(n,s){var i=this;this.inject=function(a,c){c===void 0&&(c=yw);var h=i.name+c.hash;a.hasNameForId(i.id,h)||a.insertRules(i.id,h,c(i.rules,h,"@keyframes"))},this.name=n,this.id="sc-keyframes-".concat(n),this.rules=s,fS(this,function(){throw Cm(12,String(i.name))})}return o.prototype.getName=function(n){return n===void 0&&(n=yw),this.name+n.hash},o}(),cM=function(o){return o>="A"&&o<="Z"};function _C(o){for(var n="",s=0;s<o.length;s++){var i=o[s];if(s===1&&i==="-"&&o[0]==="-")return o;cM(i)?n+="-"+i.toLowerCase():n+=i}return n.startsWith("ms-")?"-"+n:n}var fk=function(o){return o==null||o===!1||o===""},mk=function(o){var n,s,i=[];for(var a in o){var c=o[a];o.hasOwnProperty(a)&&!fk(c)&&(Array.isArray(c)&&c.isCss||op(c)?i.push("".concat(_C(a),":"),c,";"):dm(c)?i.push.apply(i,um(um(["".concat(a," {")],mk(c),!1),["}"],!1)):i.push("".concat(_C(a),": ").concat((n=a,(s=c)==null||typeof s=="boolean"||s===""?"":typeof s!="number"||s===0||n in RN||n.startsWith("--")?String(s).trim():"".concat(s,"px")),";")))}return i};function pc(o,n,s,i){if(fk(o))return[];if(gS(o))return[".".concat(o.styledComponentId)];if(op(o)){if(!op(c=o)||c.prototype&&c.prototype.isReactComponent||!n)return[o];var a=o(n);return pc(a,n,s,i)}var c;return o instanceof lM?s?(o.inject(s,i),[o.getName(i)]):[o]:dm(o)?mk(o):Array.isArray(o)?Array.prototype.concat.apply(_y,o.map(function(h){return pc(h,n,s,i)})):[o.toString()]}function bk(o){for(var n=0;n<o.length;n+=1){var s=o[n];if(op(s)&&!gS(s))return!1}return!0}var uM=ok(yy),dM=function(){function o(n,s,i){this.rules=n,this.staticRulesId="",this.isStatic=(i===void 0||i.isStatic)&&bk(n),this.componentId=s,this.baseHash=Wh(uM,s),this.baseStyle=i,Nv.registerId(s)}return o.prototype.generateAndInjectStyles=function(n,s,i){var a=this.baseStyle?this.baseStyle.generateAndInjectStyles(n,s,i):"";if(this.isStatic&&!i.hash)if(this.staticRulesId&&s.hasNameForId(this.componentId,this.staticRulesId))a=Ou(a,this.staticRulesId);else{var c=$w(pc(this.rules,n,s,i)),h=bw(Wh(this.baseHash,c)>>>0);if(!s.hasNameForId(this.componentId,h)){var g=i(c,".".concat(h),void 0,this.componentId);s.insertRules(this.componentId,h,g)}a=Ou(a,h),this.staticRulesId=h}else{for(var b=Wh(this.baseHash,i.hash),$="",y=0;y<this.rules.length;y++){var w=this.rules[y];if(typeof w=="string")$+=w;else if(w){var C=$w(pc(w,n,s,i));b=Wh(b,C+y),$+=C}}if($){var S=bw(b>>>0);s.hasNameForId(this.componentId,S)||s.insertRules(this.componentId,S,i($,".".concat(S),void 0,this.componentId)),a=Ou(a,S)}}return a},o}(),mS=Le.createContext(void 0);mS.Consumer;var m_={};function hM(o,n,s){var i=gS(o),a=o,c=!f_(o),h=n.attrs,g=h===void 0?_y:h,b=n.componentId,$=b===void 0?function(T,V){var K=typeof T!="string"?"sc":gC(T);m_[K]=(m_[K]||0)+1;var Y="".concat(K,"-").concat(ak(yy+K+m_[K]));return V?"".concat(V,"-").concat(Y):Y}(n.displayName,n.parentComponentId):b,y=n.displayName,w=y===void 0?function(T){return f_(T)?"styled.".concat(T):"Styled(".concat(PN(T),")")}(o):y,C=n.displayName&&n.componentId?"".concat(gC(n.displayName),"-").concat(n.componentId):n.componentId||$,S=i&&a.attrs?a.attrs.concat(g).filter(Boolean):g,k=n.shouldForwardProp;if(i&&a.shouldForwardProp){var E=a.shouldForwardProp;if(n.shouldForwardProp){var R=n.shouldForwardProp;k=function(T,V){return E(T,V)&&R(T,V)}}else k=E}var F=new dM(s,C,i?a.componentStyle:void 0);function M(T,V){return function(K,Y,te){var J=K.attrs,ne=K.componentStyle,Q=K.defaultProps,he=K.foldedComponentIds,q=K.styledComponentId,re=K.target,De=Le.useContext(mS),ee=_w(),Fe=K.shouldForwardProp||ee.shouldForwardProp,Ce=sk(Y,De,Q)||ip,Ze=function(at,Ue,ut){for(var rt,tt=$r($r({},Ue),{className:void 0,theme:ut}),It=0;It<at.length;It+=1){var Yt=op(rt=at[It])?rt(tt):rt;for(var Ut in Yt)tt[Ut]=Ut==="className"?Ou(tt[Ut],Yt[Ut]):Ut==="style"?$r($r({},tt[Ut]),Yt[Ut]):Yt[Ut]}return Ue.className&&(tt.className=Ou(tt.className,Ue.className)),tt}(J,Y,Ce),pe=Ze.as||re,Te={};for(var ke in Ze)Ze[ke]===void 0||ke[0]==="$"||ke==="as"||ke==="theme"&&Ze.theme===Ce||(ke==="forwardedAs"?Te.as=Ze.forwardedAs:Fe&&!Fe(ke,pe)||(Te[ke]=Ze[ke]));var Xe=function(at,Ue){var ut=_w(),rt=at.generateAndInjectStyles(Ue,ut.styleSheet,ut.stylis);return rt}(ne,Ze),Ke=Ou(he,q);return Xe&&(Ke+=" "+Xe),Ze.className&&(Ke+=" "+Ze.className),Te[f_(pe)&&!rk.has(pe)?"class":"className"]=Ke,Te.ref=te,ve.createElement(pe,Te)}(L,T,V)}M.displayName=w;var L=Le.forwardRef(M);return L.attrs=S,L.componentStyle=F,L.displayName=w,L.shouldForwardProp=k,L.foldedComponentIds=i?Ou(a.foldedComponentIds,a.styledComponentId):"",L.styledComponentId=C,L.target=i?a.target:o,Object.defineProperty(L,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(T){this._foldedDefaultProps=i?function(V){for(var K=[],Y=1;Y<arguments.length;Y++)K[Y-1]=arguments[Y];for(var te=0,J=K;te<J.length;te++)vw(V,J[te],!0);return V}({},a.defaultProps,T):T}}),fS(L,function(){return".".concat(L.styledComponentId)}),c&&dk(L,o,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0}),L}function wC(o,n){for(var s=[o[0]],i=0,a=n.length;i<a;i+=1)s.push(n[i],o[i+1]);return s}var SC=function(o){return Object.assign(o,{isCss:!0})};function $k(o){for(var n=[],s=1;s<arguments.length;s++)n[s-1]=arguments[s];if(op(o)||dm(o))return SC(pc(wC(_y,um([o],n,!0))));var i=o;return n.length===0&&i.length===1&&typeof i[0]=="string"?pc(i):SC(pc(wC(i,n)))}function ww(o,n,s){if(s===void 0&&(s=ip),!n)throw Cm(1,n);var i=function(a){for(var c=[],h=1;h<arguments.length;h++)c[h-1]=arguments[h];return o(n,s,$k.apply(void 0,um([a],c,!1)))};return i.attrs=function(a){return ww(o,n,$r($r({},s),{attrs:Array.prototype.concat(s.attrs,a).filter(Boolean)}))},i.withConfig=function(a){return ww(o,n,$r($r({},s),a))},i}var vk=function(o){return ww(hM,o)},wo=vk;rk.forEach(function(o){wo[o]=vk(o)});var pM=function(){function o(n,s){this.rules=n,this.componentId=s,this.isStatic=bk(n),Nv.registerId(this.componentId+1)}return o.prototype.createStyles=function(n,s,i,a){var c=a($w(pc(this.rules,s,i,a)),""),h=this.componentId+n;i.insertRules(h,h,c)},o.prototype.removeStyles=function(n,s){s.clearRules(this.componentId+n)},o.prototype.renderStyles=function(n,s,i,a){n>2&&Nv.registerId(this.componentId+n),this.removeStyles(n,i),this.createStyles(n,s,i,a)},o}();function gM(o){for(var n=[],s=1;s<arguments.length;s++)n[s-1]=arguments[s];var i=$k.apply(void 0,um([o],n,!1)),a="sc-global-".concat(ak(JSON.stringify(i))),c=new pM(i,a),h=function(b){var $=_w(),y=Le.useContext(mS),w=Le.useRef($.styleSheet.allocateGSInstance(a)).current;return $.styleSheet.server&&g(w,b,$.styleSheet,y,$.stylis),Le.useLayoutEffect(function(){if(!$.styleSheet.server)return g(w,b,$.styleSheet,y,$.stylis),function(){return c.removeStyles(w,$.styleSheet)}},[w,b,$.styleSheet,y,$.stylis]),null};function g(b,$,y,w,C){if(c.isStatic)c.renderStyles(b,NN,y,C);else{var S=$r($r({},$),{theme:sk($,w,h.defaultProps)});c.renderStyles(b,S,y,C)}}return Le.memo(h)}function CC(o,n){(n==null||n>o.length)&&(n=o.length);for(var s=0,i=Array(n);s<n;s++)i[s]=o[s];return i}function fM(o){if(Array.isArray(o))return o}function mM(o){if(o===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return o}function bM(o,n,s){return n=Mv(n),CM(o,yk()?Reflect.construct(n,[],Mv(o).constructor):n.apply(o,s))}function $M(o,n){if(!(o instanceof n))throw new TypeError("Cannot call a class as a function")}function vM(o,n){for(var s=0;s<n.length;s++){var i=n[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(o,_k(i.key),i)}}function yM(o,n,s){return vM(o.prototype,n),Object.defineProperty(o,"prototype",{writable:!1}),o}function Jh(o,n){var s=typeof Symbol<"u"&&o[Symbol.iterator]||o["@@iterator"];if(!s){if(Array.isArray(o)||(s=wk(o))||n){s&&(o=s);var i=0,a=function(){};return{s:a,n:function(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function(b){throw b},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var c,h=!0,g=!1;return{s:function(){s=s.call(o)},n:function(){var b=s.next();return h=b.done,b},e:function(b){g=!0,c=b},f:function(){try{h||s.return==null||s.return()}finally{if(g)throw c}}}}function Mi(o,n,s){return(n=_k(n))in o?Object.defineProperty(o,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):o[n]=s,o}function Mv(o){return Mv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Mv(o)}function _M(o,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");o.prototype=Object.create(n&&n.prototype,{constructor:{value:o,writable:!0,configurable:!0}}),Object.defineProperty(o,"prototype",{writable:!1}),n&&Sw(o,n)}function yk(){try{var o=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(yk=function(){return!!o})()}function wM(o,n){var s=o==null?null:typeof Symbol<"u"&&o[Symbol.iterator]||o["@@iterator"];if(s!=null){var i,a,c,h,g=[],b=!0,$=!1;try{if(c=(s=s.call(o)).next,n!==0)for(;!(b=(i=c.call(s)).done)&&(g.push(i.value),g.length!==n);b=!0);}catch(y){$=!0,a=y}finally{try{if(!b&&s.return!=null&&(h=s.return(),Object(h)!==h))return}finally{if($)throw a}}return g}}function SM(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function TC(o,n){var s=Object.keys(o);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(o);n&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(o,a).enumerable})),s.push.apply(s,i)}return s}function Lv(o){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?TC(Object(s),!0).forEach(function(i){Mi(o,i,s[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(s)):TC(Object(s)).forEach(function(i){Object.defineProperty(o,i,Object.getOwnPropertyDescriptor(s,i))})}return o}function CM(o,n){if(n&&(typeof n=="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return mM(o)}function Sw(o,n){return Sw=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,i){return s.__proto__=i,s},Sw(o,n)}function TM(o,n){return fM(o)||wM(o,n)||wk(o,n)||SM()}function So(o,n){return n||(n=o.slice(0)),Object.freeze(Object.defineProperties(o,{raw:{value:Object.freeze(n)}}))}function EM(o,n){if(typeof o!="object"||!o)return o;var s=o[Symbol.toPrimitive];if(s!==void 0){var i=s.call(o,n);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(o)}function _k(o){var n=EM(o,"string");return typeof n=="symbol"?n:n+""}function wk(o,n){if(o){if(typeof o=="string")return CC(o,n);var s={}.toString.call(o).slice(8,-1);return s==="Object"&&o.constructor&&(s=o.constructor.name),s==="Map"||s==="Set"?Array.from(o):s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?CC(o,n):void 0}}var EC,kM=gM(EC||(EC=So([`
  .focus-outline-hidden :focus {
      outline: none;
  }
`]))),kC,Sk=wo.button(kC||(kC=So([`
  display: block;
  padding: 0;
  border: 0;
  background: none;
  font-size: 0;
  cursor: `,`;
`])),function(o){return o.disabled?"not-allowed":"pointer"}),IC,xC,IM=wo.span(IC||(IC=So([`
  font-size: 12px;
  line-height: 1;
`])));function Ck(o){var n=o.className,s=o.onClick,i=o.inverted,a=o.label,c=o.disabled;return Le.createElement(Sk,{className:n,onClick:s,"data-tour-elem":"".concat(i?"right":"left","-arrow"),disabled:c},a?Le.createElement(IM,null,a):Le.createElement("svg",{viewBox:"0 0 18.4 14.4"},Le.createElement("path",{d:i?"M17 7.2H1M10.8 1L17 7.2l-6.2 6.2":"M1.4 7.2h16M7.6 1L1.4 7.2l6.2 6.2",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeMiterlimit:"10"})))}Ck.propTypes={className:ze.string.isRequired,onClick:ze.func.isRequired,inverted:ze.bool,label:ze.node,disabled:ze.bool};var DC=wo(Ck)(xC||(xC=So([`
  color: `,`;

  `,`;
  `,`;

  &:hover {
    color: `,`;
  }
`])),function(o){return o.disabled?"#caccce":"#646464"},function(o){return o.inverted?"margin-left: 24px;":"margin-right: 24px;"},function(o){return!o.label&&`
    width: 16px;
    height: 12px;
    flex: 0 0 16px;
  `},function(o){return o.disabled?"#caccce":"#000"}),OC;function Tk(o){var n=o.className,s=o.onClick,i=o.ariaLabel;return Le.createElement(Sk,{className:n,onClick:s,"aria-label":i},Le.createElement("svg",{viewBox:"0 0 9.1 9.1","aria-hidden":!0,role:"presentation"},Le.createElement("path",{fill:"currentColor",d:"M5.9 4.5l2.8-2.8c.4-.4.4-1 0-1.4-.4-.4-1-.4-1.4 0L4.5 3.1 1.7.3C1.3-.1.7-.1.3.3c-.4.4-.4 1 0 1.4l2.8 2.8L.3 7.4c-.4.4-.4 1 0 1.4.2.2.4.3.7.3s.5-.1.7-.3L4.5 6l2.8 2.8c.3.2.5.3.8.3s.5-.1.7-.3c.4-.4.4-1 0-1.4L5.9 4.5z"})))}Tk.propTypes={className:ze.string.isRequired,onClick:ze.func.isRequired,ariaLabel:ze.string};var xM=wo(Tk)(OC||(OC=So([`
  position: absolute;
  top: 22px;
  right: 22px;
  width: 9px;
  height: 9px;
  color: #5e5e5e;
  &:hover {
    color: #000;
  }
`])));function mv(o){var n=o.getBoundingClientRect(),s=n.top,i=n.right,a=n.bottom,c=n.left,h=n.width,g=n.height;return{top:s,right:i,bottom:a,left:c,width:h,height:g}}function Ek(o,n){if(!n.highlightedSelectors)return mv(o);var s=mv(o),i=Jh(n.highlightedSelectors),a;try{for(i.s();!(a=i.n()).done;){var c=a.value,h=document.querySelector(c);if(!(!h||h.style.display==="none"||h.style.visibility==="hidden")){var g=mv(h);g.top<s.top&&(s.top=g.top),g.right>s.right&&(s.right=g.right),g.bottom>s.bottom&&(s.bottom=g.bottom),g.left<s.left&&(s.left=g.left)}}}catch(b){i.e(b)}finally{i.f()}return s.width=s.right-s.left,s.height=s.bottom-s.top,s}function DM(o){var n=o.top,s=o.right,i=o.bottom,a=o.left,c=o.w,h=o.h,g=o.threshold,b=g===void 0?0:g;return n>=0+b&&a>=0+b&&i<=h-b&&s<=c-b}function OM(o){return o===document.querySelector("body")||o===document.querySelector("html")}var RM=function(n){return/(left|right)/.test(n)},b_=function(n,s){return n>s},$_=function(n,s){return n>s},ea=function(n){return n<0?0:n};function AM(o){return Object.keys(o).map(function(n){return{position:n,value:o[n]}}).sort(function(n,s){return s.value-n.value}).map(function(n){return n.position})}var RC,NM=wo.div(RC||(RC=So([`
  --reactour-accent: `,`;
  `,`
  position: fixed;
  transition: transform 0.3s;
  top: 0;
  left: 0;
  z-index: 1000000;

  transform: `,`;
`])),function(o){return o.accentColor},function(o){return o.defaultStyles?`
  max-width: 331px;
  min-width: 150px;
  padding-right: 40px;
  border-radius: `.concat(o.rounded,`px;
  background-color: #fff;
  padding: 24px 30px;
  box-shadow: 0 0.5em 3em rgba(0, 0, 0, 0.3);
  color: inherit;
  `):""},function(o){var n=o.targetTop,s=o.targetRight,i=o.targetBottom,a=o.targetLeft,c=o.windowWidth,h=o.windowHeight,g=o.helperWidth,b=o.helperHeight,$=o.helperPosition,y=o.padding,w={left:a,right:c-s,top:n,bottom:h-i},C=function(F){return w[F]>(RM(F)?g+y*2:b+y*2)},S=function(F){for(var M=AM(w),L=0;L<M.length;L++)if(C(M[L]))return F[M[L]];return F.center},k=function(F){if(Array.isArray(F)){var M=b_(F[0],c),L=$_(F[1],h),T=function(Q,he){console.warn("".concat(Q,":").concat(he," is outside window, falling back to center"))};return M&&T("x",F[0]),L&&T("y",F[1]),[M?c/2-g/2:F[0],L?h/2-b/2:F[1]]}var V=b_(a+g,c)?b_(s+y,c)?s-g:s-g+y:a-y,K=V>y?V:y,Y=$_(n+b,h)?$_(i+y,h)?i-b:i-b+y:n-y,te=Y>y?Y:y,J={top:[K,n-b-y*2],right:[s+y*2,te],bottom:[K,i+y*2],left:[a-g-y*2,te],center:[c/2-g/2,h/2-b/2]};return F==="center"||C(F)?J[F]:S(J)},E=k($);return"translate(".concat(Math.round(E[0]),"px, ").concat(Math.round(E[1]),"px)")}),AC,MM=wo.span(AC||(AC=So([`
  position: absolute;
  font-family: monospace;
  background: var(--reactour-accent);
  background: `,`;
  height: 1.875em;
  line-height: 2;
  padding-left: 0.8125em;
  padding-right: 0.8125em;
  font-size: 1em;
  border-radius: 1.625em;
  color: white;
  text-align: center;
  box-shadow: 0 0.25em 0.5em rgba(0, 0, 0, 0.3);
  top: -0.8125em;
  left: -0.8125em;
`])),function(o){return o.accentColor}),NC,LM=wo.div(NC||(NC=So([`
  display: flex;
  margin-top: 24px;
  align-items: center;
  justify-content: center;
`]))),MC,BM=wo.nav(MC||(MC=So([`
  counter-reset: dot;
  display: flex;
  justify-content: center;
  align-items: center;
  flex-wrap: wrap;
`]))),LC,PM=wo.button(LC||(LC=So([`
  counter-increment: dot;
  width: 8px;
  height: 8px;
  border: `,`;

  border-radius: 100%;
  padding: 0;
  display: block;
  margin: 4px;
  transition: opacity 0.3s, transform 0.3s;
  cursor: `,`;
  transform: scale(`,`);

  color: `,`;
  background: `,`;

  color: `,`;
  background: `,`;

  &:before {
    content: counter(dot);
    position: absolute;
    bottom: calc(100% + 0.25em);
    left: 50%;
    opacity: 0;
    transform: translate(-50%, 1em);
    transition: 0.3s;
    display: `,`;
  }

  &:hover {
    background-color: currentColor;

    &:before {
      opacity: 0.5;
      transform: translate(-50%, -2px);
    }
  }
`])),function(o){return o.current===o.index?"0":"1px solid #caccce"},function(o){return o.disabled?"not-allowed":"pointer"},function(o){return o.current===o.index?1.25:1},function(o){return o.current===o.index?"var(--reactour-accent)":"#caccce"},function(o){return o.current===o.index?"var(--reactour-accent)":"none"},function(o){return o.current===o.index?o.accentColor:"#caccce"},function(o){return o.current===o.index?o.accentColor:"none"},function(o){return o.showNumber?"block":"none"}),BC,FM=wo.div(BC||(BC=So([`
  opacity: `,`;
  color: `,`;
  width: 100%;
  left: 0;
  top: 0;
  height: 100%;
  position: fixed;
  z-index: 99999;
  pointer-events: none;
`])),function(o){return!o.maskClassName&&.7},function(o){return!o.maskClassName&&"#000"});function kk(o){var n=o.windowWidth,s=o.windowHeight,i=o.targetWidth,a=o.targetHeight,c=o.targetTop,h=o.targetLeft,g=o.padding,b=o.rounded,$=o.roundedStep,y=o.disableInteraction,w=o.disableInteractionClassName,C=o.className,S=o.onClick,k=o.highlightedBorder,E=ea(i+g*2),R=ea(a+g*2),F=ea(c-g),M=ea(h-g),L=$?Math.min(E/2,R/2):b;return Le.createElement(FM,{onClick:S,maskClassName:C},Le.createElement("svg",{width:n,height:s,xmlns:"http://www.w3.org/2000/svg",className:C},Le.createElement("defs",null,Le.createElement("mask",{id:"mask-main"},Le.createElement("rect",{x:0,y:0,width:n,height:s,fill:"white"}),Le.createElement("rect",{x:M,y:F,width:E,height:R,fill:"black"}),Le.createElement("rect",{x:M-1,y:F-1,width:L,height:L,fill:"white"}),Le.createElement("circle",{cx:M+L,cy:F+L,r:L,fill:"black"}),Le.createElement("rect",{x:M+E-L+1,y:F-1,width:L,height:L,fill:"white"}),Le.createElement("circle",{cx:M+E-L,cy:F+L,r:L,fill:"black"}),Le.createElement("rect",{x:M-1,y:F+R-L+1,width:L,height:L,fill:"white"}),Le.createElement("circle",{cx:M+L,cy:F+R-L,r:L,fill:"black"}),Le.createElement("rect",{x:M+E-L+1,y:F+R-L+1,width:L,height:L,fill:"white"}),Le.createElement("circle",{cx:M+E-L,cy:F+R-L,r:L,fill:"black "})),Le.createElement("clipPath",{id:"clip-path"},Le.createElement("rect",{x:0,y:0,width:n,height:F}),Le.createElement("rect",{x:0,y:F,width:M,height:R}),Le.createElement("rect",{x:h+i+g,y:F,width:ea(n-i-M),height:R}),Le.createElement("rect",{x:0,y:c+a+g,width:n,height:ea(s-a-F)}))),Le.createElement("rect",{x:0,y:0,width:n,height:s,fill:"currentColor",mask:"url(#mask-main)"}),Le.createElement("rect",{x:0,y:0,width:n,height:s,fill:"currentColor",clipPath:"url(#clip-path)",pointerEvents:"auto"}),Le.createElement("rect",{x:M,y:F,width:E,height:R,pointerEvents:"auto",fill:"transparent",display:y?"block":"none",className:w}),k&&Le.createElement("rect",{x:ea(M+k.width/2),y:ea(F+k.width/2),width:ea(E-k.width),height:ea(R-k.width),pointerEvents:"auto",fill:"none",strokeWidth:k.width,stroke:k.color,rx:L-2})))}kk.propTypes={windowWidth:ze.number.isRequired,windowHeight:ze.number.isRequired,targetWidth:ze.number.isRequired,targetHeight:ze.number.isRequired,targetTop:ze.number.isRequired,targetLeft:ze.number.isRequired,padding:ze.number.isRequired,rounded:ze.number.isRequired,roundedStep:ze.bool,disableInteraction:ze.bool.isRequired,disableInteractionClassName:ze.string.isRequired,highlightedBorder:ze.shape({color:ze.string.isRequired,width:ze.number.isRequired})};var jM=function(o){var n=o.step,s=o.refresh,i=ve.useState(0),a=TM(i,2),c=a[0],h=a[1];return ve.useEffect(function(){if(n.resizeObservables){var g=function(C){var S=Jh(C),k;try{var E=function(){var F=k.value;if(!F.attributes)return 1;var M=n.resizeObservables.find(function(L){return F.matches(L)||F.querySelector(L)!=null});M&&h(c+1)};for(S.s();!(k=S.n()).done;)E()}catch(R){S.e(R)}finally{S.f()}},b=new MutationObserver(function(w){var C=Jh(w),S;try{for(C.s();!(S=C.n()).done;){var k=S.value;k.addedNodes.length!==0&&g(k.addedNodes),k.removedNodes.length!==0&&g(k.removedNodes)}}catch(E){C.e(E)}finally{C.f()}}),$=document.documentElement||document.body,y={childList:!0,subtree:!0};return b.observe($,y),function(){b.disconnect()}}},[n,c]),ve.useEffect(function(){if(n.resizeObservables){var g=new ResizeObserver(function(C){s()}),b=Jh(n.resizeObservables),$;try{for(b.s();!($=b.n()).done;){var y=$.value,w=document.querySelector(y);w&&g.observe(w)}}catch(C){b.e(C)}finally{b.f()}return function(){g.disconnect()}}},[n,c]),null},zM=function(o){var n=o.step,s=o.refresh;return ve.useEffect(function(){if(n.mutationObservables){var i=function(b){var $=Jh(b),y;try{var w=function(){var S=y.value;if(!S.attributes)return 1;var k=n.mutationObservables.find(function(E){return S.matches(E)||S.querySelector(E)!=null});k&&s()};for($.s();!(y=$.n()).done;)w()}catch(C){$.e(C)}finally{$.f()}},a=new MutationObserver(function(g){var b=Jh(g),$;try{for(b.s();!($=b.n()).done;){var y=$.value;y.addedNodes.length!==0&&i(y.addedNodes),y.removedNodes.length!==0&&i(y.removedNodes)}}catch(w){b.e(w)}finally{b.f()}}),c=document.documentElement||document.body,h={childList:!0,subtree:!0};return a.observe(c,h),function(){a.disconnect()}}},[n]),null};function UM(o){var n=o.children,s=ve.useRef(null);return s.current===null&&(s.current=document.createElement("div"),s.current.setAttribute("id","___reactour")),ve.useEffect(function(){return document.body.appendChild(s.current),function(){document.body.removeChild(s.current)}},[s]),IT.createPortal(n,s.current)}var HM={disableFocusLock:ze.bool,badgeContent:ze.func,highlightedMaskClassName:ze.string,children:ze.oneOfType([ze.node,ze.element]),className:ze.string,closeButtonAriaLabel:ze.string,closeWithMask:ze.bool,inViewThreshold:ze.number,isOpen:ze.bool.isRequired,lastStepNextButton:ze.node,maskClassName:ze.string,maskSpace:ze.number,nextButton:ze.node,onAfterOpen:ze.func,onBeforeClose:ze.func,onRequestClose:ze.func,prevButton:ze.node,scrollDuration:ze.number,scrollOffset:ze.number,showButtons:ze.bool,showCloseButton:ze.bool,showNavigation:ze.bool,showNavigationNumber:ze.bool,showNumber:ze.bool,startAt:ze.number,goToStep:ze.number,getCurrentStep:ze.func,nextStep:ze.func,prevStep:ze.func,steps:ze.arrayOf(ze.shape({selector:ze.string,content:ze.oneOfType([ze.node,ze.element,ze.func]).isRequired,position:ze.oneOfType([ze.arrayOf(ze.number),ze.oneOf(["top","right","bottom","left","center"])]),action:ze.func,style:ze.object,stepInteraction:ze.bool,navDotAriaLabel:ze.string,roundedStep:ze.bool})),update:ze.string,updateDelay:ze.number,disableInteraction:ze.bool,disableDotsNavigation:ze.bool,disableKeyboardNavigation:ze.oneOfType([ze.arrayOf(ze.oneOf(["esc","right","left"])),ze.bool]),rounded:ze.number,accentColor:ze.string,highlightedBorder:ze.shape({color:ze.string.isRequired,width:ze.number.isRequired})},WM={disableFocusLock:!1,showNavigation:!0,showNavigationNumber:!0,showButtons:!0,showCloseButton:!0,closeButtonAriaLabel:"Close",showNumber:!0,scrollDuration:1,maskSpace:10,updateDelay:1,disableInteraction:!1,rounded:0,accentColor:"#007aff",closeWithMask:!0},Rh={mask:{base:"reactour__mask",isOpen:"reactour__mask--is-open",disableInteraction:"reactour__mask--disable-interaction"},helper:{base:"reactour__helper",isOpen:"reactour__helper--is-open"},dot:{base:"reactour__dot",active:"reactour__dot--is-active"}},bS=function(o){function n(){var s;return $M(this,n),s=bM(this,n),Mi(s,"unlockFocus",function(i){s.setState({focusUnlocked:!0},i())}),Mi(s,"showStep",function(){if(!(!s.helper||!s.helper.current)){var i=s.props.steps,a=s.state,c=a.current,h=a.focusUnlocked;h&&s.setState({focusUnlocked:!1});var g=i[c],b=g.selector?document.querySelector(g.selector):null,$=function(k){g.action&&typeof g.action=="function"&&s.unlockFocus(function(){return g.action(k)})};if(g.observe){var y=document.querySelector(g.observe),w={attributes:!0,childList:!0,characterData:!0};s.setState(function(S){return S.observer&&setTimeout(function(){S.observer.disconnect()},0),{observer:new MutationObserver(function(k){k.forEach(function(E){if(E.type==="childList"&&E.addedNodes.length>0){var R=function(){return $(E.addedNodes[0])};setTimeout(function(){return s.calculateNode(E.addedNodes[0],g,R)},100)}else if(E.type==="childList"&&E.removedNodes.length>0){var F=function(){return $(b)};s.calculateNode(b,g,F)}})})}},function(){return s.state.observer.observe(y,w)})}else s.state.observer&&(s.state.observer.disconnect(),s.setState({observer:null}));if(b){var C=function(){return $(b)};s.calculateNode(b,g,C)}else s.setState(v_(null,g,s.helper.current),$),g.selector&&console.warn("Doesn't find a DOM node '".concat(g.selector,"'. Please check the 'steps' Tour prop Array at position ").concat(c,"."))}}),Mi(s,"calculateNode",function(i,a,c){var h=s.props,g=h.scrollDuration,b=h.inViewThreshold,$=h.scrollOffset,y=Ek(i,a),w=Math.max(document.documentElement.clientWidth,window.innerWidth||0),C=Math.max(document.documentElement.clientHeight,window.innerHeight||0);if(DM(Lv(Lv({},y),{},{w,h:C,threshold:b})))s.setState(v_(i,a,s.helper.current),c);else{var S=BR(i),k=$||(y.height>C?-25:-(C/2)+y.height/2);MR.to(i,{context:OM(S)?window:S,duration:g,offset:k,callback:function(R){s.setState(v_(R,a,s.helper.current),c)}})}}),Mi(s,"recalculateNode",function(i){var a=document.querySelector(i.selector),c=function(g){i.action&&typeof i.action=="function"&&s.unlockFocus(function(){return i.action(g)})};s.calculateNode(a,i,function(){return c(a)})}),Mi(s,"maskClickHandler",function(i){var a=s.props,c=a.closeWithMask,h=a.onRequestClose;c&&!i.target.classList.contains(Rh.mask.disableInteraction)&&h(i)}),Mi(s,"nextStep",function(){var i=s.props,a=i.steps,c=i.getCurrentStep;s.setState(function(h){var g=h.current<a.length-1?h.current+1:h.current;return typeof c=="function"&&c(g),{current:g}},s.showStep)}),Mi(s,"prevStep",function(){var i=s.props.getCurrentStep;s.setState(function(a){var c=a.current>0?a.current-1:a.current;return typeof i=="function"&&i(c),{current:c}},s.showStep)}),Mi(s,"gotoStep",function(i){var a=s.props,c=a.steps,h=a.getCurrentStep;s.setState(function(g){var b=c[i]?i:g.current;return typeof h=="function"&&h(b),{current:b}},s.showStep)}),Mi(s,"keyDownHandler",function(i){var a=s.props,c=a.onRequestClose,h=a.nextStep,g=a.prevStep,b=a.disableKeyboardNavigation;if(i.stopPropagation(),b!==!0){var $,y,w;b&&($=b.includes("esc"),y=b.includes("right"),w=b.includes("left")),i.keyCode===27&&!$&&(i.preventDefault(),c()),i.keyCode===39&&!y&&(i.preventDefault(),typeof h=="function"?h():s.nextStep()),i.keyCode===37&&!w&&(i.preventDefault(),typeof g=="function"?g():s.prevStep())}}),s.state={isOpen:!1,current:0,top:0,right:0,bottom:0,left:0,width:0,height:0,w:0,h:0,inDOM:!1,observer:null,focusUnlocked:!1},s.helper=ve.createRef(),s.helperElement=null,s.debouncedShowStep=nA(s.showStep,70),s}return _M(n,o),yM(n,[{key:"componentDidMount",value:function(){var i=this.props,a=i.isOpen,c=i.startAt;a&&this.open(c)}},{key:"UNSAFE_componentWillReceiveProps",value:function(i){var a=this.props,c=a.isOpen,h=a.update,g=a.updateDelay;!c&&i.isOpen?this.open(i.startAt):c&&!i.isOpen&&this.close(),c&&h!==i.update&&(i.steps[this.state.current]?setTimeout(this.showStep,g):this.props.onRequestClose()),c&&i.isOpen&&this.state.current!==i.goToStep&&this.gotoStep(i.goToStep)}},{key:"componentWillUnmount",value:function(){var i=this.props.isOpen;i&&this.close(),this.state.observer&&this.state.observer.disconnect()}},{key:"open",value:function(i){var a=this,c=this.props.onAfterOpen;this.setState(function(h){return{isOpen:!0,current:i!==void 0?i:h.current}},function(){setTimeout(a.showStep,1),a.helperElement=a.helper.current,a.props.disableFocusLock||a.helper.current.focus(),c&&c(a.helperElement)}),window.addEventListener("resize",this.debouncedShowStep,!1),window.addEventListener("keydown",this.keyDownHandler,!1)}},{key:"close",value:function(){this.setState(function(i){return i.observer&&i.observer.disconnect(),{isOpen:!1,observer:null}},this.onBeforeClose),window.removeEventListener("resize",this.debouncedShowStep),window.removeEventListener("keydown",this.keyDownHandler)}},{key:"onBeforeClose",value:function(){var i=this.props.onBeforeClose;i&&i(this.helperElement)}},{key:"render",value:function(){var i=this,a=this.props,c=a.className,h=a.steps,g=a.maskClassName,b=a.showButtons,$=a.showCloseButton,y=a.closeButtonAriaLabel,w=a.showNavigation,C=a.showNavigationNumber,S=a.showNumber,k=a.onRequestClose,E=a.maskSpace,R=a.lastStepNextButton,F=a.nextButton,M=a.prevButton,L=a.badgeContent,T=a.highlightedMaskClassName,V=a.disableInteraction,K=a.disableDotsNavigation,Y=a.nextStep,te=a.prevStep,J=a.rounded,ne=a.accentColor,Q=a.CustomHelper,he=a.disableFocusLock,q=a.highlightedBorder,re=this.state,De=re.isOpen,ee=re.current,Fe=re.inDOM,Ce=re.top,Ze=re.right,pe=re.bottom,Te=re.left,ke=re.width,Xe=re.height,Ke=re.w,at=re.h,Ue=re.helperWidth,ut=re.helperHeight,rt=re.helperPosition;return De?Le.createElement(UM,null,Le.createElement(kM,null),Le.createElement(jM,{step:h[ee],refresh:function(){return i.recalculateNode(h[ee])}}),Le.createElement(zM,{step:h[ee],refresh:function(){return i.recalculateNode(h[ee])}}),Le.createElement(kk,{onClick:this.maskClickHandler,forwardRef:function(It){return i.mask=It},windowWidth:Ke,windowHeight:at,targetWidth:ke,targetHeight:Xe,targetTop:Ce,targetLeft:Te,padding:E,rounded:J,roundedStep:h[ee].roundedStep,className:g,disableInteraction:h[ee].stepInteraction===!1||V?!h[ee].stepInteraction:V,disableInteractionClassName:"".concat(Rh.mask.disableInteraction," ").concat(T),highlightedBorder:q}),Le.createElement(GE,{disabled:he,autoFocus:!1},Le.createElement(NM,{ref:this.helper,targetHeight:Xe,targetWidth:ke,targetTop:Ce,targetRight:Ze,targetBottom:pe,targetLeft:Te,windowWidth:Ke,windowHeight:at,helperWidth:Ue,helperHeight:ut,helperPosition:rt,padding:E,tabIndex:-1,current:ee,style:h[ee].style?h[ee].style:{},rounded:J,className:eC(Rh.helper.base,c,Mi({},Rh.helper.isOpen,De)),accentColor:ne,defaultStyles:!Q,role:"dialog"},Q?Le.createElement(Q,{current:ee,totalSteps:h.length,gotoStep:this.gotoStep,close:k,content:h[ee]&&(typeof h[ee].content=="function"?h[ee].content({close:k,goTo:this.gotoStep,inDOM:Fe,step:ee+1}):h[ee].content)},this.props.children):Le.createElement(Le.Fragment,null,this.props.children,h[ee]&&(typeof h[ee].content=="function"?h[ee].content({close:k,goTo:this.gotoStep,inDOM:Fe,step:ee+1}):h[ee].content),S&&Le.createElement(MM,{"data-tour-elem":"badge",accentColor:ne},typeof L=="function"?L(ee+1,h.length):ee+1),(b||w)&&Le.createElement(LM,{"data-tour-elem":"controls"},b&&Le.createElement(DC,{onClick:typeof te=="function"?te:this.prevStep,disabled:ee===0,label:M||null}),w&&Le.createElement(BM,{"data-tour-elem":"navigation"},h.map(function(tt,It){return Le.createElement(PM,{key:"".concat(tt.selector?tt.selector:"undef","_").concat(It),onClick:function(){return i.gotoStep(It)},current:ee,index:It,accentColor:ne,disabled:ee===It||K,showNumber:C,"data-tour-elem":"dot",className:eC(Rh.dot.base,Mi({},Rh.dot.active,ee===It)),"aria-label":tt.navDotAriaLabel})})),b&&Le.createElement(DC,{onClick:ee===h.length-1?R?k:function(){}:typeof Y=="function"?Y:this.nextStep,disabled:!R&&ee===h.length-1,inverted:!0,label:R&&ee===h.length-1?R:F||null})),$&&Le.createElement(xM,{onClick:k,className:"reactour__close",ariaLabel:y}))))):null}}])}(ve.Component),v_=function(n,s,i){if(i){var a=Math.max(document.documentElement.clientWidth,window.innerWidth||0),c=Math.max(document.documentElement.clientHeight,window.innerHeight||0),h=mv(i),g=h.width,b=h.height,$={top:c+10,right:a/2+9,bottom:c/2+9,left:a/2-g/2,width:0,height:0,w:a,h:c,helperPosition:"center"};return n&&($=Ek(n,s)),function(){return Lv(Lv({w:a,h:c,helperWidth:g,helperHeight:b,helperPosition:s.position},$),{},{inDOM:!!n})}}};bS.propTypes=HM;bS.defaultProps=WM;function VM(o){return/^script\.js\.global\./.test(o)}let GM=0;class wy extends Le.Component{monacoDiv=null;editor=null;monaco=window.monaco;insert="";originalCode;runningInstancesStr;monacoCounter=0;location;breakpoints;lastSearch="";typings={};decorations=[];constructor(n){super(n),this.state={name:"current",isDark:n.isDark||!1,language:n.language||"javascript",readOnly:n.readOnly||!1,alive:!0,check:!1,searchText:this.props.searchText||"",typingsLoaded:!1},this.runningInstancesStr=JSON.stringify(this.props.runningInstances),this.originalCode=n.code||"",this.monacoDiv=Le.createRef()}waitForMonaco(n){var i,a,c,h,g,b,$,y;let s=!!((h=(c=(a=(i=this.monaco)==null?void 0:i.languages)==null?void 0:a.typescript)==null?void 0:c.typescriptDefaults)!=null&&h.getCompilerOptions);if(!s||!this.props.runningInstances){if(this.monaco=window.monaco,s=!!((y=($=(b=(g=this.monaco)==null?void 0:g.languages)==null?void 0:b.typescript)==null?void 0:$.typescriptDefaults)!=null&&y.getCompilerOptions),this.monacoCounter++,!s&&this.monacoCounter<20){console.log("wait for monaco loaded"),setTimeout(()=>this.waitForMonaco(n),200);return}this.monacoCounter>=20&&console.error("Cannot load monaco!")}else n&&n()}loadTypings(n){if(!this.editor)return;n=n||this.props.runningInstances;const s=n&&Object.keys(n).find(i=>n&&n[i]);s&&this.props.socket.sendTo(s.replace("system.adapter.",""),"loadTypings",null).then(i=>{this.setState({alive:!0,check:!0,typingsLoaded:!0}),this.setTypeCheck(!0),i.typings?(this.typings=i.typings,this.setEditorTypings(this.state.name)):console.error(`failed to load typings: ${i.error}`)})}componentDidMount(){var i,a,c,h,g,b,$,y,w,C;let n=!!((h=(c=(a=(i=this.monaco)==null?void 0:i.languages)==null?void 0:a.typescript)==null?void 0:c.typescriptDefaults)!=null&&h.getCompilerOptions);if((!n||!this.props.runningInstances)&&(this.monaco=window.monaco,n=!!((y=($=(b=(g=this.monaco)==null?void 0:g.languages)==null?void 0:b.typescript)==null?void 0:$.typescriptDefaults)!=null&&y.getCompilerOptions),!n)){console.log("wait for monaco loaded..."),this.waitForMonaco(()=>this.componentDidMount());return}if(!this.editor&&n&&this.monaco){console.log("Init editor"),this.props.onRegisterSelect&&this.props.onRegisterSelect(()=>{var k;if(this.editor){const E=this.editor.getSelection();if(E)return(k=this.editor.getModel())==null?void 0:k.getValueInRange(E)}});const S=this.monaco.languages.typescript.typescriptDefaults.getCompilerOptions();S.allowJs=!0,S.checkJs=this.props.checkJs!==!1,S.noLib=!0,S.lib=[],S.useUnknownInCatchVariables=!1,S.moduleResolution=this.monaco.languages.typescript.ModuleResolutionKind.NodeJs,S.target=this.monaco.languages.typescript.ScriptTarget.ESNext,S.module=this.monaco.languages.typescript.ModuleKind.ESNext,S.allowNonTsExtensions=!0,this.monaco.languages.typescript.typescriptDefaults.setCompilerOptions(S),this.setTypeCheck(!1),(w=this.monacoDiv)!=null&&w.current&&(this.editor=this.monaco.editor.create((C=this.monacoDiv)==null?void 0:C.current,{lineNumbers:"on",scrollBeyondLastLine:!1,automaticLayout:!0,glyphMargin:!!this.props.breakpoints,colorDecorators:!0}),this.editor.onDidChangeModelContent(()=>this.onChange()),this.loadTypings(),this.props.onForceSave&&this.editor.addCommand(this.monaco.KeyMod.CtrlCmd|this.monaco.KeyCode.KeyS,()=>this.props.onForceSave&&this.props.onForceSave()),setTimeout(()=>{this.highlightText(this.state.searchText),this.location=this.props.location||void 0,this.breakpoints=this.props.breakpoints,this.showDecorators()}))}const s={selectOnLineNumbers:!0,scrollBeyondLastLine:!1,automaticLayout:!0,readOnly:this.state.readOnly,language:this.state.language,isDark:this.state.isDark};this.setEditorOptions(s),this.editor&&(this.editor.focus(),this.editor.setValue(this.originalCode),this.props.onToggleBreakpoint?this.editor.onMouseDown(S=>{var E;const k=S.target;this.props.onToggleBreakpoint&&((E=k.detail)==null?void 0:E.glyphMarginLeft)!==void 0&&k.position&&this.props.onToggleBreakpoint(k.position.lineNumber-1)}):this.editor.onMouseDown(()=>{}))}setEditorOptions(n){var s;n&&(n.language&&this.setEditorLanguage(n.language),this.editor&&(n.readOnly!==void 0&&this.editor.updateOptions({readOnly:n.readOnly}),n.lineWrap!==void 0&&this.editor.updateOptions({wordWrap:n.lineWrap?"on":"off"})),n.typeCheck!==void 0&&this.setTypeCheck(n.typeCheck),n.isDark!==void 0&&((s=this.monaco)==null||s.editor.setTheme(n.isDark?"vs-dark":"vs")))}componentWillUnmount(){this.editor&&(this.props.onRegisterSelect&&this.props.onRegisterSelect(null),this.editor.dispose(),this.editor=null)}setEditorLanguage(n){var i;if(!this.editor)return;const s=this.editor.getModel();if(s){const a=s.getValue(),c=s.uri.path,h=typeof c=="string"&&c.includes(".")?c.substring(0,c.lastIndexOf(".")):"index",g=n==="javascript"?"js":n==="typescript"?"ts":n;s.dispose();const b=n==="javascript"||n==="typescript"?"typescript":n,$=(i=this.monaco)==null?void 0:i.editor.createModel(a,b,this.monaco.Uri.from({scheme:window.location.protocol.replace(":",""),path:`${h}${GM++}.${g}`}));$&&this.editor.setModel($)}}setTypeCheck(n){var i,a;const s={noSemanticValidation:!this.state.alive||!n,noSyntaxValidation:!this.state.alive};(i=this.monaco)==null||i.languages.typescript.typescriptDefaults.setDiagnosticsOptions(s),(a=this.monaco)==null||a.languages.typescript.javascriptDefaults.setDiagnosticsOptions({noSemanticValidation:!this.state.alive||!n,noSyntaxValidation:!this.state.alive})}setEditorTypings(n=""){var c,h,g,b,$,y,w,C;const s=VM(n),i=`${n}.d.ts`,a=[];for(const S of Object.keys(this.typings))s&&(S==="global.d.ts"||S.startsWith("script.js.global")&&S!==i)||a.push({filePath:S,content:this.typings[S]});if((b=(g=(h=(c=this.monaco)==null?void 0:c.languages)==null?void 0:h.typescript)==null?void 0:g.typescriptDefaults)!=null&&b.setExtraLibs)this.monaco.languages.typescript.typescriptDefaults.setExtraLibs(a);else if((C=(w=(y=($=this.monaco)==null?void 0:$.languages)==null?void 0:y.typescript)==null?void 0:w.typescriptDefaults)!=null&&C.addExtraLib){const S=this.monaco.languages.typescript.typescriptDefaults.getExtraLibs();a.forEach(k=>{!S[k.filePath]&&this.monaco&&this.monaco.languages.typescript.typescriptDefaults.addExtraLib(k.content,k.filePath)})}}insertTextIntoEditor(n){if(!this.editor||!this.monaco)return;const s=this.editor.getSelection();if(s){const i=new this.monaco.Range(s.startLineNumber,s.startColumn,s.endLineNumber,s.endColumn);this.editor.executeEdits("",[{range:i,text:n,forceMoveMarkers:!0}])}this.editor.focus()}highlightText(n){var i;if(!this.editor||!this.monaco)return;const s=n?(i=this.editor.getModel())==null?void 0:i.findMatches(n,!0,!1,!1,null,!0):void 0;if(s!=null&&s.length)s.forEach(a=>{var c;return(c=this.editor)==null?void 0:c.setSelection(a.range)}),this.editor.revealLine(s[0].range.startLineNumber);else{const a=this.editor.getPosition();if(a){const c=a.lineNumber,h=a.column;this.editor.setSelection(new this.monaco.Range(c,h,c,h))}}}showDecorators(){var s;const n=[];if(this.location&&this.monaco&&(n.push({range:new this.monaco.Range(this.location.lineNumber+1,(this.location.columnNumber||0)+1,this.location.lineNumber+1,1e3),options:{isWholeLine:!1,className:this.props.isDark?"monacoCurrentLineDark":"monacoCurrentLine"}}),n.push({range:new this.monaco.Range(this.location.lineNumber+1,0,this.location.lineNumber+1,0),options:{isWholeLine:!0,className:this.props.isDark?"monacoCurrentFullLineDark":"monacoCurrentFullLine"}})),(s=this.breakpoints)==null||s.forEach(i=>{this.monaco&&n.push({range:new this.monaco.Range(i.location.lineNumber+1,0,i.location.lineNumber+1,100),options:{isWholeLine:!0,glyphMarginClassName:this.props.isDark?"monacoBreakPointDark":"monacoBreakPoint"}})}),this.editor){const i=this.editor.getModel();i&&(this.decorations=i.deltaDecorations(this.decorations,n))}}initNewScript(n,s){var i;this.setState({name:n}),this.originalCode=s||"",(i=this.editor)==null||i.setValue(s||""),this.highlightText(this.lastSearch),this.showDecorators(),this.setEditorTypings(n)}scrollToLineIfNeeded(n){if(this.editor){const s=this.editor.getVisibleRanges();(!s||!s[0]||s[0].startLineNumber>n||n>s[0].endLineNumber)&&this.editor.revealLineInCenter(n)}}UNSAFE_componentWillReceiveProps(n){const s={};this.state.name!==n.name&&this.initNewScript(n.name,n.code),JSON.stringify(n.runningInstances)!==this.runningInstancesStr&&(this.runningInstancesStr=JSON.stringify(n.runningInstances),this.state.typingsLoaded||this.loadTypings(n.runningInstances)),this.editor&&!n.changed&&(n.code!==this.originalCode||n.code!==this.editor.getValue())&&(this.originalCode=n.code||"",this.editor.setValue(this.originalCode),this.showDecorators(),this.location&&this.scrollToLineIfNeeded(this.location.lineNumber+1)),n.searchText!==this.lastSearch&&(this.lastSearch=n.searchText||"",this.highlightText(this.lastSearch)),JSON.stringify(n.location)!==JSON.stringify(this.location)&&JSON.stringify(n.breakpoints)!==JSON.stringify(this.breakpoints)?(this.location=n.location||void 0,this.breakpoints=n.breakpoints,this.showDecorators(),this.editor&&this.location&&this.scrollToLineIfNeeded(this.location.lineNumber+1)):JSON.stringify(n.breakpoints)!==JSON.stringify(this.breakpoints)?(this.breakpoints=n.breakpoints,this.showDecorators()):JSON.stringify(n.location)!==JSON.stringify(this.location)&&(this.location=n.location||void 0,this.showDecorators(),this.editor&&this.location&&this.scrollToLineIfNeeded(this.location.lineNumber+1)),this.state.language!==(n.language||"javascript")?(this.setState({language:n.language||"javascript"}),s.language=n.language||"javascript"):this.state.readOnly!==(n.readOnly||!1)?(this.setState({readOnly:n.readOnly||!1}),s.readOnly=n.readOnly):this.state.isDark!==(n.isDark||!1)&&(this.setState({isDark:n.isDark||!1}),s.isDark=n.isDark),this.setEditorOptions(s),this.insert!==n.insert&&(this.insert=n.insert||"",this.insert&&(console.log(`Insert text: ${this.insert}`),setTimeout(i=>{this.insertTextIntoEditor(i),setTimeout(()=>this.props.onInserted&&this.props.onInserted(),100)},100,this.insert)))}onChange(){!this.props.readOnly&&this.editor&&this.props.onChange&&this.props.onChange(this.editor.getValue())}render(){var n,s,i;return!((i=(s=(n=this.monaco)==null?void 0:n.languages)==null?void 0:s.typescript)!=null&&i.typescriptDefaults)||!this.props.runningInstances?(setTimeout(()=>{this.monaco=window.monaco,this.forceUpdate()},200),null):f.jsx("div",{ref:this.monacoDiv,style:{...this.props.style,width:"100%",height:"100%",overflow:"hidden",position:"relative"},children:!this.state.check&&f.jsx(D.Fab,{size:"small",title:I.I18n.t("Check is not active, because javascript adapter is disabled"),style:{bottom:10,right:10,opacity:.5,position:"absolute",zIndex:1,background:"red",color:"white"},color:"secondary",children:f.jsx(v1,{})})})}}var Ik={exports:{}};(function(o,n){(function(s,i){o.exports=i()})(ei,function(){var s={},i,a,c,h,g,b,$,y,w,C,S,k,E,R,F,M,L,T,V,K,Y,te,J,ne,Q,he,q,re,De,ee,Fe,Ce,Ze,pe,Te,ke,Xe,Ke,at,Ue,ut,rt,tt,It,Yt,Ut,Fn,Xt,en,Ot,Lt,vn,Ln,He,Ft,St,Tn,os,Ee,fe,ue,we,je,ie,Pe,vt,it,En,lt,yn,gn,Wn,Xn,Xs,as,An,Bt,jn,gs,Zs,zn,Vn,Fs,fi,Or,mc,Rr,al,bc,$c,Uu,ua,U,H,A,j,z,de,ye,$e,le,Be,Qe,xt,jt,tn,Ct,nn,bn,mt,kn,ls,Qs,da,Ar,To,xs,qt,er,Fi,cs,js,Eo,ha,ji,ko,Io,mi,zi,Hu,ll,pa,gp,vc,Om,ga,fp,Wu,yc,mp,bp,Rm,_c,cl,Vu,Am,$p,wc,Nm,Mm,fa,Lm,Sc,Vt,_n,Bm,Pm,Fm,jm,zm,Um,Gu,Ui,Gn,Cc,xo,vp,qu,vr,yp,_p,wp,Sp,Cp,Ku,tr,ul,zs,Hm,ma,bi,dl,Tc,wn,si,Ec,Wm,kc,Tp,Ep,kp,Ju,hl,Do,Vm,pl,Yu,gl,fl,ri,Ip,Ic,ba,xp,Xu,nr,ml,$a,Dp,Op,Gm,qm,Km,bl,Rp,Oo,$l,Zu,Qu,Ap,$i,vl,Hi,Np,Mp,va,Nr,Lp,Jm,Bp,Ym,Pp,Xm,Mr,oe,Se,me,Je,yt,Zt,Zn,bt,ed,yl,vs,xc,Fp,Wi,Vi,_l,Kt,Dc,td,wl,Zm,Qm,eb,Sl,Gi,Cl,Tl,Oc,jp,zp,Rc,El,ya,qi,_a,nd,tb,Ac,kl,Ro,sd,nb,Ki,Up,vi,ts,ys,Hp,sb,Ao,Wp,rd,Il,id,wa,xl,Sa,Nc,Ca,od,rb,ib,Vp,ad,Dl,No,ld,N,ii,yi,ns,_t,ob,ab,lb,Ji,cd,cb,ub,db,Gp,Lr,qp,ud,hb,pb,gb,_i,nt,sr,us,In,wi,Br,Ye,qn,yr,fb,Mo,dd,hd,Kp,Jp,pd,gd,Yp,Mc,Ol,Rl,mb,Lc,bb,Si,fd,Lo,_r,Xp,Zp,Al,Yi,Xi,md,Qp,Nl,eg,Bc,ds,bd,tg,oi,Bo,Ml,Po,Pc,xn,$d,Fo,ng,$b,Ta,sg,Ea,vd,rg,ig,ka,og,ag,Fc,yd,vb,yb,_b,lg,_d,wb,wd,cg,ug,Sd,Ll,dg,Cd,Td,hg,Ed,kd,Ia,Id,xd,pg,jc,Rt,gg,fg,xa,Dd,mg,bg,rr,Sb,zc,Od,Rd,$g,ir,Zi,Ad,vg,xe;i=function(e,t,r,l){if(!(e instanceof Ne)&&typeof e!="string"||`${e}`.trim()==="")throw Error('Invalid type "'+e+'". The type must be a non-empty string or a Blockly.registry.Type.');if(e=`${e}`.toLowerCase(),typeof t!="string"||t.trim()==="")throw Error('Invalid name "'+t+'". The name must be a non-empty string.');const p=t.toLowerCase();if(!r)throw Error("Can not register a null value");let v=Qi[e],O=Uc[e];if(v||(v=Qi[e]=Object.create(null),O=Uc[e]=Object.create(null)),a(e,r),!l&&v[p]&&v[p]!==r)throw Error('Name "'+p+'" with type "'+e+'" already registered.');v[p]=r,O[p]=t},a=function(e,t){switch(e){case String(Ne.FIELD):if(typeof t.fromJson!="function")throw Error('Type "'+e+'" must have a fromJson function')}},c=function(e,t){e=`${e}`.toLowerCase(),t=t.toLowerCase();const r=Qi[e];r&&r[t]?(delete Qi[e][t],delete Uc[e][t]):console.warn("Unable to unregister ["+t+"]["+e+"] from the registry.")},h=function(e,t,r){e=`${e}`.toLowerCase(),t=t.toLowerCase();const l=Qi[e];if(!l||!l[t]){if(t="Unable to find ["+t+"]["+e+"] in the registry.",r)throw Error(t+" You must require or register a "+e+" plugin.");return console.warn(t),null}return l[t]},g=function(e,t){return e=`${e}`.toLowerCase(),t=t.toLowerCase(),(e=Qi[e])?!!e[t]:!1},b=function(e,t,r){return h(e,t,r)},$=function(e,t,r){return h(e,t,r)},y=function(e,t,r){e=`${e}`.toLowerCase();var l=Qi[e];if(!l){if(l=`Unable to find [${e}] in the registry.`,r)throw Error(`${l} You must require or register a ${e} plugin.`);return console.warn(l),null}if(!t)return l;e=Uc[e],r=Object.create(null);for(const p of Object.keys(l))r[e[p]]=l[p];return r},w=function(e,t,r){return t=t.plugins[String(e)]||Pr,typeof t=="function"?t:b(e,t,r)},C=function(e,t,r,l){e=e+" was deprecated in "+t+" and will be deleted in "+r+".",l&&(e+=`
Use `+l+" instead."),wg.has(e)||(wg.add(e),console.warn(e))},S=function(){return"blockly-"+(Dy++).toString(36)},k=function(){return Tb.genUid()},E=function(e){return e.type===ge.BLOCK_CREATE},R=function(e){return e.type===ge.BLOCK_DELETE},F=function(e){return e.type===ge.BLOCK_CHANGE},M=function(e){return e.type===ge.BLOCK_FIELD_INTERMEDIATE_CHANGE},L=function(e){return e.type===ge.BLOCK_MOVE},T=function(e){return e.type===ge.CLICK},V=function(e){return e.type===ge.BUBBLE_OPEN},K=function(e){return e.type===ge.VIEWPORT_CHANGE},s.setRecordUndo$$module$build$src$core$events$utils=function(e){Hc=e},Y=function(){return Hc},te=function(e){ai.fireInternal(e)},J=function(e){if(re()){if(!Kn.length)try{requestAnimationFrame(()=>{setTimeout(ne,0)})}catch{setTimeout(ne,0)}Q(e)}},ne=function(){const e=he(Kn,!0);Kn.length=0;for(const t of e){if(!t.workspaceId)continue;let r;(r=pe(t.workspaceId))==null||r.fireChangeListener(t)}},Q=function(e){if(F(e)&&e.element==="mutation"){let t;for(t=Kn.length;0<t;t--){const r=Kn[t-1];if(r.group!==e.group||r.workspaceId!==e.workspaceId||!L(r)||r.newParentId!==e.blockId)break}Kn.splice(t,0,e)}else Kn.push(e)},he=function(e,t=!0){t||(C("filter(queue, /*forward=*/false)","v11.2","v12"),e=e.slice().reverse());const r=[];for(const l of e)if(e=r[r.length-1],!l.isNull())if(e&&e.workspaceId===l.workspaceId&&e.group===l.group)if(L(l)&&L(e)&&l.blockId===e.blockId){if(e.newParentId=l.newParentId,e.newInputName=l.newInputName,e.newCoordinate=l.newCoordinate,e.reason||l.reason){let p,v;e.reason=Array.from(new Set(((p=e.reason)!=null?p:[]).concat((v=l.reason)!=null?v:[])))}}else F(l)&&F(e)&&l.blockId===e.blockId&&l.element===e.element&&l.name===e.name?e.newValue=l.newValue:K(l)&&K(e)?(e.viewTop=l.viewTop,e.viewLeft=l.viewLeft,e.scale=l.scale,e.oldScale=l.oldScale):T(l)&&V(e)||r.push(l);else r.push(l);return e=r.filter(l=>!l.isNull()),t||e.reverse(),e},q=function(){for(let e=0,t;t=Kn[e];e++)t.recordUndo=!1},s.disable$$module$build$src$core$events$utils=function(){Ld++},s.enable$$module$build$src$core$events$utils=function(){Ld--},re=function(){return Ld===0},s.getGroup$$module$build$src$core$events$utils=function(){return Sg},s.setGroup$$module$build$src$core$events$utils=function(e){ai.setGroupInternal(e)},De=function(e){Sg=typeof e=="boolean"?e?k():"":e},ee=function(e){const t=[];e=e.getDescendants(!1);for(let r=0,l;l=e[r];r++)t[r]=l.id;return t},Fe=function(e,t){const r=Ce(e.type);if(!r)throw Error("Unknown event type.");return r.fromJson(e,t)},Ce=function(e){const t=b(Ne.EVENT,e);if(!t)throw Error(`Event type ${e} not found in registry.`);return t},Ze=function(e){if((L(e)||E(e))&&e.workspaceId){var t=pe(e.workspaceId);if(!e.blockId)throw Error("Encountered a blockEvent without a proper blockId");if(e=t.getBlockById(e.blockId)){const r=Hc;try{Hc=!1;const l=e.getParent();if(l&&!l.hasDisabledReason(Bd)){const p=e.getDescendants(!1);for(let v=0,O;O=p[v];v++)O.setDisabledReason(!1,Bd)}else if((e.outputConnection||e.previousConnection)&&!t.isDragging())do e.setDisabledReason(!0,Bd),e=e.getNextBlock();while(e)}finally{Hc=r}}}},pe=function(e){return Wc[e]||null},Te=function(){const e=[];for(const t in Wc)e.push(Wc[t]);return e},ke=function(e){Wc[e.id]=e},Xe=function(e){delete Wc[e.id]},Ke=function(){return Eb},at=function(e){Eb=e},Ue=function(){return Ci},s.setSelected$$module$build$src$core$common=function(e){if(Ci!==e){var t,r,l,p,v,O,G=new(Ce(ge.SELECTED))((l=(t=Ci)==null?void 0:t.id)!=null?l:null,(p=e==null?void 0:e.id)!=null?p:null,(O=(v=e==null?void 0:e.workspace.id)!=null?v:(r=Ci)==null?void 0:r.workspace.id)!=null?O:"");te(G);var _e;(_e=Ci)==null||_e.unselect(),Ci=e;var qe;(qe=Ci)==null||qe.select()}},ut=function(){return Da},rt=function(e){Da=e},tt=function(e){for(;e.options.parentWorkspace;)e=e.options.parentWorkspace;const t=e.getParentSvg(),r=e.getCachedParentSvgSize();var l=t.parentElement;if(l instanceof HTMLElement){var p=l.offsetWidth;l=l.offsetHeight,r.width!==p&&(t.setAttribute("width",p+"px"),e.setCachedParentSvgSize(p,null)),r.height!==l&&(t.setAttribute("height",l+"px"),e.setCachedParentSvgSize(null,l)),e.resize()}},It=function(e,t){const r=Object.create(null),l=e.getDescendants(!0);t&&(e=e.getNextBlock())&&(e=l.indexOf(e),l.splice(e,l.length-e));for(let p=0,v;v=l[p];p++)r[v.type]?r[v.type]++:r[v.type]=1;return r},Yt=function(e){return function(){this.jsonInit(e)}},Ut=function(e){Cg.defineBlocksWithJsonArrayInternal(e)},Fn=function(e){s.defineBlocks$$module$build$src$core$common(s.createBlockDefinitionsFromJsonArray$$module$build$src$core$common(e))},s.createBlockDefinitionsFromJsonArray$$module$build$src$core$common=function(e){const t={};for(let r=0;r<e.length;r++){const l=e[r];if(!l){console.warn(`Block definition #${r} in JSON array is ${l}. Skipping`);continue}const p=l.type;p?t[p]={init:Yt(l)}:console.warn(`Block definition #${r} in JSON array is missing a type attribute. Skipping.`)}return t},s.defineBlocks$$module$build$src$core$common=function(e){for(const t of Object.keys(e)){const r=e[t];t in or&&console.warn(`Block definition "${t}" overwrites previous definition.`),or[t]=r}},Xt=function(e,t){en(),Na=setTimeout(function(){t&&t.handleRightClick(e)},kb)},en=function(){Na&&(clearTimeout(Na),Na=0)},Ot=function(){Aa=null},Lt=function(e){return!e.type.startsWith("pointer")||e instanceof PointerEvent&&Ln(e)},vn=function(e){return`${e.pointerId}`},Ln=function(e){const t=vn(e);return Aa?Aa===t:e.type==="pointerdown"?(Aa=t,!0):!1},He=function(e,t,r,l,p){function v(G){(p||Lt(G))&&(r?l.call(r,G):l(G))}const O=[];if(t in jo)for(let G=0;G<jo[t].length;G++){const _e=jo[t][G];e.addEventListener(_e,v,!1),O.push([e,_e,v])}else e.addEventListener(t,v,!1),O.push([e,t,v]);return O},Ft=function(e,t,r,l){function p(O){r?l.call(r,O):l(O)}const v=[];if(t in jo)for(let O=0;O<jo[t].length;O++){const G=jo[t][O];e.addEventListener(G,p,!1),v.push([e,G,p])}else e.addEventListener(t,p,!1),v.push([e,t,p]);return v},St=function(e){const t=e[e.length-1][2];for(;e.length;){const[r,l,p]=e.pop();r.removeEventListener(l,p,!1)}return t},Tn=function(e){if(e.target instanceof HTMLElement){if(e.target.isContentEditable||e.target.getAttribute("data-is-text-input")==="true")return!0;if(e.target instanceof HTMLInputElement)return e=e.target,e.type==="text"||e.type==="number"||e.type==="email"||e.type==="password"||e.type==="search"||e.type==="tel"||e.type==="url";if(e.target instanceof HTMLTextAreaElement)return!0}return!1},os=function(e){return e.ctrlKey&&qc?!0:e.button===2},Ee=function(e,t,r){const l=t.createSVGPoint();return l.x=e.clientX,l.y=e.clientY,r||(r=t.getScreenCTM().inverse()),l.matrixTransform(r)},fe=function(e){switch(e.deltaMode){default:return{x:e.deltaX,y:e.deltaY};case 1:return{x:e.deltaX*Kc,y:e.deltaY*Kc};case 2:return{x:e.deltaX*Ma,y:e.deltaY*Ma}}},ue=function(e,t){return t=e.indexOf(t),t===-1?!1:(e.splice(t,1),!0)},we=function(e){if(Ng)throw Error("CSS already injected");Yc+=`
`+e},je=function(e,t){Ng||(Ng=!0,e&&(e=t.replace(/[\\/]$/,""),t=Yc.replace(/<<<PATH>>>/g,e),Yc="",e=document.createElement("style"),e.id="blockly-common-style",t=document.createTextNode(t),e.appendChild(t),document.head.insertBefore(e,document.head.firstChild)))},ie=function(e,t,r){e=document.createElementNS(Xc,`${e}`);for(const l in t)e.setAttribute(l,`${t[l]}`);return r&&r.appendChild(e),e},Pe=function(e,t){return t=t.split(" "),t.every(r=>e.classList.contains(r))?!1:(e.classList.add(...t),!0)},vt=function(e,t){e.classList.remove(...t.split(" "))},it=function(e,t){return t=t.split(" "),t.every(r=>!e.classList.contains(r))?!1:(e.classList.remove(...t),!0)},En=function(e,t){return e.classList.contains(t)},lt=function(e){return e&&e.parentNode?e.parentNode.removeChild(e):null},yn=function(e,t){const r=t.nextSibling;if(t=t.parentNode,!t)throw Error("Reference node has no parent.");r?t.insertBefore(e,r):t.appendChild(e)},gn=function(e,t){e.style.transform=t,e.style["-webkit-transform"]=t},Wn=function(){Mg++,Fr||(Fr=Object.create(null))},Xn=function(){Mg--,Mg||(Fr=null)},Xs=function(e){const t=e.textContent+`
`+e.className.baseVal;let r;if(Fr&&(r=Fr[t]))return r;try{r=e.getComputedTextLength()}catch{return 8*e.textContent.length}return Fr&&(Fr[t]=r),r},as=function(e,t,r,l){return An(e,t+"pt",r,l)},An=function(e,t,r,l){const p=e.textContent;e=p+`
`+e.className.baseVal;var v;return Fr&&(v=Fr[e])||(zd||(v=document.createElement("canvas"),v.className="blocklyComputeCanvas",document.body.appendChild(v),zd=v.getContext("2d")),zd.font=r+" "+t+" "+l,v=p?zd.measureText(p).width:0,Fr&&(Fr[e]=v)),v},Bt=function(e,t,r,l){const p=document.createElement("span");p.style.font=r+" "+t+" "+l,p.textContent=e,e=document.createElement("div"),e.style.width="1px",e.style.height="0",t=document.createElement("div"),t.style.display="flex",t.style.position="fixed",t.style.top="0",t.style.left="0",t.appendChild(p),t.appendChild(e),document.body.appendChild(t),r={height:0,baseline:0};try{t.style.alignItems="baseline",r.baseline=e.offsetTop-p.offsetTop,t.style.alignItems="flex-end",r.height=e.offsetTop-p.offsetTop}finally{document.body.removeChild(t)}return r},jn=function(e){return Ob.getSizeInternal(e)},gs=function(e){if(zn(e,"display")!=="none")return Zs(e);const t=e.style,r=t.display,l=t.visibility,p=t.position;t.visibility="hidden",t.position="absolute",t.display="inline";const v=e.offsetWidth;return e=e.offsetHeight,t.display=r,t.position=p,t.visibility=l,new Pt(v,e)},Zs=function(e){return new Pt(e.offsetWidth,e.offsetHeight)},zn=function(e,t){return e=window.getComputedStyle(e),e[t]||e.getPropertyValue(t)},Vn=function(e){const t=new Ae(0,0);e=e.getBoundingClientRect();var r=document.documentElement;return r=new Ae(window.pageXOffset||r.scrollLeft,window.pageYOffset||r.scrollTop),t.x=e.left+r.x,t.y=e.top+r.y,t},Fs=function(){const e=document.body,t=document.documentElement;return new Ae(e.scrollLeft||t.scrollLeft,e.scrollTop||t.scrollTop)},fi=function(e){const t=parseFloat(zn(e,"borderLeftWidth")),r=parseFloat(zn(e,"borderRightWidth")),l=parseFloat(zn(e,"borderTopWidth"));return e=parseFloat(zn(e,"borderBottomWidth")),new Tt(l,e,t,r)},Or=function(e,t,r){e=mc(e,t,r),t.scrollLeft=e.x,t.scrollTop=e.y},mc=function(e,t,r){var l=Vn(e),p=Vn(t),v=fi(t);const O=l.x-p.x-v.left;return l=l.y-p.y-v.top,p=Zs(e),e=t.clientWidth-p.width,p=t.clientHeight-p.height,v=t.scrollLeft,t=t.scrollTop,r?(v+=O-e/2,t+=l-p/2):(v+=Math.min(O,Math.max(O-e,0)),t+=Math.min(l,Math.max(l-p,0))),new Ae(v,t)},Rr=function(e){const t=new Ae(0,0);var r=e.x&&e.getAttribute("x");const l=e.y&&e.getAttribute("y");return r&&(t.x=parseInt(r)),l&&(t.y=parseInt(l)),(r=(r=e.getAttribute("transform"))&&r.match(Rb))&&(t.x+=Number(r[1]),r[3]&&(t.y+=Number(r[3]))),(e=e.getAttribute("style"))&&e.includes("translate")&&(e=e.match(Ab))&&(t.x+=Number(e[1]),e[3]&&(t.y+=Number(e[3]))),t},al=function(e){let t=0,r=0;for(;e;){const l=Rr(e);if(t+=l.x,r+=l.y,(" "+(e.getAttribute("class")||"")+" ").includes(" injectionDiv "))break;e=e.parentNode}return new Ae(t,r)},bc=function(){const e=Fs();return new Tt(e.y,document.documentElement.clientHeight+e.y,e.x,document.documentElement.clientWidth+e.x)},$c=function(){const e=document.documentElement,t=window;return new Ae(t.pageXOffset||e.scrollLeft,t.pageYOffset||e.scrollTop)},Uu=function(e,t){var r=t.x;t=t.y;const l=e.getInjectionDiv().getBoundingClientRect();return r=new Ae(r-l.left,t-l.top),t=e.getOriginOffsetInPixels(),Ae.difference(r,t).scale(1/e.scale)},ua=function(e,t){var r=t.scale(e.scale);t=r.x,r=r.y;const l=e.getInjectionDiv().getBoundingClientRect();return e=e.getOriginOffsetInPixels(),new Ae(t+l.left+e.x,r+l.top+e.y)},U=function(e){({document:Hd=Hd,DOMParser:Qc=Qc,XMLSerializer:jl=jl}=e),Ud=new Qc,Lg=new jl},s.createElement$$module$build$src$core$utils$xml=function(e){return Hd.createElementNS(Bg,e)},s.createTextNode$$module$build$src$core$utils$xml=function(e){return Hd.createTextNode(e)},s.textToDom$$module$build$src$core$utils$xml=function(e){let t=Ud.parseFromString(e,"text/xml");if(t&&t.documentElement&&!t.getElementsByTagName("parsererror").length)return t.documentElement;if((t=Ud.parseFromString(e,"text/html"))&&t.body.firstChild&&t.body.firstChild.nodeName.toLowerCase()==="xml")return t.body.firstChild;throw Error(`DOMParser was unable to parse: ${e}`)},H=function(e){return A(Lg.serializeToString(e))},A=function(e){return e.replace(Oy,t=>`&#${t.charCodeAt(0)};`)},j=function(e){return e?((e instanceof Element||typeof e=="string")&&(e=jt(e),e=Be(e)),z(e),e):null},z=function(e){const t=e.kind;if(e=e.contents,t&&t!==zl&&t!==Wd)throw Error("Invalid toolbox kind "+t+". Please supply either "+zl+" or "+Wd);if(!e)throw Error("Toolbox must have a contents attribute.")},de=function(e){return e?e.contents?e.contents:Array.isArray(e)&&0<e.length&&!e[0].nodeType?e:Qe(e):[]},ye=function(e){return Pg.hasCategoriesInternal(e)},$e=function(e){if(!e)return!1;const t=e.kind;return t?t===Wd:!!e.contents.filter(r=>r.kind.toUpperCase()==="CATEGORY").length},le=function(e){return e&&e.contents?!!e.contents.filter(function(t){return t.kind.toUpperCase()==="CATEGORY"}).length:!1},Be=function(e){const t={contents:Qe(e)};return e instanceof Node&&xt(e,t),t},Qe=function(e){const t=[];let r=e.childNodes;r||(r=e);for(let l=0,p;p=r[l];l++){if(!p.tagName)continue;e={};const v=p.tagName.toUpperCase();e.kind=v,v==="BLOCK"?e.blockxml=p:p.childNodes&&0<p.childNodes.length&&(e.contents=Qe(p)),xt(p,e),t.push(e)}return t},xt=function(e,t){for(let r=0;r<e.attributes.length;r++){const l=e.attributes[r];l.nodeName.includes("css-")?(t.cssconfig=t.cssconfig||{},t.cssconfig[l.nodeName.replace("css-","")]=l.value):t[l.nodeName]=l.value}},jt=function(e){let t=null;if(e)if(typeof e=="string"){if(t=s.textToDom$$module$build$src$core$utils$xml(e),t.nodeName.toLowerCase()!=="xml")throw TypeError("Toolbox should be an <xml> document.")}else e instanceof Element&&(t=e);return t},tn=function(e,t,r,l,p,v){const O=v.scrollbar&&v.scrollbar.canScrollVertically();return e.horizontal===La.LEFT?(r=p.absoluteMetrics.left+r,O&&v.RTL&&(r+=Un.scrollbarThickness)):(r=p.absoluteMetrics.left+p.viewMetrics.width-t.width-r,O&&!v.RTL&&(r-=Un.scrollbarThickness)),e.vertical===jr.TOP?e=p.absoluteMetrics.top+l:(e=p.absoluteMetrics.top+p.viewMetrics.height-t.height-l,v.scrollbar&&v.scrollbar.canScrollHorizontally()&&(e-=Un.scrollbarThickness)),new Tt(e,e+t.height,r,r+t.width)},Ct=function(e,t){return{horizontal:t.toolboxMetrics.position===wt.LEFT||e.horizontalLayout&&!e.RTL?La.RIGHT:La.LEFT,vertical:t.toolboxMetrics.position===wt.BOTTOM?jr.TOP:jr.BOTTOM}},nn=function(e,t,r,l){const p=e.left,v=e.right-e.left,O=e.bottom-e.top;for(let G=0;G<l.length;G++){const _e=l[G];e.intersects(_e)&&(e=r===ws.UP?_e.top-O-t:_e.bottom+t,e=new Tt(e,e+O,p,p+v),G=-1)}return e},bn=function(e,t){i(Ne.SERIALIZER,e,t)},mt=function(e){c(Ne.SERIALIZER,e)},kn=function(e,{addCoordinates:t=!1,saveIds:r=!0}={}){const l=e.workspace,p=Object.create(null);return p.height=e.getSize().height,p.width=e.getSize().width,r&&(p.id=e.id),t&&(t=e.getRelativeToSurfaceXY(),p.x=l.RTL?l.getWidth()-t.x:t.x,p.y=t.y),e.getText()&&(p.text=e.getText()),e.isCollapsed()&&(p.collapsed=!0),e.isOwnEditable()||(p.editable=!1),e.isOwnMovable()||(p.movable=!1),e.isOwnDeletable()||(p.deletable=!1),p},ls=function(e,t,{recordUndo:r=!1}={}){const l=Y();if(s.setRecordUndo$$module$build$src$core$events$utils(r),r=t.newComment(e.id),e.text!==void 0&&r.setText(e.text),e.x!==void 0||e.y!==void 0){const v=r.getRelativeToSurfaceXY();let O,G=(O=e.x)!=null?O:v.x;G=t.RTL?t.getWidth()-G:G;var p;t=(p=e.y)!=null?p:v.y,r.moveTo(new Ae(G,t))}if(e.width!==void 0||e.height){p=r.getSize();let v,O;r.setSize(new Pt((v=e.width)!=null?v:p.width,(O=e.height)!=null?O:p.height))}return e.collapsed!==void 0&&r.setCollapsed(e.collapsed),e.editable!==void 0&&r.setEditable(e.editable),e.movable!==void 0&&r.setMovable(e.movable),e.deletable!==void 0&&r.setDeletable(e.deletable),s.setRecordUndo$$module$build$src$core$events$utils(l),r},Qs=function(e,t){i(Ne.PASTER,e,t)},da=function(e){c(Ne.PASTER,e)},Ar=function(e){const t=e.workspace,r=e.getRelativeToSurfaceXY(),l=new Ae(0,0),p=t.getTopComments(!1).filter(v=>v.id!==e.id).map(v=>v.getRelativeToSurfaceXY());for(;To(Ae.sum(r,l),p);)l.translate(t.RTL?-30:30,30);e.moveTo(Ae.sum(r,l))},To=function(e,t){return t.some(r=>1>=Math.abs(r.x-e.x)&&1>=Math.abs(r.y-e.y))},xs=function(e,t){e.setAttribute(jb,t)},qt=function(e,t,r){Array.isArray(r)&&(r=r.join(" ")),e.setAttribute(Fb+t,`${r}`)},er=function(e){return e.saveState!==void 0&&e.loadState!==void 0},Fi=function(e){return ha(e),Eo()?(ji(),Promise.resolve()):(Ul||(Ul=new Promise(t=>{Vg=t,zb=window.requestAnimationFrame(()=>{ji(),t()})})),Ul)},cs=function(){return Ul||Promise.resolve()},js=function(e){e||window.cancelAnimationFrame(zb),ji(e),!e&&Vg&&Vg()},Eo=function(){return Db},ha=function(e){Wg.add(e),lr.set(e,s.getGroup$$module$build$src$core$events$utils());const t=e.getParent();t?ha(t):Jd.add(e)},ji=function(e){const t=e?new Set([e]):new Set([...Jd].map(v=>v.workspace)),r=[...Jd].filter(Io).filter(v=>t.has(v.workspace));for(var l of r)mi(l);for(const v of t)v.resizeContents();for(var p of r)l=p.getRelativeToSurfaceXY(),p.updateComponentLocations(l);for(const v of r)p=s.getGroup$$module$build$src$core$events$utils(),(l=lr.get(v))&&s.setGroup$$module$build$src$core$events$utils(l),v.bumpNeighbours(),s.setGroup$$module$build$src$core$events$utils(p);for(const v of r)ko(v);e||(Ul=null)},ko=function(e){Jd.delete(e),Wg.delete(e),lr.delete(e);for(const t of e.getChildren(!1))ko(t)},Io=function(e){return!e.isDisposed()&&!e.getParent()},mi=function(e){if(Wg.has(e)&&e.initialized){for(const t of e.getChildren(!1))mi(t);e.renderEfficiently()}},zi=function(e,t){Ub(e,t)},Hu=function(e){Ub=e},ll=function(e,t){Vb.confirmInternal(e,t)},pa=function(e,t){Hb(e,t)},gp=function(e){Hb=e},vc=function(e,t,r){Wb(e,t,r)},Om=function(e){Wb=e},ga=function(e){return e.getProcedureDef!==void 0},fp=function(e){return e.getProcedureCall!==void 0&&e.renameProcedure!==void 0},Wu=function(e){return e.getVariableModel!==void 0},s.allUsedVarModels$$module$build$src$core$variables=function(e){e=e.getAllBlocks(!1);const t=new Set;for(let r=0;r<e.length;r++){const l=e[r].getVarModels();if(l)for(let p=0;p<l.length;p++){const v=l[p];v.getId()&&t.add(v)}}return Array.from(t.values())},s.allDeveloperVariables$$module$build$src$core$variables=function(e){e=e.getAllBlocks(!1);const t=new Set;for(let l=0,p;p=e[l];l++){var r=p.getDeveloperVariables;if(r){r=r();for(let v=0;v<r.length;v++)t.add(r[v])}}return Array.from(t.values())},yc=function(e){let t=[];const r=document.createElement("button");return r.setAttribute("text","%{BKY_NEW_VARIABLE}"),r.setAttribute("callbackKey","CREATE_VARIABLE"),e.registerButtonCallback("CREATE_VARIABLE",function(l){cl(l.getTargetWorkspace())}),t.push(r),e=mp(e),t=t.concat(e)},mp=function(e){e=e.getVariablesOfType("");const t=[];if(0<e.length){var r=e[e.length-1];if(or.variables_set){var l=s.createElement$$module$build$src$core$utils$xml("block");l.setAttribute("type","variables_set"),l.setAttribute("gap",or.math_change?"8":"24"),l.appendChild(fa(r)),t.push(l)}if(or.math_change&&(l=s.createElement$$module$build$src$core$utils$xml("block"),l.setAttribute("type","math_change"),l.setAttribute("gap",or.variables_get?"20":"8"),l.appendChild(fa(r)),r=s.textToDom$$module$build$src$core$utils$xml('<value name="DELTA"><shadow type="math_number"><field name="NUM">1</field></shadow></value>'),l.appendChild(r),t.push(l)),or.variables_get){e.sort(ru.compareByName);for(let p=0,v;v=e[p];p++)r=s.createElement$$module$build$src$core$utils$xml("block"),r.setAttribute("type","variables_get"),r.setAttribute("gap","8"),r.appendChild(fa(v)),t.push(r)}}return t},bp=function(e){return qb.generateUniqueNameInternal(e)},Rm=function(e){return _c(Jg.charAt(0),e.getAllVariableNames())},_c=function(e,t){if(!t.length)return e;const r=Jg;let l="",p=r.indexOf(e);for(;;){let v=!1;for(let O=0;O<t.length;O++)if(t[O].toLowerCase()===e){v=!0;break}if(!v)break;p++,p===r.length&&(p=0,l=`${Number(l)+1}`),e=r.charAt(p)+l}return e},cl=function(e,t,r){function l(v){Vu(s.Msg$$module$build$src$core$msg.NEW_VARIABLE_TITLE,v,function(O){if(O){var G=$p(O,e);if(G){if(G.type===p)var _e=s.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS.replace("%1",G.name);else _e=s.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE,_e=_e.replace("%1",G.name).replace("%2",G.type);zi(_e,function(){l(O)})}else e.createVariable(O,p),t&&t(O)}else t&&t(null)})}const p=r||"";l("")},s.renameVariable$$module$build$src$core$variables=function(e,t,r){function l(p){const v=s.Msg$$module$build$src$core$msg.RENAME_VARIABLE_TITLE.replace("%1",t.name);Vu(v,p,function(O){if(O){var G=Am(O,t.type,e),_e=wc(t.name,O,e);if(G||_e){var qe="";G?qe=s.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE.replace("%1",G.name).replace("%2",G.type):_e&&(qe=s.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS_FOR_A_PARAMETER.replace("%1",O).replace("%2",_e)),zi(qe,function(){l(O)})}else e.renameVariableById(t.getId(),O),r&&r(O)}else r&&r(null)})}l("")},Vu=function(e,t,r){vc(e,t,function(l){l&&(l=l.replace(/[\s\xa0]+/g," ").trim(),l===s.Msg$$module$build$src$core$msg.RENAME_VARIABLE||l===s.Msg$$module$build$src$core$msg.NEW_VARIABLE)&&(l=null),r(l)})},Am=function(e,t,r){r=r.getVariableMap().getAllVariables(),e=e.toLowerCase();for(let l=0,p;p=r[l];l++)if(p.name.toLowerCase()===e&&p.type!==t)return p;return null},$p=function(e,t){t=t.getVariableMap().getAllVariables(),e=e.toLowerCase();for(let r=0,l;l=t[r];r++)if(l.name.toLowerCase()===e)return l;return null},wc=function(e,t,r){return r.getProcedureMap().getProcedures().length?Nm(e,t,r):Mm(e,t,r)},Nm=function(e,t,r){e=e.toLowerCase(),t=t.toLowerCase(),r=r.getProcedureMap().getProcedures();for(const p of r){var l=p.getParameters().filter(Wu).map(v=>v.getVariableModel().name);if(l&&(r=l.some(v=>v.toLowerCase()===e),l=l.some(v=>v.toLowerCase()===t),r&&l))return p.getName()}return null},Mm=function(e,t,r){e=e.toLowerCase(),t=t.toLowerCase(),r=r.getAllBlocks(!1);for(const p of r){if(!ga(p))continue;r=p.getProcedureDef();var l=r[1];const v=l.some(O=>O.toLowerCase()===e);if(l=l.some(O=>O.toLowerCase()===t),v&&l)return r[0]}return null},fa=function(e){const t=s.createElement$$module$build$src$core$utils$xml("field");return t.setAttribute("name","VAR"),t.setAttribute("id",e.getId()),t.setAttribute("variabletype",e.type),e=s.createTextNode$$module$build$src$core$utils$xml(e.name),t.appendChild(e),t},s.getOrCreateVariablePackage$$module$build$src$core$variables=function(e,t,r,l){let p=s.getVariable$$module$build$src$core$variables(e,t,r,l);return p||(p=Lm(e,t,r,l)),p},s.getVariable$$module$build$src$core$variables=function(e,t,r,l){const p=e.getPotentialVariableMap();let v=null;if(t&&(v=e.getVariableById(t),!v&&p&&(v=p.getVariableById(t)),v))return v;if(r){if(l===void 0)throw Error("Tried to look up a variable by name without a type");v=e.getVariable(r,l),!v&&p&&(v=p.getVariable(r,l))}return v},Lm=function(e,t,r,l){const p=e.getPotentialVariableMap();return r||(r=bp(e.isFlyout?e.targetWorkspace:e)),p?p.createVariable(r,l,t):e.createVariable(r,l,t)},Sc=function(e,t){e=e.getAllVariables();const r=[];if(t.length!==e.length)for(let l=0;l<e.length;l++){const p=e[l];t.includes(p)||r.push(p)}return r},Vt=function(e,{addCoordinates:t=!1,addInputBlocks:r=!0,addNextBlocks:l=!0,doFullSerialization:p=!0,saveIds:v=!0}={}){if(e.isInsertionMarker())return null;const O={type:e.type,id:v?e.id:void 0};return t&&Bm(e,O),_n(e,O),Pm(e,O,p),Fm(e,O,p),jm(e,O,p),r&&zm(e,O,p,v),l&&Um(e,O,p,v),O},_n=function(e,t){e.isCollapsed()&&(t.collapsed=!0),e.isEnabled()||(t.disabledReasons=Array.from(e.getDisabledReasons())),e.isOwnDeletable()||(t.deletable=!1),e.isOwnMovable()||(t.movable=!1),e.isOwnEditable()||(t.editable=!1),e.inputsInline!==void 0&&e.inputsInline!==e.inputsInlineDefault&&(t.inline=e.inputsInline),e.data&&(t.data=e.data)},Bm=function(e,t){const r=e.workspace;e=e.getRelativeToSurfaceXY(),t.x=Math.round(r.RTL?r.getWidth()-e.x:e.x),t.y=Math.round(e.y)},Pm=function(e,t,r){e.saveExtraState?(e=e.saveExtraState(r),e!==null&&(t.extraState=e)):e.mutationToDom&&(e=e.mutationToDom(),e!==null&&(t.extraState=vi(e).replace(' xmlns="https://developers.google.com/blockly/xml"',"")))},Fm=function(e,t,r){const l=Object.create(null);for(const p of e.getIcons())er(p)&&(e=p.saveState(r))&&(l[p.getType().toString()]=e);Object.keys(l).length&&(t.icons=l)},jm=function(e,t,r){const l=Object.create(null);for(let p=0;p<e.inputList.length;p++){const v=e.inputList[p];for(let O=0;O<v.fieldRow.length;O++){const G=v.fieldRow[O];G.isSerializable()&&(l[G.name]=G.saveState(r))}}Object.keys(l).length&&(t.fields=l)},zm=function(e,t,r,l){const p=Object.create(null);for(let v=0;v<e.inputList.length;v++){const O=e.inputList[v];if(!O.connection)continue;const G=Gu(O.connection,r,l);G&&(p[O.name]=G)}Object.keys(p).length&&(t.inputs=p)},Um=function(e,t,r,l){e.nextConnection&&(e=Gu(e.nextConnection,r,l))&&(t.next=e)},Gu=function(e,t,r){const l=e.getShadowState(!0);if(e=e.targetBlock(),!l&&!e)return null;const p=Object.create(null);return l&&(p.shadow=l),e&&!e.isShadow()&&(p.block=Vt(e,{doFullSerialization:t,saveIds:r})),p},Ui=function(e,t,{recordUndo:r=!1}={}){return e=Gn(e,t,{recordUndo:r}),t.rendered&&js(),e},Gn=function(e,t,{parentConnection:r,isShadow:l=!1,recordUndo:p=!1}={}){const v=Y();s.setRecordUndo$$module$build$src$core$events$utils(p),(p=s.getGroup$$module$build$src$core$events$utils())||s.setGroup$$module$build$src$core$events$utils(!0),s.disable$$module$build$src$core$events$utils();const O=t.getAllVariables();let G;try{G=Cc(e,t,{parentConnection:r,isShadow:l})}finally{s.enable$$module$build$src$core$events$utils()}if(xo(t,O),re()&&te(new(Ce(ge.BLOCK_CREATE))(G)),s.setGroup$$module$build$src$core$events$utils(p),s.setRecordUndo$$module$build$src$core$events$utils(v),t.rendered){const _e=G;setTimeout(()=>{_e.disposed||_e.setConnectionTracking(!0)},1)}return G},Cc=function(e,t,{parentConnection:r,isShadow:l=!1}={}){if(!e.type)throw new Kb(e);const p=t.newBlock(e.type,e.id);return p.setShadow(l),vp(p,e),qu(p,e),vr(p,e),yp(r,p,e),_p(p,e),wp(p,e),Sp(p,e),Cp(p,e),tr(p,t.rendered),p},xo=function(e,t){if(re())for(e=Sc(e,t),t=0;t<e.length;t++){const r=e[t];te(new(Ce(ge.VAR_CREATE))(r))}},vp=function(e,t){let r=t.x===void 0?0:t.x;t=t.y===void 0?0:t.y;const l=e.workspace;r=l.RTL?l.getWidth()-r:r,e.moveBy(r,t)},qu=function(e,t){if(t.collapsed&&e.setCollapsed(!0),t.deletable===!1&&e.setDeletable(!1),t.movable===!1&&e.setMovable(!1),t.editable===!1&&e.setEditable(!1),t.enabled===!1&&e.setDisabledReason(!0,Hs),Array.isArray(t.disabledReasons))for(const r of t.disabledReasons)e.setDisabledReason(!0,r);t.inline!==void 0&&e.setInputsInline(t.inline),t.data!==void 0&&(e.data=t.data)},vr=function(e,t){t.extraState&&(e.loadExtraState?e.loadExtraState(t.extraState):e.domToMutation&&e.domToMutation(s.textToDom$$module$build$src$core$utils$xml(t.extraState)))},yp=function(e,t,r){if(e){if(e.getSourceBlock().isShadow()&&!t.isShadow())throw new Yb(r);if(e.type===s.inputTypes$$module$build$src$core$inputs$input_types.VALUE){var l=t.outputConnection;if(!l)throw new iu("output",t,r)}else if(l=t.previousConnection,!l)throw new iu("previous",t,r);if(!e.connect(l)){const p=t.workspace.connectionChecker;throw new Jb(p.getErrorMessage(p.canConnectWithReason(l,e,!1),l,e),e.type===s.inputTypes$$module$build$src$core$inputs$input_types.VALUE?"output connection":"previous connection",t,r)}}},_p=function(e,t){if(t.icons){var r=Object.keys(t.icons);for(const p of r){r=t.icons[p];var l=e.getIcon(p);if(!l){if(l=b(Ne.ICON,p,!1),!l)throw new Xb(p,e,t);l=new l(e),e.addIcon(l)}er(l)&&l.loadState(r)}}},wp=function(e,t){if(t.fields){var r=Object.keys(t.fields);for(let l=0;l<r.length;l++){const p=r[l],v=t.fields[p],O=e.getField(p);O?O.loadState(v):console.warn(`Ignoring non-existant field ${p} in block ${e.type}`)}}},Sp=function(e,t){if(t.inputs){var r=Object.keys(t.inputs);for(let l=0;l<r.length;l++){const p=r[l],v=e.getInput(p);if(!v||!v.connection)throw new iu(p,e,t);Ku(v.connection,t.inputs[p])}}},Cp=function(e,t){if(t.next){if(!e.nextConnection)throw new iu("next",e,t);Ku(e.nextConnection,t.next)}},Ku=function(e,t){t.shadow&&e.setShadowState(t.shadow),t.block&&Cc(t.block,e.getSourceBlock().workspace,{parentConnection:e})},tr=function(e,t){if(t){e.setConnectionTracking(!1),e.initSvg(),e.queueRender();for(const r of e.getIcons())r.onLocationChange(e.getRelativeToSurfaceXY())}else e.initModel()},ul=function(e){return e.bubbleIsVisible!==void 0&&e.setBubbleVisible!==void 0},zs=function(e){return e*Math.PI/180},Hm=function(e){return 180*e/Math.PI},ma=function(e,t,r){if(r<e){const l=r;r=e,e=l}return Math.max(e,Math.min(t,r))},bi=function(){document.querySelector(".blocklyDropDownDiv")||(sn=document.createElement("div"),sn.className="blocklyDropDownDiv",(ut()||document.body).appendChild(sn),io=document.createElement("div"),io.className="blocklyDropDownContent",sn.appendChild(io),za=document.createElement("div"),za.className="blocklyDropDownArrow",sn.appendChild(za),sn.style.opacity="0",sn.style.transition="transform "+Yd+"s, opacity "+Yd+"s",sn.addEventListener("focusin",function(){Pe(sn,"blocklyFocused")}),sn.addEventListener("focusout",function(){it(sn,"blocklyFocused")}))},dl=function(e){Qg=e},Tc=function(){return Ho},wn=function(){return io},si=function(){io.textContent="",io.style.width=""},Ec=function(e,t){sn.style.backgroundColor=e,sn.style.borderColor=t},Wm=function(e,t,r,l){return kp(Tp(t),e,r,l)},kc=function(e,t,r){return e$=!0,kp(Ep(e),e,t,r)},Tp=function(e){var t=e.getSvgRoot();const r=e.workspace.scale,l=e.height*r;return e=e.width*r,t=Vn(t),new Tt(t.y,t.y+l,t.x,t.x+e)},Ep=function(e){return e=e.getScaledBBox(),new Tt(e.top,e.bottom,e.left,e.right)},kp=function(e,t,r,l){const p=e.left+(e.right-e.left)/2,v=e.bottom;e=e.top,l&&(e+=l),l=t.getSourceBlock();let O=l.workspace;for(;O.options.parentWorkspace;)O=O.options.parentWorkspace;return dl(O.getParentSvg().parentNode),Ju(t,l.RTL,p,v,p,e,r)},Ju=function(e,t,r,l,p,v,O){return Ho=e,Fa=O||null,sn.style.direction=t?"rtl":"ltr",e=Ke(),Wl=e.getRenderer().getClassName(),ja=e.getTheme().getClassName(),Wl&&Pe(sn,Wl),ja&&Pe(sn,ja),Ip(r,l,p,v)},hl=function(e,t,r,l){return e=pl(e,r.left,r.right,l.width),{initialX:e.divX,initialY:t,finalX:e.divX,finalY:t+Xg,arrowX:e.arrowX,arrowY:-(lu/2+Yg),arrowAtTop:!0,arrowVisible:!0}},Do=function(e,t,r,l){return e=pl(e,r.left,r.right,l.width),{initialX:e.divX,initialY:t-l.height,finalX:e.divX,finalY:t-l.height-Xg,arrowX:e.arrowX,arrowY:l.height-2*Yg-lu/2,arrowAtTop:!1,arrowVisible:!0}},Vm=function(e,t,r){return e=pl(e,t.left,t.right,r.width),{initialX:e.divX,initialY:0,finalX:e.divX,finalY:0,arrowAtTop:null,arrowX:null,arrowY:null,arrowVisible:!1}},pl=function(e,t,r,l){return t=ma(t,e-l/2,r-l),e=e-lu/2-t,r=Qb,e=ma(r,e,l-r-lu),{arrowX:e,divX:t}},Yu=function(){return!!Ho},gl=function(e,t){return Ho===e?(t?ri():fl(),!0):!1},fl=function(){sn.style.transform="translate(0, 0)",sn.style.opacity="0",Zg=setTimeout(function(){ri()},1e3*Yd),Fa&&(Fa(),Fa=null)},ri=function(){Yu()&&(Zg&&clearTimeout(Zg),sn.style.transform="",sn.style.left="",sn.style.top="",sn.style.opacity="0",sn.style.display="none",sn.style.backgroundColor="",sn.style.borderColor="",Fa&&(Fa(),Fa=null),si(),Ho=null,Wl&&(it(sn,Wl),Wl=""),ja&&(it(sn,ja),ja=""),Ke().markFocused())},Ip=function(e,t,r,l){e=ef.getPositionMetrics(e,t,r,l),e.arrowVisible?(za.style.display="",za.style.transform="translate("+e.arrowX+"px,"+e.arrowY+"px) rotate(45deg)",za.setAttribute("class",e.arrowAtTop?"blocklyDropDownArrow blocklyArrowTop":"blocklyDropDownArrow blocklyArrowBottom")):za.style.display="none",t=Math.floor(e.initialX),r=Math.floor(e.initialY),l=Math.floor(e.finalX);const p=Math.floor(e.finalY);return sn.style.left=t+"px",sn.style.top=r+"px",sn.style.display="block",sn.style.opacity="1",sn.style.transform="translate("+(l-t)+"px,"+(p-r)+"px)",!!e.arrowAtTop},Ic=function(){if(Ho){var e=Ho.getSourceBlock();e=e$?Ep(Ho):Tp(e);const t=e.left+(e.right-e.left)/2;Ip(t,e.bottom,t,e.top)}else fl()},ba=function(e){return e.length?e.reduce(function(t,r){return t.length<r.length?t:r}).length:0},xp=function(e,t){if(!e.length)return 0;if(e.length===1)return e[0].length;let r=0;t=t||ba(e);let l;for(l=0;l<t;l++){for(var p=e[0][l],v=1;v<e.length;v++)if(p!==e[v][l])return r;p===" "&&(r=l+1)}for(p=1;p<e.length;p++)if((v=e[p][l])&&v!==" ")return r;return t},Xu=function(e,t){if(!e.length)return 0;if(e.length===1)return e[0].length;let r=0;t=t||ba(e);let l;for(l=0;l<t;l++){for(var p=e[0].substr(-l-1,1),v=1;v<e.length;v++)if(p!==e[v].substr(-l-1,1))return r;p===" "&&(r=l+1)}for(p=1;p<e.length;p++)if((v=e[p].charAt(e[p].length-l-1))&&v!==" ")return r;return t},s.wrap$$module$build$src$core$utils$string=function(e,t){e=e.split(`
`);for(let r=0;r<e.length;r++)e[r]=nr(e[r],t);return e.join(`
`)},nr=function(e,t){if(e.length<=t)return e;const r=e.trim().split(/\s+/);for(var l=0;l<r.length;l++)r[l].length>t&&(t=r[l].length);var p=-1/0;let v,O=1;do{l=p,v=e,e=[],p=r.length/O;let G=1;for(let _e=0;_e<r.length-1;_e++)G<(_e+1.5)/p?(G++,e[_e]=!0):e[_e]=!1;e=$a(r,e,t),p=ml(r,e,t),e=Dp(r,e),O++}while(p>l);return v},ml=function(e,t,r){const l=[0],p=[];for(var v=0;v<e.length;v++)l[l.length-1]+=e[v].length,t[v]===!0?(l.push(0),p.push(e[v].charAt(e[v].length-1))):t[v]===!1&&l[l.length-1]++;for(e=Math.max(...l),t=0,v=0;v<l.length;v++)t-=2*Math.pow(Math.abs(r-l[v]),1.5),t-=Math.pow(e-l[v],1.5),".?!".includes(p[v])?t+=r/3:",;)]}".includes(p[v])&&(t+=r/4);return 1<l.length&&l[l.length-1]<=l[l.length-2]&&(t+=.5),t},$a=function(e,t,r){let l=ml(e,t,r),p;for(let v=0;v<t.length-1;v++){if(t[v]===t[v+1])continue;const O=[].concat(t);O[v]=!O[v],O[v+1]=!O[v+1];const G=ml(e,O,r);G>l&&(l=G,p=O)}return p?$a(e,p,r):t},Dp=function(e,t){const r=[];for(let l=0;l<e.length;l++)r.push(e[l]),t[l]!==void 0&&r.push(t[l]?`
`:" ");return r.join("")},s.isNumber$$module$build$src$core$utils$string=function(e){return/^\s*-?\d+(\.\d+)?\s*$/.test(e)},Op=function(e){Xd=e},Gm=function(){return Xd},qm=function(){return uu},Km=function(){return rs},bl=function(e){if(e=Rp(e)){for(e=e.tooltip;typeof e=="function";)e=e();if(typeof e!="string")throw Error("Tooltip function must return a string.");return e}return""},Rp=function(e){for(;e&&e.tooltip;){if(typeof e.tooltip=="string"||typeof e.tooltip=="function")return e;e=e.tooltip}return null},Oo=function(){document.querySelector(".blocklyTooltipDiv")||(rs=document.createElement("div"),rs.className="blocklyTooltipDiv",(ut()||document.body).appendChild(rs))},$l=function(e){e.mouseOverWrapper_=Ft(e,"pointerover",null,Qu),e.mouseOutWrapper_=Ft(e,"pointerout",null,Ap),e.addEventListener("pointermove",$i,!1)},Zu=function(e){e&&(St(e.mouseOverWrapper_),St(e.mouseOutWrapper_),e.removeEventListener("pointermove",$i))},Qu=function(e){Gl||(e=Rp(e.currentTarget),Sr!==e&&(Hi(),ql=null,Sr=e),clearTimeout(n$))},Ap=function(e){Gl||(n$=setTimeout(function(){ql=Sr=null,Hi()},1),clearTimeout(Ua),Ua=0)},$i=function(e){if(Sr&&Sr.tooltip&&!Gl)if(uu){const t=tf-e.pageX;e=nf-e.pageY,Math.sqrt(t*t+e*e)>s$&&Hi()}else ql!==Sr&&(clearTimeout(Ua),tf=e.pageX,nf=e.pageY,Ua=setTimeout(Jm,r$))},vl=function(){ql=Sr=null,Hi()},Hi=function(){uu&&(uu=!1,rs&&(rs.style.display="none")),Ua&&(clearTimeout(Ua),Ua=0)},Np=function(){Hi(),Gl=!0},Mp=function(){Gl=!1},va=function(){rs&&Sr&&(typeof Xd=="function"?Xd(rs,Sr):Nr())},Nr=function(){var e=bl(Sr);e=s.wrap$$module$build$src$core$utils$string(e,t$),e=e.split(`
`);for(let t=0;t<e.length;t++){const r=document.createElement("div");r.appendChild(document.createTextNode(e[t])),rs.appendChild(r)}},Lp=function(e){const t=document.documentElement.clientWidth,r=document.documentElement.clientHeight;let l=tf;l=e?l-(sf+rs.offsetWidth):l+sf;let p=nf+rf;return p+rs.offsetHeight>r+window.scrollY&&(p-=rs.offsetHeight+2*rf),e?l=Math.max(Ha-window.scrollX,l):l+rs.offsetWidth>t+window.scrollX-2*Ha&&(l=t-rs.offsetWidth-2*Ha),{x:l,y:p}},Jm=function(){if(!Gl&&(ql=Sr,rs)){rs.textContent="",va();var e=Sr.RTL;rs.style.direction=e?"rtl":"ltr",rs.style.display="block",uu=!0;var{x:t,y:r}=Lp(e);rs.style.left=t+"px",rs.style.top=r+"px"}},Bp=function(){return of},Ym=function(e){of=e},Pp=function(){return af},Xm=function(e){af=e},Mr=function(e){e=`${e}`.toLowerCase().trim();var t=i$[e];if(t||(t=e.substring(0,2)==="0x"?"#"+e.substring(2):e,t=t[0]==="#"?t:"#"+t,/^#[0-9a-f]{6}$/.test(t)))return t;if(/^#[0-9a-f]{3}$/.test(t))return["#",t[1],t[1],t[2],t[2],t[3],t[3]].join("");var r=e.match(/^(?:rgb)?\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/);return r&&(e=Number(r[1]),t=Number(r[2]),r=Number(r[3]),0<=e&&256>e&&0<=t&&256>t&&0<=r&&256>r)?oe(e,t,r):null},oe=function(e,t,r){return t=e<<16|t<<8|r,16>e?"#"+(16777216|t).toString(16).substr(1):"#"+t.toString(16)},Se=function(e){return e=Mr(e),e?(e=parseInt(e.substr(1),16),[e>>16,e>>8&255,e&255]):[0,0,0]},me=function(e,t,r){let l=0,p=0,v=0;if(t===0)v=p=l=r;else{const O=Math.floor(e/60),G=e/60-O;e=r*(1-t);const _e=r*(1-t*G);switch(t=r*(1-t*(1-G)),O){case 1:l=_e,p=r,v=e;break;case 2:l=e,p=r,v=t;break;case 3:l=e,p=_e,v=r;break;case 4:l=t,p=e,v=r;break;case 5:l=r,p=e,v=_e;break;case 6:case 0:l=r,p=t,v=e}}return oe(Math.floor(l),Math.floor(p),Math.floor(v))},Je=function(e,t,r){return e=Mr(e),!e||(t=Mr(t),!t)?null:(e=Se(e),t=Se(t),oe(Math.round(t[0]+r*(e[0]-t[0])),Math.round(t[1]+r*(e[1]-t[1])),Math.round(t[2]+r*(e[2]-t[2]))))},yt=function(e){return me(e,of,255*af)},Zt=function(e,t,r){const l=[];var p=e.split("");p.push("");var v=0;e=[];let O=null;for(let qe=0;qe<p.length;qe++){var G=p[qe];if(v===0)if(G==="%")(v=e.join(""))&&l.push(v),e.length=0,v=1;else if(r&&G===`
`){const Nn=e.join("");Nn&&l.push(Nn),e.length=0,l.push(G)}else e.push(G);else if(v===1)G==="%"?(e.push(G),v=0):t&&"0"<=G&&"9">=G?(v=2,O=G,(G=e.join(""))&&l.push(G),e.length=0):G==="{"?v=3:(e.push("%",G),v=0);else if(v===2)if("0"<=G&&"9">=G)O+=G;else{var _e=void 0;l.push(parseInt((_e=O)!=null?_e:"",10)),qe--,v=0}else v===3&&(G===""?(e.splice(0,0,"%{"),qe--,v=0):G!=="}"?e.push(G):(v=e.join(""),/[A-Z]\w*/i.test(v)?(G=v.toUpperCase(),(G=G.startsWith("BKY_")?G.substring(4):null)&&G in s.Msg$$module$build$src$core$msg?(v=s.Msg$$module$build$src$core$msg[G],typeof v=="string"?Array.prototype.push.apply(l,Zt(v,t,r)):t?l.push(`${v}`):l.push(v)):l.push("%{"+v+"}")):l.push("%{"+v+"}"),v=e.length=0))}for((t=e.join(""))&&l.push(t),_e=[],e.length=0,p=0;p<l.length;p++)typeof l[p]!="string"||r&&l[p]===`
`?((t=e.join(""))&&_e.push(t),e.length=0,_e.push(l[p])):e.push(l[p]);return(t=e.join(""))&&_e.push(t),e.length=0,_e},Zn=function(e){return Zt(e,!0,!0)},bt=function(e){return typeof e!="string"?e:(e=Zt(e,!1,!1),e.length?String(e[0]):"")},ed=function(e){let t=!0;const r=s.Msg$$module$build$src$core$msg,l=e.match(/%{BKY_[A-Z]\w*}/gi);if(l)for(let p=0;p<l.length;p++){const v=l[p].toUpperCase();r[v.slice(6,-1)]===void 0&&(console.warn("No message string for "+l[p]+" in "+e),t=!1)}return t},yl=function(e){const t=typeof e=="string"?bt(e):e;var r=Number(t);if(!isNaN(r)&&0<=r&&360>=r)return{hue:r,hex:me(r,Bp(),255*Pp())};if(r=Mr(t))return{hue:null,hex:r};throw r='Invalid colour: "'+t+'"',e!==t&&(r+=' (from "'+e+'")'),Error(r)},vs=function(){return Tr},xc=function(e){if(Tr=e,e===null){let t;(t=document.querySelector("."+Zd))==null||t.remove()}},Fp=function(){const e=ut()||document.body;document.querySelector("."+Zd)?Tr=document.querySelector("."+Zd):(Tr=document.createElement("div"),Tr.className=Zd),e.appendChild(Tr)},Wi=function(e,t,r,l){if(Vi(),Kl=e,Wa=r,r=Tr){if(r.style.direction=t?"rtl":"ltr",r.style.display="block",!l&&e instanceof fn){let O;l=(O=e.getSourceBlock())==null?void 0:O.workspace}var p;lf=(p=l)!=null?p:null;var v;e=(v=l)!=null?v:Ke(),Va=e.getRenderer().getClassName(),Ga=e.getTheme().getClassName(),Va&&Pe(r,Va),Ga&&Pe(r,Ga)}},Vi=function(){if(_l()){Kl=null;var e=Tr;e&&(e.style.display="none",e.style.left="",e.style.top="",Wa&&Wa(),Wa=null,e.textContent="",Va&&(it(e,Va),Va=""),Ga&&(it(e,Ga),Ga=""),Ke().markFocused())}},_l=function(){return!!Kl},Kt=function(e){Kl===e&&Vi()},Dc=function(e){lf!==null&&lf!==e||Vi()},td=function(e,t,r){Tr.style.left=e+"px",Tr.style.top=t+"px",Tr.style.height=r+"px"},wl=function(e,t,r,l){const p=Qm(e,t,r);e=Zm(e,t,r,l),0>p?td(e,0,r.height+p):td(e,p,r.height)},Zm=function(e,t,r,l){return l?Math.min(Math.max(t.right-r.width,e.left),e.right-r.width):Math.max(Math.min(t.left,e.right-r.width),e.left)},Qm=function(e,t,r){return t.bottom+r.height>=e.bottom?t.top-r.height:t.bottom},eb=function(e){return!(e==null||!e.repositionForWindowResize)},Sl=function(){eb(Kl)&&Kl.repositionForWindowResize()||Vi()},Gi=function(){return hu},Cl=function(e){hu=e},Tl=function(e,t,r,l){if(Wi(cf,r,ya,l),t.length){var p=Oc(t,r,e);pu=p,jp(p,e,r),setTimeout(function(){p.focus()},1),hu=null}else El()},Oc=function(e,t,r){const l=new Hg;l.setRole(zr.MENU);for(let p=0;p<e.length;p++){const v=e[p],O=new qd(v.text);O.setRightToLeft(t),O.setRole(zr.MENUITEM),l.addChild(O),O.setEnabled(v.enabled),v.enabled&&O.onAction(function(){El(),requestAnimationFrame(()=>{setTimeout(()=>{v.callback(v.scope,r)},0)})},{})}return l},jp=function(e,t,r){const l=bc();t=new Tt(t.clientY+l.top,t.clientY+l.top,t.clientX+l.left,t.clientX+l.left),zp(e);const p=e.getSize();r&&(t.left+=p.width,t.right+=p.width,l.left+=p.width,l.right+=p.width),wl(l,t,p,r),e.focus()},zp=function(e){var t=vs();if(!t)throw Error("Attempting to create a context menu when widget div is null");t=e.render(t),Pe(t,"blocklyContextMenu"),He(t,"contextmenu",null,Rc),e.focus()},Rc=function(e){e.preventDefault(),e.stopPropagation()},El=function(){Kt(cf),hu=null},ya=function(){pu&&(pu.dispose(),pu=null)},s.callbackFactory$$module$build$src$core$contextmenu=function(e,t){return()=>{s.disable$$module$build$src$core$events$utils();let r;try{r=t instanceof Element?Ao(t,e.workspace):Gn(t,e.workspace);const l=e.getRelativeToSurfaceXY();l.x=e.RTL?l.x-s.config$$module$build$src$core$config.snapRadius:l.x+s.config$$module$build$src$core$config.snapRadius,l.y+=2*s.config$$module$build$src$core$config.snapRadius,r.moveBy(l.x,l.y)}finally{s.enable$$module$build$src$core$events$utils()}return re()&&!r.isShadow()&&te(new(Ce(ge.BLOCK_CREATE))(r)),s.setSelected$$module$build$src$core$common(r),r}},qi=function(e,t){return t=Ee(t,e.getParentSvg(),e.getInverseScreenCTM()),t.x/=e.scale,t.y/=e.scale,t},_a=function(e,t,r){t=qi(e,t),a$.set(e,Ae.difference(r,t))},nd=function(e,t){if(t=qi(e,t),e=a$.get(e),!e)throw Error("Drag not initialized");return Ae.sum(e,t)},tb=function(e,t=!1){const r=s.createElement$$module$build$src$core$utils$xml("xml");var l=kl(s.allUsedVarModels$$module$build$src$core$variables(e));l.hasChildNodes()&&r.appendChild(l);for(const p of e.getTopComments())r.appendChild(Ac(p,t));for(e=e.getTopBlocks(!0),l=0;l<e.length;l++)r.appendChild(Ro(e[l],t));return r},Ac=function(e,t=!1){const r=s.createElement$$module$build$src$core$utils$xml("comment");t||r.setAttribute("id",e.id),t=e.workspace;const l=e.getRelativeToSurfaceXY();return l.x=t.RTL?t.getWidth()-l.x:l.x,r.setAttribute("x",`${l.x}`),r.setAttribute("y",`${l.y}`),r.setAttribute("w",`${e.getSize().width}`),r.setAttribute("h",`${e.getSize().height}`),e.getText()&&(r.textContent=e.getText()),e.isCollapsed()&&r.setAttribute("collapsed","true"),e.isOwnEditable()||r.setAttribute("editable","false"),e.isOwnMovable()||r.setAttribute("movable","false"),e.isOwnDeletable()||r.setAttribute("deletable","false"),r},kl=function(e){const t=s.createElement$$module$build$src$core$utils$xml("variables");for(let r=0;r<e.length;r++){const l=e[r],p=s.createElement$$module$build$src$core$utils$xml("variable");p.appendChild(s.createTextNode$$module$build$src$core$utils$xml(l.name)),l.type&&p.setAttribute("type",l.type),p.id=l.getId(),t.appendChild(p)}return t},Ro=function(e,t){if(e.isInsertionMarker()&&(e=e.getChildren(!1)[0],!e))return new DocumentFragment;let r=0;if(e.workspace.RTL&&(r=e.workspace.getWidth()),t=Ki(e,t),Vp(t)){const l=e.getRelativeToSurfaceXY();t.setAttribute("x",String(Math.round(e.workspace.RTL?r-l.x:l.x))),t.setAttribute("y",String(Math.round(l.y)))}return t},sd=function(e){if(e.isSerializable()){const t=s.createElement$$module$build$src$core$utils$xml("field");return t.setAttribute("name",e.name||""),e.toXml(t)}return null},nb=function(e,t){for(let r=0;r<e.inputList.length;r++){const l=e.inputList[r];for(let p=0;p<l.fieldRow.length;p++){const v=sd(l.fieldRow[p]);v&&t.appendChild(v)}}},Ki=function(e,t){if(e.isInsertionMarker())return(t=e.getChildren(!1)[0])?Ki(t):new DocumentFragment;const r=s.createElement$$module$build$src$core$utils$xml(e.isShadow()?"shadow":"block");if(r.setAttribute("type",e.type),t||(r.id=e.id),e.mutationToDom){var l=e.mutationToDom();l&&(l.hasChildNodes()||l.hasAttributes())&&r.appendChild(l)}if(nb(e,r),l=e.getCommentText()){var p=e.getIcon(ss.COMMENT),v=p.getBubbleSize();p=p.bubbleIsVisible();var O=s.createElement$$module$build$src$core$utils$xml("comment");O.appendChild(s.createTextNode$$module$build$src$core$utils$xml(l)),O.setAttribute("pinned",`${p}`),O.setAttribute("h",String(v.height)),O.setAttribute("w",String(v.width)),r.appendChild(O)}for(e.data&&(l=s.createElement$$module$build$src$core$utils$xml("data"),l.appendChild(s.createTextNode$$module$build$src$core$utils$xml(e.data)),r.appendChild(l)),l=0;l<e.inputList.length;l++){v=e.inputList[l];var G=void 0;if(p=!0,v.type!==s.inputTypes$$module$build$src$core$inputs$input_types.DUMMY&&v.type!==s.inputTypes$$module$build$src$core$inputs$input_types.END_ROW){O=v.connection.targetBlock(),v.type===s.inputTypes$$module$build$src$core$inputs$input_types.VALUE?G=s.createElement$$module$build$src$core$utils$xml("value"):v.type===s.inputTypes$$module$build$src$core$inputs$input_types.STATEMENT&&(G=s.createElement$$module$build$src$core$utils$xml("statement"));const qe=v.connection.getShadowDom();!qe||O&&O.isShadow()||G.appendChild(Up(qe,t)),O&&(O=Ki(O,t),O.nodeType===to.ELEMENT_NODE&&(G.appendChild(O),p=!1)),G.setAttribute("name",v.name),p||r.appendChild(G)}}e.inputsInline!==void 0&&e.inputsInline!==e.inputsInlineDefault&&r.setAttribute("inline",String(e.inputsInline)),e.isCollapsed()&&r.setAttribute("collapsed","true"),e.isEnabled()||r.setAttribute("disabled-reasons",Array.from(e.getDisabledReasons()).map(encodeURIComponent).join(",")),e.isOwnDeletable()||r.setAttribute("deletable","false"),e.isOwnMovable()||r.setAttribute("movable","false"),e.isOwnEditable()||r.setAttribute("editable","false"),G=e.getNextBlock();let _e;return G&&(l=Ki(G,t),l.nodeType===to.ELEMENT_NODE&&(_e=s.createElement$$module$build$src$core$utils$xml("next"),_e.appendChild(l),r.appendChild(_e))),e=e.nextConnection&&e.nextConnection.getShadowDom(),!e||G&&G.isShadow()||_e.appendChild(Up(e,t)),r},Up=function(e,t){let r=e=e.cloneNode(!0),l;for(;r;)if(t&&r.nodeName==="shadow"&&r.removeAttribute("id"),r.firstChild)r=r.firstChild;else{for(;r&&!r.nextSibling;){l=r,r=r.parentNode;let p;l.nodeType===to.TEXT_NODE&&l.data.trim()===""&&((p=r)==null?void 0:p.firstChild)!==l&&lt(l)}r&&(l=r,r=r.nextSibling,l.nodeType===to.TEXT_NODE&&l.data.trim()===""&&lt(l))}return e},vi=function(e){return H(e).replace(/<(\w+)([^<]*)\/>/g,"<$1$2></$1>")},ts=function(e){e=vi(e).split("<");let t="";for(let r=1;r<e.length;r++){const l=e[r];l[0]==="/"&&(t=t.substring(2)),e[r]=t+"<"+l,l[0]!=="/"&&l.slice(-2)!=="/>"&&(t+="  ")}return e=e.join(`
`),e=e.replace(/(<(\w+)\b[^>]*>[^\n]*)\n *<\/\2>/g,"$1</$2>"),e.replace(/^\n/,"")},ys=function(e,t){return t.setResizesEnabled(!1),t.clear(),e=s.domToWorkspace$$module$build$src$core$xml(e,t),t.setResizesEnabled(!0),e},s.domToWorkspace$$module$build$src$core$xml=function(e,t){let r=0;t.RTL&&(r=t.getWidth());const l=[];Wn();const p=s.getGroup$$module$build$src$core$events$utils();p||s.setGroup$$module$build$src$core$events$utils(!0),t.setResizesEnabled&&t.setResizesEnabled(!1);let v=!0;try{for(let O=0,G;G=e.childNodes[O];O++){const _e=G.nodeName.toLowerCase(),qe=G;if(_e==="block"||_e==="shadow"&&!Y()){const Nn=Ao(qe,t);l.push(Nn.id);let On;const Yr=parseInt((On=qe.getAttribute("x"))!=null?On:"10",10);let kh;const Lf=parseInt((kh=qe.getAttribute("y"))!=null?kh:"10",10);isNaN(Yr)||isNaN(Lf)||Nn.moveBy(t.RTL?r-Yr:Yr,Lf,["create"]),v=!1}else{if(_e==="shadow")throw TypeError("Shadow block cannot be a top-level block.");if(_e==="comment")Hp(qe,t);else if(_e==="variables"){if(v)Wp(qe,t);else throw Error("'variables' tag must exist once before block and shadow tag elements in the workspace XML, but it was found in another location.");v=!1}}}}finally{s.setGroup$$module$build$src$core$events$utils(p),t.setResizesEnabled&&t.setResizesEnabled(!0),t.rendered&&js(),Xn()}return te(new(Ce(ge.FINISHED_LOADING))(t)),l},Hp=function(e,t){var r;const l=(r=e.getAttribute("id"))!=null?r:void 0;r=t.rendered?new th(t,l):new gu(t,l);var p;r.setText((p=e.textContent)!=null?p:"");var v;p=parseInt((v=e.getAttribute("x"))!=null?v:"",10);let O;v=parseInt((O=e.getAttribute("y"))!=null?O:"",10),isNaN(p)||isNaN(v)||(p=t.RTL?t.getWidth()-p:p,r.moveTo(new Ae(p,v)));var G;t=parseInt((G=e.getAttribute("w"))!=null?G:"",10);let _e;return G=parseInt((_e=e.getAttribute("h"))!=null?_e:"",10),isNaN(t)||isNaN(G)||r.setSize(new Pt(t,G)),e.getAttribute("collapsed")==="true"&&r.setCollapsed(!0),e.getAttribute("editable")==="false"&&r.setEditable(!1),e.getAttribute("movable")==="false"&&r.setMovable(!1),e.getAttribute("deletable")==="false"&&r.setDeletable(!1),r},sb=function(e,t){if(!t.getBlocksBoundingBox)return s.domToWorkspace$$module$build$src$core$xml(e,t);var r=t.getBlocksBoundingBox();if(e=s.domToWorkspace$$module$build$src$core$xml(e,t),r&&r.top!==r.bottom){var l=r.bottom;r=t.RTL?r.right:r.left;var p=1/0;let v=-1/0,O=1/0;for(let G=0;G<e.length;G++){const _e=t.getBlockById(e[G]).getRelativeToSurfaceXY();_e.y<O&&(O=_e.y),_e.x<p&&(p=_e.x),_e.x>v&&(v=_e.x)}for(l=l-O+10,r=t.RTL?r-v:r-p,p=0;p<e.length;p++)t.getBlockById(e[p]).moveBy(r,l,["create"])}return e},s.domToBlock$$module$build$src$core$xml=function(e,t){return e=Ao(e,t),t.rendered&&js(),e},Ao=function(e,t){s.disable$$module$build$src$core$events$utils();var r=t.getAllVariables();let l;try{if(l=od(e,t),t.rendered){const p=l,v=l.getDescendants(!1);p.setConnectionTracking(!1);for(let O=v.length-1;0<=O;O--)v[O].initSvg();for(let O=v.length-1;0<=O;O--)v[O].queueRender();setTimeout(function(){p.disposed||p.setConnectionTracking(!0)},1),t.resizeContents()}else{const p=l.getDescendants(!1);for(let v=p.length-1;0<=v;v--)p[v].initModel()}}finally{s.enable$$module$build$src$core$events$utils()}if(re()){for(e=Sc(t,r),t=0;t<e.length;t++)r=e[t],te(new(Ce(ge.VAR_CREATE))(r));te(new(Ce(ge.BLOCK_CREATE))(l))}return l},Wp=function(e,t){for(let l=0;l<e.children.length;l++){var r=e.children[l];const p=r.getAttribute("type"),v=r.getAttribute("id");if(r=r.textContent,!r)break;t.createVariable(r,p,v)}},rd=function(e){const t={mutation:[],comment:[],data:[],field:[],input:[],next:[]};for(let r=0;r<e.children.length;r++){const l=e.children[r];if(l.nodeType!==to.TEXT_NODE)switch(l.nodeName.toLowerCase()){case"mutation":t.mutation.push(l);break;case"comment":t.comment.push(l);break;case"data":t.data.push(l);break;case"title":case"field":t.field.push(l);break;case"value":case"statement":t.input.push(l);break;case"next":t.next.push(l);break;default:console.warn("Ignoring unknown tag: "+l.nodeName)}}return t},Il=function(e,t){let r=!1;for(let l=0;l<e.length;l++){const p=e[l];t.domToMutation&&(t.domToMutation(p),t.initSvg&&(r=!0))}return r},id=function(e,t){for(let l=0;l<e.length;l++){var r=e[l];const p=r.textContent,v=r.getAttribute("pinned")==="true";let O;const G=parseInt((O=r.getAttribute("w"))!=null?O:"50",10);let _e;r=parseInt((_e=r.getAttribute("h"))!=null?_e:"50",10),t.setCommentText(p);const qe=t.getIcon(ss.COMMENT);isNaN(G)||isNaN(r)||qe.setBubbleSize(new Pt(G,r)),qe.setBubbleVisible(v),setTimeout(()=>qe.setBubbleVisible(v),1)}},wa=function(e,t){for(let r=0;r<e.length;r++)t.data=e[r].textContent},xl=function(e,t){for(let r=0;r<e.length;r++){const l=e[r],p=l.getAttribute("name");p?rb(t,p,l):console.warn(`Ignoring unnamed field in block ${t.type}`)}},Sa=function(e){let t=null,r=null;for(let l=0;l<e.childNodes.length;l++){const p=e.childNodes[l];Vp(p)&&(p.nodeName.toLowerCase()==="block"?t=p:p.nodeName.toLowerCase()==="shadow"&&(r=p))}return{childBlockElement:t,childShadowElement:r}},Nc=function(e,t,r,l){for(let v=0;v<e.length;v++){var p=e[v];const O=p.getAttribute("name"),G=O?r.getInput(O):null;if(!G){console.warn("Ignoring non-existent input "+O+" in block "+l);break}if(p=Sa(p),p.childBlockElement){if(!G.connection)throw TypeError("Input connection does not exist.");od(p.childBlockElement,t,G.connection,!1)}if(p.childShadowElement){let _e;(_e=G.connection)==null||_e.setShadowDom(p.childShadowElement)}}},Ca=function(e,t,r){for(let l=0;l<e.length;l++){const p=Sa(e[l]);if(p.childBlockElement){if(!r.nextConnection)throw TypeError("Next statement does not exist.");if(r.nextConnection.isConnected())throw TypeError("Next statement is already connected.");od(p.childBlockElement,t,r.nextConnection,!0)}p.childShadowElement&&r.nextConnection&&r.nextConnection.setShadowDom(p.childShadowElement)}},od=function(e,t,r,l){var p;const v=e.getAttribute("type");if(!v)throw TypeError("Block type unspecified: "+e.outerHTML);var O=(p=e.getAttribute("id"))!=null?p:void 0;p=t.newBlock(v,O),O=rd(e);const G=Il(O.mutation,p);if(id(O.comment,p),wa(O.data,p),r)if(l)if(p.previousConnection)r.connect(p.previousConnection);else throw TypeError("Next block does not have previous statement.");else if(p.outputConnection)r.connect(p.outputConnection);else if(p.previousConnection)r.connect(p.previousConnection);else throw TypeError("Child block does not have output or previous statement.");if(xl(O.field,p),Nc(O.input,t,p,v),Ca(O.next,t,p),G&&p.initSvg(),(t=e.getAttribute("inline"))&&p.setInputsInline(t==="true"),(t=e.getAttribute("disabled"))&&p.setDisabledReason(t==="true"||t==="disabled",Hs),t=e.getAttribute("disabled-reasons"),t!==null)for(var _e of t.split(","))p.setDisabledReason(!0,decodeURIComponent(_e));if((_e=e.getAttribute("deletable"))&&p.setDeletable(_e==="true"),(_e=e.getAttribute("movable"))&&p.setMovable(_e==="true"),(_e=e.getAttribute("editable"))&&p.setEditable(_e==="true"),(_e=e.getAttribute("collapsed"))&&p.setCollapsed(_e==="true"),e.nodeName.toLowerCase()==="shadow"){for(e=p.getChildren(!1),_e=0;_e<e.length;_e++)if(!e[_e].isShadow())throw TypeError("Shadow block not allowed non-shadow child.");p.setShadow(!0)}return p},rb=function(e,t,r){const l=e.getField(t);l?l.fromXml(r):console.warn("Ignoring non-existent field "+t+" in block "+e.type)},ib=function(e){for(let t=0;t<e.childNodes.length;t++){const r=e.childNodes[t];if(r.nodeName.toLowerCase()==="next"){e.removeChild(r);break}}},Vp=function(e){return e.nodeType===to.ELEMENT_NODE},ad=function(e){if(!(100<e.getDescendants(!1).length)){var t=e.workspace,r=e.getSvgRoot();t.getAudioManager().play("delete");var l=e.getRelativeToSurfaceXY(),p=r.cloneNode(!0);p.setAttribute("transform","translate("+l.x+","+l.y+")");var v;(v=t.getLayerManager())==null||v.appendToAnimationLayer({getSvgRoot:()=>p}),Dl(p,{x:l.x,y:l.y,width:e.width,height:e.height},t.RTL,new Date)}},Dl=function(e,t,r,l){const p=(new Date().getTime()-l.getTime())/150;1<p?lt(e):(e.setAttribute("transform","translate("+(t.x+(r?-1:1)*t.width/2*p)+","+(t.y+t.height/2*p)+") scale("+(1-p)+")"),setTimeout(Dl,10,e,t,r,l))},No=function(e){var t=e.workspace;const r=t.scale;if(t.getAudioManager().play("click"),!(1>r)){var l=t.getSvgXY(e.getSvgRoot());e.outputConnection?(l.x+=(e.RTL?3:-3)*r,l.y+=13*r):e.previousConnection&&(l.x+=(e.RTL?-23:23)*r,l.y+=3*r);var p=ie(ae.CIRCLE,{cx:l.x,cy:l.y,r:0,fill:"none",stroke:"#888","stroke-width":10},t.getParentSvg());e=ie(ae.ANIMATE,{id:"animationCircle",begin:"indefinite",attributeName:"r",dur:"150ms",from:0,to:25*r},p),t=ie(ae.ANIMATE,{id:"animationOpacity",begin:"indefinite",attributeName:"opacity",dur:"150ms",from:1,to:0},p),e.beginElement(),t.beginElement(),setTimeout(()=>void lt(p),150)}},ld=function(e){if(ii(),e.workspace.getAudioManager().play("disconnect"),!(1>e.workspace.scale)){var t=e.getHeightWidth().height;t=Math.atan(10/t)/Math.PI*180,e.RTL||(t*=-1),fu=e,N(e,t,new Date)}},N=function(e,t,r){const l=(new Date().getTime()-r.getTime())/200;let p="";1>=l&&(p=`skewX(${Math.round(Math.sin(l*Math.PI*3)*(1-l)*t)})`,nh=setTimeout(N,10,e,t,r)),e.getSvgRoot().setAttribute("transform",`${e.getTranslation()} ${p}`)},ii=function(){fu&&(nh&&(clearTimeout(nh),nh=null),fu.getSvgRoot().setAttribute("transform",fu.getTranslation()),fu=null)},yi=function(e){return e.getRelativeToSurfaceXY!==void 0&&e.isMovable!==void 0&&e.startDrag!==void 0&&e.drag!==void 0&&e.endDrag!==void 0&&e.revertDrag!==void 0},ns=function(e,t){for(const r in t)e[r]=t[r]!==null&&typeof t[r]=="object"?ns(e[r]||Object.create(null),t[r]):t[r];return e},_t=function(e,t){i(Ne.FIELD,e,t)},ob=function(e){c(Ne.FIELD,e)},s.fromJson$$module$build$src$core$field_registry=function(e){return u$.fromJsonInternal(e)},ab=function(e){const t=$(Ne.FIELD,e.type);return t?t.fromJson(e):(console.warn("Blockly could not create a field of type "+e.type+". The field is probably not being registered. This could be because the file is not loaded, the field does not register itself (Issue #1584), or the registration is not being reached."),null)},s.register$$module$build$src$core$extensions=function(e,t){if(typeof e!="string"||e.trim()==="")throw Error('Error: Invalid extension name "'+e+'"');if(Sn[e])throw Error('Error: Extension "'+e+'" is already registered.');if(typeof t!="function")throw Error('Error: Extension "'+e+'" must be a function');Sn[e]=t},s.registerMixin$$module$build$src$core$extensions=function(e,t){if(!t||typeof t!="object")throw Error('Error: Mixin "'+e+'" must be a object');s.register$$module$build$src$core$extensions(e,function(){this.mixin(t)})},s.registerMutator$$module$build$src$core$extensions=function(e,t,r,l){const p='Error when registering mutator "'+e+'": ';qp(p,t);const v=Gp(t,p);if(r&&typeof r!="function")throw Error(p+'Extension "'+e+'" is not a function');s.register$$module$build$src$core$extensions(e,function(){v&&this.setMutator(new s.MutatorIcon$$module$build$src$core$icons$mutator_icon(l||[],this)),this.mixin(t),r&&r.apply(this)})},lb=function(e){Ji(e)?delete Sn[e]:console.warn('No extension mapping for name "'+e+'" found to unregister')},Ji=function(e){return!!Sn[e]},cd=function(e,t,r){const l=Sn[e];if(typeof l!="function")throw Error('Error: Extension "'+e+'" not found.');let p;if(r?cb(e,t):p=ud(t),l.apply(t),r)qp('Error after applying mutator "'+e+'": ',t);else if(!hb(p,t))throw Error('Error when applying extension "'+e+'": mutation properties changed when applying a non-mutator extension.')},cb=function(e,t){if(ud(t).length)throw Error('Error: tried to apply mutation "'+e+'" to a block that already has mutator functions.  Block id: '+t.id)},ub=function(e,t){return Lr(e.mutationToDom,e.domToMutation,t+" mutationToDom/domToMutation")},db=function(e,t){return Lr(e.saveExtraState,e.loadExtraState,t+" saveExtraState/loadExtraState")},Gp=function(e,t){return Lr(e.compose,e.decompose,t+" compose/decompose")},Lr=function(e,t,r){if(e&&t){if(typeof e!="function"||typeof t!="function")throw Error(r+" must be a function");return!0}if(!e&&!t)return!1;throw Error(r+"Must have both or neither functions")},qp=function(e,t){const r=ub(t,e),l=db(t,e);if(!r&&!l)throw Error(e+"Mutations must contain either XML hooks, or JSON hooks, or both");Gp(t,e)},ud=function(e){const t=[];return e.domToMutation!==void 0&&t.push(e.domToMutation),e.mutationToDom!==void 0&&t.push(e.mutationToDom),e.saveExtraState!==void 0&&t.push(e.saveExtraState),e.loadExtraState!==void 0&&t.push(e.loadExtraState),e.compose!==void 0&&t.push(e.compose),e.decompose!==void 0&&t.push(e.decompose),t},hb=function(e,t){if(t=ud(t),t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(e[r]!==t[r])return!1;return!0},pb=function(e){if(typeof document!="object")throw Error("runAfterPageLoad() requires browser document.");if(document.readyState==="complete")e();else{const t=setInterval(function(){document.readyState==="complete"&&(clearInterval(t),e())},10)}},s.buildTooltipForDropdown$$module$build$src$core$extensions=function(e,t){const r=[];return function(){r.includes(this.type)||(gb(this,e,t),r.push(this.type)),this.setTooltip(function(){const l=String(this.getFieldValue(e));return bt(t[l])}.bind(this))}},gb=function(e,t,r){var l=e.getField(t);if(l instanceof cr&&!l.isOptionListDynamic()){l=l.getOptions();for(const[,p]of l)r[p]===void 0&&console.warn(`No tooltip mapping for value ${p} of field ${t} of block type ${e.type}.`)}},s.buildTooltipWithFieldText$$module$build$src$core$extensions=function(e,t){return function(){this.setTooltip(function(){const r=this.getField(t);return bt(e).replace("%1",r?r.getText():"")}.bind(this))}},_i=function(){const e=this.tooltip;this.setTooltip(function(){const t=this.getParent();return t&&t.getInputsInline()&&t.tooltip||e}.bind(this))},nt=function(e,t){return" "+e+","+t+" "},sr=function(e,t){return" "+e+t.join("")},us=function(e,t){return" M "+e+","+t+" "},In=function(e,t){return" m "+e+","+t+" "},wi=function(e,t){return" l "+e+","+t+" "},Br=function(e){return" l"+e.join("")},Ye=function(e,t){return" "+e+" "+t+" "},qn=function(e,t,r,l){return e+" "+r+" "+r+" "+t+l},yr=function(e,t){i(Ne.ICON,e.toString(),t)},fb=function(e){c(Ne.ICON,e)},Mo=function(e){return e.getProcedureModel!==void 0&&e.doProcedureUpdate!==void 0&&e.isProcedureDef!==void 0},dd=function(e){return e.startPublishing!==void 0&&e.stopPublishing!==void 0},hd=function(e){const t=e.getProcedureMap().getProcedures().filter(l=>!l.getReturnTypes()).map(l=>[l.getName(),l.getParameters().map(p=>p.getName()),!1]);e.getBlocksByType("procedures_defnoreturn",!1).forEach(l=>{!Mo(l)&&ga(l)&&t.push(l.getProcedureDef())});const r=e.getProcedureMap().getProcedures().filter(l=>!!l.getReturnTypes()).map(l=>[l.getName(),l.getParameters().map(p=>p.getName()),!0]);return e.getBlocksByType("procedures_defreturn",!1).forEach(l=>{!Mo(l)&&ga(l)&&r.push(l.getProcedureDef())}),t.sort(Kp),r.sort(Kp),[t,r]},Kp=function(e,t){return e[0].localeCompare(t[0],void 0,{sensitivity:"base"})},s.findLegalName$$module$build$src$core$procedures=function(e,t){if(t.isInFlyout)return e;for(e=e||s.Msg$$module$build$src$core$msg.UNNAMED_KEY||"unnamed";!Jp(e,t.workspace,t);){const r=e.match(/^(.*?)(\d+)$/);e=r?r[1]+(parseInt(r[2])+1):e+"2"}return e},Jp=function(e,t,r){return!pd(e,t,r)},pd=function(e,t,r){for(const l of t.getAllBlocks(!1))if(l!==r&&ga(l)&&s.Names$$module$build$src$core$names.equals(l.getProcedureDef()[0],e))return!0;r=r&&Mo(r)?r==null?void 0:r.getProcedureModel():void 0;for(const l of t.getProcedureMap().getProcedures())if(l!==r&&s.Names$$module$build$src$core$names.equals(l.getName(),e))return!0;return!1},s.rename$$module$build$src$core$procedures=function(e){var t=this.getSourceBlock();if(!t)throw new Jn;e=e.trim();const r=s.findLegalName$$module$build$src$core$procedures(e,t);Mo(t)&&!t.isInsertionMarker()&&t.getProcedureModel().setName(r);const l=this.getValue();if(l!==e&&l!==r)for(e=t.workspace.getAllBlocks(!1),t=0;t<e.length;t++){const p=e[t];p.renameProcedure&&p.renameProcedure(l,r)}return r},gd=function(e){function t(v,O){for(let _e=0;_e<v.length;_e++){var G=v[_e][0];const qe=v[_e][1],Nn=s.createElement$$module$build$src$core$utils$xml("block");Nn.setAttribute("type",O),Nn.setAttribute("gap","16");const On=s.createElement$$module$build$src$core$utils$xml("mutation");for(On.setAttribute("name",G),Nn.appendChild(On),G=0;G<qe.length;G++){const Yr=s.createElement$$module$build$src$core$utils$xml("arg");Yr.setAttribute("name",qe[G]),On.appendChild(Yr)}r.push(Nn)}}const r=[];if(or.procedures_defnoreturn){var l=s.createElement$$module$build$src$core$utils$xml("block");l.setAttribute("type","procedures_defnoreturn"),l.setAttribute("gap","16");var p=s.createElement$$module$build$src$core$utils$xml("field");p.setAttribute("name","NAME"),p.appendChild(s.createTextNode$$module$build$src$core$utils$xml(s.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_PROCEDURE)),l.appendChild(p),r.push(l)}return or.procedures_defreturn&&(l=s.createElement$$module$build$src$core$utils$xml("block"),l.setAttribute("type","procedures_defreturn"),l.setAttribute("gap","16"),p=s.createElement$$module$build$src$core$utils$xml("field"),p.setAttribute("name","NAME"),p.appendChild(s.createTextNode$$module$build$src$core$utils$xml(s.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_PROCEDURE)),l.appendChild(p),r.push(l)),or.procedures_ifreturn&&(l=s.createElement$$module$build$src$core$utils$xml("block"),l.setAttribute("type","procedures_ifreturn"),l.setAttribute("gap","16"),r.push(l)),r.length&&r[r.length-1].setAttribute("gap","24"),e=hd(e),t(e[0],"procedures_callnoreturn"),t(e[1],"procedures_callreturn"),r},Yp=function(e){var t=[],r=e.getBlocksByType("procedures_mutatorarg",!1);for(let v=0,O;O=r[v];v++)t.push(O.getFieldValue("NAME"));r=s.createElement$$module$build$src$core$utils$xml("xml");const l=s.createElement$$module$build$src$core$utils$xml("block");l.setAttribute("type","procedures_mutatorarg");const p=s.createElement$$module$build$src$core$utils$xml("field");p.setAttribute("name","NAME"),t=_c(s.DEFAULT_ARG$$module$build$src$core$procedures,t),t=s.createTextNode$$module$build$src$core$utils$xml(t),p.appendChild(t),l.appendChild(p),r.appendChild(l),e.updateToolbox(r)},Mc=function(e){if(V(e)&&e.bubbleType==="mutator"&&e.isOpen&&e.blockId){e=pe(e.workspaceId).getBlockById(e.blockId);var t=e.type;(t==="procedures_defnoreturn"||t==="procedures_defreturn")&&(e=e.getIcon(s.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE).getWorkspace(),Yp(e),e.addChangeListener(Ol))}},Ol=function(e){(E(e)||R(e)||F(e)||M(e))&&(e=pe(e.workspaceId),Yp(e))},Rl=function(e,t){return t.getAllBlocks(!1).filter(r=>mb(r,e)||fp(r)&&s.Names$$module$build$src$core$names.equals(r.getProcedureCall(),e))},mb=function(e,t){return Mo(e)&&!e.isProcedureDef()&&e.getProcedureModel()&&s.Names$$module$build$src$core$names.equals(e.getProcedureModel().getName(),t)},s.mutateCallers$$module$build$src$core$procedures=function(e){const t=Y();var r=e.getProcedureDef()[0];const l=e.mutationToDom(!0);e=Rl(r,e.workspace);for(let v=0,O;O=e[v];v++){r=(r=O.mutationToDom())&&H(r),O.domToMutation&&O.domToMutation(l);var p=O.mutationToDom();p=p&&H(p),r!==p&&(s.setRecordUndo$$module$build$src$core$events$utils(!1),te(new(Ce(ge.BLOCK_CHANGE))(O,"mutation",null,r,p)),s.setRecordUndo$$module$build$src$core$events$utils(t))}},s.getDefinition$$module$build$src$core$procedures=function(e,t){for(const r of t.getAllBlocks(!1))if(Mo(r)&&r.isProcedureDef()&&s.Names$$module$build$src$core$names.equals(r.getProcedureModel().getName(),e)||ga(r)&&s.Names$$module$build$src$core$names.equals(r.getProcedureDef()[0],e))return r;return null},Lc=function(e){return e.isDynamic},bb=function(e){return e.pathDown!==void 0&&e.pathUp!==void 0},Si=function(e){return e.pathLeft!==void 0&&e.pathRight!==void 0},fd=function(e,t){if(!e||!t)throw Error("Cannot connect null connections.");e.targetConnection=t,t.targetConnection=e},Lo=function(e,t){let r=null;t=t.outputConnection;const l=t==null?void 0:t.getConnectionChecker();for(let p=0,v;v=e.inputList[p];p++){const O=v.connection;let G;if(O&&((G=l)!=null&&G.canConnect(t,O,!1))){if(r)return null;r=O}}return r},_r=function(e,t){let r;for(;r=Lo(e,t);)if(e=r.targetBlock(),!e||e.isShadow())return r;return null},Xp=function(e){return e.getType!==void 0&&e.initView!==void 0&&e.dispose!==void 0&&e.getWeight!==void 0&&e.getSize!==void 0&&e.applyColour!==void 0&&e.hideForInsertionMarker!==void 0&&e.updateEditable!==void 0&&e.updateCollapsed!==void 0&&e.isShownWhenCollapsed!==void 0&&e.setOffsetInBlock!==void 0&&e.onLocationChange!==void 0&&e.onClick!==void 0},Zp=function(e){return Xp(e)&&ul(e)&&er(e)&&e.setText!==void 0&&e.getText!==void 0&&e.setBubbleSize!==void 0&&e.getBubbleSize!==void 0&&e.getType()===ss.COMMENT},Al=function(e){let t=e.outputConnection;return(!t||e.previousConnection&&e.previousConnection.isConnected())&&(t=e.previousConnection),t},Yi=function(e,t){i(Ne.RENDERER,e,t)},Xi=function(e){c(Ne.RENDERER,e)},md=function(e,t,r){return e=new(b(Ne.RENDERER,e))(e),e.init(t,r),e},Qp=function(e){cl(e.getTargetWorkspace(),void 0,"String")},Nl=function(e){cl(e.getTargetWorkspace(),void 0,"Number")},eg=function(e){cl(e.getTargetWorkspace(),void 0,"Colour")},Bc=function(e){let t=[],r=document.createElement("button");return r.setAttribute("text",s.Msg$$module$build$src$core$msg.NEW_STRING_VARIABLE),r.setAttribute("callbackKey","CREATE_VARIABLE_STRING"),t.push(r),r=document.createElement("button"),r.setAttribute("text",s.Msg$$module$build$src$core$msg.NEW_NUMBER_VARIABLE),r.setAttribute("callbackKey","CREATE_VARIABLE_NUMBER"),t.push(r),r=document.createElement("button"),r.setAttribute("text",s.Msg$$module$build$src$core$msg.NEW_COLOUR_VARIABLE),r.setAttribute("callbackKey","CREATE_VARIABLE_COLOUR"),t.push(r),e.registerButtonCallback("CREATE_VARIABLE_STRING",Qp),e.registerButtonCallback("CREATE_VARIABLE_NUMBER",Nl),e.registerButtonCallback("CREATE_VARIABLE_COLOUR",eg),e=ds(e),t=t.concat(e)},ds=function(e){e=e.getAllVariables();const t=[];if(0<e.length){if(or.variables_set_dynamic){var r=e[e.length-1];const l=s.createElement$$module$build$src$core$utils$xml("block");l.setAttribute("type","variables_set_dynamic"),l.setAttribute("gap","24"),l.appendChild(fa(r)),t.push(l)}if(or.variables_get_dynamic){e.sort(ru.compareByName);for(let l=0,p;p=e[l];l++)r=s.createElement$$module$build$src$core$utils$xml("block"),r.setAttribute("type","variables_get_dynamic"),r.setAttribute("gap","8"),r.appendChild(fa(p)),t.push(r)}}return t},bd=function(e,t){const r=e.workspace,l=s.config$$module$build$src$core$config.snapRadius,p=Ae.difference(t,e.getRelativeToSurfaceXY()),v=new Ae(0,0),O=r.getAllBlocks(!1).filter(G=>G.id!=e.id).map(G=>G.getRelativeToSurfaceXY());for(;tg(Ae.sum(t,v),O)||oi(e,Ae.sum(p,v),l);)r.RTL?v.translate(-l,2*l):v.translate(l,2*l);e.moveTo(Ae.sum(t,v))},tg=function(e,t){return t.some(r=>1>=Math.abs(r.x-e.x)&&1>=Math.abs(r.y-e.y))},oi=function(e,t,r){return e.getConnections_(!1).some(l=>!!l.closest(r,t).connection)},Bo=function(e,t,r){const l=r.getBoundingRectangle(),p=l.right-l.left,v=ma(t.top,l.top,t.top+t.height-(l.bottom-l.top))-l.top;let O=t.left;return t=t.left+t.width-p,e.RTL?O=Math.min(t,O):t=Math.max(O,t),(e=ma(O,l.left,t)-l.left)||v?(r.moveBy(e,v,["inbounds"]),!0):!1},Ml=function(e){return t=>{var r=e.getMetricsManager();if(r.hasFixedEdges()&&!e.isDragging()){var l;if(_g.includes((l=t.type)!=null?l:"")){l=r.getScrollMetrics(!0);const p=Po(e,t);p&&(r=s.getGroup$$module$build$src$core$events$utils()||!1,s.setGroup$$module$build$src$core$events$utils(t.group),Bo(e,l,p)&&!t.group&&console.warn("Moved object in bounds but there was no event group. This may break undo."),s.setGroup$$module$build$src$core$events$utils(r))}else K(t)&&t.scale&&t.oldScale&&t.scale>t.oldScale&&Pc(e)}}},Po=function(e,t){let r=null;switch(t.type){case ge.BLOCK_CREATE:case ge.BLOCK_MOVE:(r=e.getBlockById(t.blockId))&&(r=r.getRootBlock());break;case ge.COMMENT_CREATE:case ge.COMMENT_MOVE:case ge.COMMENT_RESIZE:r=e.getCommentById(t.commentId)}return r},Pc=function(e){var t=e.getMetricsManager();if(t.hasFixedEdges()&&!e.isDragging()){t=t.getScrollMetrics(!0);var r=e.getTopBoundedElements();for(let l=0,p;p=r[l];l++)Bo(e,t,p)}},xn=function(e){return e.isDeletable!==void 0&&e.dispose!==void 0&&e.setDeleteStyle!==void 0},$d=function(e){const t=e.toCopyData();Ms=t;let r;return Eu=(r=e.workspace)!=null?r:null,t},Fo=function(e,t,r){return e&&t?ng(e,t,r):Ms&&Eu?ng(Ms,Eu):null},ng=function(e,t,r){let l;t=(l=t.getRootWorkspace())!=null?l:t;let p,v;return(v=(p=$(Ne.PASTER,e.paster,!1))==null?void 0:p.paste(e,t,r))!=null?v:null},$b=function(e){const t=e.toCopyData();return t?Fo(t,e.workspace):null},Ta=function(e){return e.toCopyData!==void 0},sg=function(){an.registry.register({name:Oi.ESCAPE,preconditionFn(e){return!e.options.readOnly},callback(e){return e.hideChaff(),!0},keyCodes:[Nt.ESC]})},Ea=function(){an.registry.register({name:Oi.DELETE,preconditionFn(e){const t=Ue();return!e.options.readOnly&&t!=null&&xn(t)&&t.isDeletable()&&!oo.inProgress()},callback(e,t){return t.preventDefault(),e=Ue(),e instanceof qr?e.checkAndDelete():xn(e)&&e.isDeletable()&&(s.setGroup$$module$build$src$core$events$utils(!0),e.dispose(),s.setGroup$$module$build$src$core$events$utils(!1)),!0},keyCodes:[Nt.DELETE,Nt.BACKSPACE]})},vd=function(){const e=an.registry.createSerializedKey(Nt.C,[Nt.CTRL]),t=an.registry.createSerializedKey(Nt.C,[Nt.ALT]),r=an.registry.createSerializedKey(Nt.C,[Nt.META]);an.registry.register({name:Oi.COPY,preconditionFn(l){const p=Ue();return!l.options.readOnly&&!oo.inProgress()&&p!=null&&xn(p)&&p.isDeletable()&&yi(p)&&p.isMovable()&&Ta(p)},callback(l,p){return p.preventDefault(),l.hideChaff(),p=Ue(),!p||!Ta(p)?!1:(Yo=p.toCopyData(),Ri=l,ic=yi(p)?p.getRelativeToSurfaceXY():null,!!Yo)},keyCodes:[e,t,r]})},rg=function(){const e=an.registry.createSerializedKey(Nt.X,[Nt.CTRL]),t=an.registry.createSerializedKey(Nt.X,[Nt.ALT]),r=an.registry.createSerializedKey(Nt.X,[Nt.META]);an.registry.register({name:Oi.CUT,preconditionFn(l){const p=Ue();return!l.options.readOnly&&!oo.inProgress()&&p!=null&&xn(p)&&p.isDeletable()&&yi(p)&&p.isMovable()&&!p.workspace.isFlyout},callback(l){const p=Ue();return p instanceof qr?(Yo=p.toCopyData(),Ri=l,ic=p.getRelativeToSurfaceXY(),p.checkAndDelete(),!0):xn(p)&&p.isDeletable()&&Ta(p)?(Yo=p.toCopyData(),Ri=l,ic=yi(p)?p.getRelativeToSurfaceXY():null,p.dispose(),!0):!1},keyCodes:[e,t,r]})},ig=function(){const e=an.registry.createSerializedKey(Nt.V,[Nt.CTRL]),t=an.registry.createSerializedKey(Nt.V,[Nt.ALT]),r=an.registry.createSerializedKey(Nt.V,[Nt.META]);an.registry.register({name:Oi.PASTE,preconditionFn(l){return!l.options.readOnly&&!oo.inProgress()},callback(){if(!Yo||!Ri)return!1;if(!ic)return!!Fo(Yo,Ri);const{left:l,top:p,width:v,height:O}=Ri.getMetricsManager().getViewMetrics(!0);if(new Tt(p,p+O,l,l+v).contains(ic.x,ic.y))return!!Fo(Yo,Ri);const G=new Ae(l+v/2,p+O/2);return!!Fo(Yo,Ri,G)},keyCodes:[e,t,r]})},ka=function(){const e=an.registry.createSerializedKey(Nt.Z,[Nt.CTRL]),t=an.registry.createSerializedKey(Nt.Z,[Nt.ALT]),r=an.registry.createSerializedKey(Nt.Z,[Nt.META]);an.registry.register({name:Oi.UNDO,preconditionFn(l){return!l.options.readOnly&&!oo.inProgress()},callback(l,p){return l.hideChaff(),l.undo(!1),p.preventDefault(),!0},keyCodes:[e,t,r]})},og=function(){const e=an.registry.createSerializedKey(Nt.Z,[Nt.SHIFT,Nt.CTRL]),t=an.registry.createSerializedKey(Nt.Z,[Nt.SHIFT,Nt.ALT]),r=an.registry.createSerializedKey(Nt.Z,[Nt.SHIFT,Nt.META]),l=an.registry.createSerializedKey(Nt.Y,[Nt.CTRL]);an.registry.register({name:Oi.REDO,preconditionFn(p){return!oo.inProgress()&&!p.options.readOnly},callback(p,v){return p.hideChaff(),p.undo(!0),v.preventDefault(),!0},keyCodes:[e,t,r,l]})},ag=function(){sg(),Ea(),vd(),rg(),ig(),ka(),og()},Fc=function(e){const t=e.saveState();return e.getParameters().length&&(t.parameters=e.getParameters().map(r=>r.saveState())),t},yd=function(e,t,r,l){if(e=e.loadState(r,l),!r.parameters)return e;for(const[p,v]of r.parameters.entries())e.insertParameter(t.loadState(v,l),p);return e},vb=function(e){const t=Object.create(null),r=y(Ne.SERIALIZER,!0);for(const l in r){let p;const v=(p=r[l])==null?void 0:p.save(e);v&&(t[l]=v)}return t},yb=function(e,t,{recordUndo:r=!1}={}){var l=y(Ne.SERIALIZER,!0);if(l){l=Object.entries(l).sort((v,O)=>O[1].priority-v[1].priority);var p=Y();s.setRecordUndo$$module$build$src$core$events$utils(r),(r=s.getGroup$$module$build$src$core$events$utils())||s.setGroup$$module$build$src$core$events$utils(!0),Wn(),t instanceof Gr&&t.setResizesEnabled(!1);for(const[,v]of l.reverse()){let O;(O=v)==null||O.clear(t)}for(const[v,O]of l.reverse())if(e[v]){let G;(G=O)==null||G.load(e[v],t)}t instanceof Gr&&t.setResizesEnabled(!0),Xn(),te(new(Ce(ge.FINISHED_LOADING))(t)),s.setGroup$$module$build$src$core$events$utils(r),s.setRecordUndo$$module$build$src$core$events$utils(p)}},_b=function(e,t){let r=null;r=typeof e=="string"?document.getElementById(e)||document.querySelector(e):e;var l;if(!document.contains(r)&&document!==((l=r)==null?void 0:l.ownerDocument))throw Error("Error: container is not in current document");e=new Wr(t||{}),l=document.createElement("div"),Pe(l,"injectionDiv"),t!=null&&t.rtl&&Pe(l,"blocklyRTL"),l.tabIndex=0,qt(l,hs.LABEL,s.Msg$$module$build$src$core$msg.WORKSPACE_ARIA_LABEL),r.appendChild(l),t=lg(l,e);const p=_d(l,t,e);return wb(p),at(p),tt(p),l.addEventListener("focusin",function(){at(p)}),He(l,"keydown",null,wd),p},lg=function(e,t){e.setAttribute("dir","LTR"),je(t.hasCss,t.pathToMedia),e=ie(ae.SVG,{xmlns:Xc,"xmlns:html":ki,"xmlns:xlink":ar,version:"1.1",class:"blocklySvg",tabindex:"0"},e);const r=ie(ae.DEFS,{},e),l=String(Math.random()).substring(2);return t.gridPattern=ao.createDom(l,t.gridOptions,r),e},_d=function(e,t,r){r.parentWorkspace=null,r=new Gr(r);const l=r.options;r.scale=l.zoomOptions.startScale,t.appendChild(r.createDom("blocklyMainBackground",e));var p=r.getRenderer().getClassName();return p&&Pe(e,p),(p=r.getTheme().getClassName())&&Pe(e,p),!l.hasCategories&&l.languageTree&&(e=r.addFlyout(ae.SVG),yn(e,t)),l.hasTrashcan&&r.addTrashcan(),l.zoomOptions&&l.zoomOptions.controls&&r.addZoomControls(),r.getThemeManager().subscribe(t,"workspaceBackgroundColour","background-color"),r.translate(0,0),r.addChangeListener(Ml(r)),tt(r),Fp(),bi(),Oo(),r},wb=function(e){const t=e.options;var r=e.getParentSvg();if(He(r.parentNode,"contextmenu",null,function(l){Tn(l)||l.preventDefault()}),r=He(window,"resize",null,function(){Hi(),e.hideComponents(!0),Ic(),Sl(),tt(e),Pc(e)}),e.setResizeHandlerWrapper(r),cg(),t.languageTree){r=e.getToolbox();const l=e.getFlyout(!0);r?r.init():l&&(l.init(e),l.show(t.languageTree),typeof l.scrollToStart=="function"&&l.scrollToStart())}t.hasTrashcan&&e.trashcan.init(),t.zoomOptions&&t.zoomOptions.controls&&e.zoomControls_.init(),t.moveOptions&&t.moveOptions.scrollbars?(e.scrollbar=new xf(e,t.moveOptions.scrollbars===!0||!!t.moveOptions.scrollbars.horizontal,t.moveOptions.scrollbars===!0||!!t.moveOptions.scrollbars.vertical,"blocklyMainWorkspaceScrollbar"),e.scrollbar.resize()):e.setMetrics({x:.5,y:.5}),t.hasSounds&&ug(t.pathToMedia,e)},wd=function(e){const t=Ke();t&&!(Tn(e)||t.rendered&&!t.isVisible())&&an.registry.onKeyDown(t,e)},cg=function(){z$||(He(document,"scroll",null,function(){const e=Te();for(let t=0,r;r=e[t];t++)r instanceof Gr&&r.updateInverseScreenCTM()}),Ft(document,"touchend",null,en),Ft(document,"touchcancel",null,en)),z$=!0},ug=function(e,t){function r(){for(;p.length;){const v=p.pop();v&&St(v)}l.preload()}const l=t.getAudioManager();l.load([e+"click.mp3",e+"click.wav",e+"click.ogg"],"click"),l.load([e+"disconnect.wav",e+"disconnect.mp3",e+"disconnect.ogg"],"disconnect"),l.load([e+"delete.mp3",e+"delete.ogg",e+"delete.wav"],"delete");const p=[];p.push(He(document,"pointermove",null,r,!0)),p.push(He(document,"touchstart",null,r,!0))},Sd=function(){At.registry.register({displayText(){return s.Msg$$module$build$src$core$msg.UNDO},preconditionFn(e){return 0<e.workspace.getUndoStack().length?"enabled":"disabled"},callback(e){e.workspace.undo(!1)},scopeType:At.ScopeType.WORKSPACE,id:"undoWorkspace",weight:1})},Ll=function(){At.registry.register({displayText(){return s.Msg$$module$build$src$core$msg.REDO},preconditionFn(e){return 0<e.workspace.getRedoStack().length?"enabled":"disabled"},callback(e){e.workspace.undo(!0)},scopeType:At.ScopeType.WORKSPACE,id:"redoWorkspace",weight:2})},dg=function(){At.registry.register({displayText(){return s.Msg$$module$build$src$core$msg.CLEAN_UP},preconditionFn(e){return e.workspace.isMovable()?1<e.workspace.getTopBlocks(!1).length?"enabled":"disabled":"hidden"},callback(e){e.workspace.cleanUp()},scopeType:At.ScopeType.WORKSPACE,id:"cleanWorkspace",weight:3})},Cd=function(e,t){function r(v){p--,v.setCollapsed(e),p===0&&s.setGroup$$module$build$src$core$events$utils(!1)}let l=0,p=0;s.setGroup$$module$build$src$core$events$utils(!0);for(let v=0;v<t.length;v++){let O=t[v];for(;O;)p++,setTimeout(r.bind(null,O),l),O=O.getNextBlock(),l+=10}},Td=function(){At.registry.register({displayText(){return s.Msg$$module$build$src$core$msg.COLLAPSE_ALL},preconditionFn(e){if(e.workspace.options.collapse){e=e.workspace.getTopBlocks(!1);for(let t=0;t<e.length;t++){let r=e[t];for(;r;){if(!r.isCollapsed())return"enabled";r=r.getNextBlock()}}return"disabled"}return"hidden"},callback(e){Cd(!0,e.workspace.getTopBlocks(!0))},scopeType:At.ScopeType.WORKSPACE,id:"collapseWorkspace",weight:4})},hg=function(){At.registry.register({displayText(){return s.Msg$$module$build$src$core$msg.EXPAND_ALL},preconditionFn(e){if(e.workspace.options.collapse){e=e.workspace.getTopBlocks(!1);for(let t=0;t<e.length;t++){let r=e[t];for(;r;){if(r.isCollapsed())return"enabled";r=r.getNextBlock()}}return"disabled"}return"hidden"},callback(e){Cd(!1,e.workspace.getTopBlocks(!0))},scopeType:At.ScopeType.WORKSPACE,id:"expandWorkspace",weight:5})},Ed=function(e,t){if(e.isDeletable())Array.prototype.push.apply(t,e.getDescendants(!1));else{e=e.getChildren(!1);for(let r=0;r<e.length;r++)Ed(e[r],t)}},kd=function(e){const t=[];e=e.getTopBlocks(!0);for(let r=0;r<e.length;r++)Ed(e[r],t);return t},Ia=function(e,t){t?s.setGroup$$module$build$src$core$events$utils(t):(s.setGroup$$module$build$src$core$events$utils(!0),t=s.getGroup$$module$build$src$core$events$utils());const r=e.shift();r&&(r.isDeadOrDying()?Ia(e,t):(r.dispose(!1,!0),setTimeout(Ia,10,e,t))),s.setGroup$$module$build$src$core$events$utils(!1)},Id=function(){At.registry.register({displayText(e){return e.workspace?(e=kd(e.workspace).length,e===1?s.Msg$$module$build$src$core$msg.DELETE_BLOCK:s.Msg$$module$build$src$core$msg.DELETE_X_BLOCKS.replace("%1",`${e}`)):""},preconditionFn(e){return e.workspace&&0<kd(e.workspace).length?"enabled":"disabled"},callback(e){if(e.workspace){e.workspace.cancelCurrentGesture();var t=kd(e.workspace);2>t.length?Ia(t):ll(s.Msg$$module$build$src$core$msg.DELETE_ALL_BLOCKS.replace("%1",String(t.length)),function(r){r&&Ia(t)})}},scopeType:At.ScopeType.WORKSPACE,id:"workspaceDelete",weight:6})},xd=function(){Sd(),Ll(),dg(),Td(),hg(),Id()},pg=function(){At.registry.register({displayText(){return s.Msg$$module$build$src$core$msg.DUPLICATE_BLOCK},preconditionFn(e){return e=e.block,!e.isInFlyout&&e.isDeletable()&&e.isMovable()?e.isDuplicatable()?"enabled":"disabled":"hidden"},callback(e){if(e.block){var t=e.block.toCopyData();t&&Fo(t,e.block.workspace)}},scopeType:At.ScopeType.BLOCK,id:"blockDuplicate",weight:1})},jc=function(){At.registry.register({displayText(e){return e.block.hasIcon(co.TYPE)?s.Msg$$module$build$src$core$msg.REMOVE_COMMENT:s.Msg$$module$build$src$core$msg.ADD_COMMENT},preconditionFn(e){return e=e.block,!e.isInFlyout&&e.workspace.options.comments&&!e.isCollapsed()&&e.isEditable()?"enabled":"hidden"},callback(e){e=e.block,e.hasIcon(co.TYPE)?e.setCommentText(null):e.setCommentText("")},scopeType:At.ScopeType.BLOCK,id:"blockComment",weight:2})},Rt=function(){At.registry.register({displayText(e){return e.block.getInputsInline()?s.Msg$$module$build$src$core$msg.EXTERNAL_INPUTS:s.Msg$$module$build$src$core$msg.INLINE_INPUTS},preconditionFn(e){if(e=e.block,!e.isInFlyout&&e.isMovable()&&!e.isCollapsed()){for(let t=1;t<e.inputList.length;t++)if(!(e.inputList[t-1]instanceof Ch||e.inputList[t]instanceof Ch))return"enabled"}return"hidden"},callback(e){e.block.setInputsInline(!e.block.getInputsInline())},scopeType:At.ScopeType.BLOCK,id:"blockInline",weight:3})},gg=function(){At.registry.register({displayText(e){return e.block.isCollapsed()?s.Msg$$module$build$src$core$msg.EXPAND_BLOCK:s.Msg$$module$build$src$core$msg.COLLAPSE_BLOCK},preconditionFn(e){return e=e.block,!e.isInFlyout&&e.isMovable()&&e.workspace.options.collapse?"enabled":"hidden"},callback(e){e.block.setCollapsed(!e.block.isCollapsed())},scopeType:At.ScopeType.BLOCK,id:"blockCollapseExpand",weight:4})},fg=function(){At.registry.register({displayText(e){return e.block.hasDisabledReason(Hs)?s.Msg$$module$build$src$core$msg.ENABLE_BLOCK:s.Msg$$module$build$src$core$msg.DISABLE_BLOCK},preconditionFn(e){if(e=e.block,!e.isInFlyout&&e.workspace.options.disable&&e.isEditable()){var t=e.getDisabledReasons();return t=t.size>(t.has(Hs)?1:0),e.getInheritedDisabled()||t?"disabled":"enabled"}return"hidden"},callback(e){e=e.block;const t=s.getGroup$$module$build$src$core$events$utils();t||s.setGroup$$module$build$src$core$events$utils(!0),e.setDisabledReason(!e.hasDisabledReason(Hs),Hs),s.setGroup$$module$build$src$core$events$utils(t)},scopeType:At.ScopeType.BLOCK,id:"blockDisable",weight:5})},xa=function(){At.registry.register({displayText(e){var t=e.block;return e=t.getDescendants(!1).length,(t=t.getNextBlock())&&(e-=t.getDescendants(!1).length),e===1?s.Msg$$module$build$src$core$msg.DELETE_BLOCK:s.Msg$$module$build$src$core$msg.DELETE_X_BLOCKS.replace("%1",`${e}`)},preconditionFn(e){return!e.block.isInFlyout&&e.block.isDeletable()?"enabled":"hidden"},callback(e){e.block&&e.block.checkAndDelete()},scopeType:At.ScopeType.BLOCK,id:"blockDelete",weight:6})},Dd=function(){At.registry.register({displayText(){return s.Msg$$module$build$src$core$msg.HELP},preconditionFn(e){return e=e.block,(typeof e.helpUrl=="function"?e.helpUrl():e.helpUrl)?"enabled":"hidden"},callback(e){e.block.showHelp()},scopeType:At.ScopeType.BLOCK,id:"blockHelp",weight:7})},mg=function(){At.registry.register({displayText:()=>s.Msg$$module$build$src$core$msg.REMOVE_COMMENT,preconditionFn(e){let t;return(t=e.comment)!=null&&t.isDeletable()?"enabled":"hidden"},callback(e){s.setGroup$$module$build$src$core$events$utils(!0);let t;(t=e.comment)==null||t.dispose(),s.setGroup$$module$build$src$core$events$utils(!1)},scopeType:At.ScopeType.COMMENT,id:"commentDelete",weight:6})},bg=function(){At.registry.register({displayText:()=>s.Msg$$module$build$src$core$msg.DUPLICATE_COMMENT,preconditionFn(e){let t;return(t=e.comment)!=null&&t.isMovable()?"enabled":"hidden"},callback(e){if(e.comment){var t=e.comment.toCopyData();t&&Fo(t,e.comment.workspace)}},scopeType:At.ScopeType.COMMENT,id:"commentDuplicate",weight:1})},rr=function(){At.registry.register({displayText:()=>s.Msg$$module$build$src$core$msg.ADD_COMMENT,preconditionFn:()=>"enabled",callback:(e,t)=>{if(e=e.workspace){s.setGroup$$module$build$src$core$events$utils(!0);var r=new th(e);r.setText(s.Msg$$module$build$src$core$msg.WORKSPACE_COMMENT_DEFAULT_TEXT),r.moveTo(Sb(new Ae(t.clientX,t.clientY),e)),s.setSelected$$module$build$src$core$common(r),s.setGroup$$module$build$src$core$events$utils(!1)}},scopeType:At.ScopeType.WORKSPACE,id:"commentCreate",weight:8})},Sb=function(e,t){var r=t.getInjectionDiv().getBoundingClientRect();return e=new Ae(e.x-r.left,e.y-r.top),r=t.getOriginOffsetInPixels(),e=Ae.difference(e,r),e.scale(1/t.scale),e},zc=function(){pg(),jc(),Rt(),gg(),fg(),xa(),Dd()},Od=function(){bg(),mg(),rr()},Rd=function(){xd(),zc()},$g=function(e){return e.paste!==void 0},ir=function(e){return e.getSvgRoot!==void 0},Zi=function(e){return typeof e.id=="string"&&e.workspace!==void 0&&e.select!==void 0&&e.unselect!==void 0},Ad=function(e){return e.isSelectable()},vg=function(e){Ke().hideChaff(e)},xe=xe||{},xe.scope={},xe.ASSUME_ES5=!1,xe.ASSUME_NO_NATIVE_MAP=!1,xe.ASSUME_NO_NATIVE_SET=!1,xe.SIMPLE_FROUND_POLYFILL=!1,xe.ISOLATE_POLYFILLS=!1,xe.FORCE_POLYFILL_PROMISE=!1,xe.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1,xe.defineProperty=xe.ASSUME_ES5||typeof Object.defineProperties=="function"?Object.defineProperty:function(e,t,r){return e==Array.prototype||e==Object.prototype||(e[t]=r.value),e},xe.getGlobal=function(e){e=[typeof globalThis=="object"&&globalThis,e,typeof window=="object"&&window,typeof self=="object"&&self,typeof ei=="object"&&ei];for(var t=0;t<e.length;++t){var r=e[t];if(r&&r.Math==Math)return r}throw Error("Cannot find global object")},xe.global=xe.getGlobal(this),xe.IS_SYMBOL_NATIVE=typeof Symbol=="function"&&typeof Symbol("x")=="symbol",xe.TRUST_ES6_POLYFILLS=!xe.ISOLATE_POLYFILLS||xe.IS_SYMBOL_NATIVE,xe.polyfills={},xe.propertyToPolyfillSymbol={},xe.POLYFILL_PREFIX="$jscp$",xe.polyfill=function(e,t,r,l){t&&(xe.ISOLATE_POLYFILLS?xe.polyfillIsolated(e,t,r,l):xe.polyfillUnisolated(e,t,r,l))},xe.polyfillUnisolated=function(e,t,r,l){for(r=xe.global,e=e.split("."),l=0;l<e.length-1;l++){var p=e[l];if(!(p in r))return;r=r[p]}e=e[e.length-1],l=r[e],t=t(l),t!=l&&t!=null&&xe.defineProperty(r,e,{configurable:!0,writable:!0,value:t})},xe.polyfillIsolated=function(e,t,r,l){var p=e.split(".");e=p.length===1,l=p[0],l=!e&&l in xe.polyfills?xe.polyfills:xe.global;for(var v=0;v<p.length-1;v++){var O=p[v];if(!(O in l))return;l=l[O]}p=p[p.length-1],r=xe.IS_SYMBOL_NATIVE&&r==="es6"?l[p]:null,t=t(r),t!=null&&(e?xe.defineProperty(xe.polyfills,p,{configurable:!0,writable:!0,value:t}):t!==r&&(xe.propertyToPolyfillSymbol[p]===void 0&&(r=1e9*Math.random()>>>0,xe.propertyToPolyfillSymbol[p]=xe.IS_SYMBOL_NATIVE?xe.global.Symbol(p):xe.POLYFILL_PREFIX+r+"$"+p),xe.defineProperty(l,xe.propertyToPolyfillSymbol[p],{configurable:!0,writable:!0,value:t})))},xe.underscoreProtoCanBeSet=function(){var e={a:!0},t={};try{return t.__proto__=e,t.a}catch{}return!1},xe.setPrototypeOf=xe.TRUST_ES6_POLYFILLS&&typeof Object.setPrototypeOf=="function"?Object.setPrototypeOf:xe.underscoreProtoCanBeSet()?function(e,t){if(e.__proto__=t,e.__proto__!==t)throw new TypeError(e+" is not extensible");return e}:null,xe.arrayIteratorImpl=function(e){var t=0;return function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}},xe.arrayIterator=function(e){return{next:xe.arrayIteratorImpl(e)}},xe.makeIterator=function(e){var t=typeof Symbol<"u"&&Symbol.iterator&&e[Symbol.iterator];if(t)return t.call(e);if(typeof e.length=="number")return xe.arrayIterator(e);throw Error(String(e)+" is not an iterable or ArrayLike")},xe.generator={},xe.generator.ensureIteratorResultIsObject_=function(e){if(!(e instanceof Object))throw new TypeError("Iterator result "+e+" is not an object")},xe.generator.Context=function(){this.isRunning_=!1,this.yieldAllIterator_=null,this.yieldResult=void 0,this.nextAddress=1,this.finallyAddress_=this.catchAddress_=0,this.finallyContexts_=this.abruptCompletion_=null},xe.generator.Context.prototype.start_=function(){if(this.isRunning_)throw new TypeError("Generator is already running");this.isRunning_=!0},xe.generator.Context.prototype.stop_=function(){this.isRunning_=!1},xe.generator.Context.prototype.jumpToErrorHandler_=function(){this.nextAddress=this.catchAddress_||this.finallyAddress_},xe.generator.Context.prototype.next_=function(e){this.yieldResult=e},xe.generator.Context.prototype.throw_=function(e){this.abruptCompletion_={exception:e,isException:!0},this.jumpToErrorHandler_()},xe.generator.Context.prototype.return=function(e){this.abruptCompletion_={return:e},this.nextAddress=this.finallyAddress_},xe.generator.Context.prototype.jumpThroughFinallyBlocks=function(e){this.abruptCompletion_={jumpTo:e},this.nextAddress=this.finallyAddress_},xe.generator.Context.prototype.yield=function(e,t){return this.nextAddress=t,{value:e}},xe.generator.Context.prototype.yieldAll=function(e,t){e=xe.makeIterator(e);var r=e.next();if(xe.generator.ensureIteratorResultIsObject_(r),r.done)this.yieldResult=r.value,this.nextAddress=t;else return this.yieldAllIterator_=e,this.yield(r.value,t)},xe.generator.Context.prototype.jumpTo=function(e){this.nextAddress=e},xe.generator.Context.prototype.jumpToEnd=function(){this.nextAddress=0},xe.generator.Context.prototype.setCatchFinallyBlocks=function(e,t){this.catchAddress_=e,t!=null&&(this.finallyAddress_=t)},xe.generator.Context.prototype.setFinallyBlock=function(e){this.catchAddress_=0,this.finallyAddress_=e||0},xe.generator.Context.prototype.leaveTryBlock=function(e,t){this.nextAddress=e,this.catchAddress_=t||0},xe.generator.Context.prototype.enterCatchBlock=function(e){return this.catchAddress_=e||0,e=this.abruptCompletion_.exception,this.abruptCompletion_=null,e},xe.generator.Context.prototype.enterFinallyBlock=function(e,t,r){r?this.finallyContexts_[r]=this.abruptCompletion_:this.finallyContexts_=[this.abruptCompletion_],this.catchAddress_=e||0,this.finallyAddress_=t||0},xe.generator.Context.prototype.leaveFinallyBlock=function(e,t){if(t=this.finallyContexts_.splice(t||0)[0],t=this.abruptCompletion_=this.abruptCompletion_||t){if(t.isException)return this.jumpToErrorHandler_();t.jumpTo!=null&&this.finallyAddress_<t.jumpTo?(this.nextAddress=t.jumpTo,this.abruptCompletion_=null):this.nextAddress=this.finallyAddress_}else this.nextAddress=e},xe.generator.Context.prototype.forIn=function(e){return new xe.generator.Context.PropertyIterator(e)},xe.generator.Context.PropertyIterator=function(e){this.object_=e,this.properties_=[];for(var t in e)this.properties_.push(t);this.properties_.reverse()},xe.generator.Context.PropertyIterator.prototype.getNext=function(){for(;0<this.properties_.length;){var e=this.properties_.pop();if(e in this.object_)return e}return null},xe.generator.Engine_=function(e){this.context_=new xe.generator.Context,this.program_=e},xe.generator.Engine_.prototype.next_=function(e){return this.context_.start_(),this.context_.yieldAllIterator_?this.yieldAllStep_(this.context_.yieldAllIterator_.next,e,this.context_.next_):(this.context_.next_(e),this.nextStep_())},xe.generator.Engine_.prototype.return_=function(e){this.context_.start_();var t=this.context_.yieldAllIterator_;return t?this.yieldAllStep_("return"in t?t.return:function(r){return{value:r,done:!0}},e,this.context_.return):(this.context_.return(e),this.nextStep_())},xe.generator.Engine_.prototype.throw_=function(e){return this.context_.start_(),this.context_.yieldAllIterator_?this.yieldAllStep_(this.context_.yieldAllIterator_.throw,e,this.context_.next_):(this.context_.throw_(e),this.nextStep_())},xe.generator.Engine_.prototype.yieldAllStep_=function(e,t,r){try{var l=e.call(this.context_.yieldAllIterator_,t);if(xe.generator.ensureIteratorResultIsObject_(l),!l.done)return this.context_.stop_(),l;var p=l.value}catch(v){return this.context_.yieldAllIterator_=null,this.context_.throw_(v),this.nextStep_()}return this.context_.yieldAllIterator_=null,r.call(this.context_,p),this.nextStep_()},xe.generator.Engine_.prototype.nextStep_=function(){for(;this.context_.nextAddress;)try{var e=this.program_(this.context_);if(e)return this.context_.stop_(),{value:e.value,done:!1}}catch(t){this.context_.yieldResult=void 0,this.context_.throw_(t)}if(this.context_.stop_(),this.context_.abruptCompletion_){if(e=this.context_.abruptCompletion_,this.context_.abruptCompletion_=null,e.isException)throw e.exception;return{value:e.return,done:!0}}return{value:void 0,done:!0}},xe.generator.Generator_=function(e){this.next=function(t){return e.next_(t)},this.throw=function(t){return e.throw_(t)},this.return=function(t){return e.return_(t)},this[Symbol.iterator]=function(){return this}},xe.generator.createGenerator=function(e,t){return t=new xe.generator.Generator_(new xe.generator.Engine_(t)),xe.setPrototypeOf&&e.prototype&&xe.setPrototypeOf(t,e.prototype),t},xe.asyncExecutePromiseGenerator=function(e){function t(l){return e.next(l)}function r(l){return e.throw(l)}return new Promise(function(l,p){function v(O){O.done?l(O.value):Promise.resolve(O.value).then(t,r).then(v,p)}v(e.next())})},xe.asyncExecutePromiseGeneratorFunction=function(e){return xe.asyncExecutePromiseGenerator(e())},xe.asyncExecutePromiseGeneratorProgram=function(e){return xe.asyncExecutePromiseGenerator(new xe.generator.Generator_(new xe.generator.Engine_(e)))},xe.polyfill("globalThis",function(e){return e||xe.global},"es_2020","es3"),xe.polyfill("Array.prototype.includes",function(e){return e||function(t,r){var l=this;l instanceof String&&(l=String(l));var p=l.length;for(r=r||0,0>r&&(r=Math.max(r+p,0));r<p;r++){var v=l[r];if(v===t||Object.is(v,t))return!0}return!1}},"es7","es3"),xe.initSymbol=function(){},xe.iteratorPrototype=function(e){return e={next:e},e[Symbol.iterator]=function(){return this},e},xe.iteratorFromArray=function(e,t){e instanceof String&&(e+="");var r=0,l=!1,p={next:function(){if(!l&&r<e.length){var v=r++;return{value:t(v,e[v]),done:!1}}return l=!0,{done:!0,value:void 0}}};return p[Symbol.iterator]=function(){return p},p},xe.polyfill("Array.prototype.values",function(e){return e||function(){return xe.iteratorFromArray(this,function(t,r){return r})}},"es8","es3"),xe.polyfill("Array.prototype.flat",function(e){return e||function(t){t=t===void 0?1:t;var r=[];return Array.prototype.forEach.call(this,function(l){Array.isArray(l)&&0<t?(l=Array.prototype.flat.call(l,t-1),r.push.apply(r,l)):r.push(l)}),r}},"es9","es5"),xe.polyfill("Array.prototype.flatMap",function(e){return e||function(t,r){var l=[];return Array.prototype.forEach.call(this,function(p,v){p=t.call(r,p,v,this),Array.isArray(p)?l.push.apply(l,p):l.push(p)}),l}},"es9","es5"),xe.owns=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},xe.polyfill("Object.entries",function(e){return e||function(t){var r=[],l;for(l in t)xe.owns(t,l)&&r.push([l,t[l]]);return r}},"es8","es3"),xe.polyfill("Object.values",function(e){return e||function(t){var r=[],l;for(l in t)xe.owns(t,l)&&r.push(t[l]);return r}},"es8","es3");var Qi=Object.create(null),yg={typeMap:Qi},Uc=Object.create(null),Pr="default",Ne=class{constructor(e){this.name=e}toString(){return this.name}};Ne.CONNECTION_CHECKER=new Ne("connectionChecker"),Ne.CONNECTION_PREVIEWER=new Ne("connectionPreviewer"),Ne.CURSOR=new Ne("cursor"),Ne.EVENT=new Ne("event"),Ne.FIELD=new Ne("field"),Ne.INPUT=new Ne("input"),Ne.RENDERER=new Ne("renderer"),Ne.TOOLBOX=new Ne("toolbox"),Ne.THEME=new Ne("theme"),Ne.TOOLBOX_ITEM=new Ne("toolboxItem"),Ne.FLYOUTS_VERTICAL_TOOLBOX=new Ne("flyoutsVerticalToolbox"),Ne.FLYOUTS_HORIZONTAL_TOOLBOX=new Ne("flyoutsHorizontalToolbox"),Ne.METRICS_MANAGER=new Ne("metricsManager"),Ne.BLOCK_DRAGGER=new Ne("blockDragger"),Ne.SERIALIZER=new Ne("serializer"),Ne.ICON=new Ne("icon"),Ne.PASTER=new Ne("paster");var Ds={DEFAULT:Pr,TEST_ONLY:yg};Ds.Type=Ne,Ds.getAllItems=y,Ds.getClass=b,Ds.getClassFromOptions=w,Ds.getObject=$,Ds.hasItem=g,Ds.register=i,Ds.unregister=c;var or=Object.create(null),ge;(function(e){e.BLOCK_CREATE="create",e.BLOCK_DELETE="delete",e.BLOCK_CHANGE="change",e.BLOCK_FIELD_INTERMEDIATE_CHANGE="block_field_intermediate_change",e.BLOCK_MOVE="move",e.VAR_CREATE="var_create",e.VAR_DELETE="var_delete",e.VAR_RENAME="var_rename",e.UI="ui",e.BLOCK_DRAG="drag",e.SELECTED="selected",e.CLICK="click",e.MARKER_MOVE="marker_move",e.BUBBLE_OPEN="bubble_open",e.TRASHCAN_OPEN="trashcan_open",e.TOOLBOX_ITEM_SELECT="toolbox_item_select",e.THEME_CHANGE="theme_change",e.VIEWPORT_CHANGE="viewport_change",e.COMMENT_CREATE="comment_create",e.COMMENT_DELETE="comment_delete",e.COMMENT_CHANGE="comment_change",e.COMMENT_MOVE="comment_move",e.COMMENT_RESIZE="comment_resize",e.COMMENT_DRAG="comment_drag",e.COMMENT_COLLAPSE="comment_collapse",e.FINISHED_LOADING="finished_loading"})(ge||(ge={}));var _g=[ge.BLOCK_CREATE,ge.BLOCK_MOVE,ge.COMMENT_CREATE,ge.COMMENT_MOVE],wg=new Set,Nd={};Nd.warn=C;var Cb="!#$%()*+,-./:;=?@[]^_`{|}~ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",Tb={genUid:()=>{const e=Cb.length,t=[];for(let r=0;20>r;r++)t[r]=Cb.charAt(Math.random()*e);return t.join("")}},Dy=0,Md={TEST_ONLY:Tb};Md.genUid=k,Md.getNextUniqueId=S;var Sg="",Hc=!0,Ld=0,Bd="ORPHANED_BLOCK",Kn=[],ai={FIRE_QUEUE:Kn,enqueueEvent:Q,fireNow:ne,fireInternal:J,setGroupInternal:De};s.disable$$module$build$src$core$events$utils,s.enable$$module$build$src$core$events$utils,s.getGroup$$module$build$src$core$events$utils,s.setGroup$$module$build$src$core$events$utils,s.setRecordUndo$$module$build$src$core$events$utils;var Wc=Object.create(null),Eb,Ci=null,Da,Bl=[],Cg={defineBlocksWithJsonArrayInternal:Fn},_s={TEST_ONLY:Cg};_s.createBlockDefinitionsFromJsonArray=s.createBlockDefinitionsFromJsonArray$$module$build$src$core$common,_s.defineBlocks=s.defineBlocks$$module$build$src$core$common,_s.defineBlocksWithJsonArray=Ut,_s.draggingConnections=Bl,_s.getAllWorkspaces=Te,_s.getBlockTypeCounts=It,_s.getMainWorkspace=Ke,_s.getParentContainer=ut,_s.getSelected=Ue,_s.getWorkspaceById=pe,_s.registerWorkspace=ke,_s.setMainWorkspace=at,_s.setParentContainer=rt,_s.setSelected=s.setSelected$$module$build$src$core$common,_s.svgResize=tt,_s.unregisterWorkpace=Xe;var Oa=class{constructor(){this.workspaceId=void 0,this.isUiEvent=!1,this.type="",this.group=s.getGroup$$module$build$src$core$events$utils(),this.recordUndo=Y()}toJson(){return{type:this.type,group:this.group}}static fromJson(e,t,r){return r.isBlank=!1,r.group=e.group||"",r.workspaceId=t.id,r}isNull(){return!1}run(e){}getEventWorkspace_(){let e;if(this.workspaceId&&(e=pe(this.workspaceId)),!e)throw Error("Workspace is null. Event must have been generated from real Blockly events.");return e}},Os=class extends Oa{constructor(e){super(),this.recordUndo=!1,this.isUiEvent=!0,this.isBlank=typeof e>"u",this.workspaceId=e||""}},Ra=class extends Os{constructor(e,t,r){t=e?e.workspace.id:t,t===null&&(t=void 0),super(t),this.type=ge.CLICK,this.blockId=e?e.id:void 0,this.targetType=r}toJson(){const e=super.toJson();if(!this.targetType)throw Error("The click target type is undefined. Either pass a block to the constructor, or call fromJson");return e.targetType=this.targetType,e.blockId=this.blockId,e}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new Ra),t.targetType=e.targetType,t.blockId=e.blockId,t}},Tg;(function(e){e.BLOCK="block",e.WORKSPACE="workspace",e.ZOOM_CONTROLS="zoom_controls"})(Tg||(Tg={})),i(Ne.EVENT,ge.CLICK,Ra);var kb=750,Eg="ontouchstart"in globalThis||!!(globalThis.document&&document.documentElement&&"ontouchstart"in document.documentElement)||!(!globalThis.navigator||!globalThis.navigator.maxTouchPoints&&!globalThis.navigator.msMaxTouchPoints),Aa=null,jo={mousedown:["pointerdown"],mouseenter:["pointerenter"],mouseleave:["pointerleave"],mousemove:["pointermove"],mouseout:["pointerout"],mouseover:["pointerover"],mouseup:["pointerup","pointercancel"],touchend:["pointerup"],touchcancel:["pointercancel"]},Na=0,eo={TOUCH_ENABLED:Eg,TOUCH_MAP:jo};eo.checkTouchIdentifier=Ln,eo.clearTouchIdentifier=Ot,eo.getTouchIdentifierFromEvent=vn,eo.longStart=Xt,eo.longStop=en,eo.shouldHandleEvent=Lt;var Pl,Ib,kg,Vc,Gc,Fl,Ig,xg,Ti,Dg;(function(e){function t(l){return r.includes(l.toUpperCase())}Pl=e;const r=Pl.toUpperCase();Ib=t("JavaFX"),kg=t("WebKit"),Vc=t("Gecko")&&!kg,Gc=t("Android"),e=globalThis.navigator&&globalThis.navigator.maxTouchPoints,Fl=t("iPad")||t("Macintosh")&&0<e,Ig=t("iPhone")&&!Fl,xg=t("Macintosh"),Ti=Fl||Gc&&!t("Mobile")||t("Silk"),Dg=!Ti&&(Ig||Gc)})(globalThis.navigator&&globalThis.navigator.userAgent||"");var xb=Pl,Db=Ib,Og=Vc,Rg=Gc,Pd=Fl,Ei=Ig,qc=xg,Fd=Dg,Ag={ANDROID:Rg,GECKO:Og,IPAD:Pd,IPHONE:Ei,JavaFx:Db,MAC:qc,MOBILE:Fd,raw:xb},Kc=40,Ma=125,ot={};ot.bind=Ft,ot.conditionalBind=He,ot.getScrollDeltaPixels=fe,ot.isRightButton=os,ot.isTargetInput=Tn,ot.mouseToSvg=Ee,ot.unbind=St;var Jc={};Jc.removeElem=ue;var li=class{constructor(e){this.name=e}toString(){return this.name}};li.POSITIONABLE=new li("positionable"),li.DRAG_TARGET=new li("drag_target"),li.DELETE_AREA=new li("delete_area"),li.AUTOHIDEABLE=new li("autohideable");var un=class{constructor(){this.componentData=new Map,this.capabilityToComponentIds=new Map}addComponent(e,t){const r=e.component.id;if(!t&&this.componentData.has(r)){var l;throw Error('Plugin "'+r+'" with capabilities "'+((l=this.componentData.get(r))==null?void 0:l.capabilities)+'" already added.')}for(this.componentData.set(r,e),t=[],l=0;l<e.capabilities.length;l++){const p=String(e.capabilities[l]).toLowerCase();if(t.push(p),this.capabilityToComponentIds.has(p)){let v;(v=this.capabilityToComponentIds.get(p))==null||v.push(r)}else this.capabilityToComponentIds.set(p,[r])}this.componentData.get(r).capabilities=t}removeComponent(e){const t=this.componentData.get(e);if(t){for(let r=0;r<t.capabilities.length;r++){const l=String(t.capabilities[r]).toLowerCase();ue(this.capabilityToComponentIds.get(l),e)}this.componentData.delete(e)}}addCapability(e,t){if(!this.getComponent(e))throw Error('Cannot add capability, "'+t+'". Plugin "'+e+'" has not been added to the ComponentManager');if(this.hasCapability(e,t))console.warn('Plugin "'+e+'already has capability "'+t+'"');else{t=`${t}`.toLowerCase();var r;(r=this.componentData.get(e))==null||r.capabilities.push(t);var l;(l=this.capabilityToComponentIds.get(t))==null||l.push(e)}}removeCapability(e,t){if(!this.getComponent(e))throw Error('Cannot remove capability, "'+t+'". Plugin "'+e+'" has not been added to the ComponentManager');this.hasCapability(e,t)?(t=`${t}`.toLowerCase(),ue(this.componentData.get(e).capabilities,t),ue(this.capabilityToComponentIds.get(t),e)):console.warn('Plugin "'+e+`doesn't have capability "`+t+'" to remove')}hasCapability(e,t){return t=`${t}`.toLowerCase(),this.componentData.has(e)&&this.componentData.get(e).capabilities.includes(t)}getComponent(e){let t;return(t=this.componentData.get(e))==null?void 0:t.component}getComponents(e,t){if(e=`${e}`.toLowerCase(),e=this.capabilityToComponentIds.get(e),!e)return[];const r=[];if(t){const l=[];e.forEach(p=>{l.push(this.componentData.get(p))}),l.sort(function(p,v){return p.weight-v.weight}),l.forEach(function(p){r.push(p.component)})}else e.forEach(l=>{r.push(this.componentData.get(l).component)});return r}};un.Capability=li,function(e){e=e.ComponentWeight||(e.ComponentWeight={}),e[e.TOOLBOX_WEIGHT=0]="TOOLBOX_WEIGHT",e[e.FLYOUT_WEIGHT=1]="FLYOUT_WEIGHT",e[e.TRASHCAN_WEIGHT=2]="TRASHCAN_WEIGHT",e[e.ZOOM_CONTROLS_WEIGHT=3]="ZOOM_CONTROLS_WEIGHT"}(un),un.ComponentWeight;var Ng=!1,Yc=`
.blocklySvg {
  background-color: #fff;
  outline: none;
  overflow: hidden;  /* IE overflows by default. */
  position: absolute;
  display: block;
}

.blocklyWidgetDiv {
  display: none;
  position: absolute;
  z-index: 99999;  /* big value for bootstrap3 compatibility */
}

.injectionDiv {
  height: 100%;
  position: relative;
  overflow: hidden;  /* So blocks in drag surface disappear at edges */
  touch-action: none;
  user-select: none;
  -webkit-user-select: none;
}

.blocklyNonSelectable {
  user-select: none;
  -ms-user-select: none;
  -webkit-user-select: none;
}

.blocklyBlockCanvas.blocklyCanvasTransitioning,
.blocklyBubbleCanvas.blocklyCanvasTransitioning {
  transition: transform .5s;
}

.blocklyTooltipDiv {
  background-color: #ffffc7;
  border: 1px solid #ddc;
  box-shadow: 4px 4px 20px 1px rgba(0,0,0,.15);
  color: #000;
  display: none;
  font: 9pt sans-serif;
  opacity: .9;
  padding: 2px;
  position: absolute;
  z-index: 100000;  /* big value for bootstrap3 compatibility */
}

.blocklyDropDownDiv {
  position: absolute;
  left: 0;
  top: 0;
  z-index: 1000;
  display: none;
  border: 1px solid;
  border-color: #dadce0;
  background-color: #fff;
  border-radius: 2px;
  padding: 4px;
  box-shadow: 0 0 3px 1px rgba(0,0,0,.3);
}

.blocklyDropDownDiv.blocklyFocused {
  box-shadow: 0 0 6px 1px rgba(0,0,0,.3);
}

.blocklyDropDownContent {
  max-height: 300px;  /* @todo: spec for maximum height. */
  overflow: auto;
  overflow-x: hidden;
  position: relative;
}

.blocklyDropDownArrow {
  position: absolute;
  left: 0;
  top: 0;
  width: 16px;
  height: 16px;
  z-index: -1;
  background-color: inherit;
  border-color: inherit;
}

.blocklyDropDownButton {
  display: inline-block;
  float: left;
  padding: 0;
  margin: 4px;
  border-radius: 4px;
  outline: none;
  border: 1px solid;
  transition: box-shadow .1s;
  cursor: pointer;
}

.blocklyArrowTop {
  border-top: 1px solid;
  border-left: 1px solid;
  border-top-left-radius: 4px;
  border-color: inherit;
}

.blocklyArrowBottom {
  border-bottom: 1px solid;
  border-right: 1px solid;
  border-bottom-right-radius: 4px;
  border-color: inherit;
}

.blocklyResizeSE {
  cursor: se-resize;
  fill: #aaa;
}

.blocklyResizeSW {
  cursor: sw-resize;
  fill: #aaa;
}

.blocklyResizeLine {
  stroke: #515A5A;
  stroke-width: 1;
}

.blocklyHighlightedConnectionPath {
  fill: none;
  stroke: #fc3;
  stroke-width: 4px;
}

.blocklyPathLight {
  fill: none;
  stroke-linecap: round;
  stroke-width: 1;
}

.blocklySelected>.blocklyPathLight {
  display: none;
}

.blocklyDraggable {
  cursor: grab;
  cursor: -webkit-grab;
}

.blocklyDragging {
  cursor: grabbing;
  cursor: -webkit-grabbing;
  /* Drag surface disables events to not block the toolbox, so we have to
   * reenable them here for the cursor values to work. */
  pointer-events: auto;
}

  /* Changes cursor on mouse down. Not effective in Firefox because of
     https://bugzilla.mozilla.org/show_bug.cgi?id=771241 */
.blocklyDraggable:active {
  cursor: grabbing;
  cursor: -webkit-grabbing;
}

.blocklyDragging.blocklyDraggingDelete {
  cursor: url("<<<PATH>>>/handdelete.cur"), auto;
}

.blocklyDragging>.blocklyPath,
.blocklyDragging>.blocklyPathLight {
  fill-opacity: .8;
  stroke-opacity: .8;
}

.blocklyDragging>.blocklyPathDark {
  display: none;
}

.blocklyDisabled>.blocklyPath {
  fill-opacity: .5;
  stroke-opacity: .5;
}

.blocklyDisabled>.blocklyPathLight,
.blocklyDisabled>.blocklyPathDark {
  display: none;
}

.blocklyInsertionMarker>.blocklyPath,
.blocklyInsertionMarker>.blocklyPathLight,
.blocklyInsertionMarker>.blocklyPathDark {
  fill-opacity: .2;
  stroke: none;
}

.blocklyNonEditableText>text {
  pointer-events: none;
}

.blocklyFlyout {
  position: absolute;
  z-index: 20;
}

.blocklyText text {
  cursor: default;
}

.blocklyHidden {
  display: none;
}

.blocklyFieldDropdown:not(.blocklyHidden) {
  display: block;
}

.blocklyIconGroup {
  cursor: default;
}

.blocklyIconGroup:not(:hover),
.blocklyIconGroupReadonly {
  opacity: .6;
}

.blocklyIconShape {
  fill: #00f;
  stroke: #fff;
  stroke-width: 1px;
}

.blocklyIconSymbol {
  fill: #fff;
}

.blocklyMinimalBody {
  margin: 0;
  padding: 0;
  height: 100%;
}

.blocklyHtmlInput {
  border: none;
  border-radius: 4px;
  height: 100%;
  margin: 0;
  outline: none;
  padding: 0;
  width: 100%;
  text-align: center;
  display: block;
  box-sizing: border-box;
}

/* Remove the increase and decrease arrows on the field number editor */
input.blocklyHtmlInput[type=number]::-webkit-inner-spin-button,
input.blocklyHtmlInput[type=number]::-webkit-outer-spin-button {
  -webkit-appearance: none;
  margin: 0;
}

input[type=number] {
  -moz-appearance: textfield;
}

.blocklyMainBackground {
  stroke-width: 1;
  stroke: #c6c6c6;  /* Equates to #ddd due to border being off-pixel. */
}

.blocklyMutatorBackground {
  fill: #fff;
  stroke: #ddd;
  stroke-width: 1;
}

.blocklyFlyoutBackground {
  fill: #ddd;
  fill-opacity: .8;
}

.blocklyMainWorkspaceScrollbar {
  z-index: 20;
}

.blocklyFlyoutScrollbar {
  z-index: 30;
}

.blocklyScrollbarHorizontal,
.blocklyScrollbarVertical {
  position: absolute;
  outline: none;
}

.blocklyScrollbarBackground {
  opacity: 0;
}

.blocklyScrollbarHandle {
  fill: #ccc;
}

.blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,
.blocklyScrollbarHandle:hover {
  fill: #bbb;
}

/* Darken flyout scrollbars due to being on a grey background. */
/* By contrast, workspace scrollbars are on a white background. */
.blocklyFlyout .blocklyScrollbarHandle {
  fill: #bbb;
}

.blocklyFlyout .blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,
.blocklyFlyout .blocklyScrollbarHandle:hover {
  fill: #aaa;
}

.blocklyInvalidInput {
  background: #faa;
}

.blocklyVerticalMarker {
  stroke-width: 3px;
  fill: rgba(255,255,255,.5);
  pointer-events: none;
}

.blocklyComputeCanvas {
  position: absolute;
  width: 0;
  height: 0;
}

.blocklyNoPointerEvents {
  pointer-events: none;
}

.blocklyContextMenu {
  border-radius: 4px;
  max-height: 100%;
}

.blocklyDropdownMenu {
  border-radius: 2px;
  padding: 0 !important;
}

.blocklyDropdownMenu .blocklyMenuItem {
  /* 28px on the left for icon or checkbox. */
  padding-left: 28px;
}

/* BiDi override for the resting state. */
.blocklyDropdownMenu .blocklyMenuItemRtl {
  /* Flip left/right padding for BiDi. */
  padding-left: 5px;
  padding-right: 28px;
}

.blocklyWidgetDiv .blocklyMenu {
  background: #fff;
  border: 1px solid transparent;
  box-shadow: 0 0 3px 1px rgba(0,0,0,.3);
  font: normal 13px Arial, sans-serif;
  margin: 0;
  outline: none;
  padding: 4px 0;
  position: absolute;
  overflow-y: auto;
  overflow-x: hidden;
  max-height: 100%;
  z-index: 20000;  /* Arbitrary, but some apps depend on it... */
}

.blocklyWidgetDiv .blocklyMenu.blocklyFocused {
  box-shadow: 0 0 6px 1px rgba(0,0,0,.3);
}

.blocklyDropDownDiv .blocklyMenu {
  background: inherit;  /* Compatibility with gapi, reset from goog-menu */
  border: inherit;  /* Compatibility with gapi, reset from goog-menu */
  font: normal 13px "Helvetica Neue", Helvetica, sans-serif;
  outline: none;
  position: relative;  /* Compatibility with gapi, reset from goog-menu */
  z-index: 20000;  /* Arbitrary, but some apps depend on it... */
}

/* State: resting. */
.blocklyMenuItem {
  border: none;
  color: #000;
  cursor: pointer;
  list-style: none;
  margin: 0;
  /* 7em on the right for shortcut. */
  min-width: 7em;
  padding: 6px 15px;
  white-space: nowrap;
}

/* State: disabled. */
.blocklyMenuItemDisabled {
  color: #ccc;
  cursor: inherit;
}

/* State: hover. */
.blocklyMenuItemHighlight {
  background-color: rgba(0,0,0,.1);
}

/* State: selected/checked. */
.blocklyMenuItemCheckbox {
  height: 16px;
  position: absolute;
  width: 16px;
}

.blocklyMenuItemSelected .blocklyMenuItemCheckbox {
  background: url(<<<PATH>>>/sprites.png) no-repeat -48px -16px;
  float: left;
  margin-left: -24px;
  position: static;  /* Scroll with the menu. */
}

.blocklyMenuItemRtl .blocklyMenuItemCheckbox {
  float: right;
  margin-right: -24px;
}

.blocklyBlockDragSurface, .blocklyAnimationLayer {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  overflow: visible !important;
  z-index: 80;
  pointer-events: none;
}
`,jd={};jd.inject=je,jd.register=we;var Ae=class{constructor(e,t){this.x=e,this.y=t}clone(){return new Ae(this.x,this.y)}scale(e){return this.x*=e,this.y*=e,this}translate(e,t){return this.x+=e,this.y+=t,this}static equals(e,t){return e===t?!0:e&&t?e.x===t.x&&e.y===t.y:!1}static distance(e,t){const r=e.x-t.x;return e=e.y-t.y,Math.sqrt(r*r+e*e)}static magnitude(e){return Math.sqrt(e.x*e.x+e.y*e.y)}static difference(e,t){return new Ae(e.x-t.x,e.y-t.y)}static sum(e,t){return new Ae(e.x+t.x,e.y+t.y)}},Xc="http://www.w3.org/2000/svg",ki="http://www.w3.org/1999/xhtml",ar="http://www.w3.org/1999/xlink",to;(function(e){e[e.ELEMENT_NODE=1]="ELEMENT_NODE",e[e.TEXT_NODE=3]="TEXT_NODE",e[e.COMMENT_NODE=8]="COMMENT_NODE"})(to||(to={}));var Fr=null,Mg=0,zd=null,fs={HTML_NS:ki};fs.NodeType=to,fs.SVG_NS=Xc,fs.XLINK_NS=ar,fs.addClass=Pe,fs.createSvgElement=ie,fs.getFastTextWidth=as,fs.getFastTextWidthWithSizeString=An,fs.getTextWidth=Xs,fs.hasClass=En,fs.insertAfter=yn,fs.measureFontMetrics=Bt,fs.removeClass=it,fs.removeClasses=vt,fs.removeNode=lt,fs.setCssTransform=gn,fs.startTextWidthCache=Wn,fs.stopTextWidthCache=Xn;var ae=class{constructor(e){this.tagName=e}toString(){return this.tagName}};ae.ANIMATE=new ae("animate"),ae.CIRCLE=new ae("circle"),ae.CLIPPATH=new ae("clipPath"),ae.DEFS=new ae("defs"),ae.FECOMPOSITE=new ae("feComposite"),ae.FECOMPONENTTRANSFER=new ae("feComponentTransfer"),ae.FEFLOOD=new ae("feFlood"),ae.FEFUNCA=new ae("feFuncA"),ae.FEGAUSSIANBLUR=new ae("feGaussianBlur"),ae.FEPOINTLIGHT=new ae("fePointLight"),ae.FESPECULARLIGHTING=new ae("feSpecularLighting"),ae.FILTER=new ae("filter"),ae.FOREIGNOBJECT=new ae("foreignObject"),ae.G=new ae("g"),ae.IMAGE=new ae("image"),ae.LINE=new ae("line"),ae.PATH=new ae("path"),ae.PATTERN=new ae("pattern"),ae.POLYGON=new ae("polygon"),ae.RECT=new ae("rect"),ae.SVG=new ae("svg"),ae.TEXT=new ae("text"),ae.TSPAN=new ae("tspan");var Tt=class{constructor(e,t,r,l){this.top=e,this.bottom=t,this.left=r,this.right=l}clone(){return new Tt(this.top,this.bottom,this.left,this.right)}getHeight(){return this.bottom-this.top}getWidth(){return this.right-this.left}contains(e,t){return e>=this.left&&e<=this.right&&t>=this.top&&t<=this.bottom}intersects(e){return this.left<=e.right&&this.right>=e.left&&this.bottom>=e.top&&this.top<=e.bottom}static equals(e,t){return e===t?!0:e&&t?e.top===t.top&&e.bottom===t.bottom&&e.left===t.left&&e.right===t.right:!1}static createFromPoint(e,t,r){const l=e.x;return e=e.y,new Tt(e,e+r,l,l+t)}},Pt=class{constructor(e,t){this.width=e,this.height=t}static equals(e,t){return e===t?!0:e&&t?e.width===t.width&&e.height===t.height:!1}static max(e,t){return new Pt(Math.max(e.width,t.width),Math.max(e.height,t.height))}static min(e,t){return new Pt(Math.min(e.width,t.width),Math.min(e.height,t.height))}},Ob={getSizeInternal:gs},Ii={TEST_ONLY:Ob};Ii.getBorderBox=fi,Ii.getComputedStyle=zn,Ii.getContainerOffsetToScrollInto=mc,Ii.getPageOffset=Vn,Ii.getSize=jn,Ii.getViewportPageOffset=Fs,Ii.scrollIntoContainerView=Or;var Rb=/translate\(\s*([-+\d.e]+)([ ,]\s*([-+\d.e]+)\s*)?/,Ab=/transform:\s*translate(?:3d)?\(\s*([-+\d.e]+)\s*px([ ,]\s*([-+\d.e]+)\s*px)?/,Zc={XY_REGEX:Rb,XY_STYLE_REGEX:Ab},zo={TEST_ONLY:Zc};zo.getDocumentScroll=$c,zo.getInjectionDivXY=al,zo.getRelativeXY=Rr,zo.getViewportBBox=bc,zo.screenToWsCoordinates=Uu,zo.wsToScreenCoordinates=ua;var Un=class{constructor(e,t,r,l,p){this.workspace=e,this.horizontal=t,this.oldHostMetrics=null,this.ratio=1,this.origin=new Ae(0,0),this.startDragHandle=this.handlePosition=this.handleLength=this.scrollbarLength=this.startDragMouse=0,this.containerVisible=this.isHandleVisible=!0,this.position=new Ae(0,0),this.onMouseMoveWrapper_=this.onMouseUpWrapper_=null,this.pair=r||!1,this.margin=p!==void 0?p:Un.DEFAULT_SCROLLBAR_MARGIN,e="blocklyScrollbar"+(this.horizontal?"Horizontal":"Vertical"),l&&(e+=" "+l),this.outerSvg=ie(ae.SVG,{class:e}),l=ie(ae.G,{},this.outerSvg),this.svgBackground=ie(ae.RECT,{class:"blocklyScrollbarBackground"},l),e=Math.floor((Un.scrollbarThickness-5)/2),this.svgHandle=ie(ae.RECT,{class:"blocklyScrollbarHandle",rx:e,ry:e},l),this.workspace.getThemeManager().subscribe(this.svgHandle,"scrollbarColour","fill"),this.workspace.getThemeManager().subscribe(this.svgHandle,"scrollbarOpacity","fill-opacity"),yn(this.outerSvg,this.workspace.getParentSvg()),this.setInitialThickness(),t?(this.lengthAttribute_="width",this.positionAttribute_="x"):(this.lengthAttribute_="height",this.positionAttribute_="y"),this.onMouseDownBarWrapper_=He(this.svgBackground,"pointerdown",this,this.onMouseDownBar),this.onMouseDownHandleWrapper_=He(this.svgHandle,"pointerdown",this,this.onMouseDownHandle)}setInitialThickness(){const e=Un.scrollbarThickness;this.horizontal?(this.svgBackground.setAttribute("height",String(e)),this.outerSvg.setAttribute("height",String(e)),this.svgHandle.setAttribute("height",String(e-5)),this.svgHandle.setAttribute("y","2.5")):(this.svgBackground.setAttribute("width",String(e)),this.outerSvg.setAttribute("width",String(e)),this.svgHandle.setAttribute("width",String(e-5)),this.svgHandle.setAttribute("x","2.5"))}dispose(){this.cleanUp(),St(this.onMouseDownBarWrapper_),St(this.onMouseDownHandleWrapper_),lt(this.outerSvg),this.workspace.getThemeManager().unsubscribe(this.svgHandle)}constrainHandleLength(e){return e=0>=e||isNaN(e)?0:Math.min(e,this.scrollbarLength)}setHandleLength(e){this.handleLength=e,this.svgHandle.setAttribute(this.lengthAttribute_,String(this.handleLength))}constrainHandlePosition(e){return e=0>=e||isNaN(e)?0:Math.min(e,this.scrollbarLength-this.handleLength)}setHandlePosition(e){this.handlePosition=e,this.svgHandle.setAttribute(this.positionAttribute_,String(this.handlePosition))}setScrollbarLength(e){this.scrollbarLength=e,this.outerSvg.setAttribute(this.lengthAttribute_,String(this.scrollbarLength)),this.svgBackground.setAttribute(this.lengthAttribute_,String(this.scrollbarLength))}setPosition(e,t){this.position.x=e,this.position.y=t,gn(this.outerSvg,"translate("+(this.position.x+this.origin.x)+"px,"+(this.position.y+this.origin.y)+"px)")}resize(e){!e&&(e=this.workspace.getMetrics(),!e)||this.oldHostMetrics&&Un.metricsAreEquivalent(e,this.oldHostMetrics)||(this.horizontal?this.resizeHorizontal(e):this.resizeVertical(e),this.oldHostMetrics=e,this.updateMetrics())}requiresViewResize(e){return this.oldHostMetrics?this.oldHostMetrics.viewWidth!==e.viewWidth||this.oldHostMetrics.viewHeight!==e.viewHeight||this.oldHostMetrics.absoluteLeft!==e.absoluteLeft||this.oldHostMetrics.absoluteTop!==e.absoluteTop:!0}resizeHorizontal(e){this.requiresViewResize(e)?this.resizeViewHorizontal(e):this.resizeContentHorizontal(e)}resizeViewHorizontal(e){var t=e.viewWidth-2*this.margin;this.pair&&(t-=Un.scrollbarThickness),this.setScrollbarLength(Math.max(0,t)),t=e.absoluteLeft+this.margin,this.pair&&this.workspace.RTL&&(t+=Un.scrollbarThickness),this.setPosition(t,e.absoluteTop+e.viewHeight-Un.scrollbarThickness-this.margin),this.resizeContentHorizontal(e)}resizeContentHorizontal(e){if(e.viewWidth>=e.scrollWidth)this.setHandleLength(this.scrollbarLength),this.setHandlePosition(0),this.pair||this.setVisible(!1);else{this.pair||this.setVisible(!0);var t=this.scrollbarLength*e.viewWidth/e.scrollWidth;t=this.constrainHandleLength(t),this.setHandleLength(t),t=e.scrollWidth-e.viewWidth;var r=this.scrollbarLength-this.handleLength;e=(e.viewLeft-e.scrollLeft)/t*r,e=this.constrainHandlePosition(e),this.setHandlePosition(e),this.ratio=r/t}}resizeVertical(e){this.requiresViewResize(e)?this.resizeViewVertical(e):this.resizeContentVertical(e)}resizeViewVertical(e){let t=e.viewHeight-2*this.margin;this.pair&&(t-=Un.scrollbarThickness),this.setScrollbarLength(Math.max(0,t)),this.setPosition(this.workspace.RTL?e.absoluteLeft+this.margin:e.absoluteLeft+e.viewWidth-Un.scrollbarThickness-this.margin,e.absoluteTop+this.margin),this.resizeContentVertical(e)}resizeContentVertical(e){if(e.viewHeight>=e.scrollHeight)this.setHandleLength(this.scrollbarLength),this.setHandlePosition(0),this.pair||this.setVisible(!1);else{this.pair||this.setVisible(!0);var t=this.scrollbarLength*e.viewHeight/e.scrollHeight;t=this.constrainHandleLength(t),this.setHandleLength(t),t=e.scrollHeight-e.viewHeight;var r=this.scrollbarLength-this.handleLength;e=(e.viewTop-e.scrollTop)/t*r,e=this.constrainHandlePosition(e),this.setHandlePosition(e),this.ratio=r/t}}isVisible(){return this.isHandleVisible}setContainerVisible(e){const t=e!==this.containerVisible;this.containerVisible=e,t&&this.updateDisplay_()}setVisible(e){if(this.pair)throw Error("Unable to toggle visibility of paired scrollbars.");this.setVisibleInternal(e)}setVisibleInternal(e){const t=e!==this.isVisible();this.isHandleVisible=e,t&&this.updateDisplay_()}updateDisplay_(){this.containerVisible&&this.isVisible()?this.outerSvg.setAttribute("display","block"):this.outerSvg.setAttribute("display","none")}onMouseDownBar(e){if(this.workspace.markFocused(),Ot(),this.cleanUp(),os(e))e.stopPropagation();else{var t=Ee(e,this.workspace.getParentSvg(),this.workspace.getInverseScreenCTM());t=this.horizontal?t.x:t.y;var r=al(this.svgHandle);r=this.horizontal?r.x:r.y;var l=this.handlePosition,p=.95*this.handleLength;t<=r?l-=p:t>=r+this.handleLength&&(l+=p),this.setHandlePosition(this.constrainHandlePosition(l)),this.updateMetrics(),e.stopPropagation(),e.preventDefault()}}onMouseDownHandle(e){this.workspace.markFocused(),this.cleanUp(),os(e)?e.stopPropagation():(this.startDragHandle=this.handlePosition,this.startDragMouse=this.horizontal?e.clientX:e.clientY,this.onMouseUpWrapper_=He(document,"pointerup",this,this.onMouseUpHandle),this.onMouseMoveWrapper_=He(document,"pointermove",this,this.onMouseMoveHandle),e.stopPropagation(),e.preventDefault())}onMouseMoveHandle(e){this.setHandlePosition(this.constrainHandlePosition(this.startDragHandle+((this.horizontal?e.clientX:e.clientY)-this.startDragMouse))),this.updateMetrics()}onMouseUpHandle(){Ot(),this.cleanUp()}cleanUp(){this.workspace.hideChaff(!0),this.onMouseUpWrapper_&&(St(this.onMouseUpWrapper_),this.onMouseUpWrapper_=null),this.onMouseMoveWrapper_&&(St(this.onMouseMoveWrapper_),this.onMouseMoveWrapper_=null)}getRatio_(){let e=this.handlePosition/(this.scrollbarLength-this.handleLength);return isNaN(e)&&(e=0),e}updateMetrics(){const e=this.getRatio_();this.horizontal?this.workspace.setMetrics({x:e}):this.workspace.setMetrics({y:e})}set(e,t){this.setHandlePosition(this.constrainHandlePosition(e*this.ratio)),(t||t===void 0)&&this.updateMetrics()}setOrigin(e,t){this.origin=new Ae(e,t)}static metricsAreEquivalent(e,t){return e.viewWidth===t.viewWidth&&e.viewHeight===t.viewHeight&&e.viewLeft===t.viewLeft&&e.viewTop===t.viewTop&&e.absoluteTop===t.absoluteTop&&e.absoluteLeft===t.absoluteLeft&&e.scrollWidth===t.scrollWidth&&e.scrollHeight===t.scrollHeight&&e.scrollLeft===t.scrollLeft&&e.scrollTop===t.scrollTop}};Un.scrollbarThickness=Eg?25:15,Un.DEFAULT_SCROLLBAR_MARGIN=.5;var Ud={parseFromString:function(){throw Error("DOMParser was not found in the global scope and was not properly injected using injectDependencies")}},Lg={serializeToString:function(){throw Error("XMLSerializer was not foundin the global scope and was not properly injected using injectDependencies")}},{document:Hd,DOMParser:Qc,XMLSerializer:jl}=globalThis;Qc&&(Ud=new Qc),jl&&(Lg=new jl);var Bg="https://developers.google.com/blockly/xml",Oy=/[\x00-\x09\x0B\x0C\x0E-\x1F]/g,Uo={NAME_SPACE:Bg};Uo.createElement=s.createElement$$module$build$src$core$utils$xml,Uo.createTextNode=s.createTextNode$$module$build$src$core$utils$xml,Uo.domToText=H,Uo.injectDependencies=U,Uo.textToDom=s.textToDom$$module$build$src$core$utils$xml;var Wd="categoryToolbox",zl="flyoutToolbox",wt;(function(e){e[e.TOP=0]="TOP",e[e.BOTTOM=1]="BOTTOM",e[e.LEFT=2]="LEFT",e[e.RIGHT=3]="RIGHT"})(wt||(wt={}));var Pg={hasCategoriesInternal:$e},no={};no.Position=wt,no.TEST_ONLY=Pg,no.convertFlyoutDefToJsonArray=de,no.convertToolboxDefToJson=j,no.hasCategories=ye,no.isCategoryCollapsible=le,no.parseToolboxTree=jt;var jr;(function(e){e[e.TOP=0]="TOP",e[e.BOTTOM=1]="BOTTOM"})(jr||(jr={}));var La;(function(e){e[e.LEFT=0]="LEFT",e[e.RIGHT=1]="RIGHT"})(La||(La={}));var ws;(function(e){e[e.UP=0]="UP",e[e.DOWN=1]="DOWN"})(ws||(ws={}));var wr={};wr.bumpDirection=ws,wr.bumpPositionRect=nn,wr.getCornerOppositeToolbox=Ct,wr.getStartPositionRect=tn,wr.horizontalPosition=La,wr.verticalPosition=jr;var Us={width:96,height:124,url:"sprites.png"},Fg=class{constructor(e){this.workspace=e,this.id="zoomControls",this.boundEvents=[],this.zoomResetGroup=this.zoomOutGroup=this.zoomInGroup=null,this.HEIGHT=this.WIDTH=32,this.SMALL_SPACING=2,this.LARGE_SPACING=11,this.MARGIN_HORIZONTAL=this.MARGIN_VERTICAL=20,this.svgGroup=null,this.top=this.left=0,this.initialized=!1}createDom(){this.svgGroup=ie(ae.G,{});const e=String(Math.random()).substring(2);return this.createZoomOutSvg(e),this.createZoomInSvg(e),this.workspace.isMovable()&&this.createZoomResetSvg(e),this.svgGroup}init(){this.workspace.getComponentManager().addComponent({component:this,weight:un.ComponentWeight.ZOOM_CONTROLS_WEIGHT,capabilities:[un.Capability.POSITIONABLE]}),this.initialized=!0}dispose(){this.workspace.getComponentManager().removeComponent("zoomControls"),this.svgGroup&&lt(this.svgGroup);for(const e of this.boundEvents)St(e);this.boundEvents.length=0}getBoundingRectangle(){let e=this.SMALL_SPACING+2*this.HEIGHT;return this.zoomResetGroup&&(e+=this.LARGE_SPACING+this.HEIGHT),new Tt(this.top,this.top+e,this.left,this.left+this.WIDTH)}position(e,t){if(this.initialized){var r=Ct(this.workspace,e),l=this.SMALL_SPACING+2*this.HEIGHT;if(this.zoomResetGroup&&(l+=this.LARGE_SPACING+this.HEIGHT),e=tn(r,new Pt(this.WIDTH,l),this.MARGIN_HORIZONTAL,this.MARGIN_VERTICAL,e,this.workspace),r=r.vertical,t=nn(e,this.MARGIN_VERTICAL,r===jr.TOP?ws.DOWN:ws.UP,t),r===jr.TOP){var p=this.SMALL_SPACING+this.HEIGHT,v;(v=this.zoomInGroup)==null||v.setAttribute("transform","translate(0, "+p+")"),this.zoomResetGroup&&this.zoomResetGroup.setAttribute("transform","translate(0, "+(p+this.LARGE_SPACING+this.HEIGHT)+")")}else{v=this.zoomResetGroup?this.LARGE_SPACING+this.HEIGHT:0;let G;(G=this.zoomInGroup)==null||G.setAttribute("transform","translate(0, "+v+")"),v=v+this.SMALL_SPACING+this.HEIGHT,(p=this.zoomOutGroup)==null||p.setAttribute("transform","translate(0, "+v+")")}this.top=t.top,this.left=t.left;var O;(O=this.svgGroup)==null||O.setAttribute("transform","translate("+this.left+","+this.top+")")}}createZoomOutSvg(e){this.zoomOutGroup=ie(ae.G,{class:"blocklyZoom blocklyZoomOut"},this.svgGroup);const t=ie(ae.CLIPPATH,{id:"blocklyZoomoutClipPath"+e},this.zoomOutGroup);ie(ae.RECT,{width:32,height:32},t),ie(ae.IMAGE,{width:Us.width,height:Us.height,x:-64,y:-92,"clip-path":"url(#blocklyZoomoutClipPath"+e+")"},this.zoomOutGroup).setAttributeNS(ar,"xlink:href",this.workspace.options.pathToMedia+Us.url),this.boundEvents.push(He(this.zoomOutGroup,"pointerdown",null,this.zoom.bind(this,-1)))}createZoomInSvg(e){this.zoomInGroup=ie(ae.G,{class:"blocklyZoom blocklyZoomIn"},this.svgGroup);const t=ie(ae.CLIPPATH,{id:"blocklyZoominClipPath"+e},this.zoomInGroup);ie(ae.RECT,{width:32,height:32},t),ie(ae.IMAGE,{width:Us.width,height:Us.height,x:-32,y:-92,"clip-path":"url(#blocklyZoominClipPath"+e+")"},this.zoomInGroup).setAttributeNS(ar,"xlink:href",this.workspace.options.pathToMedia+Us.url),this.boundEvents.push(He(this.zoomInGroup,"pointerdown",null,this.zoom.bind(this,1)))}zoom(e,t){this.workspace.markFocused(),this.workspace.zoomCenter(e),this.fireZoomEvent(),Ot(),t.stopPropagation(),t.preventDefault()}createZoomResetSvg(e){this.zoomResetGroup=ie(ae.G,{class:"blocklyZoom blocklyZoomReset"},this.svgGroup);const t=ie(ae.CLIPPATH,{id:"blocklyZoomresetClipPath"+e},this.zoomResetGroup);ie(ae.RECT,{width:32,height:32},t),ie(ae.IMAGE,{width:Us.width,height:Us.height,y:-92,"clip-path":"url(#blocklyZoomresetClipPath"+e+")"},this.zoomResetGroup).setAttributeNS(ar,"xlink:href",this.workspace.options.pathToMedia+Us.url),this.boundEvents.push(He(this.zoomResetGroup,"pointerdown",null,this.resetZoom.bind(this)))}resetZoom(e){this.workspace.markFocused();const t=Math.log(this.workspace.options.zoomOptions.startScale/this.workspace.scale)/Math.log(this.workspace.options.zoomOptions.scaleSpeed);this.workspace.beginCanvasTransition(),this.workspace.zoomCenter(t),this.workspace.scrollCenter(),setTimeout(this.workspace.endCanvasTransition.bind(this.workspace),500),this.fireZoomEvent(),Ot(),e.stopPropagation(),e.preventDefault()}fireZoomEvent(){const e=new(Ce(ge.CLICK))(null,this.workspace.id,"zoom_controls");te(e)}};we(`
.blocklyZoom>image, .blocklyZoom>svg>image {
  opacity: .4;
}

.blocklyZoom>image:hover, .blocklyZoom>svg>image:hover {
  opacity: .6;
}

.blocklyZoom>image:active, .blocklyZoom>svg>image:active {
  opacity: .8;
}
`);var Nb=100,Mb=75,Lb=50,Bb=25,Ry={BLOCKS:Lb,PROCEDURES:Mb,VARIABLES:Nb,WORKSPACE_COMMENTS:Bb},jg={};jg.register=bn,jg.unregister=mt;var Pb=class{constructor(){this.priority=Bb}save(e){const t=[];for(const r of e.getTopComments())(e=kn(r,{addCoordinates:!0,saveIds:!0}))&&t.push(e);return t.length?t:null}load(e,t){for(const r of e)ls(r,t,{recordUndo:Y()})}clear(e){for(const t of e.getTopComments())t.dispose()}};bn("workspaceComments",new Pb);var Vd={};Vd.WorkspaceCommentSerializer=Pb,Vd.append=ls,Vd.save=kn;var zg={};zg.register=Qs,zg.unregister=da;var Gd=class{paste(e,t,r){e=e.commentState,r&&(e.x=r.x,e.y=r.y),s.disable$$module$build$src$core$events$utils();let l;try{l=ls(e,t),Ar(l)}finally{s.enable$$module$build$src$core$events$utils()}return l?(re()&&te(new(Ce(ge.COMMENT_CREATE))(l)),s.setSelected$$module$build$src$core$common(l),l):null}};Gd.TYPE="workspace-comment",Qs(Gd.TYPE,new Gd);var Ug;Ug=28,s.config$$module$build$src$core$config={dragRadius:5,flyoutDragRadius:10,snapRadius:Ug,connectingSnapRadius:Ug,currentConnectionPreference:8,bumpDelay:250},s.config$$module$build$src$core$config;var Fb="aria-",jb="role",zr;(function(e){e.GRID="grid",e.GRIDCELL="gridcell",e.GROUP="group",e.LISTBOX="listbox",e.MENU="menu",e.MENUITEM="menuitem",e.MENUITEMCHECKBOX="menuitemcheckbox",e.OPTION="option",e.PRESENTATION="presentation",e.ROW="row",e.TREE="tree",e.TREEITEM="treeitem"})(zr||(zr={}));var hs;(function(e){e.ACTIVEDESCENDANT="activedescendant",e.COLCOUNT="colcount",e.DISABLED="disabled",e.EXPANDED="expanded",e.INVALID="invalid",e.LABEL="label",e.LABELLEDBY="labelledby",e.LEVEL="level",e.ORIENTATION="orientation",e.POSINSET="posinset",e.ROWCOUNT="rowcount",e.SELECTED="selected",e.SETSIZE="setsize",e.VALUEMAX="valuemax",e.VALUEMIN="valuemin"})(hs||(hs={}));var eu={};eu.Role=zr,eu.State=hs,eu.setRole=xs,eu.setState=qt;var Hg=class{constructor(){this.menuItems=[],this.roleName=this.element=this.onKeyDownHandler=this.mouseLeaveHandler=this.mouseEnterHandler=this.clickHandler=this.mouseOverHandler=this.highlightedItem=this.openingCoords=null}addChild(e){this.menuItems.push(e)}render(e){const t=document.createElement("div");t.className="blocklyMenu goog-menu blocklyNonSelectable",t.tabIndex=0,this.roleName&&xs(t,this.roleName),this.element=t;for(let r=0,l;l=this.menuItems[r];r++)t.appendChild(l.createDom());return this.mouseOverHandler=He(t,"pointerover",this,this.handleMouseOver,!0),this.clickHandler=He(t,"pointerup",this,this.handleClick,!0),this.mouseEnterHandler=He(t,"pointerenter",this,this.handleMouseEnter,!0),this.mouseLeaveHandler=He(t,"pointerleave",this,this.handleMouseLeave,!0),this.onKeyDownHandler=He(t,"keydown",this,this.handleKeyEvent),e.appendChild(t),t}getElement(){return this.element}focus(){const e=this.getElement();e&&(e.focus({preventScroll:!0}),Pe(e,"blocklyFocused"))}blur(){const e=this.getElement();e&&(e.blur(),it(e,"blocklyFocused"))}setRole(e){this.roleName=e}dispose(){this.mouseOverHandler&&(St(this.mouseOverHandler),this.mouseOverHandler=null),this.clickHandler&&(St(this.clickHandler),this.clickHandler=null),this.mouseEnterHandler&&(St(this.mouseEnterHandler),this.mouseEnterHandler=null),this.mouseLeaveHandler&&(St(this.mouseLeaveHandler),this.mouseLeaveHandler=null),this.onKeyDownHandler&&(St(this.onKeyDownHandler),this.onKeyDownHandler=null);for(let e=0,t;t=this.menuItems[e];e++)t.dispose();this.element=null}getMenuItem(e){const t=this.getElement();for(;e&&e!==t;){if(e.classList.contains("blocklyMenuItem")){for(let r=0,l;l=this.menuItems[r];r++)if(l.getElement()===e)return l}e=e.parentElement}return null}setHighlighted(e){var t=this.highlightedItem;t&&(t.setHighlighted(!1),this.highlightedItem=null),e&&(e.setHighlighted(!0),this.highlightedItem=e,t=this.getElement(),Or(e.getElement(),t),qt(t,hs.ACTIVEDESCENDANT,e.getId()))}highlightNext(){const e=this.highlightedItem?this.menuItems.indexOf(this.highlightedItem):-1;this.highlightHelper(e,1)}highlightPrevious(){const e=this.highlightedItem?this.menuItems.indexOf(this.highlightedItem):-1;this.highlightHelper(0>e?this.menuItems.length:e,-1)}highlightFirst(){this.highlightHelper(-1,1)}highlightLast(){this.highlightHelper(this.menuItems.length,-1)}highlightHelper(e,t){e+=t;let r;for(;r=this.menuItems[e];){if(r.isEnabled()){this.setHighlighted(r);break}e+=t}}handleMouseOver(e){(e=this.getMenuItem(e.target))&&(e.isEnabled()?this.highlightedItem!==e&&this.setHighlighted(e):this.setHighlighted(null))}handleClick(e){const t=this.openingCoords;if(this.openingCoords=null,t&&typeof e.clientX=="number"){const r=new Ae(e.clientX,e.clientY);if(1>Ae.distance(t,r))return}(e=this.getMenuItem(e.target))&&e.performAction()}handleMouseEnter(e){this.focus()}handleMouseLeave(e){this.getElement()&&(this.blur(),this.setHighlighted(null))}handleKeyEvent(e){if(this.menuItems.length&&!(e.shiftKey||e.ctrlKey||e.metaKey||e.altKey)){var t=this.highlightedItem;switch(e.key){case"Enter":case" ":t&&t.performAction();break;case"ArrowUp":this.highlightPrevious();break;case"ArrowDown":this.highlightNext();break;case"PageUp":case"Home":this.highlightFirst();break;case"PageDown":case"End":this.highlightLast();break;default:return}e.preventDefault(),e.stopPropagation()}}getSize(){const e=this.getElement(),t=jn(e);return t.height=e.scrollHeight,t}},qd=class{constructor(e,t){this.content=e,this.opt_value=t,this.enabled=!0,this.element=null,this.rightToLeft=!1,this.roleName=null,this.highlight=this.checked=this.checkable=!1,this.actionHandler=null}createDom(){const e=document.createElement("div");e.id=S(),this.element=e,e.className="blocklyMenuItem goog-menuitem "+(this.enabled?"":"blocklyMenuItemDisabled goog-menuitem-disabled ")+(this.checked?"blocklyMenuItemSelected goog-option-selected ":"")+(this.highlight?"blocklyMenuItemHighlight goog-menuitem-highlight ":"")+(this.rightToLeft?"blocklyMenuItemRtl goog-menuitem-rtl ":"");const t=document.createElement("div");if(t.className="blocklyMenuItemContent goog-menuitem-content",this.checkable){var r=document.createElement("div");r.className="blocklyMenuItemCheckbox goog-menuitem-checkbox",t.appendChild(r)}return r=this.content,typeof this.content=="string"&&(r=document.createTextNode(this.content)),t.appendChild(r),e.appendChild(t),this.roleName&&xs(e,this.roleName),qt(e,hs.SELECTED,this.checkable&&this.checked||!1),qt(e,hs.DISABLED,!this.enabled),e}dispose(){this.element=null}getElement(){return this.element}getId(){return this.element.id}getValue(){let e;return(e=this.opt_value)!=null?e:null}setRightToLeft(e){this.rightToLeft=e}setRole(e){this.roleName=e}setCheckable(e){this.checkable=e}setChecked(e){this.checked=e}setHighlighted(e){this.highlight=e;const t=this.getElement();t&&this.isEnabled()&&(e?(Pe(t,"blocklyMenuItemHighlight"),Pe(t,"goog-menuitem-highlight")):(it(t,"blocklyMenuItemHighlight"),it(t,"goog-menuitem-highlight")))}isEnabled(){return this.enabled}setEnabled(e){this.enabled=e}performAction(){this.isEnabled()&&this.actionHandler&&this.actionHandler(this)}onAction(e,t){this.actionHandler=e.bind(t)}},tu="_TEMP_COLLAPSED_INPUT",Kd="_TEMP_COLLAPSED_FIELD",Hs="MANUALLY_DISABLED",Ay={COLLAPSED_FIELD_NAME:Kd,COLLAPSED_INPUT_NAME:tu,MANUALLY_DISABLED:Hs};(function(e){e[e.VALUE=1]="VALUE",e[e.STATEMENT=3]="STATEMENT",e[e.DUMMY=5]="DUMMY",e[e.CUSTOM=6]="CUSTOM",e[e.END_ROW=7]="END_ROW"})(s.inputTypes$$module$build$src$core$inputs$input_types||(s.inputTypes$$module$build$src$core$inputs$input_types={})),s.inputTypes$$module$build$src$core$inputs$input_types;var Jd=new Set,Wg=new WeakSet,lr=new WeakMap,Ul=null,Vg=null,zb=0,nu={};nu.finishQueuedRenders=cs,nu.queueRender=Fi,nu.triggerQueuedRenders=js;var Ub=function(e,t){window.alert(e),t&&t()},Hb=function(e,t){t(window.confirm(e))},Wb=function(e,t,r){r(window.prompt(e,t))},Vb={confirmInternal:pa},so={TEST_ONLY:Vb};so.alert=zi,so.confirm=ll,so.prompt=vc,so.setAlert=Hu,so.setConfirm=gp,so.setPrompt=Om;var Gg,Gb;s.Msg$$module$build$src$core$msg=Object.create(null),Gg=function(e){Object.keys(e).forEach(function(t){s.Msg$$module$build$src$core$msg[t]=e[t]})},Gb={Msg:s.Msg$$module$build$src$core$msg,setLocale:Gg};var su=class extends Oa{constructor(e){super(),this.isBlank=typeof e>"u",e&&(this.varId=e.getId(),this.workspaceId=e.workspace.id)}toJson(){const e=super.toJson();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");return e.varId=this.varId,e}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new su),t.varId=e.varId,t}},qg=class extends su{constructor(e){super(e),this.type=ge.VAR_CREATE,e&&(this.varType=e.type,this.varName=e.name)}toJson(){const e=super.toJson();if(this.varType===void 0)throw Error("The var type is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");return e.varType=this.varType,e.varName=this.varName,e}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new qg),t.varType=e.varType,t.varName=e.varName,t}run(e){const t=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");e?t.createVariable(this.varName,this.varType,this.varId):t.deleteVariableById(this.varId)}};i(Ne.EVENT,ge.VAR_CREATE,qg);var ru=class{constructor(e,t,r,l){this.workspace=e,this.name=t,this.type=r||"",this.id=l||k()}getId(){return this.id}static compareByName(e,t){return e.name.localeCompare(t.name,void 0,{sensitivity:"base"})}},Kg="VARIABLE",Jg="ijkmnopqrstuvwxyzabcdefgh",qb={generateUniqueNameInternal:Rm},Rs={CATEGORY_NAME:Kg,TEST_ONLY:qb,VAR_LETTER_OPTIONS:Jg};Rs.allDeveloperVariables=s.allDeveloperVariables$$module$build$src$core$variables,Rs.allUsedVarModels=s.allUsedVarModels$$module$build$src$core$variables,Rs.createVariableButtonHandler=cl,Rs.flyoutCategory=yc,Rs.flyoutCategoryBlocks=mp,Rs.generateUniqueName=bp,Rs.generateUniqueNameFromOptions=_c,Rs.generateVariableFieldDom=fa,Rs.getAddedVariables=Sc,Rs.getOrCreateVariablePackage=s.getOrCreateVariablePackage$$module$build$src$core$variables,Rs.getVariable=s.getVariable$$module$build$src$core$variables,Rs.nameUsedWithAnyType=$p,Rs.nameUsedWithConflictingParam=wc,Rs.promptName=Vu,Rs.renameVariable=s.renameVariable$$module$build$src$core$variables;var Hl=class extends Error{},Kb=class extends Hl{constructor(e){super("Expected to find a 'type' property, defining the block type"),this.state=e}},iu=class extends Hl{constructor(e,t,r){super(`The block ${t.toDevString()} is missing a(n) ${e}
connection`),this.block=t,this.state=r}},Jb=class extends Hl{constructor(e,t,r,l){super(`The block ${r.toDevString()} could not connect its
${t} to its parent, because: ${e}`),this.childBlock=r,this.childState=l}},Yb=class extends Hl{constructor(e){super(`Encountered a real block which is defined as a child of a shadow
block. It is an invariant of Blockly that shadow blocks only have shadow
children`),this.state=e}},Xb=class extends Hl{constructor(e,t,r){super(`Cannot add an icon of type '${e}' to the block ${t.toDevString()}, because there is no icon registered with type '${e}'. Make sure that all of your icons have been registered.`),this.block=t,this.state=r}},Ba={};Ba.BadConnectionCheck=Jb,Ba.DeserializationError=Hl,Ba.MissingBlockType=Kb,Ba.MissingConnection=iu,Ba.RealChildOfShadow=Yb,Ba.UnregisteredIcon=Xb;var Zb=class{constructor(){this.priority=Lb}save(e){const t=[];for(const r of e.getTopBlocks(!1))(e=Vt(r,{addCoordinates:!0,doFullSerialization:!1}))&&t.push(e);return t.length?{languageVersion:0,blocks:t}:null}load(e,t){e=e.blocks;for(const r of e)Ui(r,t,{recordUndo:Y()})}clear(e){for(const t of e.getTopBlocks(!1))t.dispose(!1)}};bn("blocks",new Zb);var ou={};ou.BlockSerializer=Zb,ou.append=Ui,ou.appendInternal=Gn,ou.save=Vt;var ss=class{constructor(e){this.name=e}toString(){return this.name}equals(e){return this.name===e.toString()}};ss.MUTATOR=new ss("mutator"),ss.WARNING=new ss("warning"),ss.COMMENT=new ss("comment");var Pa=class extends Oa{constructor(e){super(),this.isBlank=!e,e&&(this.blockId=e.id,this.workspaceId=e.workspace.id)}toJson(){const e=super.toJson();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");return e.blockId=this.blockId,e}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new Pa),t.blockId=e.blockId,t}},ro=class extends Pa{constructor(e,t,r,l,p){super(e),this.type=ge.BLOCK_CHANGE,e&&(this.element=t,this.name=r||void 0,this.oldValue=l,this.newValue=p)}toJson(){const e=super.toJson();if(!this.element)throw Error("The changed element is undefined. Either pass an element to the constructor, or call fromJson");return e.element=this.element,e.name=this.name,e.oldValue=this.oldValue,e.newValue=this.newValue,this.disabledReason&&(e.disabledReason=this.disabledReason),e}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new ro),t.element=e.element,t.name=e.name,t.oldValue=e.oldValue,t.newValue=e.newValue,e.disabledReason!==void 0&&(t.disabledReason=e.disabledReason),t}setDisabledReason(e){if(this.element!=="disabled")throw Error('Cannot set the disabled reason for a BlockChange event if the element is not "disabled".');this.disabledReason=e}isNull(){return this.oldValue===this.newValue}run(e){var t=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");if(t=t.getBlockById(this.blockId),!t)throw Error("The associated block is undefined. Either pass a block to the constructor, or call fromJson");const r=t.getIcon(ss.MUTATOR);switch(r&&ul(r)&&r.bubbleIsVisible()&&r.setBubbleVisible(!1),e=e?this.newValue:this.oldValue,this.element){case"field":(t=t.getField(this.name))?t.setValue(e):console.warn("Can't set non-existent field: "+this.name);break;case"comment":t.setCommentText(e||null);break;case"collapsed":t.setCollapsed(!!e);break;case"disabled":var l;t.setDisabledReason(!!e,(l=this.disabledReason)!=null?l:Hs);break;case"inline":t.setInputsInline(!!e);break;case"mutation":l=ro.getExtraBlockState_(t),t.loadExtraState?t.loadExtraState(JSON.parse(e||"{}")):t.domToMutation&&t.domToMutation(s.textToDom$$module$build$src$core$utils$xml(e||"<mutation/>")),te(new ro(t,"mutation",null,l,e));break;default:console.warn("Unknown change type: "+this.element)}}static getExtraBlockState_(e){return e.saveExtraState?(e=e.saveExtraState(!0))?JSON.stringify(e):"":e.mutationToDom&&(e=e.mutationToDom())?vi(e):""}};i(Ne.EVENT,ge.BLOCK_CHANGE,ro);var au={};au.clamp=ma,au.toDegrees=Hm,au.toRadians=zs;var lu=16,Yg=1,Qb=12,Xg=16,Yd=.25,Zg=null,Fa=null,Wl="",ja="",sn,io,za,Qg=null,Ho=null,e$=null,ef={getBoundsInfo:function(){const e=Vn(Qg),t=jn(Qg);return{left:e.x,right:e.x+t.width,top:e.y,bottom:e.y+t.height,width:t.width,height:t.height}},getPositionMetrics:function(e,t,r,l){const p=ef.getBoundsInfo(),v=jn(sn);return t+v.height<p.bottom?hl(e,t,p,v):l-v.height>p.top?Do(r,l,p,v):t+v.height<document.documentElement.clientHeight?hl(e,t,p,v):l-v.height>document.documentElement.clientTop?Do(r,l,p,v):Vm(e,p,v)}},As={ANIMATION_TIME:Yd,ARROW_HORIZONTAL_PADDING:Qb,ARROW_SIZE:lu,BORDER_SIZE:Yg,PADDING_Y:Xg,TEST_ONLY:ef};As.clearContent=si,As.createDom=bi,As.getContentDiv=wn,As.getOwner=Tc,As.getPositionX=pl,As.hide=fl,As.hideIfOwner=gl,As.hideWithoutAnimation=ri,As.isVisible=Yu,As.repositionForWindowResize=Ic,As.setBoundsElement=dl,As.setColour=Ec,As.show=Ju,As.showPositionedByBlock=Wm,As.showPositionedByField=kc;var cu=class{constructor(e){this.workspace=e,this.cursorSvg=this.cursor=null,this.markers=new Map,this.markerSvg=null}registerMarker(e,t){this.markers.has(e)&&this.unregisterMarker(e),t.setDrawer(this.workspace.getRenderer().makeMarkerDrawer(this.workspace,t)),this.setMarkerSvg(t.getDrawer().createDom()),this.markers.set(e,t)}unregisterMarker(e){const t=this.markers.get(e);if(t)t.dispose(),this.markers.delete(e);else throw Error("Marker with ID "+e+" does not exist. Can only unregister markers that exist.")}getCursor(){return this.cursor}getMarker(e){return this.markers.get(e)||null}setCursor(e){this.cursor&&this.cursor.getDrawer()&&this.cursor.getDrawer().dispose(),(this.cursor=e)&&(e=this.workspace.getRenderer().makeMarkerDrawer(this.workspace,this.cursor),this.cursor.setDrawer(e),this.setCursorSvg(this.cursor.getDrawer().createDom()))}setCursorSvg(e){e?(this.workspace.getBlockCanvas().appendChild(e),this.cursorSvg=e):this.cursorSvg=null}setMarkerSvg(e){e?this.workspace.getBlockCanvas()&&(this.cursorSvg?this.workspace.getBlockCanvas().insertBefore(e,this.cursorSvg):this.workspace.getBlockCanvas().appendChild(e)):this.markerSvg=null}updateMarkers(){this.workspace.keyboardAccessibilityMode&&this.cursorSvg&&this.workspace.getCursor().draw()}dispose(){const e=Object.keys(this.markers);for(let t=0,r;r=e[t];t++)this.unregisterMarker(r);this.markers.clear(),this.cursor&&(this.cursor.dispose(),this.cursor=null)}};cu.LOCAL_MARKER="local_marker_1";var Vl={};Vl.commonWordPrefix=xp,Vl.commonWordSuffix=Xu,Vl.isNumber=s.isNumber$$module$build$src$core$utils$string,Vl.shortestStringLength=ba,Vl.wrap=s.wrap$$module$build$src$core$utils$string;var Xd=void 0,uu=!1,Gl=!1,t$=50,n$=0,Ua=0,tf=0,nf=0,Sr=null,ql=null,sf=0,rf=10,s$=10,r$=750,Ha=5,rs=null,Cr={HOVER_MS:r$,LIMIT:t$,MARGINS:Ha,OFFSET_X:sf,OFFSET_Y:rf,RADIUS_OK:s$};Cr.bindMouseEvents=$l,Cr.block=Np,Cr.createDom=Oo,Cr.dispose=vl,Cr.getCustomTooltip=Gm,Cr.getDiv=Km,Cr.getTooltipOfObject=bl,Cr.hide=Hi,Cr.isVisible=qm,Cr.setCustomTooltip=Op,Cr.unbindMouseEvents=Zu,Cr.unblock=Mp;var of=.45,af=.65,i$={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00"},Ur={};Ur.blend=Je,Ur.getHsvSaturation=Bp,Ur.getHsvValue=Pp,Ur.hexToRgb=Se,Ur.hsvToHex=me,Ur.hueToHex=yt,Ur.names=i$,Ur.parse=Mr,Ur.rgbToHex=oe,Ur.setHsvSaturation=Ym,Ur.setHsvValue=Xm;var du={};du.checkMessageReferences=ed,du.parseBlockColour=yl,du.replaceMessageReferences=bt,du.tokenizeInterpolation=Zn;var fn=class{constructor(e,t,r){this.DEFAULT_VALUE=null,this.name=void 0,this.constants_=this.mouseDownWrapper=this.textContent_=this.textElement_=this.borderRect_=this.fieldGroup_=this.markerSvg=this.cursorSvg=this.tooltip=this.validator_=null,this.disposed=!1,this.maxDisplayLength=50,this.sourceBlock_=null,this.enabled_=this.visible_=this.isDirty_=!0,this.suffixField=this.prefixField=this.clickTarget_=null,this.EDITABLE=!0,this.SERIALIZABLE=!1,this.CURSOR="",this.value_="DEFAULT_VALUE"in new.target.prototype?new.target.prototype.DEFAULT_VALUE:this.DEFAULT_VALUE,this.size_=new Pt(0,0),e!==fn.SKIP_SETUP&&(r&&this.configure_(r),this.setValue(e),t&&this.setValidator(t))}configure_(e){e.tooltip&&this.setTooltip(bt(e.tooltip))}setSourceBlock(e){if(this.sourceBlock_)throw Error("Field already bound to a block");this.sourceBlock_=e}getConstants(){return!this.constants_&&this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()&&this.sourceBlock_.workspace.rendered&&(this.constants_=this.sourceBlock_.workspace.getRenderer().getConstants()),this.constants_}getSourceBlock(){return this.sourceBlock_}init(){this.fieldGroup_||(this.fieldGroup_=ie(ae.G,{}),this.isVisible()||(this.fieldGroup_.style.display="none"),this.sourceBlock_.getSvgRoot().appendChild(this.fieldGroup_),this.initView(),this.updateEditable(),this.setTooltip(this.tooltip),this.bindEvents_(),this.initModel(),this.applyColour())}initView(){this.createBorderRect_(),this.createTextElement_()}initModel(){}isFullBlockField(){return!this.borderRect_}createBorderRect_(){this.borderRect_=ie(ae.RECT,{rx:this.getConstants().FIELD_BORDER_RECT_RADIUS,ry:this.getConstants().FIELD_BORDER_RECT_RADIUS,x:0,y:0,height:this.size_.height,width:this.size_.width,class:"blocklyFieldRect"},this.fieldGroup_)}createTextElement_(){this.textElement_=ie(ae.TEXT,{class:"blocklyText"},this.fieldGroup_),this.getConstants().FIELD_TEXT_BASELINE_CENTER&&this.textElement_.setAttribute("dominant-baseline","central"),this.textContent_=document.createTextNode(""),this.textElement_.appendChild(this.textContent_)}bindEvents_(){const e=this.getClickTarget_();if(!e)throw Error("A click target has not been set.");$l(e),this.mouseDownWrapper=He(e,"pointerdown",this,this.onMouseDown_)}fromXml(e){this.setValue(e.textContent)}toXml(e){return e.textContent=this.getValue(),e}saveState(e){return e=this.saveLegacyState(fn),e!==null?e:this.getValue()}loadState(e){this.loadLegacyState(fn,e)||this.setValue(e)}saveLegacyState(e){return e.prototype.saveState===this.saveState&&e.prototype.toXml!==this.toXml?(e=s.createElement$$module$build$src$core$utils$xml("field"),e.setAttribute("name",this.name||""),H(this.toXml(e)).replace(' xmlns="https://developers.google.com/blockly/xml"',"")):null}loadLegacyState(e,t){return e.prototype.loadState===this.loadState&&e.prototype.fromXml!==this.fromXml?(this.fromXml(s.textToDom$$module$build$src$core$utils$xml(t)),!0):!1}dispose(){gl(this),Kt(this);let e;(e=this.getSourceBlock())!=null&&e.isDeadOrDying()||lt(this.fieldGroup_),this.disposed=!0}updateEditable(){const e=this.fieldGroup_,t=this.getSourceBlock();this.EDITABLE&&e&&t&&(this.enabled_&&t.isEditable()?(Pe(e,"blocklyEditableText"),it(e,"blocklyNonEditableText"),e.style.cursor=this.CURSOR):(Pe(e,"blocklyNonEditableText"),it(e,"blocklyEditableText"),e.style.cursor=""))}setEnabled(e){this.enabled_=e,this.updateEditable()}isEnabled(){return this.enabled_}isClickable(){return this.enabled_&&!!this.sourceBlock_&&this.sourceBlock_.isEditable()&&this.showEditor_!==fn.prototype.showEditor_}isClickableInFlyout(e){return!e}isCurrentlyEditable(){return this.enabled_&&this.EDITABLE&&!!this.sourceBlock_&&this.sourceBlock_.isEditable()}isSerializable(){let e=!1;return this.name&&(this.SERIALIZABLE?e=!0:this.EDITABLE&&(console.warn("Detected an editable field that was not serializable. Please define SERIALIZABLE property as true on all editable custom fields. Proceeding with serialization."),e=!0)),e}isVisible(){return this.visible_}setVisible(e){if(this.visible_!==e){this.visible_=e;var t=this.fieldGroup_;t&&(t.style.display=e?"block":"none")}}setValidator(e){this.validator_=e}getValidator(){return this.validator_}getSvgRoot(){return this.fieldGroup_}getBorderRect(){if(!this.borderRect_)throw Error(`The border rectangle is ${this.borderRect_}.`);return this.borderRect_}getTextElement(){if(!this.textElement_)throw Error(`The text element is ${this.textElement_}.`);return this.textElement_}getTextContent(){if(!this.textContent_)throw Error(`The text content is ${this.textContent_}.`);return this.textContent_}applyColour(){}render_(){this.textContent_&&(this.textContent_.nodeValue=this.getDisplayText_()),this.updateSize_()}showEditor(e){this.isClickable()&&this.showEditor_(e)}showEditor_(e){}repositionForWindowResize(){return!1}updateSize_(e){const t=this.getConstants();e=e!==void 0?e:this.isFullBlockField()?0:this.getConstants().FIELD_BORDER_RECT_X_PADDING;let r=2*e,l=t.FIELD_TEXT_HEIGHT,p=0;this.textElement_&&(p=as(this.textElement_,t.FIELD_TEXT_FONTSIZE,t.FIELD_TEXT_FONTWEIGHT,t.FIELD_TEXT_FONTFAMILY),r+=p),this.isFullBlockField()||(l=Math.max(l,t.FIELD_BORDER_RECT_HEIGHT)),this.size_.height=l,this.size_.width=r,this.positionTextElement_(e,p),this.positionBorderRect_()}positionTextElement_(e,t){if(this.textElement_){var r=this.getConstants(),l=this.size_.height/2,p;this.textElement_.setAttribute("x",String((p=this.getSourceBlock())!=null&&p.RTL?this.size_.width-t-e:e)),this.textElement_.setAttribute("y",String(r.FIELD_TEXT_BASELINE_CENTER?l:l-r.FIELD_TEXT_HEIGHT/2+r.FIELD_TEXT_BASELINE))}}positionBorderRect_(){this.borderRect_&&(this.borderRect_.setAttribute("width",String(this.size_.width)),this.borderRect_.setAttribute("height",String(this.size_.height)),this.borderRect_.setAttribute("rx",String(this.getConstants().FIELD_BORDER_RECT_RADIUS)),this.borderRect_.setAttribute("ry",String(this.getConstants().FIELD_BORDER_RECT_RADIUS)))}getSize(){return this.isVisible()?(this.isDirty_?(this.render_(),this.isDirty_=!1):this.visible_&&this.size_.width===0&&(this.render_(),this.size_.width!==0&&console.warn("Deprecated use of setting size_.width to 0 to rerender a field. Set field.isDirty_ to true instead.")),this.size_):new Pt(0,0)}getScaledBBox(){let e;var t=this.getSourceBlock();if(!t)throw new Jn;if(this.isFullBlockField()){var r=this.sourceBlock_.getHeightWidth();const l=t.workspace.scale;e=this.getAbsoluteXY_(),t=(r.width+1)*l,r=(r.height+1)*l,Og?(e.x+=1.5*l,e.y+=1.5*l):(e.x-=.5*l,e.y-=.5*l)}else r=this.borderRect_.getBoundingClientRect(),e=Vn(this.borderRect_),t=r.width,r=r.height;return new Tt(e.y,e.y+r,e.x,e.x+t)}onLocationChange(e){}getDisplayText_(){let e=this.getText();return e?(e.length>this.maxDisplayLength&&(e=e.substring(0,this.maxDisplayLength-2)+"…"),e=e.replace(/\s/g,fn.NBSP),this.sourceBlock_&&this.sourceBlock_.RTL&&(e+="‏"),e):fn.NBSP}getText(){const e=this.getText_();return String(e!==null?e:this.getValue())}getText_(){return null}markDirty(){this.isDirty_=!0,this.constants_=null}forceRerender(){this.isDirty_=!0,this.sourceBlock_&&this.sourceBlock_.rendered&&this.sourceBlock_.queueRender()}setValue(e,t=!0){if(e!==null){var r=s.getGroup$$module$build$src$core$events$utils();r||s.setGroup$$module$build$src$core$events$utils(!0);try{const _e=this.doClassValidation_(e),qe=this.processValidation(e,_e,t);if(!(qe instanceof Error)){var l,p=(l=this.getValidator())==null?void 0:l.call(this,qe),v=this.processValidation(qe,p,t);if(!(v instanceof Error)){var O=this.sourceBlock_;if(!O||!O.disposed){var G=this.getValue();G===v?this.doValueUpdate_(v):(this.doValueUpdate_(v),t&&O&&re()&&te(new(Ce(ge.BLOCK_CHANGE))(O,"field",this.name||null,G,v)),this.isDirty_&&this.forceRerender())}}}}finally{s.setGroup$$module$build$src$core$events$utils(r)}}}processValidation(e,t,r){return t===null?(this.doValueInvalid_(e,r),this.isDirty_&&this.forceRerender(),Error()):t===void 0?e:t}getValue(){return this.value_}doClassValidation_(e){return e??null}doValueUpdate_(e){this.value_=e,this.isDirty_=!0}doValueInvalid_(e,t){}onMouseDown_(e){this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()&&(e=this.sourceBlock_.workspace.getGesture(e))&&e.setStartField(this)}setTooltip(e){e||e===""||(e=this.sourceBlock_);const t=this.getClickTarget_();t?t.tooltip=e:this.tooltip=e}getTooltip(){const e=this.getClickTarget_();return bl(e||{tooltip:this.tooltip})}getClickTarget_(){return this.clickTarget_||this.getSvgRoot()}getAbsoluteXY_(){return Vn(this.getClickTarget_())}referencesVariables(){return!1}refreshVariableName(){}getParentInput(){let e=null;const t=this.getSourceBlock();if(!t)throw new Jn;const r=t.inputList;for(let l=0;l<t.inputList.length;l++){const p=r[l],v=p.fieldRow;for(let O=0;O<v.length;O++)if(v[O]===this){e=p;break}}return e}getFlipRtl(){return!1}isTabNavigable(){return!1}onShortcut(e){return!1}setCursorSvg(e){if(e){if(!this.fieldGroup_)throw Error(`The field group is ${this.fieldGroup_}.`);this.fieldGroup_.appendChild(e),this.cursorSvg=e}else this.cursorSvg=null}setMarkerSvg(e){if(e){if(!this.fieldGroup_)throw Error(`The field group is ${this.fieldGroup_}.`);this.fieldGroup_.appendChild(e),this.markerSvg=e}else this.markerSvg=null}updateMarkers_(){var e=this.getSourceBlock();if(!e)throw new Jn;e=e.workspace,e.keyboardAccessibilityMode&&this.cursorSvg&&e.getCursor().draw(),e.keyboardAccessibilityMode&&this.markerSvg&&e.getMarker(cu.LOCAL_MARKER).draw()}static fromJson(e){throw Error("Attempted to instantiate a field from the registry that hasn't defined a 'fromJson' method.")}};fn.NBSP=" ",fn.SKIP_SETUP=Symbol("SKIP_SETUP");var Jn=class extends Error{constructor(){super("The field has not yet been attached to its input. Call appendField to attach it.")}},Kl=null,lf=null,Wa=null,Zd="blocklyWidgetDiv",Va="",Ga="",Tr,Hr={};Hr.createDom=Fp,Hr.getDiv=vs,Hr.hide=Vi,Hr.hideIfOwner=Kt,Hr.hideIfOwnerIsInWorkspace=Dc,Hr.isVisible=_l,Hr.positionWithAnchor=wl,Hr.repositionForWindowResize=Sl,Hr.show=Wi,Hr.testOnly_setDiv=xc;var hu=null,cf={},pu=null,qa={};qa.callbackFactory=s.callbackFactory$$module$build$src$core$contextmenu,qa.dispose=ya,qa.getCurrentBlock=Gi,qa.hide=El,qa.setCurrentBlock=Cl,qa.show=Tl;var At=class{constructor(){this.registeredItems=new Map,this.reset()}reset(){this.registeredItems.clear()}register(e){if(this.registeredItems.has(e.id))throw Error('Menu item with ID "'+e.id+'" is already registered.');this.registeredItems.set(e.id,e)}unregister(e){if(!this.registeredItems.has(e))throw Error('Menu item with ID "'+e+'" not found.');this.registeredItems.delete(e)}getItem(e){let t;return(t=this.registeredItems.get(e))!=null?t:null}getContextMenuOptions(e,t){const r=[];for(const p of this.registeredItems.values())if(e===p.scopeType){var l=p.preconditionFn(t);l!=="hidden"&&(l={text:typeof p.displayText=="function"?p.displayText(t):p.displayText,enabled:l==="enabled",callback:p.callback,scope:t,weight:p.weight},r.push(l))}return r.sort(function(p,v){return p.weight-v.weight}),r}};(function(e){var t=e.ScopeType||(e.ScopeType={});t.BLOCK="block",t.WORKSPACE="workspace",t.COMMENT="comment",e.registry=new e})(At),At.ScopeType;var Wo=50,Ka=100,Qd={BLOCK:Wo,BUBBLE:Ka},o$=class{constructor(e){this.comment=e,this.startLoc=null,this.inGroup=!1,this.workspace=e.workspace}isMovable(){return this.comment.isOwnMovable()&&!this.comment.isDeadOrDying()&&!this.workspace.options.readOnly}startDrag(){(this.inGroup=!!s.getGroup$$module$build$src$core$events$utils())||s.setGroup$$module$build$src$core$events$utils(!0),this.fireDragStartEvent(),this.startLoc=this.comment.getRelativeToSurfaceXY(),this.workspace.setResizesEnabled(!1);let e;(e=this.workspace.getLayerManager())==null||e.moveToDragLayer(this.comment),this.comment.setDragging(!0)}drag(e){this.comment.moveDuringDrag(e)}endDrag(){this.fireDragEndEvent(),this.fireMoveEvent();let e;(e=this.workspace.getLayerManager())==null||e.moveOffDragLayer(this.comment,Wo),this.comment.setDragging(!1),this.comment.snapToGrid(),this.workspace.setResizesEnabled(!0),this.inGroup||s.setGroup$$module$build$src$core$events$utils(!1)}fireDragStartEvent(){const e=new(Ce(ge.COMMENT_DRAG))(this.comment,!0);te(e)}fireDragEndEvent(){const e=new(Ce(ge.COMMENT_DRAG))(this.comment,!1);te(e)}fireMoveEvent(){if(!this.comment.isDeadOrDying()){var e=new(Ce(ge.COMMENT_MOVE))(this.comment);e.setReason(["drag"]),e.oldCoordinate_=this.startLoc,e.recordNew(),te(e)}}revertDrag(){this.startLoc&&this.comment.moveDuringDrag(this.startLoc)}},a$=new WeakMap,eh=class{constructor(e){this.workspace=e,this.size=new Pt(120,100),this.collapsed=!1,this.editable=!0,this.location=new Ae(0,0),this.text="",this.textChangeListeners=[],this.sizeChangeListeners=[],this.disposeListeners=[],this.collapseChangeListeners=[],this.resizePointerMoveListener=this.resizePointerUpListener=null,this.disposed=this.disposing=!1,this.svgRoot=ie(ae.G,{class:"blocklyComment blocklyEditable blocklyDraggable"}),this.highlightRect=this.createHighlightRect(this.svgRoot),{topBarGroup:this.topBarGroup,topBarBackground:this.topBarBackground,deleteIcon:this.deleteIcon,foldoutIcon:this.foldoutIcon,textPreview:this.textPreview,textPreviewNode:this.textPreviewNode}=this.createTopBar(this.svgRoot,e),{foreignObject:this.foreignObject,textArea:this.textArea}=this.createTextArea(this.svgRoot),this.resizeHandle=this.createResizeHandle(this.svgRoot,e);let t;(t=e.getLayerManager())==null||t.append(this,Wo),this.setSizeWithoutFiringEvents(this.size),this.moveTo(new Ae(0,0))}createHighlightRect(e){return ie(ae.RECT,{class:"blocklyCommentHighlight"},e)}createTopBar(e,t){e=ie(ae.G,{class:"blocklyCommentTopbar"},e);const r=ie(ae.RECT,{class:"blocklyCommentTopbarBackground"},e),l=ie(ae.IMAGE,{class:"blocklyDeleteIcon",href:`${t.options.pathToMedia}delete-icon.svg`},e);t=ie(ae.IMAGE,{class:"blocklyFoldoutIcon",href:`${t.options.pathToMedia}foldout-icon.svg`},e);const p=ie(ae.TEXT,{class:"blocklyCommentPreview blocklyCommentText blocklyText"},e),v=document.createTextNode("");return p.appendChild(v),He(t,"pointerdown",this,this.onFoldoutDown),He(l,"pointerdown",this,this.onDeleteDown),{topBarGroup:e,topBarBackground:r,deleteIcon:l,foldoutIcon:t,textPreview:p,textPreviewNode:v}}createTextArea(e){e=ie(ae.FOREIGNOBJECT,{class:"blocklyCommentForeignObject"},e);const t=document.createElementNS(ki,"body");t.setAttribute("xmlns",ki),t.className="blocklyMinimalBody";const r=document.createElementNS(ki,"textarea");return Pe(r,"blocklyCommentText"),Pe(r,"blocklyTextarea"),Pe(r,"blocklyText"),t.appendChild(r),e.appendChild(t),He(r,"change",this,this.onTextChange),{foreignObject:e,textArea:r}}createResizeHandle(e,t){return e=ie(ae.IMAGE,{class:"blocklyResizeHandle",href:`${t.options.pathToMedia}resize-handle.svg`},e),He(e,"pointerdown",this,this.onResizePointerDown),e}getSvgRoot(){return this.svgRoot}getSize(){return this.collapsed?this.topBarBackground.getBBox():this.size}setSizeWithoutFiringEvents(e){const t=this.topBarBackground.getBBox(),r=this.deleteIcon.getBBox(),l=this.foldoutIcon.getBBox(),p=this.textPreview.getBBox(),v=this.resizeHandle.getBBox();this.size=e=Pt.max(e,this.calcMinSize(t,l,r)),this.svgRoot.setAttribute("height",`${e.height}`),this.svgRoot.setAttribute("width",`${e.width}`),this.updateHighlightRect(e),this.updateTopBarSize(e),this.updateTextAreaSize(e,t),this.updateDeleteIconPosition(e,t,r),this.updateFoldoutIconPosition(t,l),this.updateTextPreviewSize(e,t,p,r,v),this.updateResizeHandlePosition(e,v)}setSize(e){const t=this.preResizeSize||this.size;this.setSizeWithoutFiringEvents(e),this.onSizeChange(t,this.size)}calcMinSize(e,t,r){var l;this.updateTextPreview((l=this.textArea.value)!=null?l:""),l=Xs(this.textPreview);const p=this.calcFoldoutMargin(e,t),v=this.calcDeleteMargin(e,r);let O=l;return this.foldoutIcon.checkVisibility()?O+=t.width+2*p:l&&(O+=4),this.deleteIcon.checkVisibility()?O+=r.width+2*v:l&&(O+=4),new Pt(O,e.height+20)}calcDeleteMargin(e,t){return(e.height-t.height)/2}calcFoldoutMargin(e,t){return(e.height-t.height)/2}updateHighlightRect(e){this.highlightRect.setAttribute("height",`${e.height}`),this.highlightRect.setAttribute("width",`${e.width}`),this.workspace.RTL&&this.highlightRect.setAttribute("x",`${-e.width}`)}updateTopBarSize(e){this.topBarBackground.setAttribute("width",`${e.width}`)}updateTextAreaSize(e,t){this.foreignObject.setAttribute("height",`${e.height-t.height}`),this.foreignObject.setAttribute("width",`${e.width}`),this.foreignObject.setAttribute("y",`${t.height}`),this.workspace.RTL&&this.foreignObject.setAttribute("x",`${-e.width}`)}updateDeleteIconPosition(e,t,r){t=this.calcDeleteMargin(t,r),this.deleteIcon.setAttribute("y",`${t}`),this.deleteIcon.setAttribute("x",`${e.width-r.width-t}`)}updateFoldoutIconPosition(e,t){e=this.calcFoldoutMargin(e,t),this.foldoutIcon.setAttribute("y",`${e}`),this.foldoutIcon.setAttribute("x",`${e}`)}updateTextPreviewSize(e,t,r,l,p){const v=(t.height-r.height)/2,O=this.calcDeleteMargin(t,l);t=this.calcFoldoutMargin(t,p),e=e.width-p.width-2*t-l.width-2*O,this.textPreview.setAttribute("x",`${p.width+2*t*(this.workspace.RTL?-1:1)}`),this.textPreview.setAttribute("y",`${v+r.height/2}`),this.textPreview.setAttribute("width",`${e}`)}updateResizeHandlePosition(e,t){this.resizeHandle.setAttribute("y",`${e.height-t.height}`),this.resizeHandle.setAttribute("x",`${e.width-t.width}`)}onSizeChange(e,t){for(let r=this.sizeChangeListeners.length-1;0<=r;r--)this.sizeChangeListeners[r](e,t)}addSizeChangeListener(e){this.sizeChangeListeners.push(e)}removeSizeChangeListener(e){this.sizeChangeListeners.splice(this.sizeChangeListeners.indexOf(e),1)}onResizePointerDown(e){this.isEditable()&&(this.bringToFront(),os(e)||(this.preResizeSize=this.getSize(),_a(this.workspace,e,new Ae(this.workspace.RTL?-this.getSize().width:this.getSize().width,this.getSize().height)),this.resizePointerUpListener=He(document,"pointerup",this,this.onResizePointerUp),this.resizePointerMoveListener=He(document,"pointermove",this,this.onResizePointerMove),this.workspace.hideChaff()),e.stopPropagation())}onResizePointerUp(e){Ot(),this.resizePointerUpListener&&(St(this.resizePointerUpListener),this.resizePointerUpListener=null),this.resizePointerMoveListener&&(St(this.resizePointerMoveListener),this.resizePointerMoveListener=null),this.setSize(this.size),this.preResizeSize=void 0}onResizePointerMove(e){e=nd(this.workspace,e),this.setSizeWithoutFiringEvents(new Pt(this.workspace.RTL?-e.x:e.x,e.y))}isCollapsed(){return this.collapsed}setCollapsed(e){(this.collapsed=e)?Pe(this.svgRoot,"blocklyCollapsed"):it(this.svgRoot,"blocklyCollapsed"),this.setSizeWithoutFiringEvents(this.size),this.onCollapse()}onCollapse(){for(let e=this.collapseChangeListeners.length-1;0<=e;e--)this.collapseChangeListeners[e](this.collapsed)}addOnCollapseListener(e){this.collapseChangeListeners.push(e)}removeOnCollapseListener(e){this.collapseChangeListeners.splice(this.collapseChangeListeners.indexOf(e),1)}onFoldoutDown(e){Ot(),this.bringToFront(),os(e)||(this.setCollapsed(!this.collapsed),this.workspace.hideChaff()),e.stopPropagation()}isEditable(){return this.editable}setEditable(e){(this.editable=e)?(Pe(this.svgRoot,"blocklyEditable"),it(this.svgRoot,"blocklyReadonly"),this.textArea.removeAttribute("readonly")):(it(this.svgRoot,"blocklyEditable"),Pe(this.svgRoot,"blocklyReadonly"),this.textArea.setAttribute("readonly","true"))}getRelativeToSurfaceXY(){return this.location}moveTo(e){this.location=e,this.svgRoot.setAttribute("transform",`translate(${e.x}, ${e.y})`)}getText(){return this.text}setText(e){this.textArea.value=e,this.onTextChange()}addTextChangeListener(e){this.textChangeListeners.push(e)}removeTextChangeListener(e){this.textChangeListeners.splice(this.textChangeListeners.indexOf(e),1)}onTextChange(){const e=this.text;this.text=this.textArea.value,this.updateTextPreview(this.text),this.setSize(this.size);for(let t=this.textChangeListeners.length-1;0<=t;t--)this.textChangeListeners[t](e,this.text)}updateTextPreview(e){this.textPreviewNode.textContent=this.truncateText(e)}truncateText(e){return 12<=e.length?`${e.substring(0,9)}...`:e}bringToFront(){const e=this.svgRoot.parentNode,t=e.childNodes;t[t.length-1]!==this.svgRoot&&e.appendChild(this.svgRoot)}onDeleteDown(e){Ot(),os(e)||this.dispose(),e.stopPropagation()}dispose(){this.disposing=!0,lt(this.svgRoot);for(let e=this.disposeListeners.length-1;0<=e;e--)this.disposeListeners[e]();this.disposed=!0}isDisposed(){return this.disposed}isDeadOrDying(){return this.disposing||this.disposed}addDisposeListener(e){this.disposeListeners.push(e)}removeDisposeListener(e){this.disposeListeners.splice(this.disposeListeners.indexOf(e),1)}};we(`
.injectionDiv {
  --commentFillColour: #FFFCC7;
  --commentBorderColour: #F2E49B;
}

.blocklyComment .blocklyTextarea {
  background-color: var(--commentFillColour);
  border: 1px solid var(--commentBorderColour);
  box-sizing: border-box;
  display: block;
  outline: 0;
  padding: 5px;
  resize: none;
  width: 100%;
  height: 100%;
}

.blocklyReadonly.blocklyComment .blocklyTextarea {
  cursor: inherit;
}

.blocklyDeleteIcon {
  width: 20px;
  height: 20px;
  display: none;
  cursor: pointer;
}

.blocklyFoldoutIcon {
  width: 20px;
  height: 20px;
  transform-origin: 12px 12px;
  cursor: pointer;
}
.blocklyResizeHandle {
  width: 12px;
  height: 12px;
  cursor: se-resize;
}
.blocklyReadonly.blocklyComment .blocklyResizeHandle {
  cursor: inherit;
}

.blocklyCommentTopbarBackground {
  fill: var(--commentBorderColour);
  height: 24px;
}

.blocklyComment .blocklyCommentPreview.blocklyText {
  fill: #000;
  dominant-baseline: middle;
  visibility: hidden;
}

.blocklyCollapsed.blocklyComment .blocklyCommentPreview {
  visibility: visible;
}

.blocklyCollapsed.blocklyComment .blocklyCommentForeignObject,
.blocklyCollapsed.blocklyComment .blocklyResizeHandle {
  display: none;
}

.blocklyCollapsed.blocklyComment .blocklyFoldoutIcon {
  transform: rotate(-90deg);
}

.blocklyRTL .blocklyCommentTopbar {
  transform: scale(-1, 1);
}

.blocklyRTL .blocklyCommentForeignObject {
  direction: rtl;
}

.blocklyRTL .blocklyCommentPreview {
  /* Revert the scale and control RTL using direction instead. */
  transform: scale(-1, 1);
  direction: rtl;
}

.blocklyRTL .blocklyResizeHandle {
  transform: scale(-1, 1);
  cursor: sw-resize;
}

.blocklyCommentHighlight {
  fill: none;
}

.blocklySelected .blocklyCommentHighlight {
  stroke: #fc3;
  stroke-width: 3px;
}

.blocklyCollapsed.blocklySelected .blocklyCommentHighlight {
  stroke: none;
}

.blocklyCollapsed.blocklySelected .blocklyCommentTopbarBackground {
  stroke: #fc3;
  stroke-width: 3px;
}
`);var gu=class{constructor(e,t){this.workspace=e,this.text="",this.size=new Pt(120,100),this.collapsed=!1,this.deletable=this.movable=this.editable=!0,this.location=new Ae(0,0),this.disposing=this.disposed=!1,this.id=t&&!e.getCommentById(t)?t:k(),e.addTopComment(this),this.fireCreateEvent()}fireCreateEvent(){re()&&te(new(Ce(ge.COMMENT_CREATE))(this))}fireDeleteEvent(){re()&&te(new(Ce(ge.COMMENT_DELETE))(this))}fireChangeEvent(e,t){re()&&te(new(Ce(ge.COMMENT_CHANGE))(this,e,t))}fireCollapseEvent(e){re()&&te(new(Ce(ge.COMMENT_COLLAPSE))(this,e))}setText(e){const t=this.text;this.text=e,this.fireChangeEvent(t,e)}getText(){return this.text}setSize(e){const t=new(Ce(ge.COMMENT_RESIZE))(this);this.size=e,t.recordCurrentSizeAsNewSize(),te(t)}getSize(){return this.size}setCollapsed(e){this.collapsed=e,this.fireCollapseEvent(e)}isCollapsed(){return this.collapsed}setEditable(e){this.editable=e}isEditable(){return this.isOwnEditable()&&!this.workspace.options.readOnly}isOwnEditable(){return this.editable}setMovable(e){this.movable=e}isMovable(){return this.isOwnMovable()&&!this.workspace.options.readOnly}isOwnMovable(){return this.movable}setDeletable(e){this.deletable=e}isDeletable(){return this.isOwnDeletable()&&!this.isDeadOrDying()&&!this.workspace.options.readOnly}isOwnDeletable(){return this.deletable}moveTo(e,t){const r=new(Ce(ge.COMMENT_MOVE))(this);t&&r.setReason(t),this.location=e,r.recordNew(),te(r)}getRelativeToSurfaceXY(){return this.location}dispose(){this.disposing=!0,this.fireDeleteEvent(),this.workspace.removeTopComment(this),this.disposed=!0}isDisposed(){return this.disposed}isDeadOrDying(){return this.disposing||this.disposed}},th=class extends gu{constructor(e,t){super(e,t),this.dragStrategy=new o$(this),this.workspace=e,this.view=new eh(e),this.view.setSize(this.getSize()),this.view.setEditable(this.isEditable()),this.view.getSvgRoot().setAttribute("data-id",this.id),this.addModelUpdateBindings(),He(this.view.getSvgRoot(),"pointerdown",this,this.startGesture),He(this.view.getSvgRoot(),"wheel",this,r=>{r.stopPropagation()})}addModelUpdateBindings(){this.view.addTextChangeListener((e,t)=>void super.setText(t)),this.view.addSizeChangeListener((e,t)=>void super.setSize(t)),this.view.addOnCollapseListener(()=>void super.setCollapsed(this.view.isCollapsed())),this.view.addDisposeListener(()=>{this.isDeadOrDying()||this.dispose()})}setText(e){this.view.setText(e)}setSize(e){this.view.setSize(e)}setCollapsed(e){this.view.setCollapsed(e)}setEditable(e){super.setEditable(e),this.view.setEditable(this.isEditable())}getSvgRoot(){return this.view.getSvgRoot()}getSize(){return super.getSize()}getBoundingRectangle(){const e=this.getRelativeToSurfaceXY();var t,r;const l=(r=(t=this.view)==null?void 0:t.getSize())!=null?r:this.getSize();return this.workspace.RTL?(t=e.x-l.width,r=e.x):(t=e.x,r=e.x+l.width),new Tt(e.y,e.y+l.height,t,r)}moveBy(e,t,r){const l=this.getRelativeToSurfaceXY();e=new Ae(l.x+e,l.y+t),this.moveTo(e,r)}moveTo(e,t){super.moveTo(e,t),this.view.moveTo(e)}moveDuringDrag(e){this.location=e,this.view.moveTo(e)}setDragging(e){e?Pe(this.getSvgRoot(),"blocklyDragging"):it(this.getSvgRoot(),"blocklyDragging")}dispose(){this.disposing=!0,this.view.isDeadOrDying()||this.view.dispose(),super.dispose()}startGesture(e){const t=this.workspace.getGesture(e);if(t){t.handleCommentStart(e,this);let r;(r=this.workspace.getLayerManager())==null||r.append(this,Wo),s.setSelected$$module$build$src$core$common(this)}}setDeleteStyle(e){e?Pe(this.getSvgRoot(),"blocklyDraggingDelete"):it(this.getSvgRoot(),"blocklyDraggingDelete")}isMovable(){return this.dragStrategy.isMovable()}startDrag(){this.dragStrategy.startDrag()}drag(e){this.dragStrategy.drag(e)}endDrag(){this.dragStrategy.endDrag()}revertDrag(){this.dragStrategy.revertDrag()}select(){Pe(this.getSvgRoot(),"blocklySelected")}unselect(){it(this.getSvgRoot(),"blocklySelected")}toCopyData(){return{paster:Gd.TYPE,commentState:kn(this,{addCoordinates:!0})}}showContextMenu(e){const t=At.registry.getContextMenuOptions(At.ScopeType.COMMENT,{comment:this});Tl(e,t,this.workspace.RTL,this.workspace)}snapToGrid(){if(!this.isDeadOrDying()){var e=this.workspace.getGrid();if(e!=null&&e.shouldSnap()){var t=this.getRelativeToSurfaceXY();e=e.alignXY(t),e!==t&&this.moveTo(e,["snap"])}}}},Ns={};Ns.appendDomToWorkspace=sb,Ns.blockToDom=Ki,Ns.blockToDomWithXY=Ro,Ns.clearWorkspaceAndLoadFromXml=ys,Ns.deleteNext=ib,Ns.domToBlock=s.domToBlock$$module$build$src$core$xml,Ns.domToBlockInternal=Ao,Ns.domToPrettyText=ts,Ns.domToText=vi,Ns.domToVariables=Wp,Ns.domToWorkspace=s.domToWorkspace$$module$build$src$core$xml,Ns.loadWorkspaceComment=Hp,Ns.saveWorkspaceComment=Ac,Ns.variablesToDom=kl,Ns.workspaceToDom=tb;var uf=class extends Pa{constructor(e){super(e),this.type=ge.BLOCK_CREATE,e&&(e.isShadow()&&(this.recordUndo=!1),this.xml=Ro(e),this.ids=ee(e),this.json=Vt(e,{addCoordinates:!0}))}toJson(){const e=super.toJson();if(!this.xml)throw Error("The block XML is undefined. Either pass a block to the constructor, or call fromJson");if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(!this.json)throw Error("The block JSON is undefined. Either pass a block to the constructor, or call fromJson");return e.xml=vi(this.xml),e.ids=this.ids,e.json=this.json,this.recordUndo||(e.recordUndo=this.recordUndo),e}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new uf),t.xml=s.textToDom$$module$build$src$core$utils$xml(e.xml),t.ids=e.ids,t.json=e.json,e.recordUndo!==void 0&&(t.recordUndo=e.recordUndo),t}run(e){const t=this.getEventWorkspace_();if(!this.json)throw Error("The block JSON is undefined. Either pass a block to the constructor, or call fromJson");if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(!Ny(t,this.ids))if(e)Ui(this.json,t);else for(e=0;e<this.ids.length;e++){const r=this.ids[e],l=t.getBlockById(r);l?l.dispose(!1):r===this.blockId&&console.warn("Can't uncreate non-existent block: "+r)}}},Ny=function(e,t){return t.map(r=>e.getBlockById(r)).filter(r=>r&&r.isShadow()).length===t.length};i(Ne.EVENT,ge.BLOCK_CREATE,uf);var df=class extends Os{constructor(e,t){super(t),this.type=ge.THEME_CHANGE,this.themeName=e}toJson(){const e=super.toJson();if(!this.themeName)throw Error("The theme name is undefined. Either pass a theme name to the constructor, or call fromJson");return e.themeName=this.themeName,e}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new df),t.themeName=e.themeName,t}};i(Ne.EVENT,ge.THEME_CHANGE,df);var hf=class extends Os{constructor(e,t,r,l,p){super(l),this.type=ge.VIEWPORT_CHANGE,this.viewTop=e,this.viewLeft=t,this.scale=r,this.oldScale=p}toJson(){const e=super.toJson();if(this.viewTop===void 0)throw Error("The view top is undefined. Either pass a value to the constructor, or call fromJson");if(this.viewLeft===void 0)throw Error("The view left is undefined. Either pass a value to the constructor, or call fromJson");if(this.scale===void 0)throw Error("The scale is undefined. Either pass a value to the constructor, or call fromJson");if(this.oldScale===void 0)throw Error("The old scale is undefined. Either pass a value to the constructor, or call fromJson");return e.viewTop=this.viewTop,e.viewLeft=this.viewLeft,e.scale=this.scale,e.oldScale=this.oldScale,e}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new hf),t.viewTop=e.viewTop,t.viewLeft=e.viewLeft,t.scale=e.scale,t.oldScale=e.oldScale,t}};i(Ne.EVENT,ge.VIEWPORT_CHANGE,hf);var Ge;(function(e){e[e.INPUT_VALUE=1]="INPUT_VALUE",e[e.OUTPUT_VALUE=2]="OUTPUT_VALUE",e[e.NEXT_STATEMENT=3]="NEXT_STATEMENT",e[e.PREVIOUS_STATEMENT=4]="PREVIOUS_STATEMENT"})(Ge||(Ge={}));var Jl=class{constructor(e){this.connectionChecker=e,this.connections=[]}addConnection(e,t){t=this.calculateIndexForYPos(t),this.connections.splice(t,0,e)}findIndexOfConnection(e,t){if(!this.connections.length)return-1;const r=this.calculateIndexForYPos(t);if(r>=this.connections.length)return-1;t=e.y;let l=r;for(;0<=l&&this.connections[l].y===t;){if(this.connections[l]===e)return l;l--}for(l=r;l<this.connections.length&&this.connections[l].y===t;){if(this.connections[l]===e)return l;l++}return-1}calculateIndexForYPos(e){if(!this.connections.length)return 0;let t=0,r=this.connections.length;for(;t<r;){const l=Math.floor((t+r)/2);if(this.connections[l].y<e)t=l+1;else if(this.connections[l].y>e)r=l;else{t=l;break}}return t}removeConnection(e,t){if(e=this.findIndexOfConnection(e,t),e===-1)throw Error("Unable to find connection in connectionDB.");this.connections.splice(e,1)}getNeighbours(e,t){function r(qe){const Nn=p-l[qe].x,On=v-l[qe].y;return Math.sqrt(Nn*Nn+On*On)<=t&&_e.push(l[qe]),On<t}const l=this.connections,p=e.x,v=e.y;e=0;let O=l.length-2,G=O;for(;e<G;)l[G].y<v?e=G:O=G,G=Math.floor((e+O)/2);const _e=[];if(O=e=G,l.length){for(;0<=e&&r(e);)e--;do O++;while(O<l.length&&r(O))}return _e}isInYRange(e,t,r){return Math.abs(this.connections[e].y-t)<=r}searchForClosest(e,t,r){if(!this.connections.length)return{connection:null,radius:t};const l=e.y,p=e.x;e.x=p+r.x,e.y=l+r.y;var v=this.calculateIndexForYPos(e.y);r=null;let O=t,G,_e=v-1;for(;0<=_e&&this.isInYRange(_e,e.y,t);)G=this.connections[_e],this.connectionChecker.canConnect(e,G,!0,O)&&(r=G,O=G.distanceFrom(e)),_e--;for(;v<this.connections.length&&this.isInYRange(v,e.y,t);)G=this.connections[v],this.connectionChecker.canConnect(e,G,!0,O)&&(r=G,O=G.distanceFrom(e)),v++;return e.x=p,e.y=l,{connection:r,radius:O}}static init(e){const t=[];return t[Ge.INPUT_VALUE]=new Jl(e),t[Ge.OUTPUT_VALUE]=new Jl(e),t[Ge.NEXT_STATEMENT]=new Jl(e),t[Ge.PREVIOUS_STATEMENT]=new Jl(e),t}},nh=null,fu=null,mu={};mu.connectionUiEffect=No,mu.disconnectUiEffect=ld,mu.disconnectUiStop=ii,mu.disposeUiEffect=ad;var l$=class{constructor(e){this.workspace=e,this.horizontalScrollEnabled=this.workspace.isMovableHorizontally(),this.verticalScrollEnabled=this.workspace.isMovableVertically(),this.startScrollXY_=new Ae(e.scrollX,e.scrollY)}dispose(){this.workspace=null}startDrag(){Ue()&&Ue().unselect()}endDrag(e){this.drag(e)}drag(e){if(e=Ae.sum(this.startScrollXY_,e),this.horizontalScrollEnabled&&this.verticalScrollEnabled)this.workspace.scroll(e.x,e.y);else if(this.horizontalScrollEnabled)this.workspace.scroll(e.x,this.workspace.scrollY);else if(this.verticalScrollEnabled)this.workspace.scroll(this.workspace.scrollX,e.y);else throw new TypeError("Invalid state.")}},ci=5,My=6,oo=class{constructor(e,t){this.creatorWorkspace=t,this.mouseDownXY=new Ae(0,0),this.startWorkspace_=this.targetBlock=this.startComment=this.startBlock=this.startIcon=this.startField=this.startBubble=null,this.hasExceededDragRadius=!1,this.boundEvents=[],this.workspaceDragger=this.dragger=null,this.dragging=!1,this.flyout=null,this.multiTouch=this.isEnding_=this.gestureHasStarted=this.calledUpdateIsDragging=!1,this.cachedPoints=new Map,this.startDistance=this.previousScale=0,this.currentDropdownOwner=this.isPinchZoomEnabled=null,this.mostRecentEvent=e,this.currentDragDeltaXY=new Ae(0,0)}dispose(){Ot(),Mp(),this.creatorWorkspace.clearGesture();for(const e of this.boundEvents)St(e);this.boundEvents.length=0,this.workspaceDragger&&this.workspaceDragger.dispose()}updateFromEvent(e){const t=new Ae(e.clientX,e.clientY);this.updateDragDelta(t)&&(this.updateIsDragging(e),en()),this.mostRecentEvent=e}updateDragDelta(e){return this.currentDragDeltaXY=Ae.difference(e,this.mouseDownXY),this.hasExceededDragRadius?!1:this.hasExceededDragRadius=Ae.magnitude(this.currentDragDeltaXY)>(this.flyout?s.config$$module$build$src$core$config.flyoutDragRadius:s.config$$module$build$src$core$config.dragRadius)}updateIsDraggingFromFlyout(){let e;if(!this.targetBlock||(e=this.flyout)==null||!e.isBlockCreatable(this.targetBlock))return!1;if(!this.flyout.targetWorkspace)throw Error(`Cannot update dragging from the flyout because the ' +
          'flyout's target workspace is undefined`);return!this.flyout.isScrollable()||this.flyout.isDragTowardWorkspace(this.currentDragDeltaXY)?(this.startWorkspace_=this.flyout.targetWorkspace,this.startWorkspace_.updateScreenCalculationsIfScrolled(),s.getGroup$$module$build$src$core$events$utils()||s.setGroup$$module$build$src$core$events$utils(!0),this.startBlock=null,this.targetBlock=this.flyout.createBlock(this.targetBlock),s.setSelected$$module$build$src$core$common(this.targetBlock),!0):!1}updateIsDraggingWorkspace(){if(!this.startWorkspace_)throw Error("Cannot update dragging the workspace because the start workspace is undefined");(this.flyout?this.flyout.isScrollable():this.startWorkspace_&&this.startWorkspace_.isDraggable())&&(this.dragging=!0,this.workspaceDragger=new l$(this.startWorkspace_),this.workspaceDragger.startDrag())}updateIsDragging(e){if(!this.startWorkspace_)throw Error("Cannot update dragging because the start workspace is undefined");if(this.calledUpdateIsDragging)throw Error("updateIsDragging_ should only be called once per gesture.");this.calledUpdateIsDragging=!0,this.flyout&&this.updateIsDraggingFromFlyout();const t=Ue();t&&yi(t)&&t.isMovable()?(this.dragging=!0,this.dragger=this.createDragger(t,this.startWorkspace_),this.dragger.onDragStart(e),this.dragger.onDrag(e,this.currentDragDeltaXY)):this.updateIsDraggingWorkspace()}createDragger(e,t){return new(w(Ne.BLOCK_DRAGGER,this.creatorWorkspace.options,!0))(e,t)}doStart(e){if(!this.startWorkspace_)throw Error("Cannot start the touch gesture becauase the start workspace is undefined");this.isPinchZoomEnabled=this.startWorkspace_.options.zoomOptions&&this.startWorkspace_.options.zoomOptions.pinch,Tn(e)?this.cancel():(this.gestureHasStarted=!0,ii(),this.startWorkspace_.updateScreenCalculationsIfScrolled(),this.startWorkspace_.isMutator&&this.startWorkspace_.resize(),this.currentDropdownOwner=Tc(),this.startWorkspace_.hideChaff(!!this.flyout),this.startWorkspace_.markFocused(),this.mostRecentEvent=e,Np(),os(e)?this.handleRightClick(e):(e.type.toLowerCase()==="pointerdown"&&e.pointerType!=="mouse"&&Xt(e,this),this.mouseDownXY=new Ae(e.clientX,e.clientY),this.bindMouseEvents(e),this.isEnding_||this.handleTouchStart(e)))}bindMouseEvents(e){this.boundEvents.push(He(document,"pointerdown",null,this.handleStart.bind(this),!0)),this.boundEvents.push(He(document,"pointermove",null,this.handleMove.bind(this),!0)),this.boundEvents.push(He(document,"pointerup",null,this.handleUp.bind(this),!0)),e.preventDefault(),e.stopPropagation()}handleStart(e){this.isDragging()||(this.handleTouchStart(e),this.isMultiTouch()&&en())}handleMove(e){this.isDragging()&&Lt(e)||!this.isMultiTouch()?(this.updateFromEvent(e),this.workspaceDragger?this.workspaceDragger.drag(this.currentDragDeltaXY):this.dragger&&this.dragger.onDrag(this.mostRecentEvent,this.currentDragDeltaXY),e.preventDefault(),e.stopPropagation()):this.isMultiTouch()&&(this.handleTouchMove(e),en())}handleUp(e){if(this.isDragging()||this.handleTouchEnd(e),!this.isMultiTouch()||this.isDragging()){if(!Lt(e))return;if(this.updateFromEvent(e),en(),this.isEnding_){console.log("Trying to end a gesture recursively.");return}this.isEnding_=!0,this.dragger?this.dragger.onDragEnd(e,this.currentDragDeltaXY):this.workspaceDragger?this.workspaceDragger.endDrag(this.currentDragDeltaXY):this.isBubbleClick()||this.isCommentClick()||(this.isFieldClick()?this.doFieldClick():this.isIconClick()?this.doIconClick():this.isBlockClick()?this.doBlockClick():this.isWorkspaceClick()&&this.doWorkspaceClick(e))}e.preventDefault(),e.stopPropagation(),this.dispose()}handleTouchStart(e){var t=vn(e);this.cachedPoints.set(t,this.getTouchPoint(e));var r=Array.from(this.cachedPoints.keys());r.length===2&&(t=this.cachedPoints.get(r[0]),r=this.cachedPoints.get(r[1]),this.startDistance=Ae.distance(t,r),this.multiTouch=!0,e.preventDefault())}handleTouchMove(e){const t=vn(e);this.cachedPoints.set(t,this.getTouchPoint(e)),this.isPinchZoomEnabled&&this.cachedPoints.size===2?this.handlePinch(e):(this.updateFromEvent(e),this.workspaceDragger?this.workspaceDragger.drag(this.currentDragDeltaXY):this.dragger&&this.dragger.onDrag(this.mostRecentEvent,this.currentDragDeltaXY),e.preventDefault(),e.stopPropagation())}handlePinch(e){var t=Array.from(this.cachedPoints.keys()),r=this.cachedPoints.get(t[0]);if(t=this.cachedPoints.get(t[1]),r=Ae.distance(r,t)/this.startDistance,0<this.previousScale&&1/0>this.previousScale){if(t=r-this.previousScale,t=0<t?t*ci:t*My,!this.startWorkspace_)throw Error("Cannot handle a pinch because the start workspace is undefined");const l=this.startWorkspace_,p=Ee(e,l.getParentSvg(),l.getInverseScreenCTM());l.zoom(p.x,p.y,t)}this.previousScale=r,e.preventDefault()}handleTouchEnd(e){e=vn(e),this.cachedPoints.has(e)&&this.cachedPoints.delete(e),2>this.cachedPoints.size&&(this.cachedPoints.clear(),this.previousScale=0)}getTouchPoint(e){return this.startWorkspace_?new Ae(e.pageX,e.pageY):null}isMultiTouch(){return this.multiTouch}cancel(){this.isEnding_||(en(),this.dragger?this.dragger.onDragEnd(this.mostRecentEvent,this.currentDragDeltaXY):this.workspaceDragger&&this.workspaceDragger.endDrag(this.currentDragDeltaXY),this.dispose())}handleRightClick(e){this.targetBlock?(this.bringBlockToFront(),this.targetBlock.workspace.hideChaff(!!this.flyout),this.targetBlock.showContextMenu(e)):this.startBubble?this.startBubble.showContextMenu(e):this.startComment?(this.startComment.workspace.hideChaff(),this.startComment.showContextMenu(e)):this.startWorkspace_&&!this.flyout&&(this.startWorkspace_.hideChaff(),this.startWorkspace_.showContextMenu(e)),e.preventDefault(),e.stopPropagation(),this.dispose()}handleWsStart(e,t){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleWsStart, but the gesture had already been started.");this.setStartWorkspace(t),this.mostRecentEvent=e,this.startBlock||this.startBubble||this.startComment||s.setSelected$$module$build$src$core$common(null),this.doStart(e)}fireWorkspaceClick(e){te(new(Ce(ge.CLICK))(null,e.id,"workspace"))}handleFlyoutStart(e,t){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleFlyoutStart, but the gesture had already been started.");this.setStartFlyout(t),this.handleWsStart(e,t.getWorkspace())}handleBlockStart(e,t){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleBlockStart, but the gesture had already been started.");this.setStartBlock(t),this.mostRecentEvent=e}handleBubbleStart(e,t){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleBubbleStart, but the gesture had already been started.");this.setStartBubble(t),this.mostRecentEvent=e}handleCommentStart(e,t){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleCommentStart, but the gesture had already been started.");this.setStartComment(t),this.mostRecentEvent=e}doFieldClick(){if(!this.startField)throw Error("Cannot do a field click because the start field is undefined");this.currentDropdownOwner!==this.startField&&this.startField.showEditor(this.mostRecentEvent),this.bringBlockToFront()}doIconClick(){if(!this.startIcon)throw Error("Cannot do an icon click because the start icon is undefined");this.bringBlockToFront(),this.startIcon.onClick()}doBlockClick(){if(this.flyout&&this.flyout.autoClose){if(!this.targetBlock)throw Error("Cannot do a block click because the target block is undefined");if(this.targetBlock.isEnabled()){s.getGroup$$module$build$src$core$events$utils()||s.setGroup$$module$build$src$core$events$utils(!0);var e=this.flyout.createBlock(this.targetBlock);e.snapToGrid(),e.bumpNeighbours()}}else{if(!this.startWorkspace_)throw Error("Cannot do a block click because the start workspace is undefined");e=new(Ce(ge.CLICK))(this.startBlock,this.startWorkspace_.id,"block"),te(e)}this.bringBlockToFront(),s.setGroup$$module$build$src$core$events$utils(!1)}doWorkspaceClick(e){e=this.creatorWorkspace,Ue()&&Ue().unselect(),this.fireWorkspaceClick(this.startWorkspace_||e)}bringBlockToFront(){this.targetBlock&&!this.flyout&&this.targetBlock.bringToFront()}setStartField(e){if(this.gestureHasStarted)throw Error("Tried to call gesture.setStartField, but the gesture had already been started.");this.startField||(this.startField=e)}setStartIcon(e){if(this.gestureHasStarted)throw Error("Tried to call gesture.setStartIcon, but the gesture had already been started.");this.startIcon||(this.startIcon=e)}setStartBubble(e){this.startBubble||(this.startBubble=e)}setStartComment(e){this.startComment||(this.startComment=e)}setStartBlock(e){this.startBlock||this.startBubble||(this.startBlock=e,s.setSelected$$module$build$src$core$common(this.startBlock),e.isInFlyout&&e!==e.getRootBlock()?this.setTargetBlock(e.getRootBlock()):this.setTargetBlock(e))}setTargetBlock(e){e.isShadow()?this.setTargetBlock(e.getParent()):this.targetBlock=e}setStartWorkspace(e){this.startWorkspace_||(this.startWorkspace_=e)}setStartFlyout(e){this.flyout||(this.flyout=e)}isBubbleClick(){return!!this.startBubble&&!this.hasExceededDragRadius}isCommentClick(){return!!this.startComment&&!this.hasExceededDragRadius}isBlockClick(){return!!this.startBlock&&!this.hasExceededDragRadius&&!this.isFieldClick()&&!this.isIconClick()}isFieldClick(){return this.startField?this.startField.isClickable()&&!this.hasExceededDragRadius&&(!this.flyout||this.startField.isClickableInFlyout(this.flyout.autoClose)):!1}isIconClick(){if(!this.startIcon)return!1;const e=!this.flyout||!this.startIcon.isClickableInFlyout||this.startIcon.isClickableInFlyout(this.flyout.autoClose);return!this.hasExceededDragRadius&&e}isWorkspaceClick(){return!this.startBlock&&!this.startBubble&&!this.startField&&!this.hasExceededDragRadius}getCurrentDragger(){let e,t;return(t=(e=this.workspaceDragger)!=null?e:this.dragger)!=null?t:null}isDragging(){return this.dragging}hasStarted(){return this.gestureHasStarted}static inProgress(){const e=Te();for(let t=0,r;r=e[t];t++)if(r.currentGesture_)return!0;return!1}},ao=class{constructor(e,t){this.pattern=e,this.scale=1;let r;this.spacing=(r=t.spacing)!=null?r:0;let l;this.length=(l=t.length)!=null?l:1,this.line2=(this.line1=e.firstChild)&&this.line1.nextSibling;let p;this.snapToGrid=(p=t.snap)!=null?p:!1}setSpacing(e){this.spacing=e,this.update(this.scale)}getSpacing(){return this.spacing}setLength(e){this.length=e,this.update(this.scale)}getLength(){return this.length}setSnapToGrid(e){this.snapToGrid=e}shouldSnap(){return this.snapToGrid}getPatternId(){return this.pattern.id}update(e){this.scale=e;var t=this.spacing*e;this.pattern.setAttribute("width",`${t}`),this.pattern.setAttribute("height",`${t}`),t=Math.floor(this.spacing/2)+.5;let r=t-this.length/2,l=t+this.length/2;t*=e,r*=e,l*=e,this.setLineAttributes(this.line1,e,r,l,t,t),this.setLineAttributes(this.line2,e,t,t,r,l)}setLineAttributes(e,t,r,l,p,v){e&&(e.setAttribute("stroke-width",`${t}`),e.setAttribute("x1",`${r}`),e.setAttribute("y1",`${p}`),e.setAttribute("x2",`${l}`),e.setAttribute("y2",`${v}`))}moveTo(e,t){this.pattern.setAttribute("x",`${e}`),this.pattern.setAttribute("y",`${t}`)}alignXY(e){var t=this.getSpacing();const r=t/2,l=Math.round(Math.round((e.x-r)/t)*t+r);return t=Math.round(Math.round((e.y-r)/t)*t+r),l===e.x&&t===e.y?e:new Ae(l,t)}static createDom(e,t,r){e=ie(ae.PATTERN,{id:"blocklyGridPattern"+e,patternUnits:"userSpaceOnUse"},r);let l,p;if(0<((l=t.length)!=null?l:1)&&0<((p=t.spacing)!=null?p:0)){ie(ae.LINE,{stroke:t.colour},e);let v;(v=t.length)!=null&&v&&ie(ae.LINE,{stroke:t.colour},e)}else ie(ae.LINE,{},e);return e}},Et=class{constructor(e){this.workspace=e,this.layers=new Map,(e=e.getInjectionDiv())&&(this.dragLayer=this.createDragLayer(e),this.animationLayer=this.createAnimationLayer(e)),e=this.createLayer(Wo),Pe(e,"blocklyBlockCanvas"),e=this.createLayer(Ka),Pe(e,"blocklyBubbleCanvas")}createDragLayer(e){const t=ie(ae.SVG,{class:"blocklyBlockDragSurface",xmlns:Xc,"xmlns:html":ki,"xmlns:xlink":ar,version:"1.1"});return e.append(t),ie(ae.G,{},t)}createAnimationLayer(e){const t=ie(ae.SVG,{class:"blocklyAnimationLayer",xmlns:Xc,"xmlns:html":ki,"xmlns:xlink":ar,version:"1.1"});return e.append(t),ie(ae.G,{},t)}appendToAnimationLayer(e){let t;const r=(t=this.dragLayer)==null?void 0:t.getAttribute("transform");if(r){let p;(p=this.animationLayer)==null||p.setAttribute("transform",r)}let l;(l=this.animationLayer)==null||l.appendChild(e.getSvgRoot())}translateLayers(e,t){e=`translate(${e.x}, ${e.y}) scale(${t})`;let r;(r=this.dragLayer)==null||r.setAttribute("transform",e);for(const[,l]of this.layers)l.setAttribute("transform",e)}moveToDragLayer(e){let t;(t=this.dragLayer)==null||t.appendChild(e.getSvgRoot())}moveOffDragLayer(e,t){this.append(e,t)}append(e,t){this.layers.has(t)||this.createLayer(t);let r;(r=this.layers.get(t))==null||r.appendChild(e.getSvgRoot())}createLayer(e){const t=this.workspace.getSvgGroup(),r=ie(ae.G,{});let l=!1;const p=[...this.layers].sort((v,O)=>v[0]-O[0]);for(const[v,O]of p)if(e<v){t.insertBefore(r,O),l=!0;break}return l||t.appendChild(r),this.layers.set(e,r),r}hasLayer(e){return e===this.dragLayer||new Set(this.layers.values()).has(e)}getBlockLayer(){return this.layers.get(Wo)}getBubbleLayer(){return this.layers.get(Ka)}},c$={};c$.deepMerge=ns;var is=class{constructor(e,t,r,l){this.name=e,this.startHats=!1,this.blockStyles=t||Object.create(null),this.categoryStyles=r||Object.create(null),this.componentStyles=l||Object.create(null),this.fontStyle=Object.create(null),i(Ne.THEME,e,this,!0)}getClassName(){return this.name+"-theme"}setBlockStyle(e,t){this.blockStyles[e]=t}setCategoryStyle(e,t){this.categoryStyles[e]=t}getComponentStyle(e){if(e=this.componentStyles[e],!e)return null;if(typeof e=="string"){const t=this.getComponentStyle(e);if(t)return t}return`${e}`}setComponentStyle(e,t){this.componentStyles[e]=t}setFontStyle(e){this.fontStyle=e}setStartHats(e){this.startHats=e}static defineTheme(e,t){e=e.toLowerCase();const r=new is(e);let l=t.base;if(l){if(typeof l=="string"){let p;l=(p=$(Ne.THEME,l))!=null?p:void 0}l instanceof is&&(ns(r,l),r.name=e)}return ns(r.blockStyles,t.blockStyles),ns(r.categoryStyles,t.categoryStyles),ns(r.componentStyles,t.componentStyles),ns(r.fontStyle,t.fontStyle),t.startHats!==null&&(r.startHats=t.startHats),r}},Qn={colour_blocks:{colourPrimary:"20"},list_blocks:{colourPrimary:"260"},logic_blocks:{colourPrimary:"210"},loop_blocks:{colourPrimary:"120"},math_blocks:{colourPrimary:"230"},procedure_blocks:{colourPrimary:"290"},text_blocks:{colourPrimary:"160"},variable_blocks:{colourPrimary:"330"},variable_dynamic_blocks:{colourPrimary:"310"},hat_blocks:{colourPrimary:"330",hat:"cap"}},Ly={colour_category:{colour:"20"},list_category:{colour:"260"},logic_category:{colour:"210"},loop_category:{colour:"120"},math_category:{colour:"230"},procedure_category:{colour:"290"},text_category:{colour:"160"},variable_category:{colour:"330"},variable_dynamic_category:{colour:"310"}},ui=new is("classic",Qn,Ly),Wr=class{constructor(e){this.gridPattern=null,this.getMetrics=this.setMetrics=void 0;let t=null,r=!1;var l=!1,p=!1,v=!1,O=!1,G=!1;const _e=!!e.readOnly;if(!_e){var qe;t=j((qe=e.toolbox)!=null?qe:null),r=ye(t),l=e.trashcan,l=l===void 0?r:l,p=e.collapse,p=p===void 0?r:p,v=e.comments,v=v===void 0?r:v,O=e.disable,O=O===void 0?r:O,G=e.sounds,G=G===void 0?!0:G}qe=e.maxTrashcanContents,l?qe===void 0&&(qe=32):qe=0;const Nn=!!e.rtl;let On=e.horizontalLayout;On===void 0&&(On=!1);var Yr=e.toolboxPosition!=="end";Yr=On?Yr?wt.TOP:wt.BOTTOM:Yr===Nn?wt.RIGHT:wt.LEFT;let kh=e.css;kh===void 0&&(kh=!0);let Lf="https://blockly-demo.appspot.com/static/media/";e.media&&(Lf=e.media.endsWith("/")?e.media:e.media+"/");const w0=e.oneBasedIndex,kx=e.renderer||"geras",Ix=e.plugins||{};let Zy=e.modalInputs;Zy===void 0&&(Zy=!0),this.RTL=Nn,this.oneBasedIndex=w0===void 0?!0:w0,this.collapse=p,this.comments=v,this.disable=O,this.readOnly=_e,this.maxBlocks=e.maxBlocks||1/0;let S0;this.maxInstances=(S0=e.maxInstances)!=null?S0:null,this.modalInputs=Zy,this.pathToMedia=Lf,this.hasCategories=r,this.moveOptions=Wr.parseMoveOptions(e,r),this.hasScrollbars=!!this.moveOptions.scrollbars,this.hasTrashcan=l,this.maxTrashcanContents=qe,this.hasSounds=G,this.hasCss=kh,this.horizontalLayout=On,this.languageTree=t,this.gridOptions=Wr.parseGridOptions(e),this.zoomOptions=Wr.parseZoomOptions(e),this.toolboxPosition=Yr,this.theme=Wr.parseThemeOptions(e),this.renderer=kx;let C0;this.rendererOverrides=(C0=e.rendererOverrides)!=null?C0:null;let T0;this.parentWorkspace=(T0=e.parentWorkspace)!=null?T0:null,this.plugins=Ix}static parseMoveOptions(e,t){const r=e.move||{},l={};return r.scrollbars===void 0&&e.scrollbars===void 0?l.scrollbars=t:typeof r.scrollbars=="object"?(l.scrollbars={horizontal:!!r.scrollbars.horizontal,vertical:!!r.scrollbars.vertical},l.scrollbars.horizontal&&l.scrollbars.vertical?l.scrollbars=!0:l.scrollbars.horizontal||l.scrollbars.vertical||(l.scrollbars=!1)):l.scrollbars=!!r.scrollbars||!!e.scrollbars,l.wheel=l.scrollbars&&r.wheel!==void 0?!!r.wheel:typeof l.scrollbars=="object",l.drag=l.scrollbars?r.drag===void 0?!0:!!r.drag:!1,l}static parseZoomOptions(e){e=e.zoom||{};const t={};return t.controls=e.controls===void 0?!1:!!e.controls,t.wheel=e.wheel===void 0?!1:!!e.wheel,t.startScale=e.startScale===void 0?1:Number(e.startScale),t.maxScale=e.maxScale===void 0?3:Number(e.maxScale),t.minScale=e.minScale===void 0?.3:Number(e.minScale),t.scaleSpeed=e.scaleSpeed===void 0?1.2:Number(e.scaleSpeed),t.pinch=e.pinch===void 0?t.wheel||t.controls:!!e.pinch,t}static parseGridOptions(e){e=e.grid||{};const t={};return t.spacing=Number(e.spacing)||0,t.colour=e.colour||"#888",t.length=e.length===void 0?1:Number(e.length),t.snap=0<t.spacing&&!!e.snap,t}static parseThemeOptions(e){return e=e.theme||ui,typeof e=="string"?$(Ne.THEME,e):e instanceof is?e:is.defineTheme(e.name||"builtin"+S(),e)}},u$={fromJsonInternal:ab},sh={TEST_ONLY:u$};sh.fromJson=s.fromJson$$module$build$src$core$field_registry,sh.register=_t,sh.unregister=ob;var cr=class extends fn{constructor(e,t,r){super(fn.SKIP_SETUP),this.svgArrow=this.arrow=this.imageElement=this.menu_=this.selectedMenuItem=null,this.SERIALIZABLE=!0,this.CURSOR="default",this.clickTarget_=this.suffixField=this.prefixField=this.generatedOptions=null,e!==fn.SKIP_SETUP&&(Array.isArray(e)?(this.validateOptions(e),e=this.trimOptions(e),this.menuGenerator_=e.options,this.prefixField=e.prefix||null,this.suffixField=e.suffix||null):this.menuGenerator_=e,this.selectedOption=this.getOptions(!1)[0],r&&this.configure_(r),this.setValue(this.selectedOption[1]),t&&this.setValidator(t))}fromXml(e){this.isOptionListDynamic()&&this.getOptions(!1),this.setValue(e.textContent)}loadState(e){this.loadLegacyState(cr,e)||(this.isOptionListDynamic()&&this.getOptions(!1),this.setValue(e))}initView(){this.shouldAddBorderRect_()?this.createBorderRect_():this.clickTarget_=this.sourceBlock_.getSvgRoot(),this.createTextElement_(),this.imageElement=ie(ae.IMAGE,{},this.fieldGroup_),this.getConstants().FIELD_DROPDOWN_SVG_ARROW?this.createSVGArrow_():this.createTextArrow_(),this.borderRect_&&Pe(this.borderRect_,"blocklyDropdownRect")}shouldAddBorderRect_(){let e;return!this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW||this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW&&!((e=this.getSourceBlock())!=null&&e.isShadow())}createTextArrow_(){this.arrow=ie(ae.TSPAN,{},this.textElement_);let e;this.arrow.appendChild(document.createTextNode((e=this.getSourceBlock())!=null&&e.RTL?cr.ARROW_CHAR+" ":" "+cr.ARROW_CHAR)),this.getConstants().FIELD_TEXT_BASELINE_CENTER&&this.arrow.setAttribute("dominant-baseline","central");let t;(t=this.getSourceBlock())!=null&&t.RTL?this.getTextElement().insertBefore(this.arrow,this.textContent_):this.getTextElement().appendChild(this.arrow)}createSVGArrow_(){this.svgArrow=ie(ae.IMAGE,{height:this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE+"px",width:this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE+"px"},this.fieldGroup_),this.svgArrow.setAttributeNS(ar,"xlink:href",this.getConstants().FIELD_DROPDOWN_SVG_ARROW_DATAURI)}showEditor_(e){var t=this.getSourceBlock();if(!t)throw new Jn;this.dropdownCreate(),this.menu_.openingCoords=e&&typeof e.clientX=="number"?new Ae(e.clientX,e.clientY):null,si(),e=this.menu_.render(wn()),Pe(e,"blocklyDropdownMenu"),this.getConstants().FIELD_DROPDOWN_COLOURED_DIV&&(t=t.getColour(),Ec(t,this.sourceBlock_.style.colourTertiary)),kc(this,this.dropdownDispose_.bind(this)),this.menu_.focus(),this.selectedMenuItem&&(this.menu_.setHighlighted(this.selectedMenuItem),Or(this.selectedMenuItem.getElement(),wn(),!0)),this.applyColour()}dropdownCreate(){const e=this.getSourceBlock();if(!e)throw new Jn;const t=new Hg;t.setRole(zr.LISTBOX),this.menu_=t;const r=this.getOptions(!1);this.selectedMenuItem=null;for(let p=0;p<r.length;p++){const[v,O]=r[p];if(typeof v=="object"){var l=new Image(v.width,v.height);l.src=v.src,l.alt=v.alt||""}else l=v;l=new qd(l,O),l.setRole(zr.OPTION),l.setRightToLeft(e.RTL),l.setCheckable(!0),t.addChild(l),l.setChecked(O===this.value_),O===this.value_&&(this.selectedMenuItem=l),l.onAction(this.handleMenuActionEvent,this)}}dropdownDispose_(){this.menu_&&this.menu_.dispose(),this.selectedMenuItem=this.menu_=null,this.applyColour()}handleMenuActionEvent(e){gl(this,!0),this.onItemSelected_(this.menu_,e)}onItemSelected_(e,t){this.setValue(t.getValue())}isOptionListDynamic(){return typeof this.menuGenerator_=="function"}getOptions(e){if(!this.menuGenerator_)throw TypeError("A menu generator was never defined.");return Array.isArray(this.menuGenerator_)?this.menuGenerator_:e&&this.generatedOptions?this.generatedOptions:(this.generatedOptions=this.menuGenerator_(),this.validateOptions(this.generatedOptions),this.generatedOptions)}doClassValidation_(e){return this.getOptions(!0).some(t=>t[1]===e)?e:(this.sourceBlock_&&console.warn("Cannot set the dropdown's value to an unavailable option. Block type: "+this.sourceBlock_.type+", Field name: "+this.name+", Value: "+e),null)}doValueUpdate_(e){super.doValueUpdate_(e),e=this.getOptions(!0);for(let t=0,r;r=e[t];t++)r[1]===this.value_&&(this.selectedOption=r)}applyColour(){const e=this.sourceBlock_.style;this.borderRect_&&(this.borderRect_.setAttribute("stroke",e.colourTertiary),this.menu_?this.borderRect_.setAttribute("fill",e.colourTertiary):this.borderRect_.setAttribute("fill","transparent")),this.sourceBlock_&&this.arrow&&(this.sourceBlock_.isShadow()?this.arrow.style.fill=e.colourSecondary:this.arrow.style.fill=e.colourPrimary)}render_(){this.getTextContent().nodeValue="",this.imageElement.style.display="none";const e=this.selectedOption&&this.selectedOption[0];e&&typeof e=="object"?this.renderSelectedImage(e):this.renderSelectedText(),this.positionBorderRect_()}renderSelectedImage(e){const t=this.getSourceBlock();if(!t)throw new Jn;this.imageElement.style.display="",this.imageElement.setAttributeNS(ar,"xlink:href",e.src),this.imageElement.setAttribute("height",String(e.height)),this.imageElement.setAttribute("width",String(e.width));const r=Number(e.height);e=Number(e.width);var l=!!this.borderRect_;const p=Math.max(l?this.getConstants().FIELD_DROPDOWN_BORDER_RECT_HEIGHT:0,r+cr.IMAGE_Y_PADDING);l=l?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0;let v;v=this.svgArrow?this.positionSVGArrow(e+l,p/2-this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE/2):as(this.arrow,this.getConstants().FIELD_TEXT_FONTSIZE,this.getConstants().FIELD_TEXT_FONTWEIGHT,this.getConstants().FIELD_TEXT_FONTFAMILY),this.size_.width=e+v+2*l,this.size_.height=p;let O=0;t.RTL?this.imageElement.setAttribute("x",`${l+v}`):(O=e+v,this.getTextElement().setAttribute("text-anchor","end"),this.imageElement.setAttribute("x",`${l}`)),this.imageElement.setAttribute("y",String(p/2-r/2)),this.positionTextElement_(O+l,e+v)}renderSelectedText(){this.getTextContent().nodeValue=this.getDisplayText_();var e=this.getTextElement();Pe(e,"blocklyDropdownText"),e.setAttribute("text-anchor","start");var t=!!this.borderRect_;e=Math.max(t?this.getConstants().FIELD_DROPDOWN_BORDER_RECT_HEIGHT:0,this.getConstants().FIELD_TEXT_HEIGHT);const r=as(this.getTextElement(),this.getConstants().FIELD_TEXT_FONTSIZE,this.getConstants().FIELD_TEXT_FONTWEIGHT,this.getConstants().FIELD_TEXT_FONTFAMILY);t=t?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0;let l=0;this.svgArrow&&(l=this.positionSVGArrow(r+t,e/2-this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE/2)),this.size_.width=r+l+2*t,this.size_.height=e,this.positionTextElement_(t,r)}positionSVGArrow(e,t){if(!this.svgArrow)return 0;const r=this.getSourceBlock();if(!r)throw new Jn;const l=this.borderRect_?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0,p=this.getConstants().FIELD_DROPDOWN_SVG_ARROW_PADDING,v=this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE;return this.svgArrow.setAttribute("transform","translate("+(r.RTL?l:e+p)+","+t+")"),v+p}getText_(){if(!this.selectedOption)return null;const e=this.selectedOption[0];return typeof e=="object"?e.alt:e}static fromJson(e){if(!e.options)throw Error("options are required for the dropdown field. The options property must be assigned an array of [humanReadableValue, languageNeutralValue] tuples.");return new this(e.options,void 0,e)}trimOptions(e){let t=!1;const r=e.map(([O,G])=>typeof O=="string"?[bt(O),G]:(t=!0,[O.alt!==null?Object.assign({},O,{alt:bt(O.alt)}):Object.assign({},O),G]));if(t||2>e.length)return{options:r};var l=r.map(([O])=>O),p=ba(l);e=xp(l,p);const v=Xu(l,p);return!e&&!v||p<=e+v?{options:r}:(p=e?l[0].substring(0,e-1):void 0,l=v?l[0].substr(1-v):void 0,{options:this.applyTrim(r,e,v),prefix:p,suffix:l})}applyTrim(e,t,r){return e.map(([l,p])=>[l.substring(t,l.length-r),p])}validateOptions(e){if(!Array.isArray(e))throw TypeError("FieldDropdown options must be an array.");if(!e.length)throw TypeError("FieldDropdown options must not be an empty array.");let t=!1;for(let r=0;r<e.length;r++){const l=e[r];Array.isArray(l)?typeof l[1]!="string"?(t=!0,console.error(`Invalid option[${r}]: Each FieldDropdown option id must be a string. 
          Found ${l[1]} in: ${l}`)):l[0]&&typeof l[0]!="string"&&typeof l[0].src!="string"&&(t=!0,console.error(`Invalid option[${r}]: Each FieldDropdown option must have a string 
          label or image description. Found ${l[0]} in: ${l}`)):(t=!0,console.error(`Invalid option[${r}]: Each FieldDropdown option must be an array.
          Found: ${l}`))}if(t)throw TypeError("Found invalid FieldDropdown options.")}};cr.CHECKMARK_OVERHANG=25,cr.MAX_MENU_HEIGHT_VH=.45,cr.ARROW_CHAR="▾",cr.IMAGE_Y_OFFSET=5,cr.IMAGE_Y_PADDING=2*cr.IMAGE_Y_OFFSET,_t("field_dropdown",cr);var d$=class{constructor(e,t){this.bubble=e,this.workspace=t,this.startLoc=null,this.inGroup=!1}isMovable(){return!0}startDrag(){(this.inGroup=!!s.getGroup$$module$build$src$core$events$utils())||s.setGroup$$module$build$src$core$events$utils(!0),this.startLoc=this.bubble.getRelativeToSurfaceXY(),this.workspace.setResizesEnabled(!1);let e;(e=this.workspace.getLayerManager())==null||e.moveToDragLayer(this.bubble),this.bubble.setDragging&&this.bubble.setDragging(!0)}drag(e){this.bubble.moveDuringDrag(e)}endDrag(){this.workspace.setResizesEnabled(!0),this.inGroup||s.setGroup$$module$build$src$core$events$utils(!1);let e;(e=this.workspace.getLayerManager())==null||e.moveOffDragLayer(this.bubble,Ka),this.bubble.setDragging(!1)}revertDrag(){this.startLoc&&this.bubble.moveDuringDrag(this.startLoc)}},Ws,dn=class{constructor(e,t,r){this.workspace=e,this.anchor=t,this.ownerRect=r,this.size=new Pt(0,0),this.colour="#ffffff",this.disposed=!1,this.relativeLeft=this.relativeTop=0,this.dragStrategy=new d$(this,this.workspace),this.id=S(),this.svgRoot=ie(ae.G,{class:"blocklyBubble"},e.getBubbleCanvas()),e=ie(ae.G,{filter:`url(#${this.workspace.getRenderer().getConstants().embossFilterId})`},this.svgRoot),this.tail=ie(ae.PATH,{class:"blocklyBubbleTail"},e),this.background=ie(ae.RECT,{class:"blocklyDraggable",x:0,y:0,rx:Ws.BORDER_WIDTH,ry:Ws.BORDER_WIDTH},e),this.contentContainer=ie(ae.G,{},this.svgRoot),He(this.background,"pointerdown",this,this.onMouseDown)}dispose(){lt(this.svgRoot),this.disposed=!0}setAnchorLocation(e,t=!1){this.anchor=e,t?this.positionByRect(this.ownerRect):this.positionRelativeToAnchor(),this.renderTail()}setPositionRelativeToAnchor(e,t){this.relativeLeft=e,this.relativeTop=t,this.positionRelativeToAnchor(),this.renderTail()}getSize(){return this.size}setSize(e,t=!1){e.width=Math.max(e.width,Ws.MIN_SIZE),e.height=Math.max(e.height,Ws.MIN_SIZE),this.size=e,this.background.setAttribute("width",`${e.width}`),this.background.setAttribute("height",`${e.height}`),t?this.positionByRect(this.ownerRect):this.positionRelativeToAnchor(),this.renderTail()}getColour(){return this.colour}setColour(e){this.colour=e,this.tail.setAttribute("fill",e),this.background.setAttribute("fill",e)}onMouseDown(e){let t;(t=this.workspace.getGesture(e))==null||t.handleBubbleStart(e,this),this.bringToFront(),s.setSelected$$module$build$src$core$common(this)}positionRelativeToAnchor(){let e=this.anchor.x;e=this.workspace.RTL?e-(this.relativeLeft+this.size.width):e+this.relativeLeft,this.moveTo(e,this.relativeTop+this.anchor.y)}moveTo(e,t){this.svgRoot.setAttribute("transform",`translate(${e}, ${t})`)}positionByRect(e=new Tt(0,0,0,0)){var t=this.workspace.getMetricsManager().getViewMetrics(!0),r=this.getOptimalRelativeLeft(t),l=this.getOptimalRelativeTop(t);const p={x:r,y:-this.size.height-this.workspace.getRenderer().getConstants().MIN_BLOCK_HEIGHT},v={x:-this.size.width-30,y:l};l={x:e.getWidth(),y:l};var O={x:r,y:e.getHeight()};r=e.getWidth()<e.getHeight()?l:O,e=e.getWidth()<e.getHeight()?O:l,l=this.getOverlap(p,t),O=this.getOverlap(v,t);const G=this.getOverlap(r,t);t=this.getOverlap(e,t),t=Math.max(l,O,G,t),l===t?(this.relativeLeft=p.x,this.relativeTop=p.y):O===t?(this.relativeLeft=v.x,this.relativeTop=v.y):G===t?(this.relativeLeft=r.x,this.relativeTop=r.y):(this.relativeLeft=e.x,this.relativeTop=e.y),this.positionRelativeToAnchor()}getOverlap(e,t){var r=this.workspace.RTL?this.anchor.x-e.x-this.size.width:e.x+this.anchor.x;return e=e.y+this.anchor.y,Math.max(0,Math.min(1,(Math.min(r+this.size.width,t.left+t.width)-Math.max(r,t.left))*(Math.min(e+this.size.height,t.top+t.height)-Math.max(e,t.top))/(this.size.width*this.size.height)))}getOptimalRelativeLeft(e){let t=-this.size.width/4;if(this.size.width>e.width)return t;if(e=this.getWorkspaceViewRect(e),this.workspace.RTL){var r=this.anchor.x-t;r-this.size.width<e.left?t=-(e.left-this.anchor.x+this.size.width):r>e.right&&(t=-(e.right-this.anchor.x))}else{r=t+this.anchor.x;const l=r+this.size.width;r<e.left?t=e.left-this.anchor.x:l>e.right&&(t=e.right-this.anchor.x-this.size.width)}return t}getOptimalRelativeTop(e){let t=-this.size.height/4;if(this.size.height>e.height)return t;const r=this.anchor.y+t,l=r+this.size.height;return e=this.getWorkspaceViewRect(e),r<e.top?t=e.top-this.anchor.y:l>e.bottom&&(t=e.bottom-this.anchor.y-this.size.height),t}getWorkspaceViewRect(e){const t=e.top;let r=e.top+e.height,l=e.left;return e=e.left+e.width,r-=this.getScrollbarThickness(),this.workspace.RTL?l-=this.getScrollbarThickness():e-=this.getScrollbarThickness(),new Tt(t,r,l,e)}getScrollbarThickness(){return Un.scrollbarThickness/this.workspace.scale}renderTail(){const e=[];var t=this.size.width/2,r=this.size.height/2,l=-this.relativeLeft,p=-this.relativeTop;if(t===l&&r===p)e.push("M "+t+","+r);else{p-=r,l-=t,this.workspace.RTL&&(l*=-1);var v=Math.sqrt(p*p+l*l),O=Math.acos(l/v);0>p&&(O=2*Math.PI-O);var G=O+Math.PI/2;G>2*Math.PI&&(G-=2*Math.PI);var _e=Math.sin(G);const Nn=Math.cos(G);let On=(this.size.width+this.size.height)/Ws.TAIL_THICKNESS;On=Math.min(On,this.size.width,this.size.height)/4,G=1-Ws.ANCHOR_RADIUS/v,l=t+G*l,p=r+G*p,G=t+On*Nn;const Yr=r+On*_e;t-=On*Nn,r-=On*_e,_e=zs(this.workspace.RTL?-Ws.TAIL_ANGLE:Ws.TAIL_ANGLE),_e=O+_e,_e>2*Math.PI&&(_e-=2*Math.PI),O=Math.sin(_e)*v/Ws.TAIL_BEND,v=Math.cos(_e)*v/Ws.TAIL_BEND,e.push("M"+G+","+Yr),e.push("C"+(G+v)+","+(Yr+O)+" "+l+","+p+" "+l+","+p),e.push("C"+l+","+p+" "+(t+v)+","+(r+O)+" "+t+","+r)}e.push("z");let qe;(qe=this.tail)==null||qe.setAttribute("d",e.join(" "))}bringToFront(){let e;const t=(e=this.svgRoot)==null?void 0:e.parentNode;return this.svgRoot&&(t==null?void 0:t.lastChild)!==this.svgRoot?(t==null||t.appendChild(this.svgRoot),!0):!1}getRelativeToSurfaceXY(){return new Ae(this.workspace.RTL?-this.relativeLeft+this.anchor.x-this.size.width:this.anchor.x+this.relativeLeft,this.anchor.y+this.relativeTop)}getSvgRoot(){return this.svgRoot}moveDuringDrag(e){this.moveTo(e.x,e.y),this.relativeLeft=this.workspace.RTL?this.anchor.x-e.x-this.size.width:e.x-this.anchor.x,this.relativeTop=e.y-this.anchor.y,this.renderTail()}setDragging(e){}setDeleteStyle(e){}isDeletable(){return!1}showContextMenu(e){}isMovable(){return!0}startDrag(){this.dragStrategy.startDrag()}drag(e){this.dragStrategy.drag(e)}endDrag(){this.dragStrategy.endDrag()}revertDrag(){this.dragStrategy.revertDrag()}select(){}unselect(){}};Ws=dn,dn.BORDER_WIDTH=6,dn.DOUBLE_BORDER=2*Ws.BORDER_WIDTH,dn.MIN_SIZE=Ws.DOUBLE_BORDER,dn.TAIL_THICKNESS=1,dn.TAIL_ANGLE=20,dn.TAIL_BEND=4,dn.ANCHOR_RADIUS=8;var Ss=class extends dn{constructor(e,t,r,l){super(t,r,l),this.workspace=t,this.anchor=r,this.ownerRect=l,this.autoLayout=!0,t=new Wr(e),this.validateWorkspaceOptions(t),this.svgDialog=ie(ae.SVG,{x:dn.BORDER_WIDTH,y:dn.BORDER_WIDTH},this.contentContainer),e.parentWorkspace=this.workspace,this.miniWorkspace=this.newWorkspaceSvg(new Wr(e)),this.miniWorkspace.internalIsMutator=!0,e=this.miniWorkspace.createDom("blocklyMutatorBackground"),this.svgDialog.appendChild(e),t.languageTree&&(e.insertBefore(this.miniWorkspace.addFlyout(ae.G),this.miniWorkspace.getCanvas()),e=this.miniWorkspace.getFlyout(),e==null||e.init(this.miniWorkspace),e==null||e.show(t.languageTree)),this.miniWorkspace.addChangeListener(this.onWorkspaceChange.bind(this));let p,v;(p=this.miniWorkspace.getFlyout())==null||(v=p.getWorkspace())==null||v.addChangeListener(this.onWorkspaceChange.bind(this)),this.updateBubbleSize()}dispose(){this.miniWorkspace.dispose(),super.dispose()}getWorkspace(){return this.miniWorkspace}addWorkspaceChangeListener(e){this.miniWorkspace.addChangeListener(e)}validateWorkspaceOptions(e){if(e.hasCategories)throw Error("The miniworkspace bubble does not support toolboxes with categories");if(e.hasTrashcan)throw Error("The miniworkspace bubble does not support trashcans");if(e.zoomOptions.controls||e.zoomOptions.wheel||e.zoomOptions.pinch)throw Error("The miniworkspace bubble does not support zooming");if(e.moveOptions.scrollbars||e.moveOptions.wheel||e.moveOptions.drag)throw Error("The miniworkspace bubble does not scrolling/moving the workspace");if(e.horizontalLayout)throw Error("The miniworkspace bubble does not support horizontal layouts")}onWorkspaceChange(){this.bumpBlocksIntoBounds(),this.updateBubbleSize()}bumpBlocksIntoBounds(){if(!this.miniWorkspace.isDragging())for(const e of this.miniWorkspace.getTopBlocks(!1)){const t=e.getRelativeToSurfaceXY();if(20>t.y&&e.moveBy(0,20-t.y),e.RTL){let r=-20;const l=this.miniWorkspace.getFlyout();l&&(r-=l.getWidth()),t.x>r&&e.moveBy(r-t.x,0)}else 20>t.x&&e.moveBy(20-t.x,0)}}updateBubbleSize(){if(!this.miniWorkspace.isDragging()){var e=this.getSize(),t=this.calculateWorkspaceSize();Math.abs(e.width-t.width)<Ss.MINIMUM_VIEW_CHANGE&&Math.abs(e.height-t.height)<Ss.MINIMUM_VIEW_CHANGE||(this.svgDialog.setAttribute("width",`${t.width}px`),this.svgDialog.setAttribute("height",`${t.height}px`),this.miniWorkspace.setCachedParentSvgSize(t.width,t.height),this.miniWorkspace.RTL&&this.miniWorkspace.getCanvas().setAttribute("transform",`translate(${t.width}, 0)`),this.setSize(new Pt(t.width+dn.DOUBLE_BORDER,t.height+dn.DOUBLE_BORDER),this.autoLayout),this.miniWorkspace.resize(),this.miniWorkspace.recordDragTargets())}}calculateWorkspaceSize(){var e=this.miniWorkspace.getCanvas().getBBox();let t=e.width+Ss.MARGIN;e=e.height+Ss.MARGIN;const r=this.miniWorkspace.getFlyout();if(r){const l=r.getWorkspace().getMetricsManager().getScrollMetrics();e=Math.max(e,l.height+20),t+=r.getWidth()}return new Pt(t,e)}updateBlockStyles(){for(var e of this.miniWorkspace.getAllBlocks(!1))e.setStyle(e.getStyleName());let t;if(e=(t=this.miniWorkspace.getFlyout())==null?void 0:t.getWorkspace())for(const r of e.getAllBlocks(!1))r.setStyle(r.getStyleName())}moveDuringDrag(e){super.moveDuringDrag(e),this.autoLayout=!1}moveTo(e,t){super.moveTo(e,t),this.miniWorkspace.recordDragTargets()}newWorkspaceSvg(e){throw Error("The implementation of newWorkspaceSvg should be monkey-patched in by blockly.ts")}};Ss.MINIMUM_VIEW_CHANGE=10,Ss.MARGIN=3*dn.DOUBLE_BORDER;var bu=class{constructor(e){this.sourceBlock=e,this.offsetInBlock=new Ae(0,0),this.workspaceLocation=new Ae(0,0),this.svgRoot=null,this.tooltip=e}getType(){throw Error("Icons must implement getType")}initView(e){if(!this.svgRoot){var t=this.sourceBlock;this.svgRoot=ie(ae.G,{class:"blocklyIconGroup"}),t.getSvgRoot().appendChild(this.svgRoot),this.updateSvgRootOffset(),He(this.svgRoot,"pointerdown",this,e),this.svgRoot.tooltip=this,$l(this.svgRoot)}}dispose(){Zu(this.svgRoot),lt(this.svgRoot)}getWeight(){return-1}getSize(){return new Pt(0,0)}setTooltip(e){this.tooltip=e??this.sourceBlock}getTooltip(){return this.tooltip}applyColour(){}updateEditable(){}updateCollapsed(){this.svgRoot&&(this.sourceBlock.isCollapsed()?this.svgRoot.style.display="none":this.svgRoot.style.display="block",ul(this)&&this.setBubbleVisible(!1))}hideForInsertionMarker(){this.svgRoot&&(this.svgRoot.style.display="none")}isShownWhenCollapsed(){return!1}setOffsetInBlock(e){this.offsetInBlock=e,this.updateSvgRootOffset()}updateSvgRootOffset(){let e;(e=this.svgRoot)==null||e.setAttribute("transform",`translate(${this.offsetInBlock.x}, ${this.offsetInBlock.y})`)}onLocationChange(e){this.workspaceLocation=Ae.sum(e,this.offsetInBlock)}onClick(){}isClickableInFlyout(e){return!0}},Ja,Dn;Ja=17,Dn=16,s.MutatorIcon$$module$build$src$core$icons$mutator_icon=class extends bu{constructor(e,t){super(t),this.flyoutBlockTypes=e,this.sourceBlock=t,this.saveConnectionsListener=this.updateWorkspacePid=this.rootBlock=this.miniWorkspaceBubble=null}getType(){return s.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE}initView(e){this.svgRoot||(super.initView(e),ie(ae.RECT,{class:"blocklyIconShape",rx:"4",ry:"4",height:"16",width:"16"},this.svgRoot),ie(ae.PATH,{class:"blocklyIconSymbol",d:"m4.203,7.296 0,1.368 -0.92,0.677 -0.11,0.41 0.9,1.559 0.41,0.11 1.043,-0.457 1.187,0.683 0.127,1.134 0.3,0.3 1.8,0 0.3,-0.299 0.127,-1.138 1.185,-0.682 1.046,0.458 0.409,-0.11 0.9,-1.559 -0.11,-0.41 -0.92,-0.677 0,-1.366 0.92,-0.677 0.11,-0.41 -0.9,-1.559 -0.409,-0.109 -1.046,0.458 -1.185,-0.682 -0.127,-1.138 -0.3,-0.299 -1.8,0 -0.3,0.3 -0.126,1.135 -1.187,0.682 -1.043,-0.457 -0.41,0.11 -0.899,1.559 0.108,0.409z"},this.svgRoot),ie(ae.CIRCLE,{class:"blocklyIconShape",r:"2.7",cx:"8",cy:"8"},this.svgRoot),Pe(this.svgRoot,"blockly-icon-mutator"))}dispose(){super.dispose();let e;(e=this.miniWorkspaceBubble)==null||e.dispose()}getWeight(){return s.MutatorIcon$$module$build$src$core$icons$mutator_icon.WEIGHT}getSize(){return new Pt(Ja,Ja)}applyColour(){super.applyColour();let e;(e=this.miniWorkspaceBubble)==null||e.setColour(this.sourceBlock.style.colourPrimary);let t;(t=this.miniWorkspaceBubble)==null||t.updateBlockStyles()}updateCollapsed(){super.updateCollapsed(),this.sourceBlock.isCollapsed()&&this.setBubbleVisible(!1)}onLocationChange(e){super.onLocationChange(e);let t;(t=this.miniWorkspaceBubble)==null||t.setAnchorLocation(this.getAnchorLocation())}onClick(){super.onClick(),this.sourceBlock.isEditable()&&this.setBubbleVisible(!this.bubbleIsVisible())}isClickableInFlyout(){return!1}bubbleIsVisible(){return!!this.miniWorkspaceBubble}setBubbleVisible(e){const t=this;return xe.asyncExecutePromiseGeneratorFunction(function*(){if(t.bubbleIsVisible()!==e){if(yield cs(),e){t.miniWorkspaceBubble=new Ss(t.getMiniWorkspaceConfig(),t.sourceBlock.workspace,t.getAnchorLocation(),t.getBubbleOwnerRect()),t.applyColour(),t.createRootBlock(),t.addSaveConnectionsListener();let r;(r=t.miniWorkspaceBubble)==null||r.addWorkspaceChangeListener(t.createMiniWorkspaceChangeListener())}else{let r;(r=t.miniWorkspaceBubble)==null||r.dispose(),t.miniWorkspaceBubble=null,t.saveConnectionsListener&&t.sourceBlock.workspace.removeChangeListener(t.saveConnectionsListener),t.saveConnectionsListener=null}te(new(Ce(ge.BUBBLE_OPEN))(t.sourceBlock,e,"mutator"))}})}getMiniWorkspaceConfig(){let e;const t={disable:!1,media:this.sourceBlock.workspace.options.pathToMedia,rtl:this.sourceBlock.RTL,renderer:this.sourceBlock.workspace.options.renderer,rendererOverrides:(e=this.sourceBlock.workspace.options.rendererOverrides)!=null?e:void 0};return this.flyoutBlockTypes.length&&(t.toolbox={kind:"flyoutToolbox",contents:this.flyoutBlockTypes.map(r=>({kind:"block",type:r}))}),t}getAnchorLocation(){const e=Ja/2;return Ae.sum(this.workspaceLocation,new Ae(e,e))}getBubbleOwnerRect(){const e=this.sourceBlock.getSvgRoot().getBBox();return new Tt(e.y,e.y+e.height,e.x,e.x+e.width)}createRootBlock(){if(!this.sourceBlock.decompose)throw Error("Blocks with mutator icons must include a decompose method");this.rootBlock=this.sourceBlock.decompose(this.miniWorkspaceBubble.getWorkspace());for(var e of this.rootBlock.getDescendants(!1))e.queueRender();this.rootBlock.setMovable(!1),this.rootBlock.setDeletable(!1);let t,r,l,p;e=(p=(t=this.miniWorkspaceBubble)==null||(r=t.getWorkspace())==null||(l=r.getFlyout())==null?void 0:l.getWidth())!=null?p:0,this.rootBlock.moveBy(this.rootBlock.RTL?-(e+Dn):Dn,Dn)}addSaveConnectionsListener(){this.sourceBlock.saveConnections&&this.rootBlock&&(this.saveConnectionsListener=()=>{this.sourceBlock.saveConnections&&this.rootBlock&&this.sourceBlock.saveConnections(this.rootBlock)},this.saveConnectionsListener(),this.sourceBlock.workspace.addChangeListener(this.saveConnectionsListener))}createMiniWorkspaceChangeListener(){return e=>{s.MutatorIcon$$module$build$src$core$icons$mutator_icon.isIgnorableMutatorEvent(e)||this.updateWorkspacePid||(this.updateWorkspacePid=setTimeout(()=>{this.updateWorkspacePid=null,this.recomposeSourceBlock()},0))}}static isIgnorableMutatorEvent(e){return e.isUiEvent||E(e)||F(e)&&e.element==="disabled"}recomposeSourceBlock(){if(this.rootBlock){if(!this.sourceBlock.compose)throw Error("Blocks with mutator icons must include a compose method");var e=s.getGroup$$module$build$src$core$events$utils();e||s.setGroup$$module$build$src$core$events$utils(!0);var t=ro.getExtraBlockState_(this.sourceBlock);this.sourceBlock.compose(this.rootBlock);var r=ro.getExtraBlockState_(this.sourceBlock);t!==r&&te(new(Ce(ge.BLOCK_CHANGE))(this.sourceBlock,"mutation",null,t,r)),s.setGroup$$module$build$src$core$events$utils(e)}}getWorkspace(){let e;return(e=this.miniWorkspaceBubble)==null?void 0:e.getWorkspace()}},s.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE=ss.MUTATOR,s.MutatorIcon$$module$build$src$core$icons$mutator_icon.WEIGHT=1,s.MutatorIcon$$module$build$src$core$icons$mutator_icon;var Sn=Object.create(null),h$={allExtensions:Sn};s.register$$module$build$src$core$extensions("parent_tooltip_when_inline",_i);var di={TEST_ONLY:h$};di.apply=cd,di.buildTooltipForDropdown=s.buildTooltipForDropdown$$module$build$src$core$extensions,di.buildTooltipWithFieldText=s.buildTooltipWithFieldText$$module$build$src$core$extensions,di.isRegistered=Ji,di.register=s.register$$module$build$src$core$extensions,di.registerMixin=s.registerMixin$$module$build$src$core$extensions,di.registerMutator=s.registerMutator$$module$build$src$core$extensions,di.runAfterPageLoad=pb,di.unregister=lb;var Nt;(function(e){e[e.WIN_KEY_FF_LINUX=0]="WIN_KEY_FF_LINUX",e[e.MAC_ENTER=3]="MAC_ENTER",e[e.BACKSPACE=8]="BACKSPACE",e[e.TAB=9]="TAB",e[e.NUM_CENTER=12]="NUM_CENTER",e[e.ENTER=13]="ENTER",e[e.SHIFT=16]="SHIFT",e[e.CTRL=17]="CTRL",e[e.ALT=18]="ALT",e[e.PAUSE=19]="PAUSE",e[e.CAPS_LOCK=20]="CAPS_LOCK",e[e.ESC=27]="ESC",e[e.SPACE=32]="SPACE",e[e.PAGE_UP=33]="PAGE_UP",e[e.PAGE_DOWN=34]="PAGE_DOWN",e[e.END=35]="END",e[e.HOME=36]="HOME",e[e.LEFT=37]="LEFT",e[e.UP=38]="UP",e[e.RIGHT=39]="RIGHT",e[e.DOWN=40]="DOWN",e[e.PLUS_SIGN=43]="PLUS_SIGN",e[e.PRINT_SCREEN=44]="PRINT_SCREEN",e[e.INSERT=45]="INSERT",e[e.DELETE=46]="DELETE",e[e.ZERO=48]="ZERO",e[e.ONE=49]="ONE",e[e.TWO=50]="TWO",e[e.THREE=51]="THREE",e[e.FOUR=52]="FOUR",e[e.FIVE=53]="FIVE",e[e.SIX=54]="SIX",e[e.SEVEN=55]="SEVEN",e[e.EIGHT=56]="EIGHT",e[e.NINE=57]="NINE",e[e.FF_SEMICOLON=59]="FF_SEMICOLON",e[e.FF_EQUALS=61]="FF_EQUALS",e[e.FF_DASH=173]="FF_DASH",e[e.FF_HASH=163]="FF_HASH",e[e.QUESTION_MARK=63]="QUESTION_MARK",e[e.AT_SIGN=64]="AT_SIGN",e[e.A=65]="A",e[e.B=66]="B",e[e.C=67]="C",e[e.D=68]="D",e[e.E=69]="E",e[e.F=70]="F",e[e.G=71]="G",e[e.H=72]="H",e[e.I=73]="I",e[e.J=74]="J",e[e.K=75]="K",e[e.L=76]="L",e[e.M=77]="M",e[e.N=78]="N",e[e.O=79]="O",e[e.P=80]="P",e[e.Q=81]="Q",e[e.R=82]="R",e[e.S=83]="S",e[e.T=84]="T",e[e.U=85]="U",e[e.V=86]="V",e[e.W=87]="W",e[e.X=88]="X",e[e.Y=89]="Y",e[e.Z=90]="Z",e[e.META=91]="META",e[e.WIN_KEY_RIGHT=92]="WIN_KEY_RIGHT",e[e.CONTEXT_MENU=93]="CONTEXT_MENU",e[e.NUM_ZERO=96]="NUM_ZERO",e[e.NUM_ONE=97]="NUM_ONE",e[e.NUM_TWO=98]="NUM_TWO",e[e.NUM_THREE=99]="NUM_THREE",e[e.NUM_FOUR=100]="NUM_FOUR",e[e.NUM_FIVE=101]="NUM_FIVE",e[e.NUM_SIX=102]="NUM_SIX",e[e.NUM_SEVEN=103]="NUM_SEVEN",e[e.NUM_EIGHT=104]="NUM_EIGHT",e[e.NUM_NINE=105]="NUM_NINE",e[e.NUM_MULTIPLY=106]="NUM_MULTIPLY",e[e.NUM_PLUS=107]="NUM_PLUS",e[e.NUM_MINUS=109]="NUM_MINUS",e[e.NUM_PERIOD=110]="NUM_PERIOD",e[e.NUM_DIVISION=111]="NUM_DIVISION",e[e.F1=112]="F1",e[e.F2=113]="F2",e[e.F3=114]="F3",e[e.F4=115]="F4",e[e.F5=116]="F5",e[e.F6=117]="F6",e[e.F7=118]="F7",e[e.F8=119]="F8",e[e.F9=120]="F9",e[e.F10=121]="F10",e[e.F11=122]="F11",e[e.F12=123]="F12",e[e.NUMLOCK=144]="NUMLOCK",e[e.SCROLL_LOCK=145]="SCROLL_LOCK",e[e.FIRST_MEDIA_KEY=166]="FIRST_MEDIA_KEY",e[e.LAST_MEDIA_KEY=183]="LAST_MEDIA_KEY",e[e.SEMICOLON=186]="SEMICOLON",e[e.DASH=189]="DASH",e[e.EQUALS=187]="EQUALS",e[e.COMMA=188]="COMMA",e[e.PERIOD=190]="PERIOD",e[e.SLASH=191]="SLASH",e[e.APOSTROPHE=192]="APOSTROPHE",e[e.TILDE=192]="TILDE",e[e.SINGLE_QUOTE=222]="SINGLE_QUOTE",e[e.OPEN_SQUARE_BRACKET=219]="OPEN_SQUARE_BRACKET",e[e.BACKSLASH=220]="BACKSLASH",e[e.CLOSE_SQUARE_BRACKET=221]="CLOSE_SQUARE_BRACKET",e[e.WIN_KEY=224]="WIN_KEY",e[e.MAC_FF_META=224]="MAC_FF_META",e[e.MAC_WK_CMD_LEFT=91]="MAC_WK_CMD_LEFT",e[e.MAC_WK_CMD_RIGHT=93]="MAC_WK_CMD_RIGHT",e[e.WIN_IME=229]="WIN_IME",e[e.VK_NONAME=252]="VK_NONAME",e[e.PHANTOM=255]="PHANTOM"})(Nt||(Nt={}));var lo={};lo.arc=qn,lo.curve=sr,lo.line=Br,lo.lineOnAxis=Ye,lo.lineTo=wi,lo.moveBy=In,lo.moveTo=us,lo.point=nt;var Bn={};Bn.Coordinate=Ae,Bn.KeyCodes=Nt,Bn.Rect=Tt,Bn.Size=Pt,Bn.Svg=ae,Bn.aria=eu,Bn.array=Jc,Bn.browserEvents=ot,Bn.colour=Ur,Bn.deprecation=Nd,Bn.dom=fs,Bn.extensions=di,Bn.idGenerator=Md,Bn.math=au,Bn.object=c$,Bn.parsing=du,Bn.string=Vl,Bn.style=Ii,Bn.svgMath=zo,Bn.svgPaths=lo,Bn.toolbox=no,Bn.userAgent=Ag,Bn.xml=Uo;var p$=class extends dn{constructor(e,t,r){super(e,t,r),this.workspace=e,this.anchor=t,this.ownerRect=r,this.resizePointerMoveListener=this.resizePointerUpListener=null,this.textChangeListeners=[],this.sizeChangeListeners=[],this.text="",this.DEFAULT_SIZE=new Pt(160+dn.DOUBLE_BORDER,80+dn.DOUBLE_BORDER),this.MIN_SIZE=new Pt(45+dn.DOUBLE_BORDER,20+dn.DOUBLE_BORDER),this.editable=!0,Pe(this.svgRoot,"blocklyTextInputBubble"),{inputRoot:this.inputRoot,textArea:this.textArea}=this.createEditor(this.contentContainer),this.resizeGroup=this.createResizeHandle(this.svgRoot,e),this.setSize(this.DEFAULT_SIZE,!0)}getText(){return this.text}setText(e){this.text=e,this.textArea.value=e,this.onTextChange()}setEditable(e){(this.editable=e)?this.textArea.removeAttribute("readonly"):this.textArea.setAttribute("readonly","")}isEditable(){return this.editable}addTextChangeListener(e){this.textChangeListeners.push(e)}addSizeChangeListener(e){this.sizeChangeListeners.push(e)}createEditor(e){e=ie(ae.FOREIGNOBJECT,{x:dn.BORDER_WIDTH,y:dn.BORDER_WIDTH},e);const t=document.createElementNS(ki,"body");t.setAttribute("xmlns",ki),t.className="blocklyMinimalBody";const r=document.createElementNS(ki,"textarea");return r.className="blocklyTextarea blocklyText",r.setAttribute("dir",this.workspace.RTL?"RTL":"LTR"),t.appendChild(r),e.appendChild(t),this.bindTextAreaEvents(r),setTimeout(()=>{r.focus()},0),{inputRoot:e,textArea:r}}bindTextAreaEvents(e){He(e,"wheel",this,t=>{t.stopPropagation()}),He(e,"focus",this,this.onStartEdit,!0),He(e,"change",this,this.onTextChange)}createResizeHandle(e,t){return e=ie(ae.IMAGE,{class:"blocklyResizeHandle",href:`${t.options.pathToMedia}resize-handle.svg`},e),He(e,"pointerdown",this,this.onResizePointerDown),e}setSize(e,t=!1){e.width=Math.max(e.width,this.MIN_SIZE.width),e.height=Math.max(e.height,this.MIN_SIZE.height);const r=e.width-dn.DOUBLE_BORDER,l=e.height-dn.DOUBLE_BORDER;this.inputRoot.setAttribute("width",`${r}`),this.inputRoot.setAttribute("height",`${l}`),this.resizeGroup.setAttribute("y",`${l}`),this.workspace.RTL?this.resizeGroup.setAttribute("x",`${-dn.DOUBLE_BORDER}`):this.resizeGroup.setAttribute("x",`${r}`),super.setSize(e,t),this.onSizeChange()}getSize(){return super.getSize()}onResizePointerDown(e){this.bringToFront(),os(e)||(_a(this.workspace,e,new Ae(this.workspace.RTL?-this.getSize().width:this.getSize().width,this.getSize().height)),this.resizePointerUpListener=He(document,"pointerup",this,this.onResizePointerUp),this.resizePointerMoveListener=He(document,"pointermove",this,this.onResizePointerMove),this.workspace.hideChaff()),e.stopPropagation()}onResizePointerUp(e){Ot(),this.resizePointerUpListener&&(St(this.resizePointerUpListener),this.resizePointerUpListener=null),this.resizePointerMoveListener&&(St(this.resizePointerMoveListener),this.resizePointerMoveListener=null)}onResizePointerMove(e){e=nd(this.workspace,e),this.setSize(new Pt(this.workspace.RTL?-e.x:e.x,e.y),!1),this.onSizeChange()}onStartEdit(){this.bringToFront()&&this.textArea.focus()}onTextChange(){this.text=this.textArea.value;for(const e of this.textChangeListeners)e()}onSizeChange(){for(const e of this.sizeChangeListeners)e()}};we(`
.blocklyTextInputBubble .blocklyTextarea {
  background-color: var(--commentFillColour);
  border: 0;
  box-sizing: border-box;
  display: block;
  outline: 0;
  padding: 5px;
  resize: none;
  width: 100%;
  height: 100%;
}
`);var pf={};pf.register=yr,pf.unregister=fb;var rh=17,Yl=160,ih=80,co=class extends bu{constructor(e){super(e),this.sourceBlock=e,this.textInputBubble=null,this.text="",this.bubbleSize=new Pt(Yl,ih),this.bubbleVisiblity=!1}getType(){return co.TYPE}initView(e){this.svgRoot||(super.initView(e),ie(ae.CIRCLE,{class:"blocklyIconShape",r:"8",cx:"8",cy:"8"},this.svgRoot),ie(ae.PATH,{class:"blocklyIconSymbol",d:"m6.8,10h2c0.003,-0.617 0.271,-0.962 0.633,-1.266 2.875,-2.4050.607,-5.534 -3.765,-3.874v1.7c3.12,-1.657 3.698,0.118 2.336,1.25-1.201,0.998 -1.201,1.528 -1.204,2.19z"},this.svgRoot),ie(ae.RECT,{class:"blocklyIconSymbol",x:"6.8",y:"10.78",height:"2",width:"2"},this.svgRoot),Pe(this.svgRoot,"blockly-icon-comment"))}dispose(){super.dispose();let e;(e=this.textInputBubble)==null||e.dispose()}getWeight(){return co.WEIGHT}getSize(){return new Pt(rh,rh)}applyColour(){super.applyColour();const e=this.sourceBlock.style.colourPrimary;let t;(t=this.textInputBubble)==null||t.setColour(e)}updateEditable(){const e=this,t=()=>super.updateEditable;return xe.asyncExecutePromiseGeneratorFunction(function*(){t().call(e),e.bubbleIsVisible()&&(yield e.setBubbleVisible(!1),yield e.setBubbleVisible(!0))})}onLocationChange(e){super.onLocationChange(e),e=this.getAnchorLocation();let t;(t=this.textInputBubble)==null||t.setAnchorLocation(e)}setText(e){const t=this.text;te(new(Ce(ge.BLOCK_CHANGE))(this.sourceBlock,"comment",null,t,e)),this.text=e;let r;(r=this.textInputBubble)==null||r.setText(this.text)}getText(){return this.text}setBubbleSize(e){this.bubbleSize=e;let t;(t=this.textInputBubble)==null||t.setSize(this.bubbleSize,!0)}getBubbleSize(){return this.bubbleSize}saveState(){return this.text?{text:this.text,pinned:this.bubbleIsVisible(),height:this.bubbleSize.height,width:this.bubbleSize.width}:null}loadState(e){let t;this.text=(t=e.text)!=null?t:"";let r,l;this.bubbleSize=new Pt((r=e.width)!=null?r:Yl,(l=e.height)!=null?l:ih);let p;this.bubbleVisiblity=(p=e.pinned)!=null?p:!1,this.setBubbleVisible(this.bubbleVisiblity)}onClick(){super.onClick(),this.setBubbleVisible(!this.bubbleIsVisible())}isClickableInFlyout(){return!1}onTextChange(){if(this.textInputBubble){var e=this.textInputBubble.getText();this.text!==e&&(te(new(Ce(ge.BLOCK_CHANGE))(this.sourceBlock,"comment",null,this.text,e)),this.text=e)}}onSizeChange(){this.textInputBubble&&(this.bubbleSize=this.textInputBubble.getSize())}bubbleIsVisible(){return this.bubbleVisiblity}setBubbleVisible(e){const t=this;return xe.asyncExecutePromiseGeneratorFunction(function*(){t.bubbleVisiblity!==e&&(t.bubbleVisiblity=e,yield cs(),!t.sourceBlock.rendered||t.sourceBlock.isInFlyout||t.sourceBlock.isInsertionMarker()||(e?(t.sourceBlock.isEditable()?t.showEditableBubble():t.showNonEditableBubble(),t.applyColour()):t.hideBubble(),te(new(Ce(ge.BUBBLE_OPEN))(t.sourceBlock,e,"comment"))))})}showEditableBubble(){this.createBubble();let e;(e=this.textInputBubble)==null||e.addTextChangeListener(()=>this.onTextChange());let t;(t=this.textInputBubble)==null||t.addSizeChangeListener(()=>this.onSizeChange())}showNonEditableBubble(){this.createBubble();let e;(e=this.textInputBubble)==null||e.setEditable(!1)}createBubble(){this.textInputBubble=new p$(this.sourceBlock.workspace,this.getAnchorLocation(),this.getBubbleOwnerRect()),this.textInputBubble.setText(this.getText()),this.textInputBubble.setSize(this.bubbleSize,!0)}hideBubble(){let e;(e=this.textInputBubble)==null||e.dispose(),this.textInputBubble=null}getAnchorLocation(){const e=rh/2;return Ae.sum(this.workspaceLocation,new Ae(e,e))}getBubbleOwnerRect(){return this.sourceBlock.getBoundingRectangleWithoutChildren()}};co.TYPE=ss.COMMENT,co.WEIGHT=3,yr(co.TYPE,co);var gf=class extends Error{constructor(e){super(`Tried to append an icon of type ${e.getType()} when an icon of that type already exists on the block. Use getIcon to access the existing icon.`),this.icon=e}},$u={};$u.DuplicateIconType=gf;var ur=class extends dn{constructor(e,t,r,l){super(t,r,l),this.text=e,this.workspace=t,this.anchor=r,this.ownerRect=l,this.paragraph=this.stringToSvg(e,this.contentContainer),this.updateBubbleSize()}getText(){return this.text}setText(e){this.text=e,lt(this.paragraph),this.paragraph=this.stringToSvg(e,this.contentContainer),this.updateBubbleSize()}stringToSvg(e,t){return t=this.createParagraph(t),e=this.createSpans(t,e),this.workspace.RTL&&this.rightAlignSpans(t.getBBox().width,e),t}createParagraph(e){return ie(ae.TEXT,{class:"blocklyText blocklyBubbleText blocklyNoPointerEvents",y:dn.BORDER_WIDTH},e)}createSpans(e,t){return t.split(`
`).map(r=>{const l=ie(ae.TSPAN,{dy:"1em",x:dn.BORDER_WIDTH},e);return r=document.createTextNode(r),l.appendChild(r),l})}rightAlignSpans(e,t){for(const r of t)r.setAttribute("text-anchor","end"),r.setAttribute("x",`${e+dn.BORDER_WIDTH}`)}updateBubbleSize(){const e=this.paragraph.getBBox();this.setSize(new Pt(e.width+2*dn.BORDER_WIDTH,e.height+2*dn.BORDER_WIDTH),!0)}},Vo=17,uo=class extends bu{constructor(e){super(e),this.sourceBlock=e,this.textMap=new Map,this.textBubble=null}getType(){return uo.TYPE}initView(e){this.svgRoot||(super.initView(e),ie(ae.PATH,{class:"blocklyIconShape",d:"M2,15Q-1,15 0.5,12L6.5,1.7Q8,-1 9.5,1.7L15.5,12Q17,15 14,15z"},this.svgRoot),ie(ae.PATH,{class:"blocklyIconSymbol",d:"m7,4.8v3.16l0.27,2.27h1.46l0.27,-2.27v-3.16z"},this.svgRoot),ie(ae.RECT,{class:"blocklyIconSymbol",x:"7",y:"11",height:"2",width:"2"},this.svgRoot),Pe(this.svgRoot,"blockly-icon-warning"))}dispose(){super.dispose();let e;(e=this.textBubble)==null||e.dispose()}getWeight(){return uo.WEIGHT}getSize(){return new Pt(Vo,Vo)}applyColour(){super.applyColour();let e;(e=this.textBubble)==null||e.setColour(this.sourceBlock.style.colourPrimary)}updateCollapsed(){}isShownWhenCollapsed(){return!0}onLocationChange(e){super.onLocationChange(e);let t;(t=this.textBubble)==null||t.setAnchorLocation(this.getAnchorLocation())}addMessage(e,t){if(this.textMap.get(t)===e)return this;e?this.textMap.set(t,e):this.textMap.delete(t);let r;return(r=this.textBubble)==null||r.setText(this.getText()),this}getText(){return[...this.textMap.values()].join(`
`)}onClick(){super.onClick(),this.setBubbleVisible(!this.bubbleIsVisible())}isClickableInFlyout(){return!1}bubbleIsVisible(){return!!this.textBubble}setBubbleVisible(e){const t=this;return xe.asyncExecutePromiseGeneratorFunction(function*(){if(t.bubbleIsVisible()!==e){if(yield cs(),e)t.textBubble=new ur(t.getText(),t.sourceBlock.workspace,t.getAnchorLocation(),t.getBubbleOwnerRect()),t.applyColour();else{let r;(r=t.textBubble)==null||r.dispose(),t.textBubble=null}te(new(Ce(ge.BUBBLE_OPEN))(t.sourceBlock,e,"warning"))}})}getAnchorLocation(){const e=Vo/2;return Ae.sum(this.workspaceLocation,new Ae(e,e))}getBubbleOwnerRect(){const e=this.sourceBlock.getSvgRoot().getBBox();return new Tt(e.y,e.y+e.height,e.x,e.x+e.width)}};uo.TYPE=ss.WARNING,uo.WEIGHT=2;var Go={};Go.CommentIcon=co,Go.Icon=bu,Go.IconType=ss,Go.MutatorIcon=s.MutatorIcon$$module$build$src$core$icons$mutator_icon,Go.WarningIcon=uo,Go.exceptions=$u,Go.registry=pf,s.Names$$module$build$src$core$names=class{constructor(e,t){this.db=new Map,this.dbReverse=new Set,this.variableMap=null,this.variablePrefix=t||"",this.reservedWords=new Set(e?e.split(","):[])}reset(){this.db.clear(),this.dbReverse.clear(),this.variableMap=null}setVariableMap(e){this.variableMap=e}getNameForUserVariable(e){return this.variableMap?(e=this.variableMap.getVariableById(e))?e.name:null:(console.warn(`Deprecated call to Names.prototype.getName without defining a variable map. To fix, add the following code in your generator's init() function:
Blockly.YourGeneratorName.nameDB_.setVariableMap(workspace.getVariableMap());`),null)}populateVariables(e){e=s.allUsedVarModels$$module$build$src$core$variables(e);for(let t=0;t<e.length;t++)this.getName(e[t].getId(),s.NameType$$module$build$src$core$names.VARIABLE)}populateProcedures(e){throw Error("The implementation of populateProcedures should be monkey-patched in by blockly.ts")}getName(e,t){let r=e;t===s.NameType$$module$build$src$core$names.VARIABLE&&(e=this.getNameForUserVariable(e))&&(r=e),e=r.toLowerCase();const l=t===s.NameType$$module$build$src$core$names.VARIABLE||t===s.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE?this.variablePrefix:"";this.db.has(t)||this.db.set(t,new Map);const p=this.db.get(t);return p.has(e)?l+p.get(e):(t=this.getDistinctName(r,t),p.set(e,t.substr(l.length)),t)}getUserNames(e){let t;return(e=(t=this.db.get(e))==null?void 0:t.keys())?Array.from(e):[]}getDistinctName(e,t){e=this.safeName(e);let r=null,l,p;for(;this.dbReverse.has(e+((l=r)!=null?l:""))||this.reservedWords.has(e+((p=r)!=null?p:""));)r=r?r+1:2;let v;return e+=(v=r)!=null?v:"",this.dbReverse.add(e),(t===s.NameType$$module$build$src$core$names.VARIABLE||t===s.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE?this.variablePrefix:"")+e}safeName(e){return e?(e=encodeURI(e.replace(/ /g,"_")).replace(/[^\w]/g,"_"),"0123456789".includes(e[0])&&(e="my_"+e)):e=s.Msg$$module$build$src$core$msg.UNNAMED_KEY||"unnamed",e}static equals(e,t){return e.toLowerCase()===t.toLowerCase()}},function(e){e=e.NameType||(e.NameType={}),e.DEVELOPER_VARIABLE="DEVELOPER_VARIABLE",e.VARIABLE="VARIABLE",e.PROCEDURE="PROCEDURE"}(s.Names$$module$build$src$core$names||(s.Names$$module$build$src$core$names={})),s.NameType$$module$build$src$core$names=s.Names$$module$build$src$core$names.NameType,s.Names$$module$build$src$core$names.DEVELOPER_VARIABLE_TYPE=s.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE,s.NameType$$module$build$src$core$names,s.Names$$module$build$src$core$names;var g$=class extends Map{constructor(){super()}set(e,t){return this.get(e)===t?this:(super.set(e,t),dd(t)&&t.startPublishing(),this)}delete(e){const t=this.get(e);return e=super.delete(e),e&&(dd(t)&&t.stopPublishing(),e)}clear(){if(this.size)for(const e of this.keys())this.delete(e)}add(e){return this.set(e.getId(),e)}getProcedures(){return[...this.values()]}},oh,Vs;oh="PROCEDURE",s.DEFAULT_ARG$$module$build$src$core$procedures="x",Vs={CATEGORY_NAME:oh,DEFAULT_ARG:s.DEFAULT_ARG$$module$build$src$core$procedures},Vs.ObservableProcedureMap=g$,Vs.allProcedures=hd,Vs.findLegalName=s.findLegalName$$module$build$src$core$procedures,Vs.flyoutCategory=gd,Vs.getCallers=Rl,Vs.getDefinition=s.getDefinition$$module$build$src$core$procedures,Vs.isNameUsed=pd,Vs.isProcedureBlock=Mo,Vs.mutateCallers=s.mutateCallers$$module$build$src$core$procedures,Vs.mutatorOpenListener=Mc,Vs.rename=s.rename$$module$build$src$core$procedures;var f$=class{constructor(){this.NONE=0,this.FIELD=1,this.HAT=2,this.ICON=4,this.SPACER=8,this.BETWEEN_ROW_SPACER=16,this.IN_ROW_SPACER=32,this.EXTERNAL_VALUE_INPUT=64,this.INPUT=128,this.INLINE_INPUT=256,this.STATEMENT_INPUT=512,this.CONNECTION=1024,this.PREVIOUS_CONNECTION=2048,this.NEXT_CONNECTION=4096,this.OUTPUT_CONNECTION=8192,this.CORNER=16384,this.LEFT_SQUARE_CORNER=32768,this.LEFT_ROUND_CORNER=65536,this.RIGHT_SQUARE_CORNER=131072,this.RIGHT_ROUND_CORNER=262144,this.JAGGED_EDGE=524288,this.ROW=1048576,this.TOP_ROW=2097152,this.BOTTOM_ROW=4194304,this.INPUT_ROW=8388608,this.LEFT_CORNER=this.LEFT_SQUARE_CORNER|this.LEFT_ROUND_CORNER,this.RIGHT_CORNER=this.RIGHT_SQUARE_CORNER|this.RIGHT_ROUND_CORNER,this.nextTypeValue_=16777216}getType(e){return Object.prototype.hasOwnProperty.call(this,e)||(this[e]=this.nextTypeValue_,this.nextTypeValue_<<=1),this[e]}isField(e){return e.type&this.FIELD}isHat(e){return e.type&this.HAT}isIcon(e){return e.type&this.ICON}isSpacer(e){return e.type&this.SPACER}isInRowSpacer(e){return e.type&this.IN_ROW_SPACER}isInput(e){return e.type&this.INPUT}isExternalInput(e){return e.type&this.EXTERNAL_VALUE_INPUT}isInlineInput(e){return e.type&this.INLINE_INPUT}isStatementInput(e){return e.type&this.STATEMENT_INPUT}isPreviousConnection(e){return e.type&this.PREVIOUS_CONNECTION}isNextConnection(e){return e.type&this.NEXT_CONNECTION}isPreviousOrNextConnection(e){return e.type&(this.PREVIOUS_CONNECTION|this.NEXT_CONNECTION)}isLeftRoundedCorner(e){return e.type&this.LEFT_ROUND_CORNER}isRightRoundedCorner(e){return e.type&this.RIGHT_ROUND_CORNER}isLeftSquareCorner(e){return e.type&this.LEFT_SQUARE_CORNER}isRightSquareCorner(e){return e.type&this.RIGHT_SQUARE_CORNER}isCorner(e){return e.type&this.CORNER}isJaggedEdge(e){return e.type&this.JAGGED_EDGE}isRow(e){return e.type&this.ROW}isBetweenRowSpacer(e){return e.type&this.BETWEEN_ROW_SPACER}isTopRow(e){return e.type&this.TOP_ROW}isBottomRow(e){return e.type&this.BOTTOM_ROW}isTopOrBottomRow(e){return e.type&(this.TOP_ROW|this.BOTTOM_ROW)}isInputRow(e){return e.type&this.INPUT_ROW}},X=new f$,ft=class{constructor(e){this.centerline=this.xPos=this.height=this.width=0,this.constants_=e,this.type=X.NONE,this.notchOffset=this.constants_.NOTCH_OFFSET_LEFT}},Xl=class{constructor(e){this.elements=[],this.xPos=this.yPos=this.widthWithConnectedBlocks=this.minWidth=this.minHeight=this.width=this.height=0,this.hasStatement=this.hasExternalInput=!1,this.statementEdge=0,this.hasJaggedEdge=this.hasDummyInput=this.hasInlineInput=!1,this.align=null,this.constants_=e,this.type=X.ROW,this.notchOffset=this.constants_.NOTCH_OFFSET_LEFT}getLastInput(){for(let e=this.elements.length-1;0<=e;e--){const t=this.elements[e];if(X.isInput(t))return t}return null}measure(){throw Error("Unexpected attempt to measure a base Row.")}startsWithElemSpacer(){return!0}endsWithElemSpacer(){return!0}getFirstSpacer(){for(let e=0;e<this.elements.length;e++){const t=this.elements[e];if(X.isSpacer(t))return t}return null}getLastSpacer(){for(let e=this.elements.length-1;0<=e;e--){const t=this.elements[e];if(X.isSpacer(t))return t}return null}},dr=class extends Xl{constructor(e){super(e),this.hasNextConnection=!1,this.connection=null,this.baseline=this.descenderHeight=0,this.type|=X.BOTTOM_ROW}hasLeftSquareCorner(e){return!!e.outputConnection||!!e.getNextBlock()}hasRightSquareCorner(e){return!0}measure(){let e=0,t=0,r=0;for(let l=0;l<this.elements.length;l++){const p=this.elements[l];t+=p.width,X.isSpacer(p)||(X.isNextConnection(p)?r=Math.max(r,p.height):e=Math.max(e,p.height))}this.width=Math.max(this.minWidth,t),this.height=Math.max(this.minHeight,e)+r,this.descenderHeight=r,this.widthWithConnectedBlocks=this.width}startsWithElemSpacer(){return!1}endsWithElemSpacer(){return!1}},xi=class extends ft{constructor(e,t){super(e),this.connectionModel=t,this.type|=X.CONNECTION,this.shape=this.constants_.shapeFor(t),this.isDynamicShape="isDynamic"in this.shape&&this.shape.isDynamic,this.highlighted=t.isHighlighted()}},qo=class extends xi{constructor(e,t){super(e,t.connection),this.input=t,this.connectionOffsetY=this.connectionOffsetX=0,this.type|=X.INPUT,this.align=t.align,(this.connectedBlock=t.connection&&t.connection.targetBlock()?t.connection.targetBlock():null)?(e=this.connectedBlock.getHeightWidth(),this.connectedBlockWidth=e.width,this.connectedBlockHeight=e.height):this.connectedBlockHeight=this.connectedBlockWidth=0}},rn=class extends qo{constructor(e,t){super(e,t),this.height=0,this.type|=X.EXTERNAL_VALUE_INPUT,this.height=this.connectedBlock?this.connectedBlockHeight-this.constants_.TAB_OFFSET_FROM_TOP-this.constants_.MEDIUM_PADDING:this.shape.height,this.width=this.shape.width+this.constants_.EXTERNAL_VALUE_INPUT_PADDING,this.connectionOffsetY=this.constants_.TAB_OFFSET_FROM_TOP,this.connectionHeight=this.shape.height,this.connectionWidth=this.shape.width}},Zl=class extends ft{constructor(e,t,r){super(e),this.field=t,this.parentInput=r,this.isEditable=t.EDITABLE,this.flipRtl=t.getFlipRtl(),this.type|=X.FIELD,e=this.field.getSize(),this.height=e.height,this.width=e.width}},ah=class extends ft{constructor(e){super(e),this.type|=X.HAT,this.height=this.constants_.START_HAT.height,this.width=this.constants_.START_HAT.width,this.ascenderHeight=this.height}},vu=class extends ft{constructor(e,t){super(e),this.icon=t,this.flipRtl=!1,this.type|=X.ICON,e=t.getSize(),this.height=e.height,this.width=e.width}},Er=class extends ft{constructor(e,t){super(e),this.type=this.type|X.SPACER|X.IN_ROW_SPACER,this.width=t,this.height=this.constants_.SPACER_DEFAULT_HEIGHT}},ff=class extends qo{constructor(e,t){super(e,t),this.type|=X.INLINE_INPUT,this.connectedBlock?(this.width=this.connectedBlockWidth,this.height=this.connectedBlockHeight):(this.height=this.constants_.EMPTY_INLINE_INPUT_HEIGHT,this.width=this.constants_.EMPTY_INLINE_INPUT_PADDING),this.connectionHeight=this.isDynamicShape?this.shape.height(this.height):this.shape.height,this.connectionWidth=this.isDynamicShape?this.shape.width(this.height):this.shape.width,this.connectedBlock||(this.width+=this.connectionWidth*(this.isDynamicShape?2:1)),this.connectionOffsetY="connectionOffsetY"in this.shape?this.shape.connectionOffsetY(this.connectionHeight):this.constants_.TAB_OFFSET_FROM_TOP,this.connectionOffsetX="connectionOffsetX"in this.shape?this.shape.connectionOffsetX(this.connectionWidth):0}},yu=class extends qo{constructor(e,t){super(e,t),this.type|=X.STATEMENT_INPUT,this.height=this.connectedBlock?this.connectedBlockHeight+this.constants_.STATEMENT_BOTTOM_SPACER:this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT,this.width=this.constants_.STATEMENT_INPUT_NOTCH_OFFSET+this.shape.width}},mf=class extends Xl{constructor(e){super(e),this.connectedBlockWidths=0,this.type|=X.INPUT_ROW}measure(){this.width=this.minWidth,this.height=this.minHeight;let e=0;for(let t=0;t<this.elements.length;t++){const r=this.elements[t];this.width+=r.width,X.isInput(r)&&r instanceof qo&&(X.isStatementInput(r)&&r instanceof yu?e+=r.connectedBlockWidth:X.isExternalInput(r)&&r instanceof rn&&r.connectedBlockWidth!==0&&(e+=r.connectedBlockWidth-r.connectionWidth)),X.isSpacer(r)||(this.height=Math.max(this.height,r.height))}this.connectedBlockWidths=e,this.widthWithConnectedBlocks=this.width+e}endsWithElemSpacer(){return!this.hasExternalInput&&!this.hasStatement}},m$=class extends ft{constructor(e){super(e),this.type|=X.JAGGED_EDGE,this.height=this.constants_.JAGGED_TEETH.height,this.width=this.constants_.JAGGED_TEETH.width}},b$=class extends xi{constructor(e,t){super(e,t),this.type|=X.NEXT_CONNECTION,this.height=this.shape.height,this.width=this.shape.width}},$$=class extends xi{constructor(e,t){super(e,t),this.connectionOffsetX=0,this.type|=X.OUTPUT_CONNECTION,this.height=this.isDynamicShape?0:this.shape.height,this.startX=this.width=this.isDynamicShape?0:this.shape.width,this.connectionOffsetY=this.constants_.TAB_OFFSET_FROM_TOP}},v$=class extends xi{constructor(e,t){super(e,t),this.type|=X.PREVIOUS_CONNECTION,this.height=this.shape.height,this.width=this.shape.width}},_u=class extends ft{constructor(e,t){super(e),this.type=(t&&t!=="left"?X.RIGHT_ROUND_CORNER:X.LEFT_ROUND_CORNER)|X.CORNER,this.width=this.constants_.CORNER_RADIUS,this.height=this.constants_.CORNER_RADIUS/2}},bf=class extends Xl{constructor(e,t,r){super(e),this.height=t,this.width=r,this.precedesStatement=this.followsStatement=!1,this.widthWithConnectedBlocks=0,this.type=this.type|X.SPACER|X.BETWEEN_ROW_SPACER,this.elements=[new Er(this.constants_,r)]}measure(){}},wu=class extends ft{constructor(e,t){super(e),this.type=(t&&t!=="left"?X.RIGHT_SQUARE_CORNER:X.LEFT_SQUARE_CORNER)|X.CORNER,this.width=this.height=this.constants_.NO_PADDING}},$f=class extends Xl{constructor(e){super(e),this.ascenderHeight=this.capline=0,this.hasPreviousConnection=!1,this.connection=null,this.type|=X.TOP_ROW}hasLeftSquareCorner(e){const t=(e.hat?e.hat==="cap":this.constants_.ADD_START_HATS)&&!e.outputConnection&&!e.previousConnection,r=e.getPreviousBlock();return!!e.outputConnection||t||(r?r.getNextBlock()===e:!1)}hasRightSquareCorner(e){return!0}measure(){let e=0,t=0,r=0;for(let l=0;l<this.elements.length;l++){const p=this.elements[l];t+=p.width,X.isSpacer(p)||(X.isHat(p)&&p instanceof ah?r=Math.max(r,p.ascenderHeight):e=Math.max(e,p.height))}this.width=Math.max(this.minWidth,t),this.height=Math.max(this.minHeight,e)+r,this.capline=this.ascenderHeight=r,this.widthWithConnectedBlocks=this.width}startsWithElemSpacer(){return!1}endsWithElemSpacer(){return!1}},lh=class{constructor(){this.NO_PADDING=0,this.SMALL_PADDING=3,this.MEDIUM_PADDING=5,this.MEDIUM_LARGE_PADDING=8,this.LARGE_PADDING=10,this.TAB_HEIGHT=15,this.TAB_OFFSET_FROM_TOP=5,this.TAB_VERTICAL_OVERLAP=2.5,this.TAB_WIDTH=8,this.NOTCH_WIDTH=15,this.NOTCH_HEIGHT=4,this.MIN_BLOCK_WIDTH=12,this.EMPTY_BLOCK_SPACER_HEIGHT=16,this.CORNER_RADIUS=8,this.NOTCH_OFFSET_LEFT=15,this.STATEMENT_BOTTOM_SPACER=0,this.STATEMENT_INPUT_PADDING_LEFT=20,this.BETWEEN_STATEMENT_PADDING_Y=4,this.ADD_START_HATS=!1,this.START_HAT_HEIGHT=15,this.START_HAT_WIDTH=100,this.SPACER_DEFAULT_HEIGHT=15,this.MIN_BLOCK_HEIGHT=24,this.EMPTY_INLINE_INPUT_PADDING=14.5,this.EXTERNAL_VALUE_INPUT_PADDING=2,this.JAGGED_TEETH_HEIGHT=12,this.JAGGED_TEETH_WIDTH=6,this.FIELD_TEXT_FONTSIZE=11,this.FIELD_TEXT_FONTWEIGHT="normal",this.FIELD_TEXT_FONTFAMILY="sans-serif",this.FIELD_TEXT_BASELINE=this.FIELD_TEXT_HEIGHT=-1,this.FIELD_BORDER_RECT_RADIUS=4,this.FIELD_BORDER_RECT_HEIGHT=16,this.FIELD_BORDER_RECT_X_PADDING=5,this.FIELD_BORDER_RECT_Y_PADDING=3,this.FIELD_BORDER_RECT_COLOUR="#fff",this.FIELD_DROPDOWN_SVG_ARROW=this.FIELD_DROPDOWN_COLOURED_DIV=this.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW=!1,this.FIELD_DROPDOWN_SVG_ARROW_SIZE=12,this.FIELD_COLOUR_FULL_BLOCK=this.FIELD_TEXTINPUT_BOX_SHADOW=!1,this.FIELD_COLOUR_DEFAULT_WIDTH=26,this.defs=null,this.embossFilterId="",this.embossFilter=null,this.disabledPatternId="",this.disabledPattern=null,this.debugFilterId="",this.cssNode=this.debugFilter=null,this.CURSOR_COLOUR="#cc0a0a",this.MARKER_COLOUR="#4286f4",this.CURSOR_WS_WIDTH=100,this.WS_CURSOR_HEIGHT=5,this.CURSOR_STACK_PADDING=10,this.CURSOR_BLOCK_PADDING=2,this.CURSOR_STROKE_WIDTH=4,this.FULL_BLOCK_FIELDS=!1,this.INSERTION_MARKER_COLOUR="#000000",this.INSERTION_MARKER_OPACITY=.2,this.SHAPES={PUZZLE:1,NOTCH:2},this.TALL_INPUT_FIELD_OFFSET_Y=this.MEDIUM_PADDING,this.DUMMY_INPUT_SHADOW_MIN_HEIGHT=this.DUMMY_INPUT_MIN_HEIGHT=this.TAB_HEIGHT,this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT,this.TOP_ROW_MIN_HEIGHT=this.MEDIUM_PADDING,this.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.BOTTOM_ROW_MIN_HEIGHT=this.MEDIUM_PADDING,this.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.EMPTY_INLINE_INPUT_HEIGHT=this.TAB_HEIGHT+11,this.EMPTY_STATEMENT_INPUT_HEIGHT=this.MIN_BLOCK_HEIGHT,this.START_POINT=In(0,0),this.FIELD_TEXT_BASELINE_CENTER=!0,this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT,this.FIELD_DROPDOWN_SVG_ARROW_PADDING=this.FIELD_BORDER_RECT_X_PADDING,this.FIELD_DROPDOWN_SVG_ARROW_DATAURI="data:image/svg+xml;base64,PHN2ZyBpZD0iTGF5ZXJfMSIgZGF0YS1uYW1lPSJMYXllciAxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMi43MSIgaGVpZ2h0PSI4Ljc5IiB2aWV3Qm94PSIwIDAgMTIuNzEgOC43OSI+PHRpdGxlPmRyb3Bkb3duLWFycm93PC90aXRsZT48ZyBvcGFjaXR5PSIwLjEiPjxwYXRoIGQ9Ik0xMi43MSwyLjQ0QTIuNDEsMi40MSwwLDAsMSwxMiw0LjE2TDguMDgsOC4wOGEyLjQ1LDIuNDUsMCwwLDEtMy40NSwwTDAuNzIsNC4xNkEyLjQyLDIuNDIsMCwwLDEsMCwyLjQ0LDIuNDgsMi40OCwwLDAsMSwuNzEuNzFDMSwwLjQ3LDEuNDMsMCw2LjM2LDBTMTEuNzUsMC40NiwxMiwuNzFBMi40NCwyLjQ0LDAsMCwxLDEyLjcxLDIuNDRaIiBmaWxsPSIjMjMxZjIwIi8+PC9nPjxwYXRoIGQ9Ik02LjM2LDcuNzlhMS40MywxLjQzLDAsMCwxLTEtLjQyTDEuNDIsMy40NWExLjQ0LDEuNDQsMCwwLDEsMC0yYzAuNTYtLjU2LDkuMzEtMC41Niw5Ljg3LDBhMS40NCwxLjQ0LDAsMCwxLDAsMkw3LjM3LDcuMzdBMS40MywxLjQzLDAsMCwxLDYuMzYsNy43OVoiIGZpbGw9IiNmZmYiLz48L3N2Zz4=",this.FIELD_COLOUR_DEFAULT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT,this.FIELD_CHECKBOX_X_OFFSET=this.FIELD_BORDER_RECT_X_PADDING-3,this.randomIdentifier=String(Math.random()).substring(2)}init(){this.JAGGED_TEETH=this.makeJaggedTeeth(),this.NOTCH=this.makeNotch(),this.START_HAT=this.makeStartHat(),this.PUZZLE_TAB=this.makePuzzleTab(),this.INSIDE_CORNERS=this.makeInsideCorners(),this.OUTSIDE_CORNERS=this.makeOutsideCorners()}setTheme(e){this.blockStyles=Object.create(null);const t=e.blockStyles;for(const r in t)this.blockStyles[r]=this.validatedBlockStyle_(t[r]);this.setDynamicProperties_(e)}setDynamicProperties_(e){this.setFontConstants_(e),this.setComponentConstants_(e),this.ADD_START_HATS=e.startHats!==void 0?e.startHats:this.ADD_START_HATS}setFontConstants_(e){e.fontStyle&&e.fontStyle.family&&(this.FIELD_TEXT_FONTFAMILY=e.fontStyle.family),e.fontStyle&&e.fontStyle.weight&&(this.FIELD_TEXT_FONTWEIGHT=e.fontStyle.weight),e.fontStyle&&e.fontStyle.size&&(this.FIELD_TEXT_FONTSIZE=e.fontStyle.size),e=Bt("Hg",this.FIELD_TEXT_FONTSIZE+"pt",this.FIELD_TEXT_FONTWEIGHT,this.FIELD_TEXT_FONTFAMILY),this.FIELD_TEXT_HEIGHT=e.height,this.FIELD_TEXT_BASELINE=e.baseline}setComponentConstants_(e){this.CURSOR_COLOUR=e.getComponentStyle("cursorColour")||this.CURSOR_COLOUR,this.MARKER_COLOUR=e.getComponentStyle("markerColour")||this.MARKER_COLOUR,this.INSERTION_MARKER_COLOUR=e.getComponentStyle("insertionMarkerColour")||this.INSERTION_MARKER_COLOUR,this.INSERTION_MARKER_OPACITY=Number(e.getComponentStyle("insertionMarkerOpacity"))||this.INSERTION_MARKER_OPACITY}getBlockStyleForColour(e){const t="auto_"+e;return this.blockStyles[t]||(this.blockStyles[t]=this.createBlockStyle_(e)),{style:this.blockStyles[t],name:t}}getBlockStyle(e){return this.blockStyles[e||""]||(e&&e.startsWith("auto_")?this.getBlockStyleForColour(e.substring(5)).style:this.createBlockStyle_("#000000"))}createBlockStyle_(e){return this.validatedBlockStyle_({colourPrimary:e})}validatedBlockStyle_(e){const t={};return e&&Object.assign(t,e),e=yl(t.colourPrimary||"#000"),t.colourPrimary=e.hex,t.colourSecondary=t.colourSecondary?yl(t.colourSecondary).hex:this.generateSecondaryColour_(t.colourPrimary),t.colourTertiary=t.colourTertiary?yl(t.colourTertiary).hex:this.generateTertiaryColour_(t.colourPrimary),t.hat=t.hat||"",t}generateSecondaryColour_(e){return Je("#fff",e,.6)||e}generateTertiaryColour_(e){return Je("#fff",e,.3)||e}dispose(){this.embossFilter&&lt(this.embossFilter),this.disabledPattern&&lt(this.disabledPattern),this.debugFilter&&lt(this.debugFilter),this.cssNode=null}makeJaggedTeeth(){const e=this.JAGGED_TEETH_HEIGHT,t=this.JAGGED_TEETH_WIDTH,r=Br([nt(t,e/4),nt(2*-t,e/2),nt(t,e/4)]);return{height:e,width:t,path:r}}makeStartHat(){const e=this.START_HAT_HEIGHT,t=this.START_HAT_WIDTH,r=sr("c",[nt(30,-e),nt(70,-e),nt(t,0)]);return{height:e,width:t,path:r}}makePuzzleTab(){function e(v){v=v?-1:1;const O=-v;var G=r/2;const _e=G+2.5,qe=G+.5,Nn=nt(-t,v*G);return G=nt(t,v*G),sr("c",[nt(0,v*_e),nt(-t,O*qe),Nn])+sr("s",[nt(t,2.5*O),G])}const t=this.TAB_WIDTH,r=this.TAB_HEIGHT,l=e(!0),p=e(!1);return{type:this.SHAPES.PUZZLE,width:t,height:r,pathDown:p,pathUp:l}}makeNotch(){function e(O){return Br([nt(O*l,r),nt(3*O,0),nt(O*l,-r)])}const t=this.NOTCH_WIDTH,r=this.NOTCH_HEIGHT,l=(t-3)/2,p=e(1),v=e(-1);return{type:this.SHAPES.NOTCH,width:t,height:r,pathLeft:p,pathRight:v}}makeInsideCorners(){const e=this.CORNER_RADIUS,t=qn("a","0 0,0",e,nt(-e,e)),r=qn("a","0 0,0",e,nt(e,e));return{width:e,height:e,pathTop:t,pathBottom:r}}makeOutsideCorners(){const e=this.CORNER_RADIUS,t=In(0,e)+qn("a","0 0,1",e,nt(e,-e)),r=qn("a","0 0,1",e,nt(e,e)),l=qn("a","0 0,1",e,nt(-e,-e)),p=qn("a","0 0,1",e,nt(-e,e));return{topLeft:t,topRight:r,bottomRight:p,bottomLeft:l,rightHeight:e}}shapeFor(e){switch(e.type){case Ge.INPUT_VALUE:case Ge.OUTPUT_VALUE:return this.PUZZLE_TAB;case Ge.PREVIOUS_STATEMENT:case Ge.NEXT_STATEMENT:return this.NOTCH;default:throw Error("Unknown connection type")}}createDom(e,t,r){this.injectCSS_(t,r),this.defs=ie(ae.DEFS,{},e),e=ie(ae.FILTER,{id:"blocklyEmbossFilter"+this.randomIdentifier},this.defs),ie(ae.FEGAUSSIANBLUR,{in:"SourceAlpha",stdDeviation:1,result:"blur"},e),t=ie(ae.FESPECULARLIGHTING,{in:"blur",surfaceScale:1,specularConstant:.5,specularExponent:10,"lighting-color":"white",result:"specOut"},e),ie(ae.FEPOINTLIGHT,{x:-5e3,y:-1e4,z:2e4},t),ie(ae.FECOMPOSITE,{in:"specOut",in2:"SourceAlpha",operator:"in",result:"specOut"},e),ie(ae.FECOMPOSITE,{in:"SourceGraphic",in2:"specOut",operator:"arithmetic",k1:0,k2:1,k3:1,k4:0},e),this.embossFilterId=e.id,this.embossFilter=e,e=ie(ae.PATTERN,{id:"blocklyDisabledPattern"+this.randomIdentifier,patternUnits:"userSpaceOnUse",width:10,height:10},this.defs),ie(ae.RECT,{width:10,height:10,fill:"#aaa"},e),ie(ae.PATH,{d:"M 0 0 L 10 10 M 10 0 L 0 10",stroke:"#cc0"},e),this.disabledPatternId=e.id,this.disabledPattern=e,this.createDebugFilter()}createDebugFilter(){if(!this.debugFilter){const e=ie(ae.FILTER,{id:"blocklyDebugFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},this.defs),t=ie(ae.FECOMPONENTTRANSFER,{result:"outBlur"},e);ie(ae.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},t),ie(ae.FEFLOOD,{"flood-color":"#ff0000","flood-opacity":.5,result:"outColor"},e),ie(ae.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},e),this.debugFilterId=e.id,this.debugFilter=e}}injectCSS_(e,t){t=this.getCSS_(t),e="blockly-renderer-style-"+e,this.cssNode=document.getElementById(e);const r=t.join(`
`);this.cssNode?this.cssNode.firstChild.textContent=r:(t=document.createElement("style"),t.id=e,e=document.createTextNode(r),t.appendChild(e),document.head.insertBefore(t,document.head.firstChild),this.cssNode=t)}getCSS_(e){return[`${e} .blocklyText, `,`${e} .blocklyFlyoutLabelText {`,`font: ${this.FIELD_TEXT_FONTWEIGHT} ${this.FIELD_TEXT_FONTSIZE}pt ${this.FIELD_TEXT_FONTFAMILY};`,"}",`${e} .blocklyText {`,"fill: #fff;","}",`${e} .blocklyNonEditableText>rect,`,`${e} .blocklyEditableText>rect {`,`fill: ${this.FIELD_BORDER_RECT_COLOUR};`,"fill-opacity: .6;","stroke: none;","}",`${e} .blocklyNonEditableText>text,`,`${e} .blocklyEditableText>text {`,"fill: #000;","}",`${e} .blocklyFlyoutLabelText {`,"fill: #000;","}",`${e} .blocklyText.blocklyBubbleText {`,"fill: #000;","}",`${e} .blocklyEditableText:not(.editing):hover>rect {`,"stroke: #fff;","stroke-width: 2;","}",`${e} .blocklyHtmlInput {`,`font-family: ${this.FIELD_TEXT_FONTFAMILY};`,`font-weight: ${this.FIELD_TEXT_FONTWEIGHT};`,"}",`${e} .blocklySelected>.blocklyPath {`,"stroke: #fc3;","stroke-width: 3px;","}",`${e} .blocklyHighlightedConnectionPath {`,"stroke: #fc3;","}",`${e} .blocklyReplaceable .blocklyPath {`,"fill-opacity: .5;","}",`${e} .blocklyReplaceable .blocklyPathLight,`,`${e} .blocklyReplaceable .blocklyPathDark {`,"display: none;","}",`${e} .blocklyInsertionMarker>.blocklyPath {`,`fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,"stroke: none;","}"]}},Ql=class{constructor(e,t){this.inlinePath_=this.outlinePath_="",this.block_=e,this.info_=t,this.topLeft_=e.getRelativeToSurfaceXY(),this.constants_=t.getRenderer().getConstants()}draw(){this.drawOutline_(),this.drawInternals_(),this.updateConnectionHighlights(),this.block_.pathObject.setPath(this.outlinePath_+`
`+this.inlinePath_),this.info_.RTL&&this.block_.pathObject.flipRTL(),this.recordSizeOnBlock_()}recordSizeOnBlock_(){this.block_.height=this.info_.height,this.block_.width=this.info_.widthWithChildren,this.block_.childlessWidth=this.info_.width}drawOutline_(){this.drawTop_();for(let e=1;e<this.info_.rows.length-1;e++){const t=this.info_.rows[e];t.hasJaggedEdge?this.drawJaggedEdge_(t):t.hasStatement?this.drawStatementInput_(t):t.hasExternalInput?this.drawValueInput_(t):this.drawRightSideRow_(t)}this.drawBottom_(),this.drawLeft_()}drawTop_(){const e=this.info_.topRow,t=e.elements;this.positionPreviousConnection_(),this.outlinePath_+=In(e.xPos,this.info_.startY);for(let r=0,l;l=t[r];r++)X.isLeftRoundedCorner(l)?this.outlinePath_+=this.constants_.OUTSIDE_CORNERS.topLeft:X.isRightRoundedCorner(l)?this.outlinePath_+=this.constants_.OUTSIDE_CORNERS.topRight:X.isPreviousConnection(l)&&l instanceof xi?this.outlinePath_+=l.shape.pathLeft:X.isHat(l)?this.outlinePath_+=this.constants_.START_HAT.path:X.isSpacer(l)&&(this.outlinePath_+=Ye("h",l.width));this.outlinePath_+=Ye("v",e.height)}drawJaggedEdge_(e){this.outlinePath_+=this.constants_.JAGGED_TEETH.path+Ye("v",e.height-this.constants_.JAGGED_TEETH.height)}drawValueInput_(e){const t=e.getLastInput();this.positionExternalValueConnection_(e);const r=Lc(t.shape)?t.shape.pathDown(t.height):t.shape.pathDown;this.outlinePath_+=Ye("H",t.xPos+t.width)+r+Ye("v",e.height-t.connectionHeight)}drawStatementInput_(e){var t=e.getLastInput();if(t){var r=t.xPos+t.notchOffset+t.shape.width;t=t.shape.pathRight+Ye("h",-(t.notchOffset-this.constants_.INSIDE_CORNERS.width))+this.constants_.INSIDE_CORNERS.pathTop;var l=e.height-2*this.constants_.INSIDE_CORNERS.height;this.outlinePath_+=Ye("H",r)+t+Ye("v",l)+this.constants_.INSIDE_CORNERS.pathBottom+Ye("H",e.xPos+e.width),this.positionStatementInputConnection_(e)}}drawRightSideRow_(e){this.outlinePath_+=Ye("V",e.yPos+e.height)}drawBottom_(){const e=this.info_.bottomRow,t=e.elements;this.positionNextConnection_();let r=0,l="";for(let p=t.length-1,v;v=t[p];p--)X.isNextConnection(v)&&v instanceof xi?l+=v.shape.pathRight:X.isLeftSquareCorner(v)?l+=Ye("H",e.xPos):X.isLeftRoundedCorner(v)?l+=this.constants_.OUTSIDE_CORNERS.bottomLeft:X.isRightRoundedCorner(v)?(l+=this.constants_.OUTSIDE_CORNERS.bottomRight,r=this.constants_.OUTSIDE_CORNERS.rightHeight):X.isSpacer(v)&&(l+=Ye("h",-1*v.width));this.outlinePath_+=Ye("V",e.baseline-r),this.outlinePath_+=l}drawLeft_(){var e=this.info_.outputConnection;if(this.positionOutputConnection_(),e){const t=e.connectionOffsetY+e.height;e=Lc(e.shape)?e.shape.pathUp(e.height):e.shape.pathUp,this.outlinePath_+=Ye("V",t)+e}this.outlinePath_+="z"}drawInternals_(){for(let e=0,t;t=this.info_.rows[e];e++)for(let r=0,l;l=t.elements[r];r++)X.isInlineInput(l)?this.drawInlineInput_(l):(X.isIcon(l)||X.isField(l))&&this.layoutField_(l)}layoutField_(e){const t=e.centerline-e.height/2;let r=e.xPos;var l="";this.info_.RTL&&(r=-(r+e.width),e.flipRtl&&(r+=e.width,l="scale(-1 1)")),X.isIcon(e)?(l=e.icon,l.setOffsetInBlock(new Ae(r,t)),this.info_.isInsertionMarker&&l.hideForInsertionMarker()):(e=e.field.getSvgRoot(),e.setAttribute("transform","translate("+r+","+t+")"+l),this.info_.isInsertionMarker&&e.setAttribute("display","none"))}drawInlineInput_(e){const t=e.width,r=e.height,l=e.connectionOffsetY,p=e.connectionHeight+l;this.inlinePath_+=us(e.xPos+e.connectionWidth,e.centerline-r/2)+Ye("v",l)+e.shape.pathDown+Ye("v",r-p)+Ye("h",t-e.connectionWidth)+Ye("v",-r)+"z",this.positionInlineInputConnection_(e)}positionInlineInputConnection_(e){const t=e.centerline-e.height/2;if(e.connectionModel){let r=e.xPos+e.connectionWidth+e.connectionOffsetX;this.info_.RTL&&(r*=-1),e.connectionModel.setOffsetInBlock(r,t+e.connectionOffsetY)}}positionStatementInputConnection_(e){const t=e.getLastInput();if(t!=null&&t.connectionModel){let r=e.xPos+e.statementEdge+t.notchOffset;this.info_.RTL&&(r*=-1),t.connectionModel.setOffsetInBlock(r,e.yPos)}}positionExternalValueConnection_(e){const t=e.getLastInput();if(t&&t.connectionModel){let r=e.xPos+e.width;this.info_.RTL&&(r*=-1),t.connectionModel.setOffsetInBlock(r,e.yPos)}}positionPreviousConnection_(){const e=this.info_.topRow;if(e.connection){const t=e.xPos+e.notchOffset;e.connection.connectionModel.setOffsetInBlock(this.info_.RTL?-t:t,0)}}positionNextConnection_(){const e=this.info_.bottomRow;if(e.connection){const t=e.connection,r=t.xPos;t.connectionModel.setOffsetInBlock(this.info_.RTL?-r:r,e.baseline)}}positionOutputConnection_(){if(this.info_.outputConnection){const e=this.info_.startX+this.info_.outputConnection.connectionOffsetX;this.block_.outputConnection.setOffsetInBlock(this.info_.RTL?-e:e,this.info_.outputConnection.connectionOffsetY)}}updateConnectionHighlights(){for(const e of this.info_.rows)for(const t of e.elements)if(t instanceof xi)if(t.highlighted)this.drawConnectionHighlightPath(t);else{let r,l;(l=(r=this.block_.pathObject).removeConnectionHighlight)==null||l.call(r,t.connectionModel)}}drawConnectionHighlightPath(e){const t=e.connectionModel;e=t.type===Ge.INPUT_VALUE||t.type===Ge.OUTPUT_VALUE?this.getExpressionConnectionHighlightPath(e):this.getStatementConnectionHighlightPath(e);const r=t.getSourceBlock();let l,p;(p=(l=r.pathObject).addConnectionHighlight)==null||p.call(l,t,e,t.getOffsetInBlock(),r.RTL)}getExpressionConnectionHighlightPath(e){let t="";return Lc(e.shape)?t=e.shape.pathDown(e.height):bb(e.shape)&&(t=e.shape.pathDown),e=this.constants_.TAB_OFFSET_FROM_TOP,In(0,-e)+Ye("v",e)+t+Ye("v",e)}getStatementConnectionHighlightPath(e){if(!Si(e.shape))throw Error("Statement connections should have notch shapes");const t=this.constants_.NOTCH_OFFSET_LEFT-this.constants_.CORNER_RADIUS;return In(-t,0)+Ye("h",t)+e.shape.pathLeft+Ye("h",t)}};(function(e){e[e.LEFT=-1]="LEFT",e[e.CENTRE=0]="CENTRE",e[e.RIGHT=1]="RIGHT"})(s.Align$$module$build$src$core$inputs$align||(s.Align$$module$build$src$core$inputs$align={})),s.Align$$module$build$src$core$inputs$align;var Ya=class extends fn{constructor(e,t,r){super(fn.SKIP_SETUP),this.class=null,this.EDITABLE=!1,this.maxDisplayLength=1/0,e!==fn.SKIP_SETUP&&(r?this.configure_(r):this.class=t||null,this.setValue(e))}configure_(e){super.configure_(e),e.class&&(this.class=e.class)}initView(){this.createTextElement_(),this.class&&Pe(this.getTextElement(),this.class)}doClassValidation_(e){return e==null?null:`${e}`}setClass(e){this.textElement_&&(this.class&&it(this.textElement_,this.class),e&&Pe(this.textElement_,e)),this.class=e}static fromJson(e){return new this(bt(e.text),void 0,e)}};_t("field_label",Ya),Ya.prototype.DEFAULT_VALUE="";var Ko=class{constructor(e,t){this.name=e,this.sourceBlock=t,this.fieldRow=[],this.align=s.Align$$module$build$src$core$inputs$align.LEFT,this.visible=!0,this.type=s.inputTypes$$module$build$src$core$inputs$input_types.CUSTOM,this.connection=null}getSourceBlock(){return this.sourceBlock}appendField(e,t){return this.insertFieldAt(this.fieldRow.length,e,t),this}insertFieldAt(e,t,r){if(0>e||e>this.fieldRow.length)throw Error("index "+e+" out of bounds.");return(t||t===""&&r)&&(typeof t=="string"&&(t=s.fromJson$$module$build$src$core$field_registry({type:"field_label",text:t})),t.setSourceBlock(this.sourceBlock),this.sourceBlock.initialized&&this.initField(t),t.name=r,t.setVisible(this.isVisible()),t.prefixField&&(e=this.insertFieldAt(e,t.prefixField)),this.fieldRow.splice(e,0,t),e++,t.suffixField&&(e=this.insertFieldAt(e,t.suffixField)),this.sourceBlock.rendered&&this.sourceBlock.queueRender()),e}removeField(e,t){for(let r=0,l;l=this.fieldRow[r];r++)if(l.name===e)return l.dispose(),this.fieldRow.splice(r,1),this.sourceBlock.rendered&&this.sourceBlock.queueRender(),!0;if(t)return!1;throw Error('Field "'+e+'" not found.')}isVisible(){return this.visible}setVisible(e){let t=[];if(this.visible===e)return t;this.visible=e;for(let l=0,p;p=this.fieldRow[l];l++)p.setVisible(e);if(this.connection){var r=this.connection;e?t=r.startTrackingAll():r.stopTrackingAll(),(r=r.targetBlock())&&(r.getSvgRoot().style.display=e?"block":"none")}return t}markDirty(){for(let e=0,t;t=this.fieldRow[e];e++)t.markDirty()}setCheck(e){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.setCheck(e),this}setAlign(e){return this.align=e,this.sourceBlock.rendered&&this.sourceBlock.queueRender(),this}setShadowDom(e){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.setShadowDom(e),this}getShadowDom(){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.getShadowDom()}init(){for(const e of this.fieldRow)e.init()}initModel(){for(const e of this.fieldRow)e.initModel()}initField(e){this.sourceBlock.rendered?e.init():e.initModel()}dispose(){for(let e=0,t;t=this.fieldRow[e];e++)t.dispose();this.connection&&this.connection.dispose()}makeConnection(e){return this.sourceBlock.makeConnection_(e)}},Di=class extends Ko{constructor(e,t){super(e,t),this.name=e,this.type=s.inputTypes$$module$build$src$core$inputs$input_types.DUMMY}},ho=class extends Ko{constructor(e,t){super(e,t),this.name=e,this.type=s.inputTypes$$module$build$src$core$inputs$input_types.END_ROW}},kr=class extends Ko{constructor(e,t){if(!e)throw Error("Statement inputs must have a non-empty name");super(e,t),this.name=e,this.type=s.inputTypes$$module$build$src$core$inputs$input_types.STATEMENT,this.connection=this.makeConnection(Ge.NEXT_STATEMENT)}},ps;s.ValueInput$$module$build$src$core$inputs$value_input=class extends Ko{constructor(e,t){if(!e)throw Error("Value inputs must have a non-empty name");super(e,t),this.name=e,this.type=s.inputTypes$$module$build$src$core$inputs$input_types.VALUE,this.connection=this.makeConnection(Ge.INPUT_VALUE)}},ps={},ps.ValueInput=s.ValueInput$$module$build$src$core$inputs$value_input;var ms=class{constructor(e,t){this.statementEdge=this.width=this.widthWithChildren=this.height=0,this.rows=[],this.inputRows=[],this.startY=this.startX=0,this.renderer_=e,this.block_=t,this.constants_=this.renderer_.getConstants(),this.outputConnection=t.outputConnection?new $$(this.constants_,t.outputConnection):null,this.isInline=t.getInputsInline()&&!t.isCollapsed(),this.isCollapsed=t.isCollapsed(),this.isInsertionMarker=t.isInsertionMarker(),this.RTL=t.RTL,this.topRow=new $f(this.constants_),this.bottomRow=new dr(this.constants_)}getRenderer(){return this.renderer_}measure(){this.createRows_(),this.addElemSpacing_(),this.addRowSpacing_(),this.computeBounds_(),this.alignRowElements_(),this.finalize_()}createRows_(){this.populateTopRow_(),this.rows.push(this.topRow);let e=new mf(this.constants_);this.inputRows.push(e);var t=this.block_.getIcons();for(let r=0,l;l=t[r];r++){const p=new vu(this.constants_,l);this.isCollapsed&&!l.isShownWhenCollapsed()||e.elements.push(p)}t=void 0;for(let r=0,l;l=this.block_.inputList[r];r++)if(l.isVisible()){this.shouldStartNewRow_(l,t)&&(this.rows.push(e),e=new mf(this.constants_),this.inputRows.push(e));for(let p=0,v;v=l.fieldRow[p];p++)e.elements.push(new Zl(this.constants_,v,l));this.addInput_(l,e),t=l}this.isCollapsed&&(e.hasJaggedEdge=!0,e.elements.push(new m$(this.constants_))),(e.elements.length||e.hasDummyInput)&&this.rows.push(e),this.populateBottomRow_(),this.rows.push(this.bottomRow)}populateTopRow_(){var e=!!this.block_.previousConnection;const t=(this.block_.hat?this.block_.hat==="cap":this.constants_.ADD_START_HATS)&&!this.outputConnection&&!e;let r=this.topRow.hasLeftSquareCorner(this.block_)?wu:_u;this.topRow.elements.push(new r(this.constants_)),t?(e=new ah(this.constants_),this.topRow.elements.push(e),this.topRow.capline=e.ascenderHeight):e&&(this.topRow.hasPreviousConnection=!0,this.topRow.connection=new v$(this.constants_,this.block_.previousConnection),this.topRow.elements.push(this.topRow.connection)),this.block_.inputList.length&&this.block_.inputList[0]instanceof kr&&!this.block_.isCollapsed()?this.topRow.minHeight=this.constants_.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT:this.topRow.minHeight=this.constants_.TOP_ROW_MIN_HEIGHT,r=this.topRow.hasRightSquareCorner(this.block_)?wu:_u,this.topRow.elements.push(new r(this.constants_,"right"))}populateBottomRow_(){this.bottomRow.hasNextConnection=!!this.block_.nextConnection,this.bottomRow.minHeight=this.block_.inputList.length&&this.block_.inputList[this.block_.inputList.length-1]instanceof kr?this.constants_.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT:this.constants_.BOTTOM_ROW_MIN_HEIGHT,this.bottomRow.hasLeftSquareCorner(this.block_)?this.bottomRow.elements.push(new wu(this.constants_)):this.bottomRow.elements.push(new _u(this.constants_)),this.bottomRow.hasNextConnection&&(this.bottomRow.connection=new b$(this.constants_,this.block_.nextConnection),this.bottomRow.elements.push(this.bottomRow.connection)),this.bottomRow.hasRightSquareCorner(this.block_)?this.bottomRow.elements.push(new wu(this.constants_,"right")):this.bottomRow.elements.push(new _u(this.constants_,"right"))}addInput_(e,t){this.isInline&&e instanceof s.ValueInput$$module$build$src$core$inputs$value_input?(t.elements.push(new ff(this.constants_,e)),t.hasInlineInput=!0):e instanceof kr?(t.elements.push(new yu(this.constants_,e)),t.hasStatement=!0):e instanceof s.ValueInput$$module$build$src$core$inputs$value_input?(t.elements.push(new rn(this.constants_,e)),t.hasExternalInput=!0):(e instanceof Di||e instanceof ho)&&(t.minHeight=Math.max(t.minHeight,e.getSourceBlock()&&e.getSourceBlock().isShadow()?this.constants_.DUMMY_INPUT_SHADOW_MIN_HEIGHT:this.constants_.DUMMY_INPUT_MIN_HEIGHT),t.hasDummyInput=!0),t.align===null&&(t.align=e.align)}shouldStartNewRow_(e,t){return t?t instanceof ho||e instanceof kr||t instanceof kr?!0:e instanceof s.ValueInput$$module$build$src$core$inputs$value_input||e instanceof Di||t instanceof s.ValueInput$$module$build$src$core$inputs$value_input?!this.isInline:!1:!1}addElemSpacing_(){for(let e=0,t;t=this.rows[e];e++){const r=t.elements;if(t.elements=[],t.startsWithElemSpacer()&&t.elements.push(new Er(this.constants_,this.getInRowSpacing_(null,r[0]))),r.length){for(let l=0;l<r.length-1;l++){t.elements.push(r[l]);const p=this.getInRowSpacing_(r[l],r[l+1]);t.elements.push(new Er(this.constants_,p))}t.elements.push(r[r.length-1]),t.endsWithElemSpacer()&&t.elements.push(new Er(this.constants_,this.getInRowSpacing_(r[r.length-1],null)))}}}getInRowSpacing_(e,t){if(!e&&t&&X.isStatementInput(t))return this.constants_.STATEMENT_INPUT_PADDING_LEFT;if(e&&X.isInput(e)&&!t){if(X.isExternalInput(e))return this.constants_.NO_PADDING;if(X.isInlineInput(e))return this.constants_.LARGE_PADDING;if(X.isStatementInput(e))return this.constants_.NO_PADDING}return e&&X.isLeftSquareCorner(e)&&t&&(X.isPreviousConnection(t)||X.isNextConnection(t))?t.notchOffset:e&&X.isLeftRoundedCorner(e)&&t&&(X.isPreviousConnection(t)||X.isNextConnection(t))?t.notchOffset-this.constants_.CORNER_RADIUS:this.constants_.MEDIUM_PADDING}computeBounds_(){let e=0,t=0,r=0;for(let p=0,v;v=this.rows[p];p++){if(v.measure(),t=Math.max(t,v.width),v.hasStatement){var l=v.getLastInput();let O,G;l=v.width-((G=(O=l)==null?void 0:O.width)!=null?G:0),e=Math.max(e,l)}r=Math.max(r,v.widthWithConnectedBlocks)}this.statementEdge=e,this.width=t;for(let p=0,v;v=this.rows[p];p++)v.hasStatement&&(v.statementEdge=this.statementEdge);this.widthWithChildren=Math.max(t,r),this.outputConnection&&(this.startX=this.outputConnection.width,this.width+=this.outputConnection.width,this.widthWithChildren+=this.outputConnection.width)}alignRowElements_(){for(let t=0,r;r=this.rows[t];t++)if(r.hasStatement)this.alignStatementRow_(r);else{var e=r.width;e=this.getDesiredRowWidth_(r)-e,0<e&&this.addAlignmentPadding_(r,e),X.isTopOrBottomRow(r)&&(r.widthWithConnectedBlocks=r.width)}}getDesiredRowWidth_(e){return this.width-this.startX}addAlignmentPadding_(e,t){const r=e.getFirstSpacer(),l=e.getLastSpacer();if((e.hasExternalInput||e.hasStatement)&&(e.widthWithConnectedBlocks+=t),e.align===s.Align$$module$build$src$core$inputs$align.LEFT&&l)l.width+=t;else if(e.align===s.Align$$module$build$src$core$inputs$align.CENTRE&&r&&l)r.width+=t/2,l.width+=t/2;else if(e.align===s.Align$$module$build$src$core$inputs$align.RIGHT&&r)r.width+=t;else if(l)l.width+=t;else return;e.width+=t}alignStatementRow_(e){const t=e.getLastInput();if(t){var r=e.width-t.width,l=this.statementEdge;r=l-r,0<r&&this.addAlignmentPadding_(e,r),r=e.width,l=this.getDesiredRowWidth_(e),t.width+=l-r,t.height=Math.max(t.height,e.height),e.width+=l-r,e.widthWithConnectedBlocks=Math.max(e.width,this.statementEdge+e.connectedBlockWidths)}}addRowSpacing_(){const e=this.rows;this.rows=[];for(let t=0;t<e.length;t++)this.rows.push(e[t]),t!==e.length-1&&this.rows.push(this.makeSpacerRow_(e[t],e[t+1]))}makeSpacerRow_(e,t){var r=this.getSpacerRowHeight_(e,t);const l=this.getSpacerRowWidth_(e,t);return r=new bf(this.constants_,r,l),e.hasStatement&&(r.followsStatement=!0),t.hasStatement&&(r.precedesStatement=!0),r}getSpacerRowWidth_(e,t){return this.width-this.startX}getSpacerRowHeight_(e,t){return this.constants_.MEDIUM_PADDING}getElemCenterline_(e,t){return X.isSpacer(t)?e.yPos+t.height/2:X.isBottomRow(e)?(e=e.yPos+e.height-e.descenderHeight,X.isNextConnection(t)?e+t.height/2:e-t.height/2):X.isTopRow(e)?X.isHat(t)?e.capline-t.height/2:e.capline+t.height/2:e.yPos+e.height/2}recordElemPositions_(e){let t=e.xPos;for(let r=0,l;l=e.elements[r];r++)X.isSpacer(l)&&(l.height=e.height),l.xPos=t,l.centerline=this.getElemCenterline_(e,l),t+=l.width}finalize_(){let e=0,t=0;for(let r=0,l;l=this.rows[r];r++)l.yPos=t,l.xPos=this.startX,t+=l.height,e=Math.max(e,l.widthWithConnectedBlocks),this.recordElemPositions_(l);if(this.outputConnection&&this.block_.nextConnection){const r=this.block_.nextConnection.targetBlock();r&&(e=Math.max(e,r.getHeightWidth().width))}this.widthWithChildren=e+this.startX,this.height=t,this.startY=this.topRow.capline,this.bottomRow.baseline=t-this.bottomRow.descenderHeight}getMeasureableForConnection(e){let t;if(((t=this.outputConnection)==null?void 0:t.connectionModel)===e)return this.outputConnection;for(const r of this.rows)for(const l of r.elements)if(l instanceof xi&&l.connectionModel===e)return l;return null}},vf=class extends Pa{constructor(e){if(super(e),this.type=ge.BLOCK_DELETE,e){if(e.getParent())throw Error("Connected blocks cannot be deleted.");e.isShadow()&&(this.recordUndo=!1),this.oldXml=Ro(e),this.ids=ee(e),this.wasShadow=e.isShadow(),this.oldJson=Vt(e,{addCoordinates:!0})}}toJson(){const e=super.toJson();if(!this.oldXml)throw Error("The old block XML is undefined. Either pass a block to the constructor, or call fromJson");if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(this.wasShadow===void 0)throw Error("Whether the block was a shadow is undefined. Either pass a block to the constructor, or call fromJson");if(!this.oldJson)throw Error("The old block JSON is undefined. Either pass a block to the constructor, or call fromJson");return e.oldXml=vi(this.oldXml),e.ids=this.ids,e.wasShadow=this.wasShadow,e.oldJson=this.oldJson,this.recordUndo||(e.recordUndo=this.recordUndo),e}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new vf),t.oldXml=s.textToDom$$module$build$src$core$utils$xml(e.oldXml),t.ids=e.ids,t.wasShadow=e.wasShadow||t.oldXml.tagName.toLowerCase()==="shadow",t.oldJson=e.oldJson,e.recordUndo!==void 0&&(t.recordUndo=e.recordUndo),t}run(e){const t=this.getEventWorkspace_();if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(!this.oldJson)throw Error("The old block JSON is undefined. Either pass a block to the constructor, or call fromJson");if(e)for(e=0;e<this.ids.length;e++){const r=this.ids[e],l=t.getBlockById(r);l?l.dispose(!1):r===this.blockId&&console.warn("Can't delete non-existent block: "+r)}else Ui(this.oldJson,t)}};i(Ne.EVENT,ge.BLOCK_DELETE,vf);var Jt=class{constructor(e,t){this.type=t,this.targetConnection=null,this.disposed=!1,this.shadowDom=this.check=null,this.y=this.x=0,this.shadowState=null,this.sourceBlock_=e}connect_(e){const t=Ge.INPUT_VALUE,r=this.getSourceBlock();var l=e.getSourceBlock();e.isConnected()&&e.disconnectInternal(!1);let p;if(this.isConnected()){const O=this.stashShadowState(),G=this.targetBlock();G.isShadow()?G.dispose(!1):(this.disconnectInternal(),p=G),this.applyShadowState(O)}let v;re()&&(v=new(Ce(ge.BLOCK_MOVE))(l),v.setReason(["connect"])),fd(this,e),l.setParent(r),v&&(v.recordNew(),te(v)),p&&(e=this.type===t?p.outputConnection:p.previousConnection)&&((l=Jt.getConnectionForOrphanedConnection(l,e))?e.connect(l):e.onFailedConnect(this))}dispose(){if(this.isConnected()){this.isSuperior()&&this.setShadowStateInternal();const e=this.targetBlock();e&&!e.isDeadOrDying()&&e.unplug()}this.disposed=!0}getSourceBlock(){return this.sourceBlock_}isSuperior(){return this.type===Ge.INPUT_VALUE||this.type===Ge.NEXT_STATEMENT}isConnected(){return!!this.targetConnection}getConnectionChecker(){return this.sourceBlock_.workspace.connectionChecker}onFailedConnect(e){}connect(e){if(this.targetConnection===e)return!0;if(this.getConnectionChecker().canConnect(this,e,!1)){const t=s.getGroup$$module$build$src$core$events$utils();t||s.setGroup$$module$build$src$core$events$utils(!0),this.isSuperior()?this.connect_(e):e.connect_(this),s.setGroup$$module$build$src$core$events$utils(t)}return this.isConnected()}disconnect(){this.disconnectInternal()}disconnectInternal(e=!0){const{parentConnection:t,childConnection:r}=this.getParentAndChildConnections();if(!t||!r)throw Error("Source connection not connected.");const l=s.getGroup$$module$build$src$core$events$utils();l||s.setGroup$$module$build$src$core$events$utils(!0);let p;re()&&(p=new(Ce(ge.BLOCK_MOVE))(r.getSourceBlock()),p.setReason(["disconnect"]));const v=this.targetConnection;v&&(v.targetConnection=null),this.targetConnection=null,e&&r.getSourceBlock().setParent(null),p&&(p.recordNew(),te(p)),r.getSourceBlock().isShadow()||t.respawnShadow_(),s.setGroup$$module$build$src$core$events$utils(l)}getParentAndChildConnections(){return this.targetConnection?this.isSuperior()?{parentConnection:this,childConnection:this.targetConnection}:{parentConnection:this.targetConnection,childConnection:this}:{}}respawnShadow_(){this.createShadowBlock(!0)}reconnect(e,t){if(this.getSourceBlock().isDeadOrDying())return!1;var r;return t=(r=e.getInput(t))==null?void 0:r.connection,r=this.targetBlock(),r&&r!==e||!t||t.targetConnection===this?!1:(t.isConnected()&&t.disconnect(),t.connect(this),!0)}targetBlock(){if(this.isConnected()){let e,t;return(t=(e=this.targetConnection)==null?void 0:e.getSourceBlock())!=null?t:null}return null}onCheckChanged_(){!this.isConnected()||this.targetConnection&&this.getConnectionChecker().canConnect(this,this.targetConnection,!1)||(this.isSuperior()?this.targetBlock():this.sourceBlock_).unplug()}setCheck(e){return e?(Array.isArray(e)||(e=[e]),this.check=e,this.onCheckChanged_()):this.check=null,this}getCheck(){return this.check}setShadowDom(e){this.setShadowStateInternal({shadowDom:e})}getShadowDom(e){return e&&this.targetBlock().isShadow()?Ki(this.targetBlock()):this.shadowDom}setShadowState(e){this.setShadowStateInternal({shadowState:e})}getShadowState(e){return e&&this.targetBlock()&&this.targetBlock().isShadow()?Vt(this.targetBlock()):this.shadowState}neighbours(e){return[]}getParentInput(){let e=null;const t=this.sourceBlock_.inputList;for(let r=0;r<t.length;r++)if(t[r].connection===this){e=t[r];break}return e}toString(){const e=this.sourceBlock_;if(!e)return"Orphan Connection";if(e.outputConnection===this)var t="Output Connection of ";else if(e.previousConnection===this)t="Previous Connection of ";else if(e.nextConnection===this)t="Next Connection of ";else{t=null;for(let r=0,l;l=e.inputList[r];r++)if(l.connection===this){t=l;break}if(t)t='Input "'+t.name+'" connection on ';else return console.warn("Connection not actually connected to sourceBlock_"),"Orphan Connection"}return t+e.toDevString()}stashShadowState(){const e=this.getShadowDom(!0),t=this.getShadowState(!0);return this.shadowState=this.shadowDom=null,{shadowDom:e,shadowState:t}}applyShadowState({shadowDom:e,shadowState:t}){this.shadowDom=e,this.shadowState=t}setShadowStateInternal({shadowDom:e=null,shadowState:t=null}={}){this.shadowDom=e,this.shadowState=t,this.getSourceBlock().isDeadOrDying()||((e=this.targetBlock())?e.isShadow()?(e.dispose(!1),this.respawnShadow_(),this.targetBlock()&&this.targetBlock().isShadow()&&this.serializeShadow(this.targetBlock())):(e=this.createShadowBlock(!1),this.serializeShadow(e),e&&e.dispose(!1)):(this.respawnShadow_(),this.targetBlock()&&this.targetBlock().isShadow()&&this.serializeShadow(this.targetBlock())))}createShadowBlock(e){var t=this.getSourceBlock();const r=this.getShadowState(),l=this.getShadowDom();if(t.isDeadOrDying()||!r&&!l)return null;if(r)return t=Gn(r,t.workspace,{parentConnection:e?this:void 0,isShadow:!0,recordUndo:!1});if(l){if(t=Ao(l,t.workspace),e)if(this.type===Ge.INPUT_VALUE){if(!t.outputConnection)throw Error("Shadow block is missing an output connection");if(!this.connect(t.outputConnection))throw Error("Could not connect shadow block to connection")}else if(this.type===Ge.NEXT_STATEMENT){if(!t.previousConnection)throw Error("Shadow block is missing previous connection");if(!this.connect(t.previousConnection))throw Error("Could not connect shadow block to connection")}else throw Error("Cannot connect a shadow block to a previous/output connection");return t}return null}serializeShadow(e){e&&(this.shadowDom=Ki(e),this.shadowState=Vt(e))}static getConnectionForOrphanedConnection(e,t){if(t.type===Ge.OUTPUT_VALUE)return _r(e,t.getSourceBlock());e=e.lastConnectionInStack(!0);const r=t.getConnectionChecker();return e&&r.canConnect(t,e,!1)?e:null}};Jt.CAN_CONNECT=0,Jt.REASON_SELF_CONNECTION=1,Jt.REASON_WRONG_TYPE=2,Jt.REASON_TARGET_NULL=3,Jt.REASON_CHECKS_FAILED=4,Jt.REASON_DIFFERENT_WORKSPACES=5,Jt.REASON_SHADOW_PARENT=6,Jt.REASON_DRAG_CHECKS_FAILED=7,Jt.REASON_PREVIOUS_AND_OUTPUT=8;var Jo=class{constructor(e,t,r){if(this.data=null,this.disposed=!1,this.hue=null,this.colour_="#000000",this.styleName_="",this.suppressPrefixSuffix=!1,this.previousConnection=this.nextConnection=this.outputConnection=null,this.inputList=[],this.icons=[],this.disabledReasons=new Set,this.tooltip="",this.contextMenu=!0,this.parentBlock_=null,this.childBlocks_=[],this.editable=this.movable=this.deletable=!0,this.collapsed_=this.shadow=!1,this.outputShape_=null,this.rendered=this.isInsertionMarker_=this.initialized=this.disposing=!1,this.onchangeWrapper=this.helpUrl=null,this.statementInputCount=0,this.workspace=e,this.id=r&&!e.getBlockById(r)?r:k(),e.setBlockById(this.id,this),this.xy=new Ae(0,0),this.isInFlyout=e.isFlyout,this.isInMutator=e.isMutator,this.RTL=e.RTL,t){if(this.type=t,r=or[t],!r||typeof r!="object")throw TypeError("Invalid block definition for type: "+t);Object.assign(this,r)}e.addTopBlock(this),e.addTypedBlock(this),new.target===Jo&&this.doInit_()}doInit_(){const e=s.getGroup$$module$build$src$core$events$utils();e||s.setGroup$$module$build$src$core$events$utils(!0);const t=Y();try{typeof this.init=="function"&&(s.setRecordUndo$$module$build$src$core$events$utils(!1),this.init(),s.setRecordUndo$$module$build$src$core$events$utils(t)),re()&&te(new(Ce(ge.BLOCK_CREATE))(this))}finally{s.setGroup$$module$build$src$core$events$utils(e),s.setRecordUndo$$module$build$src$core$events$utils(t)}this.inputsInlineDefault=this.inputsInline,typeof this.onchange=="function"&&this.setOnChange(this.onchange)}dispose(e=!1){this.disposing=!0,this.onchangeWrapper&&this.workspace.removeChangeListener(this.onchangeWrapper),this.unplug(e),re()&&te(new(Ce(ge.BLOCK_DELETE))(this)),this.workspace.removeTopBlock(this),this.disposeInternal()}disposeInternal(){this.disposing=!0,this.onchangeWrapper&&this.workspace.removeChangeListener(this.onchangeWrapper),this.workspace.removeTypedBlock(this),this.workspace.removeBlockById(this.id),typeof this.destroy=="function"&&this.destroy(),this.childBlocks_.forEach(e=>e.disposeInternal()),this.inputList.forEach(e=>e.dispose()),this.inputList.length=0,this.getConnections_(!0).forEach(e=>e.dispose()),this.disposed=!0}isDeadOrDying(){return this.disposing||this.disposed}initModel(){if(!this.initialized){for(const e of this.inputList)e.initModel();this.initialized=!0}}unplug(e){this.outputConnection&&this.unplugFromRow(e),this.previousConnection&&this.unplugFromStack(e)}unplugFromRow(e){let t=null,r;(r=this.outputConnection)!=null&&r.isConnected()&&(t=this.outputConnection.targetConnection,this.outputConnection.disconnect()),t&&e&&(e=this.getOnlyValueConnection())&&e.isConnected()&&!e.targetBlock().isShadow()&&(e=e.targetConnection,e==null||e.disconnect(),this.workspace.connectionChecker.canConnect(e,t,!1)?t.connect(e):e==null||e.onFailedConnect(t))}getOnlyValueConnection(){let e=null;for(let t=0;t<this.inputList.length;t++){const r=this.inputList[t].connection;if(r&&r.type===Ge.INPUT_VALUE&&r.targetConnection){if(e)return null;e=r}}return e}unplugFromStack(e){let t=null;var r;if((r=this.previousConnection)!=null&&r.isConnected()&&(t=this.previousConnection.targetConnection,this.previousConnection.disconnect()),r=this.getNextBlock(),e&&r&&!r.isShadow()){let l,p;e=(p=(l=this.nextConnection)==null?void 0:l.targetConnection)!=null?p:null,e==null||e.disconnect(),t&&this.workspace.connectionChecker.canConnect(t,e,!1)&&t.connect(e)}}getConnections_(e){e=[],this.outputConnection&&e.push(this.outputConnection),this.previousConnection&&e.push(this.previousConnection),this.nextConnection&&e.push(this.nextConnection);for(let t=0,r;r=this.inputList[t];t++)r.connection&&e.push(r.connection);return e}lastConnectionInStack(e){let t=this.nextConnection;for(;t;){const r=t.targetBlock();if(!r||e&&r.isShadow())return t;t=r.nextConnection}return null}bumpNeighbours(){}getParent(){return this.parentBlock_}getInputWithBlock(e){for(let t=0,r;r=this.inputList[t];t++)if(r.connection&&r.connection.targetBlock()===e)return r;return null}getSurroundParent(){let e=this,t;do if(t=e,e=e.getParent(),!e)return null;while(e.getNextBlock()===t);return e}getNextBlock(){return this.nextConnection&&this.nextConnection.targetBlock()}getPreviousBlock(){return this.previousConnection&&this.previousConnection.targetBlock()}getRootBlock(){let e,t=this;do e=t,t=e.parentBlock_;while(t);return e}getTopStackBlock(){let e=this,t;do t=e.getPreviousBlock();while(t&&t.getNextBlock()===e&&(e=t));return e}getChildren(e){if(!e)return this.childBlocks_;e=[];for(let r=0,l;l=this.inputList[r];r++)if(l.connection){var t=l.connection.targetBlock();t&&e.push(t)}return(t=this.getNextBlock())&&e.push(t),e}setParent(e){if(e!==this.parentBlock_){var t=this.previousConnection&&this.previousConnection.targetBlock()||this.outputConnection&&this.outputConnection.targetBlock(),r=!!t;if(r&&e&&t!==e)throw Error("Block connected to superior one that is not new parent.");if(!r&&e)throw Error("Block not connected to new parent.");if(r&&!e)throw Error("Cannot set parent to null while block is still connected to superior block.");this.parentBlock_?ue(this.parentBlock_.childBlocks_,this):this.workspace.removeTopBlock(this),(this.parentBlock_=e)?e.childBlocks_.push(this):this.workspace.addTopBlock(this)}}getDescendants(e){const t=[this],r=this.getChildren(e);for(let l,p=0;l=r[p];p++)t.push(...l.getDescendants(e));return t}isDeletable(){return this.deletable&&!this.shadow&&!this.isDeadOrDying()&&!this.workspace.options.readOnly}isOwnDeletable(){return this.deletable}setDeletable(e){this.deletable=e}isMovable(){return this.movable&&!this.shadow&&!this.isDeadOrDying()&&!this.workspace.options.readOnly}isOwnMovable(){return this.movable}setMovable(e){this.movable=e}isDuplicatable(){return this.workspace.hasBlockLimits()?this.workspace.isCapacityAvailable(It(this,!0)):!0}isShadow(){return this.shadow}setShadow(e){this.shadow=e}isInsertionMarker(){return this.isInsertionMarker_}setInsertionMarker(e){this.isInsertionMarker_=e}isEditable(){return this.editable&&!this.isDeadOrDying()&&!this.workspace.options.readOnly}isOwnEditable(){return this.editable}setEditable(e){this.editable=e;for(let t=0,r;r=this.inputList[t];t++)for(let l=0,p;p=r.fieldRow[l];l++)p.updateEditable()}isDisposed(){return this.disposed}isSimpleReporter(){if(!this.outputConnection)return!1;for(const e of this.inputList)if(e.connection||1<e.fieldRow.length)return!1;return!0}getMatchingConnection(e,t){const r=this.getConnections_(!0);if(e=e.getConnections_(!0),r.length!==e.length)throw Error("Connection lists did not match in length.");for(let l=0;l<e.length;l++)if(e[l]===t)return r[l];return null}setHelpUrl(e){this.helpUrl=e}setTooltip(e){this.tooltip=e}getTooltip(){return bl(this)}getColour(){return this.colour_}getStyleName(){return this.styleName_}getHue(){return this.hue}setColour(e){e=yl(e),this.hue=e.hue,this.colour_=e.hex}setStyle(e){this.styleName_=e}setOnChange(e){if(e&&typeof e!="function")throw Error("onchange must be a function.");this.onchangeWrapper&&this.workspace.removeChangeListener(this.onchangeWrapper),this.onchange=e,this.onchangeWrapper=e.bind(this),this.workspace.addChangeListener(this.onchangeWrapper)}getField(e){if(typeof e!="string")throw TypeError("Block.prototype.getField expects a string with the field name but received "+(e===void 0?"nothing":e+" of type "+typeof e)+" instead");for(let t=0,r;r=this.inputList[t];t++)for(let l=0,p;p=r.fieldRow[l];l++)if(p.name===e)return p;return null}getVars(){const e=[];for(let t=0,r;r=this.inputList[t];t++)for(let l=0,p;p=r.fieldRow[l];l++)p.referencesVariables()&&e.push(p.getValue());return e}getVarModels(){const e=[];for(let t=0,r;r=this.inputList[t];t++)for(let l=0,p;p=r.fieldRow[l];l++)if(p.referencesVariables()){const v=this.workspace.getVariableById(p.getValue());v&&e.push(v)}return e}updateVarName(e){for(let t=0,r;r=this.inputList[t];t++)for(let l=0,p;p=r.fieldRow[l];l++)p.referencesVariables()&&e.getId()===p.getValue()&&p.refreshVariableName()}renameVarById(e,t){for(let r=0,l;l=this.inputList[r];r++)for(let p=0,v;v=l.fieldRow[p];p++)v.referencesVariables()&&e===v.getValue()&&v.setValue(t)}getFieldValue(e){return(e=this.getField(e))?e.getValue():null}setFieldValue(e,t){const r=this.getField(t);if(!r)throw Error('Field "'+t+'" not found.');r.setValue(e)}setPreviousStatement(e,t){if(e)t===void 0&&(t=null),this.previousConnection||(this.previousConnection=this.makeConnection_(Ge.PREVIOUS_STATEMENT)),this.previousConnection.setCheck(t);else if(this.previousConnection){if(this.previousConnection.isConnected())throw Error("Must disconnect previous statement before removing connection.");this.previousConnection.dispose(),this.previousConnection=null}}setNextStatement(e,t){if(e)t===void 0&&(t=null),this.nextConnection||(this.nextConnection=this.makeConnection_(Ge.NEXT_STATEMENT)),this.nextConnection.setCheck(t);else if(this.nextConnection){if(this.nextConnection.isConnected())throw Error("Must disconnect next statement before removing connection.");this.nextConnection.dispose(),this.nextConnection=null}}setOutput(e,t){if(e)t===void 0&&(t=null),this.outputConnection||(this.outputConnection=this.makeConnection_(Ge.OUTPUT_VALUE)),this.outputConnection.setCheck(t);else if(this.outputConnection){if(this.outputConnection.isConnected())throw Error("Must disconnect output value before removing connection.");this.outputConnection.dispose(),this.outputConnection=null}}setInputsInline(e){this.inputsInline!==e&&(te(new(Ce(ge.BLOCK_CHANGE))(this,"inline",null,this.inputsInline,e)),this.inputsInline=e)}getInputsInline(){if(this.inputsInline!==void 0)return this.inputsInline;for(var e=1;e<this.inputList.length;e++)if(this.inputList[e-1]instanceof Di&&this.inputList[e]instanceof Di)return!1;for(e=1;e<this.inputList.length;e++)if(this.inputList[e-1]instanceof s.ValueInput$$module$build$src$core$inputs$value_input&&this.inputList[e]instanceof Di)return!0;for(e=0;e<this.inputList.length;e++)if(this.inputList[e]instanceof ho)return!0;return!1}setOutputShape(e){this.outputShape_=e}getOutputShape(){return this.outputShape_}isEnabled(){return this.disabledReasons.size===0}get disabled(){return C("disabled","v11","v12","the isEnabled or hasDisabledReason methods of Block"),this.hasDisabledReason(Hs)}set disabled(e){C("disabled","v11","v12","the setDisabledReason method of Block"),this.setDisabledReason(e,Hs)}setEnabled(e){C("setEnabled","v11","v12","the setDisabledReason method of Block"),this.setDisabledReason(!e,Hs)}setDisabledReason(e,t){e||this.workspace.options.disable||!this.hasDisabledReason(Hs)||t==Hs||this.setDisabledReason(!1,Hs),this.disabledReasons.has(t)!==e&&(e?this.disabledReasons.add(t):this.disabledReasons.delete(t),e=new(Ce(ge.BLOCK_CHANGE))(this,"disabled",null,!e,e),e.setDisabledReason(t),te(e))}getInheritedDisabled(){let e=this.getSurroundParent();for(;e;){if(!e.isEnabled())return!0;e=e.getSurroundParent()}return!1}hasDisabledReason(e){return this.disabledReasons.has(e)}getDisabledReasons(){return this.disabledReasons}isCollapsed(){return this.collapsed_}setCollapsed(e){this.collapsed_!==e&&(te(new(Ce(ge.BLOCK_CHANGE))(this,"collapsed",null,this.collapsed_,e)),this.collapsed_=e)}toString(e,t){t=this.toTokens(t);for(let l=2;l<t.length;l++)t[l-2]==="("&&t[l]===")"&&(t[l-2]=t[l-1],t.splice(l-1,2));let r="";return t=t.reduce((l,p)=>(l=l+(r==="("||p===")"?"":" ")+p,r=p[p.length-1],l),""),t=t.trim()||"???",e&&t.length>e&&(t=t.substring(0,e-3)+"..."),t}toTokens(e="?"){const t=[];for(const l of this.inputList)if(l.name!=tu){for(const p of l.fieldRow)t.push(p.getText());if(l.connection){const p=l.connection.targetBlock();if(p){var r=l.connection;let v=r.getCheck();!v&&r.targetConnection&&(v=r.targetConnection.getCheck()),(r=!!v&&(v.includes("Boolean")||v.includes("Number")))&&t.push("("),t.push(...p.toTokens(e)),r&&t.push(")")}else t.push(e)}}return t}appendValueInput(e){return this.appendInput(new s.ValueInput$$module$build$src$core$inputs$value_input(e,this))}appendStatementInput(e){return this.statementInputCount++,this.appendInput(new kr(e,this))}appendDummyInput(e=""){return this.appendInput(new Di(e,this))}appendEndRowInput(e=""){return this.appendInput(new ho(e,this))}appendInput(e){return this.inputList.push(e),e}appendInputFromRegistry(e,t){return(e=b(Ne.INPUT,e,!1))?this.appendInput(new e(t,this)):null}jsonInit(e){var t=e.type?'Block "'+e.type+'": ':"";if(e.output&&e.previousStatement)throw Error(t+"Must not have both an output and a previousStatement.");for(var r=0;e["args"+r];){if(e["message"+r]===void 0)throw Error(t+`args${r} must have a corresponding message (message${r}).`);r++}if(e.style&&e.style.hat&&(this.hat=e.style.hat,e.style=null),e.style&&e.colour)throw Error(t+"Must not have both a colour and a style.");for(e.style?this.jsonInitStyle(e,t):this.jsonInitColour(e,t),r=0;e["message"+r]!==void 0;)this.interpolate(e["message"+r],e["args"+r]||[],e["implicitAlign"+r]||e["lastDummyAlign"+r],t),r++;if(e.inputsInline!==void 0&&(s.disable$$module$build$src$core$events$utils(),this.setInputsInline(e.inputsInline),s.enable$$module$build$src$core$events$utils()),e.output!==void 0&&this.setOutput(!0,e.output),e.outputShape!==void 0&&this.setOutputShape(e.outputShape),e.previousStatement!==void 0&&this.setPreviousStatement(!0,e.previousStatement),e.nextStatement!==void 0&&this.setNextStatement(!0,e.nextStatement),e.tooltip!==void 0&&(r=bt(e.tooltip),this.setTooltip(r)),e.enableContextMenu!==void 0&&(this.contextMenu=!!e.enableContextMenu),e.suppressPrefixSuffix!==void 0&&(this.suppressPrefixSuffix=!!e.suppressPrefixSuffix),e.helpUrl!==void 0&&(r=bt(e.helpUrl),this.setHelpUrl(r)),typeof e.extensions=="string"&&(console.warn(t+"JSON attribute 'extensions' should be an array of strings. Found raw string in JSON for '"+e.type+"' block."),e.extensions=[e.extensions]),e.mutator!==void 0&&cd(e.mutator,this,!0),e=e.extensions,Array.isArray(e))for(t=0;t<e.length;t++)cd(e[t],this,!1)}jsonInitColour(e,t){if("colour"in e)if(e.colour===void 0)console.warn(t+"Undefined colour value.");else{e=e.colour;try{this.setColour(e)}catch{console.warn(t+"Illegal colour value: ",e)}}}jsonInitStyle(e,t){e=e.style;try{this.setStyle(e)}catch{console.warn(t+"Style does not exist: ",e)}}mixin(e,t){if(t!==void 0&&typeof t!="boolean")throw Error("opt_disableCheck must be a boolean if provided");if(!t){t=[];for(const r in e)this[r]!==void 0&&t.push(r);if(t.length)throw Error("Mixin will overwrite block members: "+JSON.stringify(t))}Object.assign(this,e)}interpolate(e,t,r,l){e=Zn(e),this.validateTokens(e,t.length),t=this.interpolateArguments(e,t,r),r=[];for(let p=0,v;v=t[p];p++)if(this.isInputKeyword(v.type)){if(e=this.inputFromJson(v,l)){for(let O=0,G;G=r[O];O++)e.appendField(G[0],G[1]);r.length=0}}else(e=this.fieldFromJson(v))&&r.push([e,v.name])}validateTokens(e,t){const r=[];let l=0;for(let p=0;p<e.length;p++){const v=e[p];if(typeof v=="number"){if(1>v||v>t)throw Error('Block "'+this.type+'": Message index %'+v+" out of range.");if(r[v])throw Error('Block "'+this.type+'": Message index %'+v+" duplicated.");r[v]=!0,l++}}if(l!==t)throw Error('Block "'+this.type+'": Message does not reference all '+t+" arg(s).")}interpolateArguments(e,t,r){const l=[];for(let v=0;v<e.length;v++){var p=e[v];if(typeof p=="number"&&(p=t[p-1]),typeof p=="string"){if(p===`
`)p={type:"input_end_row"},r&&(p.align=r);else if(p=this.stringToFieldJson(p),!p)continue}l.push(p)}return(e=l.length)&&!this.isInputKeyword(l[e-1].type)&&(e={type:"input_dummy"},r&&(e.align=r),l.push(e)),l}fieldFromJson(e){const t=s.fromJson$$module$build$src$core$field_registry(e);return!t&&e.alt?typeof e.alt=="string"?(e=this.stringToFieldJson(e.alt))?this.fieldFromJson(e):null:this.fieldFromJson(e.alt):t}inputFromJson(e,t){var r={LEFT:s.Align$$module$build$src$core$inputs$align.LEFT,RIGHT:s.Align$$module$build$src$core$inputs$align.RIGHT,CENTRE:s.Align$$module$build$src$core$inputs$align.CENTRE,CENTER:s.Align$$module$build$src$core$inputs$align.CENTRE};let l;switch(e.type){case"input_value":l=this.appendValueInput(e.name);break;case"input_statement":l=this.appendStatementInput(e.name);break;case"input_dummy":l=this.appendDummyInput(e.name);break;case"input_end_row":l=this.appendEndRowInput(e.name);break;default:l=this.appendInputFromRegistry(e.type,e.name)}return l?(e.check&&l.setCheck(e.check),e.align&&(r=r[e.align.toUpperCase()],r===void 0?console.warn(t+"Illegal align value: ",e.align):l.setAlign(r)),l):null}isInputKeyword(e){return e==="input_value"||e==="input_statement"||e==="input_dummy"||e==="input_end_row"||g(Ne.INPUT,e)}stringToFieldJson(e){return(e=e.trim())?{type:"field_label",text:e}:null}moveInputBefore(e,t){if(e!==t){var r=-1,l=t?-1:this.inputList.length;for(let p=0,v;v=this.inputList[p];p++)if(v.name===e){if(r=p,l!==-1)break}else if(t&&v.name===t&&(l=p,r!==-1))break;if(r===-1)throw Error('Named input "'+e+'" not found.');if(l===-1)throw Error('Reference input "'+t+'" not found.');this.moveNumberedInputBefore(r,l)}}moveNumberedInputBefore(e,t){if(e===t)throw Error("Can't move input to itself.");if(e>=this.inputList.length)throw RangeError("Input index "+e+" out of bounds.");if(t>this.inputList.length)throw RangeError("Reference input "+t+" out of bounds.");const r=this.inputList[e];this.inputList.splice(e,1),e<t&&t--,this.inputList.splice(t,0,r)}removeInput(e,t){for(let r=0,l;l=this.inputList[r];r++)if(l.name===e)return l instanceof kr&&this.statementInputCount--,l.dispose(),this.inputList.splice(r,1),!0;if(t)return!1;throw Error("Input not found: "+e)}getInput(e){for(let t=0,r;r=this.inputList[t];t++)if(r.name===e)return r;return null}getInputTargetBlock(e){return(e=this.getInput(e))&&e.connection&&e.connection.targetBlock()}getCommentText(){let e,t;return(t=(e=this.getIcon(ss.COMMENT))==null?void 0:e.getText())!=null?t:null}setCommentText(e){var t;let r;const l=(r=(t=this.getIcon(ss.COMMENT))==null?void 0:t.getText())!=null?r:null;if(l!==e){if(e!==null){if(t=this.getIcon(ss.COMMENT),!t){if(t=b(Ne.ICON,ss.COMMENT.toString(),!1),!t)throw Error("No comment icon class is registered, so a comment cannot be set");if(t=new t(this),!Zp(t))throw Error("The class registered as a comment icon does not conform to the ICommentIcon interface");t=this.addIcon(t)}s.disable$$module$build$src$core$events$utils(),t.setText(e),s.enable$$module$build$src$core$events$utils()}else this.removeIcon(ss.COMMENT);te(new(Ce(ge.BLOCK_CHANGE))(this,"comment",null,l,e))}}setWarningText(e,t){}setMutator(e){}addIcon(e){if(this.hasIcon(e.getType()))throw new gf(e);return this.icons.push(e),this.icons.sort((t,r)=>t.getWeight()-r.getWeight()),e}removeIcon(e){if(!this.hasIcon(e))return!1;let t;return(t=this.getIcon(e))==null||t.dispose(),this.icons=this.icons.filter(r=>!r.getType().equals(e)),!0}hasIcon(e){return this.icons.some(t=>t.getType().equals(e))}getIcon(e){return e instanceof ss?this.icons.find(t=>t.getType().equals(e)):this.icons.find(t=>t.getType().toString()===e)}getIcons(){return[...this.icons]}getRelativeToSurfaceXY(){return this.xy}moveBy(e,t,r){if(this.parentBlock_)throw Error("Block has parent");const l=new(Ce(ge.BLOCK_MOVE))(this);r&&l.setReason(r),this.xy.translate(e,t),l.recordNew(),te(l)}makeConnection_(e){return new Jt(this,e)}allInputsFilled(e){if(e===void 0&&(e=!0),!e&&this.isShadow())return!1;for(let r=0,l;l=this.inputList[r];r++)if(l.connection){var t=l.connection.targetBlock();if(!t||!t.allInputsFilled(e))return!1}return(t=this.getNextBlock())?t.allInputsFilled(e):!0}toDevString(){let e=this.type?'"'+this.type+'" block':"Block";return this.id&&(e+=' (id="'+this.id+'")'),e}};Jo.COLLAPSED_INPUT_NAME=tu,Jo.COLLAPSED_FIELD_NAME=Kd;var Ir=class{constructor(e,t,r,l){this.workspace=e,this.targetWorkspace=t,this.isFlyoutLabel=l,this.onMouseUpWrapper=null,this.height=this.width=0,this.cursorSvg=this.svgText=this.svgGroup=null,this.text=r.text,this.position=new Ae(0,0),this.callbackKey=r.callbackKey||r.callbackkey,this.cssClass=r["web-class"]||null,this.info=r}createDom(){var e=this.isFlyoutLabel?"blocklyFlyoutLabel":"blocklyFlyoutButton";this.cssClass&&(e+=" "+this.cssClass),this.svgGroup=ie(ae.G,{class:e},this.workspace.getCanvas());let t;this.isFlyoutLabel||(t=ie(ae.RECT,{class:"blocklyFlyoutButtonShadow",rx:Ir.BORDER_RADIUS,ry:Ir.BORDER_RADIUS,x:1,y:1},this.svgGroup)),e=ie(ae.RECT,{class:this.isFlyoutLabel?"blocklyFlyoutLabelBackground":"blocklyFlyoutButtonBackground",rx:Ir.BORDER_RADIUS,ry:Ir.BORDER_RADIUS},this.svgGroup);const r=ie(ae.TEXT,{class:this.isFlyoutLabel?"blocklyFlyoutLabelText":"blocklyText",x:0,y:0,"text-anchor":"middle"},this.svgGroup);var l=bt(this.text);this.workspace.RTL&&(l+="‏"),r.textContent=l,this.isFlyoutLabel&&(this.svgText=r,this.workspace.getThemeManager().subscribe(this.svgText,"flyoutForegroundColour","fill"));const p=zn(r,"fontSize"),v=zn(r,"fontWeight"),O=zn(r,"fontFamily");if(this.width=An(r,p,v,O),l=Bt(l,p,v,O),this.height=l.height,!this.isFlyoutLabel){this.width+=2*Ir.TEXT_MARGIN_X,this.height+=2*Ir.TEXT_MARGIN_Y;let G;(G=t)==null||G.setAttribute("width",String(this.width));let _e;(_e=t)==null||_e.setAttribute("height",String(this.height))}return e.setAttribute("width",String(this.width)),e.setAttribute("height",String(this.height)),r.setAttribute("x",String(this.width/2)),r.setAttribute("y",String(this.height/2-l.height/2+l.baseline)),this.updateTransform(),this.onMouseUpWrapper=He(this.svgGroup,"pointerup",this,this.onMouseUp),this.svgGroup}show(){this.updateTransform(),this.svgGroup.setAttribute("display","block")}updateTransform(){this.svgGroup.setAttribute("transform","translate("+this.position.x+","+this.position.y+")")}moveTo(e,t){this.position.x=e,this.position.y=t,this.updateTransform()}isLabel(){return this.isFlyoutLabel}getPosition(){return this.position}getButtonText(){return this.text}getTargetWorkspace(){return this.targetWorkspace}getWorkspace(){return this.workspace}dispose(){this.onMouseUpWrapper&&St(this.onMouseUpWrapper),this.svgGroup&&lt(this.svgGroup),this.svgText&&this.workspace.getThemeManager().unsubscribe(this.svgText)}setCursorSvg(e){e?this.svgGroup&&(this.svgGroup.appendChild(e),this.cursorSvg=e):this.cursorSvg=null}setMarkerSvg(){throw Error("Attempted to set a marker on a button.")}onMouseUp(e){(e=this.targetWorkspace.getGesture(e))&&e.cancel(),this.isFlyoutLabel&&this.callbackKey?console.warn("Labels should not have callbacks. Label text: "+this.text):this.isFlyoutLabel||this.callbackKey&&this.targetWorkspace.getButtonCallback(this.callbackKey)?this.isFlyoutLabel||(e=this.targetWorkspace.getButtonCallback(this.callbackKey))&&e(this):console.warn("Buttons should have callbacks. Button text: "+this.text)}};Ir.TEXT_MARGIN_X=5,Ir.TEXT_MARGIN_Y=2,Ir.BORDER_RADIUS=4,we(`
.blocklyFlyoutButton {
  fill: #888;
  cursor: default;
}

.blocklyFlyoutButtonShadow {
  fill: #666;
}

.blocklyFlyoutButton:hover {
  fill: #aaa;
}

.blocklyFlyoutLabel {
  cursor: default;
}

.blocklyFlyoutLabelBackground {
  opacity: 0;
}
`);var Ie=class{constructor(e,t,r){if(this.wsCoordinate=null,!t)throw Error("Cannot create a node without a location.");this.type=e,this.isConnectionLocation=Ie.isConnectionType(e),this.location=t,this.processParams(r||null)}processParams(e){e&&e.wsCoordinate&&(this.wsCoordinate=e.wsCoordinate)}getLocation(){return this.location}getType(){return this.type}getWsCoordinate(){return this.wsCoordinate}isConnection(){return this.isConnectionLocation}findNextForInput(){var e=this.location.getParentInput();const t=e.getSourceBlock();for(e=t.inputList.indexOf(e),e+=1;e<t.inputList.length;e++){const r=t.inputList[e],l=r.fieldRow;for(let p=0;p<l.length;p++){const v=l[p];if(v.isClickable()||Ie.NAVIGATE_ALL_FIELDS)return Ie.createFieldNode(v)}if(r.connection)return Ie.createInputNode(r)}return null}findNextForField(){var e=this.location,t=e.getParentInput();const r=e.getSourceBlock();if(!r)throw Error("The current AST location is not associated with a block");var l=r.inputList.indexOf(t);for(e=t.fieldRow.indexOf(e)+1;l<r.inputList.length;l++){t=r.inputList[l];const p=t.fieldRow;for(;e<p.length;){if(p[e].isClickable()||Ie.NAVIGATE_ALL_FIELDS)return Ie.createFieldNode(p[e]);e++}if(e=0,t.connection)return Ie.createInputNode(t)}return null}findPrevForInput(){const e=this.location.getParentInput(),t=e.getSourceBlock();for(var r=t.inputList.indexOf(e);0<=r;r--){var l=t.inputList[r];if(l.connection&&l!==e)return Ie.createInputNode(l);l=l.fieldRow;for(let p=l.length-1;0<=p;p--){const v=l[p];if(v.isClickable()||Ie.NAVIGATE_ALL_FIELDS)return Ie.createFieldNode(v)}}return null}findPrevForField(){var e=this.location;const t=e.getParentInput(),r=e.getSourceBlock();if(!r)throw Error("The current AST location is not associated with a block");var l=r.inputList.indexOf(t);for(e=t.fieldRow.indexOf(e)-1;0<=l;l--){var p=r.inputList[l];if(p.connection&&p!==t)return Ie.createInputNode(p);for(p=p.fieldRow;-1<e;){if(p[e].isClickable()||Ie.NAVIGATE_ALL_FIELDS)return Ie.createFieldNode(p[e]);e--}0<=l-1&&(e=r.inputList[l-1].fieldRow.length-1)}return null}navigateBetweenStacks(e){var t=this.getLocation();if(t.getSourceBlock){var r=t.getSourceBlock();r&&(t=r)}if(!t||t.isDeadOrDying())return null;if(t.workspace.isFlyout)return this.navigateFlyoutContents(e);r=t.getRootBlock(),t=r.workspace.getTopBlocks(!0);for(let l=0;l<t.length;l++)if(r.id===t[l].id)return e=l+(e?1:-1),e===-1||e===t.length?null:Ie.createStackNode(t[e]);throw Error("Couldn't find "+(e?"next":"previous")+" stack?!")}navigateFlyoutContents(e){let t;switch(this.getType()){case Ie.types.STACK:t=this.getLocation();var r=t.workspace.targetWorkspace;break;case Ie.types.BUTTON:t=this.getLocation(),r=t.getTargetWorkspace();break;default:return null}return r=r.getFlyout(),r&&(e=this.findNextLocationInFlyout(r.getContents(),t,e))?e.type==="button"&&e.button?Ie.createButtonNode(e.button):e.type==="block"&&e.block?Ie.createStackNode(e.block):null:null}findNextLocationInFlyout(e,t,r){const l=e.findIndex(p=>t instanceof Jo&&p.block===t||t instanceof Ir&&p.button===t);return 0>l?null:(r=r?l+1:l-1,r===-1||r===e.length?null:e[r])}findTopASTNodeForBlock(e){const t=Al(e);return t?Ie.createConnectionNode(t):Ie.createBlockNode(e)}getOutAstNodeForBlock(e){if(!e)return null;e=e.getTopStackBlock();const t=Al(e);return t&&t.targetConnection&&t.targetConnection.getParentInput()?Ie.createInputNode(t.targetConnection.getParentInput()):Ie.createStackNode(e)}findFirstFieldOrInput(e){e=e.inputList;for(let t=0;t<e.length;t++){const r=e[t],l=r.fieldRow;for(let p=0;p<l.length;p++){const v=l[p];if(v.isClickable()||Ie.NAVIGATE_ALL_FIELDS)return Ie.createFieldNode(v)}if(r.connection)return Ie.createInputNode(r)}return null}getSourceBlock(){return this.getType()===Ie.types.BLOCK?this.getLocation():this.getType()===Ie.types.STACK?this.getLocation():this.getType()===Ie.types.WORKSPACE||this.getType()===Ie.types.BUTTON?null:this.getLocation().getSourceBlock()}next(){switch(this.type){case Ie.types.STACK:return this.navigateBetweenStacks(!0);case Ie.types.OUTPUT:return Ie.createBlockNode(this.location.getSourceBlock());case Ie.types.FIELD:return this.findNextForField();case Ie.types.INPUT:return this.findNextForInput();case Ie.types.BLOCK:const e=this.location.nextConnection;if(!e)break;return Ie.createConnectionNode(e);case Ie.types.PREVIOUS:return Ie.createBlockNode(this.location.getSourceBlock());case Ie.types.NEXT:return Ie.createConnectionNode(this.location.targetConnection);case Ie.types.BUTTON:return this.navigateFlyoutContents(!0)}return null}in(){switch(this.type){case Ie.types.WORKSPACE:const e=this.location.getTopBlocks(!0);if(0<e.length)return Ie.createStackNode(e[0]);break;case Ie.types.STACK:return this.findTopASTNodeForBlock(this.location);case Ie.types.BLOCK:return this.findFirstFieldOrInput(this.location);case Ie.types.INPUT:return Ie.createConnectionNode(this.location.targetConnection)}return null}prev(){switch(this.type){case Ie.types.STACK:return this.navigateBetweenStacks(!1);case Ie.types.FIELD:return this.findPrevForField();case Ie.types.INPUT:return this.findPrevForInput();case Ie.types.BLOCK:var e=Al(this.location);if(!e)break;return Ie.createConnectionNode(e);case Ie.types.PREVIOUS:if((e=this.location.targetConnection)&&!e.getParentInput())return Ie.createConnectionNode(e);break;case Ie.types.NEXT:return Ie.createBlockNode(this.location.getSourceBlock());case Ie.types.BUTTON:return this.navigateFlyoutContents(!1)}return null}out(){switch(this.type){case Ie.types.STACK:var e=this.location,t=e.getRelativeToSurfaceXY();return t=new Ae(t.x,t.y+Ie.DEFAULT_OFFSET_Y),Ie.createWorkspaceNode(e.workspace,t);case Ie.types.OUTPUT:return e=this.location,(t=e.targetConnection)?Ie.createConnectionNode(t):Ie.createStackNode(e.getSourceBlock());case Ie.types.FIELD:if(e=this.location.getSourceBlock(),!e)throw Error("The current AST location is not associated with a block");return Ie.createBlockNode(e);case Ie.types.INPUT:return Ie.createBlockNode(this.location.getSourceBlock());case Ie.types.BLOCK:return this.getOutAstNodeForBlock(this.location);case Ie.types.PREVIOUS:return this.getOutAstNodeForBlock(this.location.getSourceBlock());case Ie.types.NEXT:return this.getOutAstNodeForBlock(this.location.getSourceBlock())}return null}static isConnectionType(e){switch(e){case Ie.types.PREVIOUS:case Ie.types.NEXT:case Ie.types.INPUT:case Ie.types.OUTPUT:return!0}return!1}static createFieldNode(e){return e?new Ie(Ie.types.FIELD,e):null}static createConnectionNode(e){if(!e)return null;const t=e.type;return t===Ge.INPUT_VALUE||t===Ge.NEXT_STATEMENT&&e.getParentInput()?Ie.createInputNode(e.getParentInput()):t===Ge.NEXT_STATEMENT?new Ie(Ie.types.NEXT,e):t===Ge.OUTPUT_VALUE?new Ie(Ie.types.OUTPUT,e):t===Ge.PREVIOUS_STATEMENT?new Ie(Ie.types.PREVIOUS,e):null}static createInputNode(e){return e&&e.connection?new Ie(Ie.types.INPUT,e.connection):null}static createBlockNode(e){return e?new Ie(Ie.types.BLOCK,e):null}static createStackNode(e){return e?new Ie(Ie.types.STACK,e):null}static createButtonNode(e){return e?new Ie(Ie.types.BUTTON,e):null}static createWorkspaceNode(e,t){return t&&e?new Ie(Ie.types.WORKSPACE,e,{wsCoordinate:t}):null}static createTopNode(e){const t=Al(e);return t?Ie.createConnectionNode(t):Ie.createBlockNode(e)}};Ie.NAVIGATE_ALL_FIELDS=!1,Ie.DEFAULT_OFFSET_Y=-20,function(e){e=e.types||(e.types={}),e.FIELD="field",e.BLOCK="block",e.INPUT="input",e.OUTPUT="output",e.NEXT="next",e.PREVIOUS="previous",e.STACK="stack",e.WORKSPACE="workspace",e.BUTTON="button"}(Ie);var yf=class extends Os{constructor(e,t,r,l){let p=e?e.workspace.id:void 0;l&&l.getType()===Ie.types.WORKSPACE&&(p=l.getLocation().id),super(p),this.type=ge.MARKER_MOVE,this.blockId=e==null?void 0:e.id,this.oldNode=r||void 0,this.newNode=l,this.isCursor=t}toJson(){const e=super.toJson();if(this.isCursor===void 0)throw Error("Whether this is a cursor event or not is undefined. Either pass a value to the constructor, or call fromJson");if(!this.newNode)throw Error("The new node is undefined. Either pass a node to the constructor, or call fromJson");return e.isCursor=this.isCursor,e.blockId=this.blockId,e.oldNode=this.oldNode,e.newNode=this.newNode,e}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new yf),t.isCursor=e.isCursor,t.blockId=e.blockId,t.oldNode=e.oldNode,t.newNode=e.newNode,t}};i(Ne.EVENT,ge.MARKER_MOVE,yf);var By="blocklyCursor",y$="blocklyMarker",Py=.75,_f=class{constructor(e,t,r){this.workspace=e,this.marker=r,this.markerSvgRect_=this.markerSvgLine_=this.markerInput_=this.markerBlock_=this.svgGroup_=this.markerSvg_=this.currentMarkerSvg=this.parent=null,this.constants_=t,e=this.isCursor()?this.constants_.CURSOR_COLOUR:this.constants_.MARKER_COLOUR,this.colour_=r.colour||e}getSvgRoot(){return this.svgGroup_}getMarker(){return this.marker}isCursor(){return this.marker.type==="cursor"}createDom(){const e=this.isCursor()?By:y$;return this.svgGroup_=ie(ae.G,{class:e}),this.createDomInternal_(),this.svgGroup_}setParent_(e){this.isCursor()?(this.parent&&this.parent.setCursorSvg(null),e.setCursorSvg(this.getSvgRoot())):(this.parent&&this.parent.setMarkerSvg(null),e.setMarkerSvg(this.getSvgRoot())),this.parent=e}draw(e,t){if(t){this.constants_=this.workspace.getRenderer().getConstants();var r=this.isCursor()?this.constants_.CURSOR_COLOUR:this.constants_.MARKER_COLOUR;this.colour_=this.marker.colour||r,this.applyColour_(t),this.showAtLocation_(t),this.fireMarkerEvent(e,t),e=this.currentMarkerSvg.childNodes[0],e!==void 0&&e.beginElement&&e.beginElement()}else this.hide()}showAtLocation_(e){const t=e.getLocation().type;e.getType()===Ie.types.BLOCK?this.showWithBlock_(e):e.getType()===Ie.types.OUTPUT?this.showWithOutput_(e):t===Ge.INPUT_VALUE?this.showWithInput_(e):t===Ge.NEXT_STATEMENT?this.showWithNext_(e):e.getType()===Ie.types.PREVIOUS?this.showWithPrevious_(e):e.getType()===Ie.types.FIELD?this.showWithField_(e):e.getType()===Ie.types.WORKSPACE?this.showWithCoordinates_(e):e.getType()===Ie.types.STACK?this.showWithStack_(e):e.getType()===Ie.types.BUTTON&&this.showWithButton_(e)}showWithBlockPrevOutput(e){e=e.getSourceBlock();const t=e.width;var r=e.height,l=r*Py;const p=this.constants_.CURSOR_BLOCK_PADDING;e.previousConnection?(r=this.constants_.shapeFor(e.previousConnection),this.positionPrevious_(t,p,l,r)):e.outputConnection?(l=this.constants_.shapeFor(e.outputConnection),this.positionOutput_(t,r,l)):this.positionBlock_(t,p,l),this.setParent_(e),this.showCurrent_()}showWithBlock_(e){this.showWithBlockPrevOutput(e)}showWithPrevious_(e){this.showWithBlockPrevOutput(e)}showWithOutput_(e){this.showWithBlockPrevOutput(e)}showWithCoordinates_(e){var t=e.getWsCoordinate();e=t.x,t=t.y,this.workspace.RTL&&(e-=this.constants_.CURSOR_WS_WIDTH),this.positionLine_(e,t,this.constants_.CURSOR_WS_WIDTH),this.setParent_(this.workspace),this.showCurrent_()}showWithField_(e){e=e.getLocation();const t=e.getSize().width,r=e.getSize().height;this.positionRect_(0,0,t,r),this.setParent_(e),this.showCurrent_()}showWithInput_(e){e=e.getLocation();const t=e.getSourceBlock();this.positionInput_(e),this.setParent_(t),this.showCurrent_()}showWithNext_(e){var t=e.getLocation();e=t.getSourceBlock();let r=0;t=t.getOffsetInBlock().y;const l=e.getHeightWidth().width;this.workspace.RTL&&(r=-l),this.positionLine_(r,t,l),this.setParent_(e),this.showCurrent_()}showWithStack_(e){e=e.getLocation();var t=e.getHeightWidth();const r=t.width+this.constants_.CURSOR_STACK_PADDING;t=t.height+this.constants_.CURSOR_STACK_PADDING;const l=-this.constants_.CURSOR_STACK_PADDING/2,p=-this.constants_.CURSOR_STACK_PADDING/2;let v=l;this.workspace.RTL&&(v=-(r+l)),this.positionRect_(v,p,r,t),this.setParent_(e),this.showCurrent_()}showWithButton_(e){e=e.getLocation();const t=e.width+this.constants_.CURSOR_STACK_PADDING,r=e.height+this.constants_.CURSOR_STACK_PADDING,l=-this.constants_.CURSOR_STACK_PADDING/2,p=-this.constants_.CURSOR_STACK_PADDING/2;let v=l;this.workspace.RTL&&(v=-(t+l)),this.positionRect_(v,p,t,r),this.setParent_(e),this.showCurrent_()}showCurrent_(){this.hide(),this.currentMarkerSvg&&(this.currentMarkerSvg.style.display="")}positionBlock_(e,t,r){if(e=In(-t,r)+Ye("V",-t)+Ye("H",e+2*t)+Ye("V",r),!this.markerBlock_)throw Error("createDom should be called before positioning the marker");this.markerBlock_.setAttribute("d",e),this.workspace.RTL&&this.flipRtl(this.markerBlock_),this.currentMarkerSvg=this.markerBlock_}positionInput_(e){const t=e.getOffsetInBlock().x,r=e.getOffsetInBlock().y;e=us(0,0)+this.constants_.shapeFor(e).pathDown,this.markerInput_.setAttribute("d",e),this.markerInput_.setAttribute("transform","translate("+t+","+r+")"+(this.workspace.RTL?" scale(-1 1)":"")),this.currentMarkerSvg=this.markerInput_}positionLine_(e,t,r){if(!this.markerSvgLine_)throw Error("createDom should be called before positioning the line");this.markerSvgLine_.setAttribute("x",`${e}`),this.markerSvgLine_.setAttribute("y",`${t}`),this.markerSvgLine_.setAttribute("width",`${r}`),this.currentMarkerSvg=this.markerSvgLine_}positionOutput_(e,t,r){if(!this.markerBlock_)throw Error("createDom should be called before positioning the output");e=In(e,0)+Ye("h",-(e-r.width))+Ye("v",this.constants_.TAB_OFFSET_FROM_TOP)+r.pathDown+Ye("V",t)+Ye("H",e),this.markerBlock_.setAttribute("d",e),this.workspace.RTL&&this.flipRtl(this.markerBlock_),this.currentMarkerSvg=this.markerBlock_}positionPrevious_(e,t,r,l){if(!this.markerBlock_)throw Error("createDom should be called before positioning the previous connection marker");e=In(-t,r)+Ye("V",-t)+Ye("H",this.constants_.NOTCH_OFFSET_LEFT)+l.pathLeft+Ye("H",e+2*t)+Ye("V",r),this.markerBlock_.setAttribute("d",e),this.workspace.RTL&&this.flipRtl(this.markerBlock_),this.currentMarkerSvg=this.markerBlock_}positionRect_(e,t,r,l){if(!this.markerSvgRect_)throw Error("createDom should be called before positioning the rect");this.markerSvgRect_.setAttribute("x",`${e}`),this.markerSvgRect_.setAttribute("y",`${t}`),this.markerSvgRect_.setAttribute("width",`${r}`),this.markerSvgRect_.setAttribute("height",`${l}`),this.currentMarkerSvg=this.markerSvgRect_}flipRtl(e){e.setAttribute("transform","scale(-1 1)")}hide(){if(!(this.markerSvgLine_&&this.markerSvgRect_&&this.markerInput_&&this.markerBlock_))throw Error("createDom should be called before hiding the marker");this.markerSvgLine_.style.display="none",this.markerSvgRect_.style.display="none",this.markerInput_.style.display="none",this.markerBlock_.style.display="none"}fireMarkerEvent(e,t){const r=t.getSourceBlock();e=new(Ce(ge.MARKER_MOVE))(r,this.isCursor(),e,t),te(e)}getBlinkProperties_(){return{attributeType:"XML",attributeName:"fill",dur:"1s",values:this.colour_+";transparent;transparent;",repeatCount:"indefinite"}}createDomInternal_(){if(this.markerSvg_=ie(ae.G,{width:this.constants_.CURSOR_WS_WIDTH,height:this.constants_.WS_CURSOR_HEIGHT},this.svgGroup_),this.markerSvgLine_=ie(ae.RECT,{width:this.constants_.CURSOR_WS_WIDTH,height:this.constants_.WS_CURSOR_HEIGHT},this.markerSvg_),this.markerSvgRect_=ie(ae.RECT,{class:"blocklyVerticalMarker",rx:10,ry:10},this.markerSvg_),this.markerInput_=ie(ae.PATH,{transform:""},this.markerSvg_),this.markerBlock_=ie(ae.PATH,{transform:"",fill:"none","stroke-width":this.constants_.CURSOR_STROKE_WIDTH},this.markerSvg_),this.hide(),this.isCursor()){const e=this.getBlinkProperties_();ie(ae.ANIMATE,e,this.markerSvgLine_),ie(ae.ANIMATE,e,this.markerInput_),ie(ae.ANIMATE,Object.assign({},e,{attributeName:"stroke"}),this.markerBlock_)}return this.markerSvg_}applyColour_(e){if(!(this.markerSvgLine_&&this.markerSvgRect_&&this.markerInput_&&this.markerBlock_))throw Error("createDom should be called before applying color to the markerj");this.markerSvgLine_.setAttribute("fill",this.colour_),this.markerSvgRect_.setAttribute("stroke",this.colour_),this.markerInput_.setAttribute("fill",this.colour_),this.markerBlock_.setAttribute("stroke",this.colour_),this.isCursor()&&(e=this.colour_+";transparent;transparent;",this.markerSvgLine_.firstElementChild.setAttribute("values",e),this.markerInput_.firstElementChild.setAttribute("values",e),this.markerBlock_.firstElementChild.setAttribute("values",e))}dispose(){this.svgGroup_&&lt(this.svgGroup_)}},ch=class{constructor(e,t,r){this.markerSvg=this.cursorSvg=null,this.connectionHighlights=new WeakMap,this.highlightOffsets=new WeakMap,this.constants=r,this.style=t,this.svgRoot=e,this.svgPath=ie(ae.PATH,{class:"blocklyPath"},this.svgRoot)}setPath(e){this.svgPath.setAttribute("d",e)}flipRTL(){this.svgPath.setAttribute("transform","scale(-1 1)")}setCursorSvg(e){e?(this.svgRoot.appendChild(e),this.cursorSvg=e):this.cursorSvg=null}setMarkerSvg(e){e?(this.cursorSvg?this.svgRoot.insertBefore(e,this.cursorSvg):this.svgRoot.appendChild(e),this.markerSvg=e):this.markerSvg=null}applyColour(e){this.svgPath.setAttribute("stroke",this.style.colourTertiary),this.svgPath.setAttribute("fill",this.style.colourPrimary),this.updateShadow_(e.isShadow()),this.updateDisabled_(!e.isEnabled()||e.getInheritedDisabled())}setStyle(e){this.style=e}setClass_(e,t){e&&(t?Pe(this.svgRoot,e):it(this.svgRoot,e))}updateHighlighted(e){e?this.svgPath.setAttribute("filter","url(#"+this.constants.embossFilterId+")"):this.svgPath.setAttribute("filter","none")}updateShadow_(e){e&&(this.svgPath.setAttribute("stroke","none"),this.svgPath.setAttribute("fill",this.style.colourSecondary))}updateDisabled_(e){this.setClass_("blocklyDisabled",e),e&&this.svgPath.setAttribute("fill","url(#"+this.constants.disabledPatternId+")")}updateSelected(e){this.setClass_("blocklySelected",e)}updateDraggingDelete(e){this.setClass_("blocklyDraggingDelete",e)}updateInsertionMarker(e){this.setClass_("blocklyInsertionMarker",e)}updateMovable(e){this.setClass_("blocklyDraggable",e)}updateReplacementFade(e){this.setClass_("blocklyReplaceable",e)}updateShapeForInputHighlight(e,t){}addConnectionHighlight(e,t,r,l){if(this.connectionHighlights.has(e)){if(this.currentHighlightMatchesNew(e,t,r))return;this.removeConnectionHighlight(e)}t=ie(ae.PATH,{class:"blocklyHighlightedConnectionPath",d:t,transform:`translate(${r.x}, ${r.y})`+(l?" scale(-1 1)":"")},this.svgRoot),this.connectionHighlights.set(e,t)}currentHighlightMatchesNew(e,t,r){let l;const p=(l=this.connectionHighlights.get(e))==null?void 0:l.getAttribute("d");return e=this.highlightOffsets.get(e),p===t&&Ae.equals(e,r)}removeConnectionHighlight(e){const t=this.connectionHighlights.get(e);t&&(lt(t),this.connectionHighlights.delete(e))}},Vr=class{constructor(e){this.activeCandidate=this.lastMarker=this.lastOnStack=null,this.wouldDeleteBlock=!1,this.fadedBlock=this.highlightedBlock=this.markerConnection=null,s.setSelected$$module$build$src$core$common(e),this.topBlock=e,this.workspace=e.workspace,this.firstMarker=this.createMarkerBlock(this.topBlock),this.availableConnections=this.initAvailableConnections(),this.lastOnStack&&(this.lastMarker=this.createMarkerBlock(this.lastOnStack.getSourceBlock()))}dispose(){this.availableConnections.length=0,this.disposeInsertionMarker(this.firstMarker),this.disposeInsertionMarker(this.lastMarker)}updateAvailableConnections(){this.availableConnections=this.initAvailableConnections()}wouldConnectBlock(){return!!this.activeCandidate}applyConnections(){if(this.activeCandidate){s.disable$$module$build$src$core$events$utils(),this.hidePreview(),s.enable$$module$build$src$core$events$utils();var{local:e,closest:t}=this.activeCandidate;e.connect(t);var r=e.isSuperior()?t:e,l=this.topBlock.getRootBlock();cs().then(()=>{No(r.getSourceBlock()),setTimeout(()=>{l.bringToFront()},0)})}}update(e,t){const r=this.getCandidate(e);((this.wouldDeleteBlock=this.shouldDelete(!!r,t))||this.shouldUpdatePreviews(r,e))&&(s.disable$$module$build$src$core$events$utils(),this.maybeHidePreview(r),this.maybeShowPreview(r),s.enable$$module$build$src$core$events$utils())}createMarkerBlock(e){s.disable$$module$build$src$core$events$utils();let t;try{const r=Vt(e,{addCoordinates:!1,addInputBlocks:!1,addNextBlocks:!1,doFullSerialization:!1});if(!r)throw Error(`Failed to serialize source block. ${e.toDevString()}`);t=Ui(r,this.workspace);for(const l of t.getDescendants(!1))l.setInsertionMarker(!0);t.initSvg(),t.getSvgRoot().setAttribute("visibility","hidden")}finally{s.enable$$module$build$src$core$events$utils()}return t}initAvailableConnections(){const e=this.topBlock.getConnections_(!1),t=this.topBlock.lastConnectionInStack(!0);return t&&t!==this.topBlock.nextConnection&&(e.push(t),this.lastOnStack=t),e}shouldUpdatePreviews(e,t){if(!e)return!!this.activeCandidate;if(!this.activeCandidate)return!0;const{local:r,closest:l}=this.activeCandidate;if(l===e.closest&&r===e.local)return!1;const p=r.x+t.x-l.x;return t=r.y+t.y-l.y,e.radius<Math.sqrt(p*p+t*t)-s.config$$module$build$src$core$config.currentConnectionPreference}getCandidate(e){this.markerConnection&&this.markerConnection.isConnected()||this.updateAvailableConnections();let t=this.getStartRadius(),r=null;for(let l=0;l<this.availableConnections.length;l++){const p=this.availableConnections[l],v=p.closest(t,e);v.connection&&(r={closest:v.connection,local:p,radius:v.radius},t=v.radius)}return r}getStartRadius(){return this.activeCandidate?s.config$$module$build$src$core$config.connectingSnapRadius:s.config$$module$build$src$core$config.snapRadius}shouldDelete(e,t){return t&&this.workspace.getComponentManager().hasCapability(t.id,un.Capability.DELETE_AREA)?t.wouldDelete(this.topBlock):!1}maybeShowPreview(e){if(!this.wouldDeleteBlock&&e){var t=e.closest,r;t===((r=this.activeCandidate)==null?void 0:r.closest)||t.getSourceBlock().isInsertionMarker()?console.log("Trying to connect to an insertion marker"):(this.activeCandidate=e,this.showPreview(this.activeCandidate))}}showPreview(e){const t=this.workspace.getRenderer();switch(t.getConnectionPreviewMethod(e.closest,e.local,this.topBlock)){case Vr.PREVIEW_TYPE.INPUT_OUTLINE:this.showInsertionInputOutline(e);break;case Vr.PREVIEW_TYPE.INSERTION_MARKER:this.showInsertionMarker(e);break;case Vr.PREVIEW_TYPE.REPLACEMENT_FADE:this.showReplacementFade(e)}t.shouldHighlightConnection(e.closest)&&e.closest.highlight()}maybeHidePreview(e){if(!e)this.hidePreview();else if(this.activeCandidate){const t=this.activeCandidate.local!==e.local;(this.activeCandidate.closest!==e.closest||t||this.wouldDeleteBlock)&&this.hidePreview()}this.activeCandidate=this.markerConnection=null}hidePreview(){let e;const t=(e=this.activeCandidate)==null?void 0:e.closest;t&&t.targetBlock()&&this.workspace.getRenderer().shouldHighlightConnection(t)&&t.unhighlight(),this.hideReplacementFade(),this.hideInsertionInputOutline(),this.hideInsertionMarker()}showInsertionMarker(e){const{local:t,closest:r}=e;let l=(e=this.lastOnStack&&t===this.lastOnStack)?this.lastMarker:this.firstMarker;if(!l)throw Error("Cannot show the insertion marker because there is no insertion marker block");let p;try{p=l.getMatchingConnection(t.getSourceBlock(),t)}catch{if(e&&this.lastOnStack?(this.disposeInsertionMarker(this.lastMarker),l=this.lastMarker=this.createMarkerBlock(this.lastOnStack.getSourceBlock())):(this.disposeInsertionMarker(this.firstMarker),l=this.firstMarker=this.createMarkerBlock(this.topBlock)),!l)throw Error("Cannot show the insertion marker because there is no insertion marker block");p=l.getMatchingConnection(t.getSourceBlock(),t)}if(!p)throw Error("Cannot show the insertion marker because there is no associated connection");if(p===this.markerConnection)throw Error("Made it to showInsertionMarker_ even though the marker isn't changing");l.queueRender(),js(),p.connect(r);const v={x:r.x-p.x,y:r.y-p.y},O=p.getOffsetInBlock().clone(),G=p;cs().then(()=>{let _e;(_e=l)==null||_e.positionNearConnection(G,v,O);let qe;(qe=l)==null||qe.getSvgRoot().setAttribute("visibility","visible")}),this.markerConnection=p}hideInsertionMarker(){if(this.markerConnection){var e=this.markerConnection,t=e.getSourceBlock(),r=t.outputConnection,l;if((l=t.previousConnection)!=null&&l.targetConnection||r!=null&&r.targetConnection)t.unplug(!0);else{let p;(p=e.targetBlock())==null||p.unplug(!1)}if(e.targetConnection)throw Error("markerConnection still connected at the end of disconnectInsertionMarker");this.markerConnection=null,(e=t.getSvgRoot())&&e.setAttribute("visibility","hidden")}}showInsertionInputOutline(e){e=e.closest,this.highlightedBlock=e.getSourceBlock(),this.highlightedBlock.highlightShapeForInput(e,!0)}hideInsertionInputOutline(){if(this.highlightedBlock){if(!this.activeCandidate)throw Error("Cannot hide the insertion marker outline because there is no active candidate");this.highlightedBlock.highlightShapeForInput(this.activeCandidate.closest,!1),this.highlightedBlock=null}}showReplacementFade(e){if(this.fadedBlock=e.closest.targetBlock(),!this.fadedBlock)throw Error("Cannot show the replacement fade because the closest connection does not have a target block");this.fadedBlock.fadeForReplacement(!0)}hideReplacementFade(){this.fadedBlock&&(this.fadedBlock.fadeForReplacement(!1),this.fadedBlock=null)}getInsertionMarkers(){const e=[];return this.firstMarker&&e.push(this.firstMarker),this.lastMarker&&e.push(this.lastMarker),e}disposeInsertionMarker(e){if(e){s.disable$$module$build$src$core$events$utils();try{e.dispose()}finally{s.enable$$module$build$src$core$events$utils()}}}};(function(e){e=e.PREVIEW_TYPE||(e.PREVIEW_TYPE={}),e[e.INSERTION_MARKER=0]="INSERTION_MARKER",e[e.INPUT_OUTLINE=1]="INPUT_OUTLINE",e[e.REPLACEMENT_FADE=2]="REPLACEMENT_FADE"})(Vr),Vr.PREVIEW_TYPE;var Su=class{constructor(e){this.overrides=null,this.name=e}getClassName(){return this.name+"-renderer"}init(e,t){this.constants_=this.makeConstants_(),t&&(this.overrides=t,Object.assign(this.constants_,t)),this.constants_.setTheme(e),this.constants_.init()}createDom(e,t){this.constants_.createDom(e,this.name+"-"+t.name,"."+this.getClassName()+"."+t.getClassName())}refreshDom(e,t){const r=this.getConstants();r.dispose(),this.constants_=this.makeConstants_(),this.overrides&&Object.assign(this.constants_,this.overrides),this.constants_.randomIdentifier=r.randomIdentifier,this.constants_.setTheme(t),this.constants_.init(),this.createDom(e,t)}dispose(){this.constants_&&this.constants_.dispose()}makeConstants_(){return new lh}makeRenderInfo_(e){return new ms(this,e)}makeDrawer_(e,t){return new Ql(e,t)}makeMarkerDrawer(e,t){return new _f(e,this.getConstants(),t)}makePathObject(e,t){return new ch(e,t,this.constants_)}getConstants(){return this.constants_}shouldHighlightConnection(e){return!0}orphanCanConnectAtEnd(e,t,r){return!!Jt.getConnectionForOrphanedConnection(e,r===Ge.OUTPUT_VALUE?t.outputConnection:t.previousConnection)}getConnectionPreviewMethod(e,t,r){return C("getConnectionPreviewMethod","v10","v12","an IConnectionPreviewer, if it fulfills your use case."),t.type===Ge.OUTPUT_VALUE||t.type===Ge.PREVIOUS_STATEMENT?!e.isConnected()||this.orphanCanConnectAtEnd(r,e.targetBlock(),t.type)?Vr.PREVIEW_TYPE.INSERTION_MARKER:Vr.PREVIEW_TYPE.REPLACEMENT_FADE:Vr.PREVIEW_TYPE.INSERTION_MARKER}render(e){const t=this.makeRenderInfo_(e);t.measure(),this.makeDrawer_(e,t).draw()}},on={};on.BottomRow=dr,on.Connection=xi,on.ConstantProvider=lh,on.Drawer=Ql,on.ExternalValueInput=rn,on.Field=Zl,on.Hat=ah,on.Icon=vu,on.InRowSpacer=Er,on.InlineInput=ff,on.InputConnection=qo,on.InputRow=mf,on.JaggedEdge=m$,on.MarkerSvg=_f,on.Measurable=ft,on.NextConnection=b$,on.OutputConnection=$$,on.PathObject=ch,on.PreviousConnection=v$,on.RenderInfo=ms,on.Renderer=Su,on.RoundCorner=_u,on.Row=Xl,on.SpacerRow=bf,on.SquareCorner=wu,on.StatementInput=yu,on.TopRow=$f,on.Types=X,on.init=md,on.register=Yi,on.unregister=Xi;var _$=class{constructor(e,t){this.workspace=e,this.theme=t,this.subscribedWorkspaces=[],this.componentDB=new Map}getTheme(){return this.theme}setTheme(e){var t=this.theme;this.theme=e,(e=this.workspace.getInjectionDiv())&&(t&&(t=t.getClassName())&&it(e,t),(t=this.theme.getClassName())&&Pe(e,t));for(let r=0,l;l=this.subscribedWorkspaces[r];r++)l.refreshTheme();for(const[r,l]of this.componentDB)for(const p of l){e=p.element,t=p.propertyName;const v=this.theme&&this.theme.getComponentStyle(r);e.style.setProperty(t,v||"")}for(const r of this.subscribedWorkspaces)r.hideChaff()}subscribeWorkspace(e){this.subscribedWorkspaces.push(e)}unsubscribeWorkspace(e){if(!ue(this.subscribedWorkspaces,e))throw Error("Cannot unsubscribe a workspace that hasn't been subscribed.")}subscribe(e,t,r){this.componentDB.has(t)||this.componentDB.set(t,[]),this.componentDB.get(t).push({element:e,propertyName:r}),t=this.theme&&this.theme.getComponentStyle(t),e.style.setProperty(r,t||"")}unsubscribe(e){if(e)for(const[t,r]of this.componentDB){for(let l=r.length-1;0<=l;l--)r[l].element===e&&r.splice(l,1);r.length||this.componentDB.delete(t)}}dispose(){this.subscribedWorkspaces.length=0,this.componentDB.clear()}},wf="VARIABLE_DYNAMIC",ec={CATEGORY_NAME:wf};ec.flyoutCategory=Bc,ec.flyoutCategoryBlocks=ds,ec.onCreateVariableButtonClick_Colour=eg,ec.onCreateVariableButtonClick_Number=Nl,ec.onCreateVariableButtonClick_String=Qp;var Xa=30,Za=[];Za[Ge.INPUT_VALUE]=Ge.OUTPUT_VALUE,Za[Ge.OUTPUT_VALUE]=Ge.INPUT_VALUE,Za[Ge.NEXT_STATEMENT]=Ge.PREVIOUS_STATEMENT,Za[Ge.PREVIOUS_STATEMENT]=Ge.NEXT_STATEMENT;var Sf="RENAME_VARIABLE_ID",Cf="DELETE_VARIABLE_ID",w$=class{canConnect(e,t,r,l){return this.canConnectWithReason(e,t,r,l)===Jt.CAN_CONNECT}canConnectWithReason(e,t,r,l){const p=this.doSafetyChecks(e,t);return p!==Jt.CAN_CONNECT?p:this.doTypeChecks(e,t)?r&&!this.doDragChecks(e,t,l||0)?Jt.REASON_DRAG_CHECKS_FAILED:Jt.CAN_CONNECT:Jt.REASON_CHECKS_FAILED}getErrorMessage(e,t,r){switch(e){case Jt.REASON_SELF_CONNECTION:return"Attempted to connect a block to itself.";case Jt.REASON_DIFFERENT_WORKSPACES:return"Blocks not on same workspace.";case Jt.REASON_WRONG_TYPE:return"Attempt to connect incompatible types.";case Jt.REASON_TARGET_NULL:return"Target connection is null.";case Jt.REASON_CHECKS_FAILED:return"Connection checks failed. "+(t+" expected "+t.getCheck()+", found "+r.getCheck());case Jt.REASON_SHADOW_PARENT:return"Connecting non-shadow to shadow block.";case Jt.REASON_DRAG_CHECKS_FAILED:return"Drag checks failed.";case Jt.REASON_PREVIOUS_AND_OUTPUT:return"Block would have an output and a previous connection.";default:return"Unknown connection failure: this should never happen!"}}doSafetyChecks(e,t){if(!e||!t)return Jt.REASON_TARGET_NULL;let r,l,p;return e.isSuperior()?(r=e.getSourceBlock(),l=t.getSourceBlock(),p=t):(l=e.getSourceBlock(),r=t.getSourceBlock(),p=e,e=t),r===l?Jt.REASON_SELF_CONNECTION:p.type!==Za[e.type]?Jt.REASON_WRONG_TYPE:r.workspace!==l.workspace?Jt.REASON_DIFFERENT_WORKSPACES:r.isShadow()&&!l.isShadow()?Jt.REASON_SHADOW_PARENT:p.type===Ge.OUTPUT_VALUE&&l.previousConnection&&l.previousConnection.isConnected()||p.type===Ge.PREVIOUS_STATEMENT&&l.outputConnection&&l.outputConnection.isConnected()?Jt.REASON_PREVIOUS_AND_OUTPUT:Jt.CAN_CONNECT}doTypeChecks(e,t){if(e=e.getCheck(),t=t.getCheck(),!e||!t)return!0;for(let r=0;r<e.length;r++)if(t.includes(e[r]))return!0;return!1}doDragChecks(e,t,r){if(e.distanceFrom(t)>r||t.getSourceBlock().isInsertionMarker())return!1;switch(t.type){case Ge.PREVIOUS_STATEMENT:return this.canConnectToPrevious_(e,t);case Ge.OUTPUT_VALUE:if(t.isConnected()&&!t.targetBlock().isInsertionMarker()||e.isConnected())return!1;break;case Ge.INPUT_VALUE:if(t.isConnected()&&!t.targetBlock().isMovable()&&!t.targetBlock().isShadow())return!1;break;case Ge.NEXT_STATEMENT:if(t.isConnected()&&!e.getSourceBlock().nextConnection&&!t.targetBlock().isShadow()&&t.targetBlock().nextConnection||t.targetBlock()&&!t.targetBlock().isMovable()&&!t.targetBlock().isShadow())return!1;break;default:return!1}return!Bl.includes(t)}canConnectToPrevious_(e,t){return e.targetConnection||Bl.includes(t)?!1:t.targetConnection?(e=t.targetBlock(),e.isInsertionMarker()?!e.getPreviousBlock():!1):!0}};i(Ne.CONNECTION_CHECKER,Pr,w$);var Tf=class extends su{constructor(e){super(e),this.type=ge.VAR_DELETE,e&&(this.varType=e.type,this.varName=e.name)}toJson(){const e=super.toJson();if(this.varType===void 0)throw Error("The var type is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");return e.varType=this.varType,e.varName=this.varName,e}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new Tf),t.varType=e.varType,t.varName=e.varName,t}run(e){const t=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");e?t.deleteVariableById(this.varId):t.createVariable(this.varName,this.varType,this.varId)}};i(Ne.EVENT,ge.VAR_DELETE,Tf);var uh=class extends su{constructor(e,t){super(e),this.type=ge.VAR_RENAME,e&&(this.oldName=e.name,this.newName=typeof t>"u"?"":t)}toJson(){const e=super.toJson();if(!this.oldName)throw Error("The old var name is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.newName)throw Error("The new var name is undefined. Either pass a value to the constructor, or call fromJson");return e.oldName=this.oldName,e.newName=this.newName,e}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new uh),t.oldName=e.oldName,t.newName=e.newName,t}run(e){const t=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.oldName)throw Error("The old var name is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.newName)throw Error("The new var name is undefined. Either pass a value to the constructor, or call fromJson");e?t.renameVariableById(this.varId,this.newName):t.renameVariableById(this.varId,this.oldName)}};i(Ne.EVENT,ge.VAR_RENAME,uh);var dh=class{constructor(e){this.workspace=e,this.variableMap=new Map}clear(){for(const e of this.variableMap.values())for(;0<e.length;)this.deleteVariable(e[0]);if(this.variableMap.size!==0)throw Error("Non-empty variable map")}renameVariable(e,t){if(e.name!==t){var r=this.getVariable(t,e.type),l=this.workspace.getAllBlocks(!1),p=s.getGroup$$module$build$src$core$events$utils();p||s.setGroup$$module$build$src$core$events$utils(!0);try{r&&r.getId()!==e.getId()?this.renameVariableWithConflict(e,t,r,l):this.renameVariableAndUses(e,t,l)}finally{s.setGroup$$module$build$src$core$events$utils(p)}}}renameVariableById(e,t){const r=this.getVariableById(e);if(!r)throw Error("Tried to rename a variable that didn't exist. ID: "+e);this.renameVariable(r,t)}renameVariableAndUses(e,t,r){for(te(new(Ce(ge.VAR_RENAME))(e,t)),e.name=t,t=0;t<r.length;t++)r[t].updateVarName(e)}renameVariableWithConflict(e,t,r,l){const p=e.type;for(t!==r.name&&this.renameVariableAndUses(r,t,l),t=0;t<l.length;t++)l[t].renameVarById(e.getId(),r.getId());te(new(Ce(ge.VAR_DELETE))(e)),ue(this.variableMap.get(p),e)}createVariable(e,t,r){var l=this.getVariable(e,t);if(l){if(r&&l.getId()!==r)throw Error('Variable "'+e+'" is already in use and its id is "'+l.getId()+'" which conflicts with the passed in id, "'+r+'".');return l}if(r&&this.getVariableById(r))throw Error('Variable id, "'+r+'", is already in use.');return l=r||k(),t=t||"",l=new ru(this.workspace,e,t,l),e=this.variableMap.get(t)||[],e.push(l),this.variableMap.delete(t),this.variableMap.set(t,e),te(new(Ce(ge.VAR_CREATE))(l)),l}deleteVariable(e){const t=e.getId(),r=this.variableMap.get(e.type);if(r){for(let l=0;l<r.length;l++)if(r[l].getId()===t){r.splice(l,1),te(new(Ce(ge.VAR_DELETE))(e)),r.length===0&&this.variableMap.delete(e.type);break}}}deleteVariableById(e){const t=this.getVariableById(e);if(t){var r=t.name;const l=this.getVariableUsesById(e);for(let p=0,v;v=l[p];p++)if(v.type==="procedures_defnoreturn"||v.type==="procedures_defreturn"){e=String(v.getFieldValue("NAME")),r=s.Msg$$module$build$src$core$msg.CANNOT_DELETE_VARIABLE_PROCEDURE.replace("%1",r).replace("%2",e),zi(r);return}1<l.length?(r=s.Msg$$module$build$src$core$msg.DELETE_VARIABLE_CONFIRMATION.replace("%1",String(l.length)).replace("%2",r),ll(r,p=>{p&&t&&this.deleteVariableInternal(t,l)})):this.deleteVariableInternal(t,l)}else console.warn("Can't delete non-existent variable: "+e)}deleteVariableInternal(e,t){const r=s.getGroup$$module$build$src$core$events$utils();r||s.setGroup$$module$build$src$core$events$utils(!0);try{for(let l=0;l<t.length;l++)t[l].dispose(!0);this.deleteVariable(e)}finally{s.setGroup$$module$build$src$core$events$utils(r)}}getVariable(e,t){if(t=this.variableMap.get(t||"")){for(let r=0,l;l=t[r];r++)if(s.Names$$module$build$src$core$names.equals(l.name,e))return l}return null}getVariableById(e){for(const t of this.variableMap.values())for(const r of t)if(r.getId()===e)return r;return null}getVariablesOfType(e){return(e=this.variableMap.get(e||""))?e.slice():[]}getVariableTypes(e){const t=new Set(this.variableMap.keys());if(e&&e.getPotentialVariableMap())for(const r of e.getPotentialVariableMap().variableMap.keys())t.add(r);return t.has("")||t.add(""),Array.from(t.values())}getAllVariables(){let e=[];for(const t of this.variableMap.values())e=e.concat(t);return e}getAllVariableNames(){return Array.from(this.variableMap.values()).flat().map(e=>e.name)}getVariableUsesById(e){const t=[],r=this.workspace.getAllBlocks(!1);for(let l=0;l<r.length;l++){const p=r[l].getVarModels();if(p)for(let v=0;v<p.length;v++)p[v].getId()===e&&t.push(r[l])}return t}},tc=class{get isFlyout(){return this.internalIsFlyout}get isMutator(){return this.internalIsMutator}constructor(e){this.isClearing=this.internalIsMutator=this.internalIsFlyout=this.rendered=!1,this.MAX_UNDO=1024,this.connectionDBList=[],this.topBlocks=[],this.topComments=[],this.commentDB=new Map,this.listeners=[],this.undoStack_=[],this.redoStack_=[],this.blockDB=new Map,this.typedBlocksDB=new Map,this.procedureMap=new g$,this.potentialVariableMap=null,this.id=k(),ke(this),this.options=e||new Wr({}),this.RTL=!!this.options.RTL,this.horizontalLayout=!!this.options.horizontalLayout,this.toolboxPosition=this.options.toolboxPosition,this.connectionChecker=new(w(Ne.CONNECTION_CHECKER,this.options,!0))(this),this.variableMap=new dh(this)}dispose(){this.listeners.length=0,this.clear(),Xe(this)}sortObjects(e,t){const r=Math.sin(zs(tc.SCAN_ANGLE))*(this.RTL?-1:1);return e=e.getRelativeToSurfaceXY(),t=t.getRelativeToSurfaceXY(),e.y+r*e.x-(t.y+r*t.x)}addTopBlock(e){this.topBlocks.push(e)}removeTopBlock(e){if(!ue(this.topBlocks,e))throw Error("Block not present in workspace's list of top-most blocks.")}getTopBlocks(e=!1){const t=[].concat(this.topBlocks);return e&&1<t.length&&t.sort(this.sortObjects.bind(this)),t}addTypedBlock(e){this.typedBlocksDB.has(e.type)||this.typedBlocksDB.set(e.type,[]),this.typedBlocksDB.get(e.type).push(e)}removeTypedBlock(e){ue(this.typedBlocksDB.get(e.type),e),this.typedBlocksDB.get(e.type).length||this.typedBlocksDB.delete(e.type)}getBlocksByType(e,t=!1){return this.typedBlocksDB.has(e)?(e=this.typedBlocksDB.get(e).slice(0),t&&e&&1<e.length&&e.sort(this.sortObjects.bind(this)),e.filter(r=>!r.isInsertionMarker())):[]}addTopComment(e){this.topComments.push(e),this.commentDB.has(e.id)&&console.warn('Overriding an existing comment on this workspace, with id "'+e.id+'"'),this.commentDB.set(e.id,e)}removeTopComment(e){if(!ue(this.topComments,e))throw Error("Comment not present in workspace's list of top-most comments.");this.commentDB.delete(e.id)}getTopComments(e=!1){const t=[].concat(this.topComments);return e&&1<t.length&&t.sort(this.sortObjects.bind(this)),t}getAllBlocks(e=!1){if(e){var t=this.getTopBlocks(!0);e=[];for(let r=0;r<t.length;r++)e.push(...t[r].getDescendants(!0))}else for(e=this.getTopBlocks(!1),t=0;t<e.length;t++)e.push(...e[t].getChildren(!1));return e.filter(r=>!r.isInsertionMarker())}clear(){this.isClearing=!0;try{const e=s.getGroup$$module$build$src$core$events$utils();for(e||s.setGroup$$module$build$src$core$events$utils(!0);this.topBlocks.length;)this.topBlocks[0].dispose(!1);for(;this.topComments.length;)this.topComments[this.topComments.length-1].dispose();s.setGroup$$module$build$src$core$events$utils(e),this.variableMap.clear(),this.potentialVariableMap&&this.potentialVariableMap.clear()}finally{this.isClearing=!1}}renameVariableById(e,t){this.variableMap.renameVariableById(e,t)}createVariable(e,t,r){return this.variableMap.createVariable(e,t,r)}getVariableUsesById(e){return this.variableMap.getVariableUsesById(e)}deleteVariableById(e){this.variableMap.deleteVariableById(e)}getVariable(e,t){return this.variableMap.getVariable(e,t)}getVariableById(e){return this.variableMap.getVariableById(e)}getVariablesOfType(e){return this.variableMap.getVariablesOfType(e)}getVariableTypes(){return this.variableMap.getVariableTypes(this)}getAllVariables(){return this.variableMap.getAllVariables()}getAllVariableNames(){return this.variableMap.getAllVariableNames()}getWidth(){return 0}newBlock(e,t){throw Error("The implementation of newBlock should be monkey-patched in by blockly.ts")}newComment(e){throw Error("The implementation of newComment should be monkey-patched in by blockly.ts")}remainingCapacity(){return isNaN(this.options.maxBlocks)?1/0:this.options.maxBlocks-this.getAllBlocks(!1).length}remainingCapacityOfType(e){return this.options.maxInstances?(this.options.maxInstances[e]!==void 0?this.options.maxInstances[e]:1/0)-this.getBlocksByType(e,!1).length:1/0}isCapacityAvailable(e){if(!this.hasBlockLimits())return!0;let t=0;for(const r in e){if(e[r]>this.remainingCapacityOfType(r))return!1;t+=e[r]}return!(t>this.remainingCapacity())}hasBlockLimits(){return this.options.maxBlocks!==1/0||!!this.options.maxInstances}getUndoStack(){return this.undoStack_}getRedoStack(){return this.redoStack_}undo(e){var t=e?this.redoStack_:this.undoStack_,r=e?this.undoStack_:this.redoStack_;const l=t.pop();if(l){for(var p=[l];t.length&&l.group&&l.group===t[t.length-1].group;){const v=t.pop();v&&p.push(v)}for(t=0;t<p.length;t++)r.push(p[t]);s.setRecordUndo$$module$build$src$core$events$utils(!1);try{for(r=0;r<p.length;r++)p[r].run(e)}finally{s.setRecordUndo$$module$build$src$core$events$utils(!0)}}}clearUndo(){this.undoStack_.length=0,this.redoStack_.length=0,q()}addChangeListener(e){return this.listeners.push(e),e}removeChangeListener(e){ue(this.listeners,e)}fireChangeListener(e){if(e.recordUndo)for(this.undoStack_.push(e),this.redoStack_.length=0;this.undoStack_.length>this.MAX_UNDO&&0<=this.MAX_UNDO;)this.undoStack_.shift();for(let t=0;t<this.listeners.length;t++)(0,this.listeners[t])(e)}getBlockById(e){return this.blockDB.get(e)||null}setBlockById(e,t){this.blockDB.set(e,t)}removeBlockById(e){this.blockDB.delete(e)}getCommentById(e){let t;return(t=this.commentDB.get(e))!=null?t:null}allInputsFilled(e){const t=this.getTopBlocks(!1);for(let r=0;r<t.length;r++)if(!t[r].allInputsFilled(e))return!1;return!0}getPotentialVariableMap(){return this.potentialVariableMap}createPotentialVariableMap(){this.potentialVariableMap=new dh(this)}getVariableMap(){return this.variableMap}setVariableMap(e){this.variableMap=e}getProcedureMap(){return this.procedureMap}getRootWorkspace(){let e=null;const t=this.options.parentWorkspace;return this.isFlyout?t&&t.options&&(e=t.options.parentWorkspace):t&&(e=t),e}static getById(e){return pe(e)}static getAll(){return Te()}};tc.SCAN_ANGLE=3;var Fy=100,S$=class{constructor(e){this.parentWorkspace=e,this.sounds=new Map,this.lastSound=null,this.muted=!1}dispose(){this.sounds.clear()}load(e,t){if(e.length){try{var r=new globalThis.Audio}catch{return}for(let p=0;p<e.length;p++){const v=e[p],O=v.match(/\.(\w+)$/);if(O&&r.canPlayType("audio/"+O[1])){var l=new globalThis.Audio(v);break}}l&&this.sounds.set(t,l)}}preload(){for(const e of this.sounds.values()){e.volume=.01;const t=e.play();if(t!==void 0?t.then(e.pause).catch(function(){}):e.pause(),Pd||Ei)break}}play(e,t){if(!this.muted){var r=this.sounds.get(e);r?(e=new Date,this.lastSound!==null&&e.getTime()-this.lastSound.getTime()<Fy||(this.lastSound=e,r=Pd||Rg?r:r.cloneNode(),r.volume=t===void 0?1:t,r.play())):this.parentWorkspace&&this.parentWorkspace.getAudioManager().play(e,t)}}setMuted(e){this.muted=e}getMuted(){return this.muted}},jy=20,Gr=class extends tc{constructor(e){super(e),this.resizeHandlerWrapper=null,this.resizesEnabled=this.visible=this.rendered=!0,this.startScrollY=this.startScrollX=this.scrollY=this.scrollX=0,this.oldScale=this.scale=1,this.oldLeft=this.oldTop=0,this.inverseScreenCTM=this.targetWorkspace=this.dummyWheelListener=this.configureContextMenu=this.lastRecordedPageScroll=this.injectionDiv=this.currentGesture_=this.toolbox=this.flyout=this.scrollbar=this.trashcan=null,this.inverseScreenCTMDirty=!0,this.highlightedBlocks=[],this.toolboxCategoryCallbacks=new Map,this.flyoutButtonCallbacks=new Map,this.cachedParentSvg=null,this.keyboardAccessibilityMode=!1,this.topBoundedElements=[],this.dragTargetAreas=[],this.zoomControls_=this.layerManager=null,this.metricsManager=new(w(Ne.METRICS_MANAGER,e,!0))(this),this.getMetrics=e.getMetrics||this.metricsManager.getMetrics.bind(this.metricsManager),this.setMetrics=e.setMetrics||Gr.setTopLevelWorkspaceMetrics,this.componentManager=new un,this.connectionDBList=Jl.init(this.connectionChecker),this.audioManager=new S$(e.parentWorkspace),this.grid=this.options.gridPattern?new ao(this.options.gridPattern,e.gridOptions):null,this.markerManager=new cu(this),yc&&this.registerToolboxCategoryCallback(Kg,yc),Bc&&this.registerToolboxCategoryCallback(wf,Bc),Vs&&gd&&(this.registerToolboxCategoryCallback(oh,gd),this.addChangeListener(Mc)),this.themeManager_=this.options.parentWorkspace?this.options.parentWorkspace.getThemeManager():new _$(this,this.options.theme||ui),this.themeManager_.subscribeWorkspace(this);let t;this.renderer=md(this.options.renderer||"geras",this.getTheme(),(t=this.options.rendererOverrides)!=null?t:void 0),this.cachedParentSvgSize=new Pt(0,0)}getMarkerManager(){return this.markerManager}getMetricsManager(){return this.metricsManager}setMetricsManager(e){this.metricsManager=e,this.getMetrics=this.metricsManager.getMetrics.bind(this.metricsManager)}getComponentManager(){return this.componentManager}setCursorSvg(e){this.markerManager.setCursorSvg(e)}setMarkerSvg(e){this.markerManager.setMarkerSvg(e)}getMarker(e){return this.markerManager?this.markerManager.getMarker(e):null}getCursor(){return this.markerManager?this.markerManager.getCursor():null}getRenderer(){return this.renderer}getThemeManager(){return this.themeManager_}getTheme(){return this.themeManager_.getTheme()}setTheme(e){e||(e=ui),this.themeManager_.setTheme(e)}refreshTheme(){this.svgGroup_&&this.renderer.refreshDom(this.svgGroup_,this.getTheme()),this.updateBlockStyles(this.getAllBlocks(!1).filter(t=>!!t.getStyleName())),this.refreshToolboxSelection(),this.toolbox&&this.toolbox.refreshTheme(),this.isVisible()&&this.setVisible(!0);const e=new(Ce(ge.THEME_CHANGE))(this.getTheme().name,this.id);te(e)}updateBlockStyles(e){for(let t=0,r;r=e[t];t++){const l=r.getStyleName();l&&r.setStyle(l)}}getInverseScreenCTM(){if(this.inverseScreenCTMDirty){const e=this.getParentSvg().getScreenCTM();e&&(this.inverseScreenCTM=e.inverse(),this.inverseScreenCTMDirty=!1)}return this.inverseScreenCTM}updateInverseScreenCTM(){this.inverseScreenCTMDirty=!0}isVisible(){return this.visible}getSvgXY(e){let t=0,r=0,l=1;(this.getCanvas().contains(e)||this.getBubbleCanvas().contains(e))&&(l=this.scale);do{const p=Rr(e);(e===this.getCanvas()||e===this.getBubbleCanvas())&&(l=1),t+=p.x*l,r+=p.y*l,e=e.parentNode}while(e&&e!==this.getParentSvg()&&e!==this.getInjectionDiv());return new Ae(t,r)}getCachedParentSvgSize(){const e=this.cachedParentSvgSize;return new Pt(e.width,e.height)}getOriginOffsetInPixels(){return al(this.getCanvas())}getInjectionDiv(){if(!this.injectionDiv){let e=this.svgGroup_;for(;e;){if((" "+(e.getAttribute("class")||"")+" ").includes(" injectionDiv ")){this.injectionDiv=e;break}e=e.parentNode}}return this.injectionDiv}getSvgGroup(){return this.svgGroup_}getBlockCanvas(){return this.getCanvas()}setResizeHandlerWrapper(e){this.resizeHandlerWrapper=e}createDom(e,t){return this.injectionDiv||(this.injectionDiv=t??null),this.svgGroup_=ie(ae.G,{class:"blocklyWorkspace"}),e&&(this.svgBackground_=ie(ae.RECT,{height:"100%",width:"100%",class:e},this.svgGroup_),e==="blocklyMainBackground"&&this.grid?this.svgBackground_.style.fill="url(#"+this.grid.getPatternId()+")":this.themeManager_.subscribe(this.svgBackground_,"workspaceBackgroundColour","fill")),this.layerManager=new Et(this),this.svgBlockCanvas_=this.layerManager.getBlockLayer(),this.svgBubbleCanvas_=this.layerManager.getBubbleLayer(),this.isFlyout||(He(this.svgGroup_,"pointerdown",this,this.onMouseDown,!1),this.dummyWheelListener=()=>{},document.body.addEventListener("wheel",this.dummyWheelListener),He(this.svgGroup_,"wheel",this,this.onMouseWheel)),this.options.hasCategories&&(this.toolbox=new(w(Ne.TOOLBOX,this.options,!0))(this)),this.grid&&this.grid.update(this.scale),this.recordDragTargets(),(e=w(Ne.CURSOR,this.options))&&this.markerManager.setCursor(new e),this.renderer.createDom(this.svgGroup_,this.getTheme()),this.svgGroup_}dispose(){if(this.rendered=!1,this.currentGesture_&&this.currentGesture_.cancel(),this.svgGroup_&&lt(this.svgGroup_),this.toolbox&&(this.toolbox.dispose(),this.toolbox=null),this.flyout&&(this.flyout.dispose(),this.flyout=null),this.trashcan&&(this.trashcan.dispose(),this.trashcan=null),this.scrollbar&&(this.scrollbar.dispose(),this.scrollbar=null),this.zoomControls_&&this.zoomControls_.dispose(),this.audioManager&&this.audioManager.dispose(),this.grid&&(this.grid=null),this.renderer.dispose(),this.markerManager&&this.markerManager.dispose(),super.dispose(),this.themeManager_&&(this.themeManager_.unsubscribeWorkspace(this),this.themeManager_.unsubscribe(this.svgBackground_),this.options.parentWorkspace||this.themeManager_.dispose()),this.connectionDBList.length=0,this.toolboxCategoryCallbacks.clear(),this.flyoutButtonCallbacks.clear(),!this.options.parentWorkspace){const e=this.getParentSvg();e&&e.parentNode&&lt(e.parentNode)}this.resizeHandlerWrapper&&(St(this.resizeHandlerWrapper),this.resizeHandlerWrapper=null),this.dummyWheelListener&&(document.body.removeEventListener("wheel",this.dummyWheelListener),this.dummyWheelListener=null)}addTrashcan(){this.trashcan=Gr.newTrashcan(this);const e=this.trashcan.createDom();this.svgGroup_.insertBefore(e,this.getCanvas())}static newTrashcan(e){throw Error("The implementation of newTrashcan should be monkey-patched in by blockly.ts")}addZoomControls(){this.zoomControls_=new Fg(this);const e=this.zoomControls_.createDom();this.svgGroup_.appendChild(e)}addFlyout(e){const t=new Wr({parentWorkspace:this,rtl:this.RTL,oneBasedIndex:this.options.oneBasedIndex,horizontalLayout:this.horizontalLayout,renderer:this.options.renderer,rendererOverrides:this.options.rendererOverrides,move:{scrollbars:!0}});return t.toolboxPosition=this.options.toolboxPosition,this.flyout=this.horizontalLayout?new(w(Ne.FLYOUTS_HORIZONTAL_TOOLBOX,this.options,!0))(t):new(w(Ne.FLYOUTS_VERTICAL_TOOLBOX,this.options,!0))(t),this.flyout.autoClose=!1,this.flyout.getWorkspace().setVisible(!0),this.flyout.createDom(e)}getFlyout(e){return this.flyout||e?this.flyout:this.toolbox?this.toolbox.getFlyout():null}getToolbox(){return this.toolbox}updateScreenCalculations(){this.updateInverseScreenCTM(),this.recordDragTargets()}resizeContents(){this.resizesEnabled&&this.rendered&&(this.scrollbar&&this.scrollbar.resize(),this.updateInverseScreenCTM())}resize(){this.toolbox&&this.toolbox.position(),this.flyout&&this.flyout.position();const e=this.componentManager.getComponents(un.Capability.POSITIONABLE,!0),t=this.getMetricsManager().getUiMetrics(),r=[];for(let l=0,p;p=e[l];l++){p.position(t,r);const v=p.getBoundingRectangle();v&&r.push(v)}this.scrollbar&&this.scrollbar.resize(),this.updateScreenCalculations()}updateScreenCalculationsIfScrolled(){const e=$c();Ae.equals(this.lastRecordedPageScroll,e)||(this.lastRecordedPageScroll=e,this.updateScreenCalculations())}getLayerManager(){return this.layerManager}getCanvas(){return this.layerManager.getBlockLayer()}setCachedParentSvgSize(e,t){const r=this.getParentSvg();e!=null&&(this.cachedParentSvgSize.width=e,r.setAttribute("data-cached-width",`${e}`)),t!=null&&(this.cachedParentSvgSize.height=t,r.setAttribute("data-cached-height",`${t}`))}getBubbleCanvas(){return this.layerManager.getBubbleLayer()}getParentSvg(){if(!this.cachedParentSvg){let e=this.svgGroup_;for(;e;){if(e.tagName==="svg"){this.cachedParentSvg=e;break}e=e.parentNode}}return this.cachedParentSvg}maybeFireViewportChangeEvent(){if(re()){var e=this.scale,t=-this.scrollY,r=-this.scrollX;if(!(e===this.oldScale&&1>Math.abs(t-this.oldTop)&&1>Math.abs(r-this.oldLeft))){var l=new(Ce(ge.VIEWPORT_CHANGE))(t,r,e,this.id,this.oldScale);this.oldScale=e,this.oldTop=t,this.oldLeft=r,te(l)}}}translate(e,t){let r;(r=this.layerManager)==null||r.translateLayers(new Ae(e,t),this.scale);let l;(l=this.grid)==null||l.moveTo(e,t),this.maybeFireViewportChangeEvent()}getWidth(){const e=this.getMetrics();return e?e.viewWidth/this.scale:0}setVisible(e){this.visible=e,this.svgGroup_&&(this.scrollbar&&this.scrollbar.setContainerVisible(e),this.getFlyout()&&this.getFlyout().setContainerVisible(e),this.getParentSvg().style.display=e?"block":"none",this.toolbox&&this.toolbox.setVisible(e),e||this.hideChaff(!0))}render(){const e=this.getAllBlocks(!1);for(let t=e.length-1;0<=t;t--)e[t].queueRender();this.getTopBlocks().flatMap(t=>t.getDescendants(!1)).filter(t=>t.isInsertionMarker()).forEach(t=>t.queueRender()),cs().then(()=>void this.markerManager.updateMarkers())}highlightBlock(e,t){if(t===void 0){for(let r=0,l;l=this.highlightedBlocks[r];r++)l.setHighlighted(!1);this.highlightedBlocks.length=0}(e=e?this.getBlockById(e):null)&&((t=t===void 0||t)?this.highlightedBlocks.includes(e)||this.highlightedBlocks.push(e):ue(this.highlightedBlocks,e),e.setHighlighted(t))}refreshToolboxSelection(){const e=this.isFlyout?this.targetWorkspace:this;e&&!e.currentGesture_&&e.toolbox&&e.toolbox.getFlyout()&&e.toolbox.refreshSelection()}renameVariableById(e,t){super.renameVariableById(e,t),this.refreshToolboxSelection()}deleteVariableById(e){super.deleteVariableById(e),this.refreshToolboxSelection()}createVariable(e,t,r){return e=super.createVariable(e,t,r),this.refreshToolboxSelection(),e}recordDragTargets(){const e=this.componentManager.getComponents(un.Capability.DRAG_TARGET,!0);this.dragTargetAreas=[];for(let t=0,r;r=e[t];t++){const l=r.getClientRect();l&&this.dragTargetAreas.push({component:r,clientRect:l})}}newBlock(e,t){throw Error("The implementation of newBlock should be monkey-patched in by blockly.ts")}newComment(e){throw Error("The implementation of newComment should be monkey-patched in by blockly.ts")}getDragTarget(e){for(let t=0,r;r=this.dragTargetAreas[t];t++)if(r.clientRect.contains(e.clientX,e.clientY))return r.component;return null}onMouseDown(e){const t=this.getGesture(e);t&&t.handleWsStart(e,this)}startDrag(e,t){_a(this,e,t)}moveDrag(e){return nd(this,e)}isDragging(){return this.currentGesture_!==null&&this.currentGesture_.isDragging()}isDraggable(){return this.options.moveOptions&&this.options.moveOptions.drag}isMovable(){return this.options.moveOptions&&!!this.options.moveOptions.scrollbars||this.options.moveOptions&&this.options.moveOptions.wheel||this.options.moveOptions&&this.options.moveOptions.drag||this.options.zoomOptions&&this.options.zoomOptions.wheel||this.options.zoomOptions&&this.options.zoomOptions.pinch}isMovableHorizontally(){const e=!!this.scrollbar;return this.isMovable()&&(!e||e&&this.scrollbar.canScrollHorizontally())}isMovableVertically(){const e=!!this.scrollbar;return this.isMovable()&&(!e||e&&this.scrollbar.canScrollVertically())}onMouseWheel(e){if(oo.inProgress())e.preventDefault(),e.stopPropagation();else{var t=this.options.zoomOptions&&this.options.zoomOptions.wheel,r=this.options.moveOptions&&this.options.moveOptions.wheel;if(t||r){var l=fe(e);if(qc)var p=e.metaKey;t&&(e.ctrlKey||p||!r)?(l=-l.y/50,t=Ee(e,this.getParentSvg(),this.getInverseScreenCTM()),this.zoom(t.x,t.y,l)):(t=this.scrollX-l.x,r=this.scrollY-l.y,e.shiftKey&&!l.x&&(t=this.scrollX-l.y,r=this.scrollY),this.scroll(t,r)),e.preventDefault()}}}getBlocksBoundingBox(){const e=this.getTopBoundedElements();if(!e.length)return new Tt(0,0,0,0);const t=e[0].getBoundingRectangle();for(let l=1;l<e.length;l++){var r=e[l];r.isInsertionMarker&&r.isInsertionMarker()||(r=r.getBoundingRectangle(),r.top<t.top&&(t.top=r.top),r.bottom>t.bottom&&(t.bottom=r.bottom),r.left<t.left&&(t.left=r.left),r.right>t.right&&(t.right=r.right))}return t}cleanUp(){this.setResizesEnabled(!1),s.setGroup$$module$build$src$core$events$utils(!0);var e=this.getTopBlocks(!0),t=e.filter(v=>v.isMovable());const r=e.filter(v=>!v.isMovable()).map(v=>v.getBoundingRectangle());e=function(v){for(const O of r)if(v.intersects(O))return O;return null};var l=0;const p=this.renderer.getConstants().MIN_BLOCK_HEIGHT;for(const v of t){for(t=v.getBoundingRectangle(),v.moveBy(-t.left,l-t.top,["cleanup"]),v.snapToGrid(),t=v.getBoundingRectangle(),l=e(t);l!=null;)l=l.top+l.getHeight()+p,v.moveBy(0,l-t.top,["cleanup"]),v.snapToGrid(),t=v.getBoundingRectangle(),l=e(t);l=v.getRelativeToSurfaceXY().y+v.getHeightWidth().height+p}s.setGroup$$module$build$src$core$events$utils(!1),this.setResizesEnabled(!0)}showContextMenu(e){if(!this.options.readOnly&&!this.isFlyout){var t=At.registry.getContextMenuOptions(At.ScopeType.WORKSPACE,{workspace:this});this.configureContextMenu&&this.configureContextMenu(t,e),Tl(e,t,this.RTL,this)}}updateToolbox(e){if(e=j(e)){if(!this.options.languageTree)throw Error("Existing toolbox is null.  Can't create new toolbox.");if(ye(e)){if(!this.toolbox)throw Error("Existing toolbox has no categories.  Can't change mode.");this.options.languageTree=e,this.toolbox.render(e)}else{if(!this.flyout)throw Error("Existing toolbox has categories.  Can't change mode.");this.options.languageTree=e,this.flyout.show(e)}}else if(this.options.languageTree)throw Error("Can't nullify an existing toolbox.")}markFocused(){this.options.parentWorkspace?this.options.parentWorkspace.markFocused():(at(this),this.getParentSvg().focus({preventScroll:!0}))}zoom(e,t,r){r=Math.pow(this.options.zoomOptions.scaleSpeed,r);const l=this.scale*r;if(this.scale!==l){l>this.options.zoomOptions.maxScale?r=this.options.zoomOptions.maxScale/this.scale:l<this.options.zoomOptions.minScale&&(r=this.options.zoomOptions.minScale/this.scale);var p=this.getCanvas().getCTM(),v=this.getParentSvg().createSVGPoint();v.x=e,v.y=t,v=v.matrixTransform(p.inverse()),e=v.x,t=v.y,p=p.translate(e*(1-r),t*(1-r)).scale(r),this.scrollX=p.e,this.scrollY=p.f,this.setScale(l)}}zoomCenter(e){var t=this.getMetrics();let r;this.flyout?(r=t.svgWidth?t.svgWidth/2:0,t=t.svgHeight?t.svgHeight/2:0):(r=t.viewWidth/2+t.absoluteLeft,t=t.viewHeight/2+t.absoluteTop),this.zoom(r,t,e)}zoomToFit(){if(this.isMovable()){var e=this.getMetrics(),t=e.viewWidth;e=e.viewHeight;var r=this.getBlocksBoundingBox(),l=2*jy,p=r.right-r.left+l;if(r=r.bottom-r.top+l,p){this.flyout&&(this.horizontalLayout?(e+=this.flyout.getHeight(),r+=this.flyout.getHeight()/this.scale):(t+=this.flyout.getWidth(),p+=this.flyout.getWidth()/this.scale)),t/=p,e/=r,s.disable$$module$build$src$core$events$utils();try{this.setScale(Math.min(t,e)),this.scrollCenter()}finally{s.enable$$module$build$src$core$events$utils()}this.maybeFireViewportChangeEvent()}}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")}beginCanvasTransition(){Pe(this.getCanvas(),"blocklyCanvasTransitioning"),Pe(this.getBubbleCanvas(),"blocklyCanvasTransitioning")}endCanvasTransition(){it(this.getCanvas(),"blocklyCanvasTransitioning"),it(this.getBubbleCanvas(),"blocklyCanvasTransitioning")}scrollCenter(){if(this.isMovable()){var e=this.getMetrics(),t=(e.scrollWidth-e.viewWidth)/2,r=(e.scrollHeight-e.viewHeight)/2;t=-t-e.scrollLeft,r=-r-e.scrollTop,this.scroll(t,r)}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")}centerOnBlock(e,t){if(this.isMovable()){var r=e?this.getBlockById(e):null;if(r){e=r.getRelativeToSurfaceXY(),r=t?{height:r.height,width:r.width}:r.getHeightWidth();var l=this.scale;t=(e.x+(this.RTL?-1:1)*r.width/2)*l,e=(e.y+r.height/2)*l,r=this.getMetrics(),this.scroll(-(t-r.viewWidth/2),-(e-r.viewHeight/2))}}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")}setScale(e){this.options.zoomOptions.maxScale&&e>this.options.zoomOptions.maxScale?e=this.options.zoomOptions.maxScale:this.options.zoomOptions.minScale&&e<this.options.zoomOptions.minScale&&(e=this.options.zoomOptions.minScale),this.scale=e,this.hideChaff(!1),(e=this.getFlyout(!1))&&e.isVisible()&&(e.reflow(),this.recordDragTargets()),this.grid&&this.grid.update(this.scale),e=this.getMetrics(),this.scrollX-=e.absoluteLeft,this.scrollY-=e.absoluteTop,e.viewLeft+=e.absoluteLeft,e.viewTop+=e.absoluteTop,this.scroll(this.scrollX,this.scrollY),this.scrollbar&&(this.flyout?this.scrollbar.resizeView(e):this.scrollbar.resizeContent(e))}getScale(){return this.options.parentWorkspace?this.options.parentWorkspace.getScale():this.scale}scroll(e,t){this.hideChaff(!0);const r=this.getMetrics();e=Math.min(e,-r.scrollLeft),t=Math.min(t,-r.scrollTop);const l=r.scrollTop+Math.max(0,r.scrollHeight-r.viewHeight);e=Math.max(e,-(r.scrollLeft+Math.max(0,r.scrollWidth-r.viewWidth))),t=Math.max(t,-l),this.scrollX=e,this.scrollY=t,this.scrollbar&&this.scrollbar.set(-(e+r.scrollLeft),-(t+r.scrollTop),!1),e+=r.absoluteLeft,t+=r.absoluteTop,this.translate(e,t)}getBlockById(e){return super.getBlockById(e)}getAllBlocks(e=!1){return super.getAllBlocks(e)}getTopBlocks(e=!1){return super.getTopBlocks(e)}addTopBlock(e){this.addTopBoundedElement(e),super.addTopBlock(e)}removeTopBlock(e){this.removeTopBoundedElement(e),super.removeTopBlock(e)}addTopComment(e){this.addTopBoundedElement(e),super.addTopComment(e)}removeTopComment(e){this.removeTopBoundedElement(e),super.removeTopComment(e)}getRootWorkspace(){return super.getRootWorkspace()}addTopBoundedElement(e){this.topBoundedElements.push(e)}removeTopBoundedElement(e){ue(this.topBoundedElements,e)}getTopBoundedElements(){return[].concat(this.topBoundedElements)}setResizesEnabled(e){const t=!this.resizesEnabled&&e;this.resizesEnabled=e,t&&this.resizeContents()}clear(){this.setResizesEnabled(!1),super.clear(),this.topBoundedElements=[],this.setResizesEnabled(!0)}registerButtonCallback(e,t){if(typeof t!="function")throw TypeError("Button callbacks must be functions.");this.flyoutButtonCallbacks.set(e,t)}getButtonCallback(e){let t;return(t=this.flyoutButtonCallbacks.get(e))!=null?t:null}removeButtonCallback(e){this.flyoutButtonCallbacks.delete(e)}registerToolboxCategoryCallback(e,t){if(typeof t!="function")throw TypeError("Toolbox category callbacks must be functions.");this.toolboxCategoryCallbacks.set(e,t)}getToolboxCategoryCallback(e){return this.toolboxCategoryCallbacks.get(e)||null}removeToolboxCategoryCallback(e){this.toolboxCategoryCallbacks.delete(e)}getGesture(e){const t=e.type==="pointerdown",r=this.currentGesture_;return r?t&&r.hasStarted()?(console.warn("Tried to start the same gesture twice."),r.cancel(),null):r:t?this.currentGesture_=new oo(e,this):null}clearGesture(){this.currentGesture_=null}cancelCurrentGesture(){this.currentGesture_&&this.currentGesture_.cancel()}getAudioManager(){return this.audioManager}getGrid(){return this.grid}hideChaff(e=!1){Hi(),Dc(this),ri(),this.hideComponents(e)}hideComponents(e=!1){this.getComponentManager().getComponents(un.Capability.AUTOHIDEABLE,!0).forEach(t=>t.autoHide(e))}static setTopLevelWorkspaceMetrics(e){const t=this.getMetrics();typeof e.x=="number"&&(this.scrollX=-(t.scrollLeft+(t.scrollWidth-t.viewWidth)*e.x)),typeof e.y=="number"&&(this.scrollY=-(t.scrollTop+(t.scrollHeight-t.viewHeight)*e.y)),this.translate(this.scrollX+t.absoluteLeft,this.scrollY+t.absoluteTop)}},Ef=class extends Os{constructor(e,t,r){super(r),this.type=ge.SELECTED,this.oldElementId=e??void 0,this.newElementId=t??void 0}toJson(){const e=super.toJson();return e.oldElementId=this.oldElementId,e.newElementId=this.newElementId,e}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new Ef),t.oldElementId=e.oldElementId,t.newElementId=e.newElementId,t}};i(Ne.EVENT,ge.SELECTED,Ef);var Cu=class{paste(e,t,r){if(!t.isCapacityAvailable(e.typeCounts))return null;r&&(e.blockState.x=r.x,e.blockState.y=r.y),r=r||new Ae(e.blockState.x||0,e.blockState.y||0),s.disable$$module$build$src$core$events$utils();let l;try{l=Ui(e.blockState,t),bd(l,r)}finally{s.enable$$module$build$src$core$events$utils()}return l&&(re()&&!l.isShadow()&&te(new(Ce(ge.BLOCK_CREATE))(l)),s.setSelected$$module$build$src$core$common(l),l)}};Cu.TYPE="block",Qs(Cu.TYPE,new Cu);var hh={};hh.bumpIntoBounds=Bo,hh.bumpIntoBoundsHandler=Ml,hh.bumpTopObjectsIntoBounds=Pc;var C$=class{constructor(e){this.block=e,this.connectionPreviewer=this.connectionCandidate=this.startLoc=this.startChildConn=this.startParentConn=null,this.dragging=!1,this.dragOffset=new Ae(0,0),this.inGroup=!1,this.workspace=e.workspace}isMovable(){if(this.block.isShadow()){let e,t;return(t=(e=this.block.getParent())==null?void 0:e.isMovable())!=null?t:!1}return this.block.isOwnMovable()&&!this.block.isDeadOrDying()&&!this.workspace.options.readOnly&&!this.block.isInFlyout}startDrag(e){if(this.block.isShadow())this.startDraggingShadow(e);else{this.dragging=!0,(this.inGroup=!!s.getGroup$$module$build$src$core$events$utils())||s.setGroup$$module$build$src$core$events$utils(!0),this.fireDragStartEvent(),this.startLoc=this.block.getRelativeToSurfaceXY(),this.connectionCandidate=null,this.connectionPreviewer=new(w(Ne.CONNECTION_PREVIEWER,this.workspace.options))(this.block),Wn(),this.workspace.setResizesEnabled(!1),ii(),e=!!e&&(e.altKey||e.ctrlKey||e.metaKey),this.shouldDisconnect(e)&&this.disconnectBlock(e),this.block.setDragging(!0);var t;(t=this.workspace.getLayerManager())==null||t.moveToDragLayer(this.block)}}startDraggingShadow(e){const t=this.block.getParent();if(!t)throw Error("Tried to drag a shadow block with no parent. Shadow blocks should always have parents.");this.dragOffset=Ae.difference(t.getRelativeToSurfaceXY(),this.block.getRelativeToSurfaceXY()),t.startDrag(e)}shouldDisconnect(e){return!!(this.block.getParent()||e&&this.block.nextConnection&&this.block.nextConnection.targetBlock())}disconnectBlock(e){let t,r,l;if(this.startParentConn=(l=(t=this.block.outputConnection)==null?void 0:t.targetConnection)!=null?l:(r=this.block.previousConnection)==null?void 0:r.targetConnection,e){let p;this.startChildConn=(p=this.block.nextConnection)==null?void 0:p.targetConnection}this.block.unplug(e),ld(this.block)}fireDragStartEvent(){const e=new(Ce(ge.BLOCK_DRAG))(this.block,!0,this.block.getDescendants(!1));te(e)}fireDragEndEvent(){const e=new(Ce(ge.BLOCK_DRAG))(this.block,!1,this.block.getDescendants(!1));te(e)}fireMoveEvent(){if(!this.block.isDeadOrDying()){var e=new(Ce(ge.BLOCK_MOVE))(this.block);e.setReason(["drag"]),e.oldCoordinate=this.startLoc,e.recordNew(),te(e)}}drag(e){if(this.block.isShadow()){let t;(t=this.block.getParent())==null||t.drag(Ae.sum(e,this.dragOffset))}else this.block.moveDuringDrag(e),this.updateConnectionPreview(this.block,Ae.difference(e,this.startLoc))}updateConnectionPreview(e,t){var r=this.connectionCandidate;const l=this.getConnectionCandidate(e,t);if(l){this.connectionCandidate=t=r&&this.currCandidateIsBetter(r,t,l)?r:l;var{local:p,neighbour:v}=t;t=p.type===Ge.OUTPUT_VALUE||p.type===Ge.PREVIOUS_STATEMENT,r=v.isConnected()&&!v.targetBlock().isInsertionMarker(),t&&r&&!this.orphanCanConnectAtEnd(e,v.targetBlock(),p.type)?this.connectionPreviewer.previewReplacement(p,v,v.targetBlock()):this.connectionPreviewer.previewConnection(p,v)}else this.connectionPreviewer.hidePreview(),this.connectionCandidate=null}orphanCanConnectAtEnd(e,t,r){return!!Jt.getConnectionForOrphanedConnection(e,r===Ge.OUTPUT_VALUE?t.outputConnection:t.previousConnection)}currCandidateIsBetter(e,t,r){const{local:l,neighbour:p}=e;e=new Ae(l.x,l.y);const v=new Ae(p.x,p.y);return t=Ae.distance(Ae.sum(e,t),v),r.distance>t-s.config$$module$build$src$core$config.currentConnectionPreference}getConnectionCandidate(e,t){e=this.getLocalConnections(e);let r=this.connectionCandidate?s.config$$module$build$src$core$config.connectingSnapRadius:s.config$$module$build$src$core$config.snapRadius,l=null;for(const p of e){const{connection:v,radius:O}=p.closest(r,t);v&&(l={local:p,neighbour:v,distance:O},r=O)}return l}getLocalConnections(e){const t=e.getConnections_(!1),r=e.lastConnectionInStack(!0);return r&&r!==e.nextConnection&&t.push(r),t}endDrag(e){if(this.block.isShadow()){let t;(t=this.block.getParent())==null||t.endDrag(e)}else{if(this.fireDragEndEvent(),this.fireMoveEvent(),Xn(),ii(),this.connectionPreviewer.hidePreview(),!this.block.isDeadOrDying()&&this.dragging){let t;(t=this.workspace.getLayerManager())==null||t.moveOffDragLayer(this.block,Wo),this.block.setDragging(!1)}this.connectionCandidate?(this.applyConnections(this.connectionCandidate),this.disposeStep()):this.block.queueRender().then(()=>this.disposeStep()),this.inGroup||s.setGroup$$module$build$src$core$events$utils(!1)}}disposeStep(){this.block.snapToGrid(),this.connectionPreviewer.dispose(),this.workspace.setResizesEnabled(!0)}applyConnections(e){const{local:t,neighbour:r}=e;t.connect(r);const l=t.isSuperior()?r:t,p=this.block.getRootBlock();cs().then(()=>{No(l.getSourceBlock()),setTimeout(()=>{p.bringToFront()},0)})}revertDrag(){if(this.block.isShadow()){let t;(t=this.block.getParent())==null||t.revertDrag()}else{var e;if((e=this.startChildConn)==null||e.connect(this.block.nextConnection),this.startParentConn)switch(this.startParentConn.type){case Ge.INPUT_VALUE:this.startParentConn.connect(this.block.outputConnection);break;case Ge.NEXT_STATEMENT:this.startParentConn.connect(this.block.previousConnection)}else{this.block.moveTo(this.startLoc,["drag"]);let t;(t=this.workspace.getLayerManager())==null||t.moveOffDragLayer(this.block,Wo),Bo(this.workspace,this.workspace.getMetricsManager().getScrollMetrics(!0),this.block)}this.startParentConn=this.startChildConn=null,this.connectionPreviewer.hidePreview(),this.connectionCandidate=null,this.block.setDragging(!1),this.dragging=!1}}},T$=class{constructor(){this.drawer=this.curNode=this.colour=null,this.type="marker"}setDrawer(e){this.drawer=e}getDrawer(){return this.drawer}getCurNode(){return this.curNode}setCurNode(e){const t=this.curNode;this.curNode=e,this.drawer&&this.drawer.draw(t,this.curNode)}draw(){this.drawer&&this.drawer.draw(this.curNode,this.curNode)}hide(){this.drawer&&this.drawer.hide()}dispose(){this.getDrawer()&&this.getDrawer().dispose()}},kf=class extends T${constructor(){super(),this.type="cursor"}next(){var e=this.getCurNode();if(!e)return null;for(e=e.next();e&&e.next()&&(e.getType()===Ie.types.NEXT||e.getType()===Ie.types.BLOCK);)e=e.next();return e&&this.setCurNode(e),e}in(){var e=this.getCurNode();if(!e)return null;(e.getType()===Ie.types.PREVIOUS||e.getType()===Ie.types.OUTPUT)&&(e=e.next());let t,r;return(e=(r=(t=e)==null?void 0:t.in())!=null?r:null)&&this.setCurNode(e),e}prev(){var e=this.getCurNode();if(!e)return null;for(e=e.prev();e&&e.prev()&&(e.getType()===Ie.types.NEXT||e.getType()===Ie.types.BLOCK);)e=e.prev();return e&&this.setCurNode(e),e}out(){var e=this.getCurNode();return e?((e=e.out())&&e.getType()===Ie.types.BLOCK&&(e=e.prev()||e),e&&this.setCurNode(e),e):null}};i(Ne.CURSOR,Pr,kf);var Tu=class extends kf{constructor(){super()}next(){var e=this.getCurNode();return e?((e=this.getNextNode_(e,this.validNode_))&&this.setCurNode(e),e):null}in(){return this.next()}prev(){var e=this.getCurNode();return e?((e=this.getPreviousNode_(e,this.validNode_))&&this.setCurNode(e),e):null}out(){return this.prev()}getNextNode_(e,t){if(!e)return null;const r=e.in()||e.next();return t(r)?r:r?this.getNextNode_(r,t):(e=this.findSiblingOrParent(e.out()),t(e)?e:e?this.getNextNode_(e,t):null)}getPreviousNode_(e,t){if(!e)return null;let r=e.prev();return r=r?this.getRightMostChild(r):e.out(),t(r)?r:r?this.getPreviousNode_(r,t):null}validNode_(e){let t=!1;return e=e&&e.getType(),(e===Ie.types.OUTPUT||e===Ie.types.INPUT||e===Ie.types.FIELD||e===Ie.types.NEXT||e===Ie.types.PREVIOUS||e===Ie.types.WORKSPACE)&&(t=!0),t}findSiblingOrParent(e){if(!e)return null;const t=e.next();return t||this.findSiblingOrParent(e.out())}getRightMostChild(e){if(!e.in())return e;for(e=e.in();e&&e.next();)e=e.next();return this.getRightMostChild(e)}};Tu.registrationName="basicCursor",i(Ne.CURSOR,Tu.registrationName,Tu);var E$=class extends Tu{validNode_(e){let t=!1;const r=e&&e.getType();return e&&(e=e.getLocation(),r===Ie.types.FIELD&&e&&e.isTabNavigable()&&e.isClickable()&&(t=!0)),t}},k$=10,hr=class extends Jt{constructor(e,t){super(e,t),this.highlighted=!1,this.targetConnection=null,this.db=e.workspace.connectionDBList[t],this.dbOpposite=e.workspace.connectionDBList[Za[t]],this.offsetInBlock=new Ae(0,0),this.trackedState=hr.TrackedState.WILL_TRACK}dispose(){super.dispose(),this.trackedState===hr.TrackedState.TRACKED&&this.db.removeConnection(this,this.y);let e,t;(t=(e=this.sourceBlock_.pathObject).removeConnectionHighlight)==null||t.call(e,this)}getSourceBlock(){return super.getSourceBlock()}targetBlock(){return super.targetBlock()}distanceFrom(e){const t=this.x-e.x;return e=this.y-e.y,Math.sqrt(t*t+e*e)}bumpAwayFrom(e,t=!1){if(!this.sourceBlock_.workspace.isDragging()){var r=s.config$$module$build$src$core$config.snapRadius+Math.floor(Math.random()*k$),l=s.config$$module$build$src$core$config.snapRadius+Math.floor(Math.random()*k$),p=e.sourceBlock_.getRootBlock(),v=this.sourceBlock_.getRootBlock();if(!p.isInFlyout&&!v.isInFlyout){var O=!0;if(v.isMovable())p.isMovable()&&t&&(l=-l);else if(p.isMovable())O=!1,r=-r,l=-l;else return;t=O?e:this,e=O?this:e,p=O?v:p,(v=Ue()===p)||p.addSelect(),p.RTL&&(r=-r),p.moveBy(t.x+r-e.x,t.y+l-e.y,["bump"]),v||p.removeSelect()}}}moveTo(e,t){let r=!1;return this.trackedState===hr.TrackedState.WILL_TRACK?(this.db.addConnection(this,t),this.trackedState=hr.TrackedState.TRACKED,r=!0):this.trackedState===hr.TrackedState.TRACKED&&(this.db.removeConnection(this,this.y),this.db.addConnection(this,t),r=!0),this.x=e,this.y=t,r}moveBy(e,t){return this.moveTo(this.x+e,this.y+t)}moveToOffset(e){return this.moveTo(e.x+this.offsetInBlock.x,e.y+this.offsetInBlock.y)}setOffsetInBlock(e,t){this.offsetInBlock.x=e,this.offsetInBlock.y=t}getOffsetInBlock(){return this.offsetInBlock}tightenEfficiently(){var e=this.targetConnection;const t=this.targetBlock();e&&t&&(e=Ae.difference(this.offsetInBlock,e.offsetInBlock),t.translate(e.x,e.y))}closest(e,t){return this.dbOpposite.searchForClosest(this,e,t)}highlight(){this.highlighted=!0,this.getSourceBlock().queueRender()}unhighlight(){this.highlighted=!1,this.getSourceBlock().queueRender()}isHighlighted(){return this.highlighted}setTracking(e){e&&this.trackedState===hr.TrackedState.TRACKED||!e&&this.trackedState===hr.TrackedState.UNTRACKED||this.sourceBlock_.isInFlyout||(e?(this.db.addConnection(this,this.y),this.trackedState=hr.TrackedState.TRACKED):(this.trackedState===hr.TrackedState.TRACKED&&this.db.removeConnection(this,this.y),this.trackedState=hr.TrackedState.UNTRACKED))}stopTrackingAll(){if(this.setTracking(!1),this.targetConnection){const e=this.targetBlock().getDescendants(!1);for(let t=0;t<e.length;t++){const r=e[t],l=r.getConnections_(!0);for(let p=0;p<l.length;p++)l[p].setTracking(!1);for(const p of r.getIcons())ul(p)&&p.setBubbleVisible(!1)}}}startTrackingAll(){this.setTracking(!0);let e=[];if(this.type!==Ge.INPUT_VALUE&&this.type!==Ge.NEXT_STATEMENT)return e;const t=this.targetBlock();if(t){let r;t.isCollapsed()?(r=[],t.outputConnection&&r.push(t.outputConnection),t.nextConnection&&r.push(t.nextConnection),t.previousConnection&&r.push(t.previousConnection)):r=t.getConnections_(!0);for(let l=0;l<r.length;l++)e.push(...r[l].startTrackingAll());e.length||(e=[t])}return e}onFailedConnect(e){const t=this.getSourceBlock();if(Y()){const r=s.getGroup$$module$build$src$core$events$utils();setTimeout(function(){t.isDisposed()||t.getParent()||(s.setGroup$$module$build$src$core$events$utils(r),this.bumpAwayFrom(e),s.setGroup$$module$build$src$core$events$utils(!1))}.bind(this),s.config$$module$build$src$core$config.bumpDelay)}}disconnectInternal(e=!0){const{parentConnection:t,childConnection:r}=this.getParentAndChildConnections();if(t&&r){var l=s.getGroup$$module$build$src$core$events$utils();l||s.setGroup$$module$build$src$core$events$utils(!0);var p=t.getSourceBlock(),v=r.getSourceBlock();super.disconnectInternal(e),p.queueRender(),v.updateDisabled(),v.queueRender(),v.getSvgRoot().style.display="block",s.setGroup$$module$build$src$core$events$utils(l)}}respawnShadow_(){super.respawnShadow_();const e=this.targetBlock();e&&(e.initSvg(),e.queueRender())}neighbours(e){return this.dbOpposite.getNeighbours(this,e)}connect_(e){super.connect_(e);var t=this.getSourceBlock();e=e.getSourceBlock(),t.updateDisabled(),e.updateDisabled(),e.queueRender(),(t=t.getInputWithBlock(e))&&(t=t.isVisible(),e.getSvgRoot().style.display=t?"block":"none")}onCheckChanged_(){!this.isConnected()||this.targetConnection&&this.getConnectionChecker().canConnect(this,this.targetConnection,!1)||(this.isSuperior()?this.targetBlock():this.sourceBlock_).unplug()}setCheck(e){return super.setCheck(e),this.sourceBlock_.queueRender(),this}};(function(e){e=e.TrackedState||(e.TrackedState={}),e[e.WILL_TRACK=-1]="WILL_TRACK",e[e.UNTRACKED=0]="UNTRACKED",e[e.TRACKED=1]="TRACKED"})(hr),hr.TrackedState;var qr=class extends Jo{constructor(e,t,r){if(super(e,t,r),this.childlessWidth=this.width=this.height=0,this.warningTextDb=new Map,this.mutator=null,this.rendered=!0,this.visuallyDisabled=!1,this.translation="",this.dragging=!1,this.relativeCoords=new Ae(0,0),this.dragStrategy=new C$(this),!e.rendered)throw TypeError("Cannot create a rendered block in a headless workspace");this.workspace=e,this.svgGroup=ie(ae.G,{}),this.style=e.getRenderer().getConstants().getBlockStyle(null),this.pathObject=e.getRenderer().makePathObject(this.svgGroup,this.style),e=this.pathObject.svgPath,e.tooltip=this,$l(e),this.svgGroup.setAttribute("data-id",this.id),this.doInit_()}initSvg(){if(!this.initialized){for(var e of this.inputList)e.init();for(const t of this.getIcons())t.initView(this.createIconPointerDownListener(t)),t.updateEditable();this.applyColour(),this.pathObject.updateMovable(this.isMovable()||this.isInFlyout),e=this.getSvgRoot(),!this.workspace.options.readOnly&&e&&He(e,"pointerdown",this,this.onMouseDown),e.parentNode||this.workspace.getCanvas().appendChild(e),this.initialized=!0}}getColourSecondary(){return this.style.colourSecondary}getColourTertiary(){return this.style.colourTertiary}select(){if(this.isShadow()){let e;(e=this.getParent())==null||e.select()}else this.addSelect()}unselect(){if(this.isShadow()){let e;(e=this.getParent())==null||e.unselect()}else this.removeSelect()}setParent(e){const t=this.parentBlock_;if(e!==t){Wn(),super.setParent(e),Xn();var r=this.getSvgRoot();if(!this.workspace.isClearing&&r){var l=this.getRelativeToSurfaceXY();e?e.getSvgRoot().appendChild(r):t&&((e=this.workspace.getCanvas().querySelector(".blocklyDragging"))?this.workspace.getCanvas().insertBefore(r,e):this.workspace.getCanvas().appendChild(r),this.translate(l.x,l.y)),this.applyColour()}}}getRelativeToSurfaceXY(){const e=this.workspace.getLayerManager();if(!e)throw Error("Cannot calculate position because the workspace has not been appended");let t=0,r=0,l=this.getSvgRoot();if(l)do{const p=Rr(l);t+=p.x,r+=p.y,l=l.parentNode}while(l&&!e.hasLayer(l));return new Ae(t,r)}moveBy(e,t,r){if(this.parentBlock_)throw Error("Block has parent");const l=re();let p=null;l&&(p=new(Ce(ge.BLOCK_MOVE))(this),r&&p.setReason(r)),e=new Ae(e,t),t=this.getRelativeToSurfaceXY(),e=Ae.sum(t,e),this.translate(e.x,e.y),this.updateComponentLocations(e),l&&p&&(p.recordNew(),te(p)),this.workspace.resizeContents()}translate(e,t){this.translation=`translate(${e}, ${t})`,this.relativeCoords=new Ae(e,t),this.getSvgRoot().setAttribute("transform",this.getTranslation())}getTranslation(){return this.translation}moveTo(e,t){const r=this.getRelativeToSurfaceXY();this.moveBy(e.x-r.x,e.y-r.y,t)}moveDuringDrag(e){this.translate(e.x,e.y),this.getSvgRoot().setAttribute("transform",this.getTranslation()),this.updateComponentLocations(e)}snapToGrid(){if(!this.isDeadOrDying()&&!this.getParent()&&!this.isInFlyout){var e=this.workspace.getGrid();if(e!=null&&e.shouldSnap()){var t=this.getRelativeToSurfaceXY();e=e.alignXY(t),e!==t&&this.moveTo(e,["snap"])}}}getBoundingRectangle(){return this.getBoundingRectangleWithDimensions(this.getHeightWidth())}getBoundingRectangleWithoutChildren(){return this.getBoundingRectangleWithDimensions({height:this.height,width:this.childlessWidth})}getBoundingRectangleWithDimensions(e){const t=this.getRelativeToSurfaceXY();let r,l;return this.RTL?(r=t.x-e.width,l=t.x):(r=t.x,l=t.x+e.width),new Tt(t.y,t.y+e.height,r,l)}markDirty(){this.pathObject.constants=this.workspace.getRenderer().getConstants();for(let e=0,t;t=this.inputList[e];e++)t.markDirty()}setCollapsed(e){this.collapsed_!==e&&(super.setCollapsed(e),this.updateCollapsed())}updateCollapsed(){var e=this.isCollapsed();const t=tu,r=Kd;for(let p=0,v;v=this.inputList[p];p++)v.name!==t&&v.setVisible(!e);for(var l of this.getIcons())l.updateCollapsed();e?(e=this.toString(Xa),(l=this.getField(r))?l.setValue(e):(this.getInput(t)||this.appendDummyInput(t)).appendField(new Ya(e),r)):(this.updateDisabled(),this.removeInput(t))}tab(e,t){const r=new E$;r.setCurNode(Ie.createFieldNode(e)),e=r.getCurNode(),t?r.next():r.prev(),(t=r.getCurNode())&&t!==e&&(t.getLocation().showEditor(),this.workspace.keyboardAccessibilityMode&&this.workspace.getCursor().setCurNode(t))}onMouseDown(e){const t=this.workspace.getGesture(e);t&&t.handleBlockStart(e,this)}showHelp(){const e=typeof this.helpUrl=="function"?this.helpUrl():this.helpUrl;e&&window.open(e)}generateContextMenu(){if(this.workspace.options.readOnly||!this.contextMenu)return null;const e=At.registry.getContextMenuOptions(At.ScopeType.BLOCK,{block:this});return this.customContextMenu&&this.customContextMenu(e),e}showContextMenu(e){const t=this.generateContextMenu();t&&t.length&&(Tl(e,t,this.RTL,this.workspace),Cl(this))}updateComponentLocations(e){this.dragging||this.updateConnectionLocations(e),this.updateIconLocations(e),this.updateFieldLocations(e);for(const t of this.getChildren(!1))t.updateComponentLocations(Ae.sum(e,t.relativeCoords))}updateConnectionLocations(e){for(const t of this.getConnections_(!1))t.moveToOffset(e)}updateIconLocations(e){for(const t of this.getIcons())t.onLocationChange(e)}updateFieldLocations(e){for(const t of this.inputList)for(const r of t.fieldRow)r.onLocationChange(e)}setDragging(e){(this.dragging=e)?(this.translation="",Bl.push(...this.getConnections_(!0)),Pe(this.svgGroup,"blocklyDragging")):(Bl.length=0,it(this.svgGroup,"blocklyDragging"));for(let t=0;t<this.childBlocks_.length;t++)this.childBlocks_[t].setDragging(e)}setMovable(e){super.setMovable(e),this.pathObject.updateMovable(e)}setEditable(e){super.setEditable(e),e=this.getIcons();for(let t=0;t<e.length;t++)e[t].updateEditable()}setShadow(e){super.setShadow(e),this.applyColour()}setInsertionMarker(e){this.isInsertionMarker_!==e&&(this.isInsertionMarker_=e)&&(this.setColour(this.workspace.getRenderer().getConstants().INSERTION_MARKER_COLOUR),this.pathObject.updateInsertionMarker(!0))}getSvgRoot(){return this.svgGroup}dispose(e,t){if(this.disposing=!0,vl(),El(),t&&(this.unplug(e),ad(this)),t=Ue(),t instanceof Jo){let r=t;for(;r!==null;)r===this&&t.unselect(),r=r.getParent()}super.dispose(!!e),lt(this.svgGroup)}disposeInternal(){this.disposing=!0,super.disposeInternal(),Ue()===this&&(this.unselect(),this.workspace.cancelCurrentGesture()),[...this.warningTextDb.values()].forEach(e=>clearTimeout(e)),this.warningTextDb.clear(),this.getIcons().forEach(e=>e.dispose())}checkAndDelete(){this.workspace.isFlyout||(s.setGroup$$module$build$src$core$events$utils(!0),this.workspace.hideChaff(),this.outputConnection?this.dispose(!1,!0):this.dispose(!0,!0),s.setGroup$$module$build$src$core$events$utils(!1))}toCopyData(){return this.isInsertionMarker_?null:{paster:Cu.TYPE,blockState:Vt(this,{addCoordinates:!0,addNextBlocks:!1}),typeCounts:It(this,!0)}}applyColour(){this.pathObject.applyColour(this);const e=this.getIcons();for(let t=0;t<e.length;t++)e[t].applyColour();for(let t=0,r;r=this.inputList[t];t++)for(let l=0,p;p=r.fieldRow[l];l++)p.applyColour()}updateDisabled(){const e=!this.isEnabled()||this.getInheritedDisabled();if(this.visuallyDisabled===e){let t;(t=this.getNextBlock())==null||t.updateDisabled()}else{this.applyColour(),this.visuallyDisabled=e;for(const t of this.getChildren(!1))t.updateDisabled()}}setWarningText(e,t=""){if(t)this.warningTextDb.has(t)&&(clearTimeout(this.warningTextDb.get(t)),this.warningTextDb.delete(t));else{for(var r of this.warningTextDb.values())clearTimeout(r);this.warningTextDb.clear()}if(this.workspace.isDragging())this.warningTextDb.set(t,setTimeout(()=>{this.isDeadOrDying()||(this.warningTextDb.delete(t),this.setWarningText(e,t))},100));else if(this.isInFlyout&&(e=null),r=this.getIcon(uo.TYPE),e){let l=this.getSurroundParent(),p=null;for(;l;)l.isCollapsed()&&(p=l),l=l.getSurroundParent();p&&p.setWarningText(s.Msg$$module$build$src$core$msg.COLLAPSED_WARNINGS_WARNING,qr.COLLAPSED_WARNING_ID),r?r.addMessage(e,t):this.addIcon(new uo(this).addMessage(e,t))}else r&&(t?(r.addMessage("",t),r.getText()||this.removeIcon(uo.TYPE)):this.removeIcon(uo.TYPE))}setMutator(e){this.removeIcon(s.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE),e&&this.addIcon(e)}addIcon(e){return super.addIcon(e),e instanceof s.MutatorIcon$$module$build$src$core$icons$mutator_icon&&(this.mutator=e),e.initView(this.createIconPointerDownListener(e)),e.applyColour(),e.updateEditable(),this.queueRender(),e}createIconPointerDownListener(e){return t=>{this.isDeadOrDying()||(t=this.workspace.getGesture(t))&&t.setStartIcon(e)}}removeIcon(e){const t=super.removeIcon(e);return e.equals(s.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE)&&(this.mutator=null),this.queueRender(),t}setEnabled(e){C("setEnabled","v11","v12","the setDisabledReason method of BlockSvg");const t=this.isEnabled();super.setEnabled(e),this.isEnabled()===t||this.getInheritedDisabled()||this.updateDisabled()}setDisabledReason(e,t){const r=this.isEnabled();super.setDisabledReason(e,t),this.isEnabled()===r||this.getInheritedDisabled()||this.updateDisabled()}setHighlighted(e){this.pathObject.updateHighlighted(e)}addSelect(){this.pathObject.updateSelected(!0)}removeSelect(){this.pathObject.updateSelected(!1)}setDeleteStyle(e){this.pathObject.updateDraggingDelete(e)}getColour(){return this.style.colourPrimary}setColour(e){super.setColour(e),e=this.workspace.getRenderer().getConstants().getBlockStyleForColour(this.colour_),this.pathObject.setStyle(e.style),this.style=e.style,this.styleName_=e.name,this.applyColour()}setStyle(e){const t=this.workspace.getRenderer().getConstants().getBlockStyle(e);if(this.styleName_=e,t)this.hat=t.hat,this.pathObject.setStyle(t),this.colour_=t.colourPrimary,this.style=t,this.applyColour();else throw Error("Invalid style name: "+e)}bringToFront(e=!1){let t=this;if(!t.isDeadOrDying())do{const r=t.getSvgRoot(),l=r.parentNode,p=l.childNodes;if(p[p.length-1]!==r&&l.appendChild(r),e)break;t=t.getParent()}while(t)}setPreviousStatement(e,t){super.setPreviousStatement(e,t),this.queueRender()}setNextStatement(e,t){super.setNextStatement(e,t),this.queueRender()}setOutput(e,t){super.setOutput(e,t),this.queueRender()}setInputsInline(e){super.setInputsInline(e),this.queueRender()}removeInput(e,t){return e=super.removeInput(e,t),this.queueRender(),e}moveNumberedInputBefore(e,t){super.moveNumberedInputBefore(e,t),this.queueRender()}appendInput(e){return super.appendInput(e),this.queueRender(),e}setConnectionTracking(e){if(this.previousConnection&&this.previousConnection.setTracking(e),this.outputConnection&&this.outputConnection.setTracking(e),this.nextConnection){this.nextConnection.setTracking(e);var t=this.nextConnection.targetBlock();t&&t.setConnectionTracking(e)}if(!this.collapsed_)for(t=0;t<this.inputList.length;t++){var r=this.inputList[t].connection;r&&(r.setTracking(e),(r=r.targetBlock())&&r.setConnectionTracking(e))}}getConnections_(e){const t=[];if(this.outputConnection&&t.push(this.outputConnection),this.previousConnection&&t.push(this.previousConnection),this.nextConnection&&t.push(this.nextConnection),e||!this.collapsed_)for(let r=0,l;l=this.inputList[r];r++)l.connection&&t.push(l.connection);return t}lastConnectionInStack(e){return super.lastConnectionInStack(e)}getMatchingConnection(e,t){return super.getMatchingConnection(e,t)}makeConnection_(e){return new hr(this,e)}getNextBlock(){return super.getNextBlock()}getPreviousBlock(){return super.getPreviousBlock()}bumpNeighbours(){const e=this.getRootBlock();if(!(this.isDeadOrDying()||this.workspace.isDragging()||e.isInFlyout))for(const t of this.getConnections_(!1)){if(t.isSuperior()){let r;(r=t.targetBlock())==null||r.bumpNeighbours()}for(const r of t.neighbours(s.config$$module$build$src$core$config.snapRadius))r.getSourceBlock().getRootBlock()!==e&&(t.isConnected()&&r.isConnected()||(t.isSuperior()?r.bumpAwayFrom(t,!1):t.bumpAwayFrom(r,!0)))}}scheduleSnapAndBump(){this.snapToGrid(),this.bumpNeighbours()}positionNearConnection(e,t,r){if(e.type===Ge.NEXT_STATEMENT||e.type===Ge.INPUT_VALUE){let l=t.x;t=t.y,l+=r.x-e.getOffsetInBlock().x,t+=r.y-e.getOffsetInBlock().y,this.moveBy(l,t)}}getChildren(e){return super.getChildren(e)}queueRender(){return Fi(this)}render(){this.queueRender(),js()}renderEfficiently(){Wn(),this.isCollapsed()&&this.updateCollapsed(),this.isEnabled()||this.updateDisabled(),this.workspace.getRenderer().render(this),this.tightenChildrenEfficiently(),Xn(),this.updateMarkers_()}tightenChildrenEfficiently(){for(const e of this.inputList){const t=e.connection;t&&t.tightenEfficiently()}this.nextConnection&&this.nextConnection.tightenEfficiently()}updateMarkers_(){this.workspace.keyboardAccessibilityMode&&this.pathObject.cursorSvg&&this.workspace.getCursor().draw(),this.workspace.keyboardAccessibilityMode&&this.pathObject.markerSvg&&this.workspace.getMarker(cu.LOCAL_MARKER).draw();for(const e of this.inputList)for(const t of e.fieldRow)t.updateMarkers_()}setCursorSvg(e){this.pathObject.setCursorSvg(e)}setMarkerSvg(e){this.pathObject.setMarkerSvg(e)}getHeightWidth(){let e=this.height,t=this.width;var r=this.getNextBlock();if(r){r=r.getHeightWidth();const l=this.workspace.getRenderer().getConstants().NOTCH_HEIGHT;e+=r.height-l,t=Math.max(t,r.width)}return{height:e,width:t}}fadeForReplacement(e){this.pathObject.updateReplacementFade(e)}highlightShapeForInput(e,t){this.pathObject.updateShapeForInputHighlight(e,t)}setDragStrategy(e){this.dragStrategy=e}isMovable(){return this.dragStrategy.isMovable()}startDrag(e){this.dragStrategy.startDrag(e)}drag(e,t){this.dragStrategy.drag(e,t)}endDrag(e){this.dragStrategy.endDrag(e)}revertDrag(){this.dragStrategy.revertDrag()}toFlyoutInfo(){const e=Object.assign({},{kind:"BLOCK"},Vt(this)),t=new Set(["id","height","width","pinned","enabled"]),r=function(l){for(const p in l)t.has(p)?delete l[p]:typeof l[p]=="object"&&r(l[p])};return r(e),[e]}};qr.INLINE=-1,qr.COLLAPSED_WARNING_ID="TEMP_COLLAPSED_WARNING_";var I$=class{constructor(){}onDragEnter(e){}onDragOver(e){}onDragExit(e){}onDrop(e){}getClientRect(){return null}shouldPreventMove(e){return!1}},ph=class extends I${constructor(){super(),this.wouldDelete_=!1}wouldDelete(e){return e instanceof qr?(e=!e.getParent()&&e.isDeletable(),this.updateWouldDelete_(e)):this.updateWouldDelete_(xn(e)&&e.isDeletable()),this.wouldDelete_}updateWouldDelete_(e){this.wouldDelete_=e}},If=class extends Os{constructor(e,t){super(t),this.type=ge.TRASHCAN_OPEN,this.isOpen=e}toJson(){const e=super.toJson();if(this.isOpen===void 0)throw Error("Whether this is already open or not is undefined. Either pass a value to the constructor, or call fromJson");return e.isOpen=this.isOpen,e}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new If),t.isOpen=e.isOpen,t}};i(Ne.EVENT,ge.TRASHCAN_OPEN,If);var x$=class extends ph{constructor(e){super(),this.workspace=e,this.id="trashcan",this.contents=[],this.flyout=null,this.isLidOpen=!1,this.minOpenness=0,this.lidTask=this.svgLid=this.svgGroup=null,this.top=this.left=this.lidOpen=0,this.initialized=!1,0>=this.workspace.options.maxTrashcanContents||(e=new Wr({scrollbars:!0,parentWorkspace:this.workspace,rtl:this.workspace.RTL,oneBasedIndex:this.workspace.options.oneBasedIndex,renderer:this.workspace.options.renderer,rendererOverrides:this.workspace.options.rendererOverrides,move:{scrollbars:!0}}),this.workspace.horizontalLayout?(e.toolboxPosition=this.workspace.toolboxPosition===wt.TOP?wt.BOTTOM:wt.TOP,this.flyout=new(w(Ne.FLYOUTS_HORIZONTAL_TOOLBOX,this.workspace.options,!0))(e)):(e.toolboxPosition=this.workspace.toolboxPosition===wt.RIGHT?wt.LEFT:wt.RIGHT,this.flyout=new(w(Ne.FLYOUTS_VERTICAL_TOOLBOX,this.workspace.options,!0))(e)),this.workspace.addChangeListener(this.onDelete.bind(this)))}createDom(){this.svgGroup=ie(ae.G,{class:"blocklyTrash"});let e;const t=String(Math.random()).substring(2);e=ie(ae.CLIPPATH,{id:"blocklyTrashBodyClipPath"+t},this.svgGroup),ie(ae.RECT,{width:nc,height:gh,y:sc},e);const r=ie(ae.IMAGE,{width:Us.width,x:-fh,height:Us.height,y:-mh,"clip-path":"url(#blocklyTrashBodyClipPath"+t+")"},this.svgGroup);return r.setAttributeNS(ar,"xlink:href",this.workspace.options.pathToMedia+Us.url),e=ie(ae.CLIPPATH,{id:"blocklyTrashLidClipPath"+t},this.svgGroup),ie(ae.RECT,{width:nc,height:sc},e),this.svgLid=ie(ae.IMAGE,{width:Us.width,x:-fh,height:Us.height,y:-mh,"clip-path":"url(#blocklyTrashLidClipPath"+t+")"},this.svgGroup),this.svgLid.setAttributeNS(ar,"xlink:href",this.workspace.options.pathToMedia+Us.url),Ft(this.svgGroup,"pointerdown",this,this.blockMouseDownWhenOpenable),Ft(this.svgGroup,"pointerup",this,this.click),Ft(r,"pointerover",this,this.mouseOver),Ft(r,"pointerout",this,this.mouseOut),this.animateLid(),this.svgGroup}init(){0<this.workspace.options.maxTrashcanContents&&(yn(this.flyout.createDom(ae.SVG),this.workspace.getParentSvg()),this.flyout.init(this.workspace)),this.workspace.getComponentManager().addComponent({component:this,weight:un.ComponentWeight.TRASHCAN_WEIGHT,capabilities:[un.Capability.AUTOHIDEABLE,un.Capability.DELETE_AREA,un.Capability.DRAG_TARGET,un.Capability.POSITIONABLE]}),this.initialized=!0,this.setLidOpen(!1)}dispose(){this.workspace.getComponentManager().removeComponent("trashcan"),this.svgGroup&&lt(this.svgGroup),this.lidTask&&clearTimeout(this.lidTask)}hasContents(){return!!this.contents.length}contentsIsOpen(){return!!this.flyout&&this.flyout.isVisible()}openFlyout(){if(!this.contentsIsOpen()){var e=this.contents.map(function(r){return JSON.parse(r)}),t=this.workspace.getParentSvg().style;t.cursor="wait",setTimeout(()=>{let r;(r=this.flyout)==null||r.show(e),t.cursor="";let l;(l=this.workspace.scrollbar)==null||l.setVisible(!1)},10),this.fireUiEvent(!0)}}closeFlyout(){if(this.contentsIsOpen()){var e;(e=this.flyout)==null||e.hide();var t;(t=this.workspace.scrollbar)==null||t.setVisible(!0),this.fireUiEvent(!1),this.workspace.recordDragTargets()}}autoHide(e){!e&&this.flyout&&this.closeFlyout()}emptyContents(){this.hasContents()&&(this.contents.length=0,this.setMinOpenness(0),this.closeFlyout())}position(e,t){if(this.initialized){var r=Ct(this.workspace,e);e=tn(r,new Pt(nc,gh+sc),zy,D$,e,this.workspace),t=nn(e,D$,r.vertical===jr.TOP?ws.DOWN:ws.UP,t),this.top=t.top,this.left=t.left;var l;(l=this.svgGroup)==null||l.setAttribute("transform","translate("+this.left+","+this.top+")")}}getBoundingRectangle(){return new Tt(this.top,this.top+gh+sc,this.left,this.left+nc)}getClientRect(){if(!this.svgGroup)return null;var e=this.svgGroup.getBoundingClientRect();const t=e.top+mh-rc;return e=e.left+fh-rc,new Tt(t,t+sc+gh+2*rc,e,e+nc+2*rc)}onDragOver(e){this.setLidOpen(this.wouldDelete_)}onDragExit(e){this.setLidOpen(!1)}onDrop(e){setTimeout(this.setLidOpen.bind(this,!1),100)}setLidOpen(e){this.isLidOpen!==e&&(this.lidTask&&clearTimeout(this.lidTask),this.isLidOpen=e,this.animateLid())}animateLid(){const e=Wy;var t=1/(e+1);this.lidOpen+=this.isLidOpen?t:-t,this.lidOpen=Math.min(Math.max(this.lidOpen,this.minOpenness),1),this.setLidAngle(this.lidOpen*O$),t=bh+this.lidOpen*(Vy-bh),this.svgGroup&&(this.svgGroup.style.opacity=`${t}`),this.lidOpen>this.minOpenness&&1>this.lidOpen&&(this.lidTask=setTimeout(this.animateLid.bind(this),Hy/e))}setLidAngle(e){const t=this.workspace.toolboxPosition===wt.RIGHT||this.workspace.horizontalLayout&&this.workspace.RTL;let r;(r=this.svgLid)==null||r.setAttribute("transform","rotate("+(t?-e:e)+","+(t?4:nc-4)+","+(sc-2)+")")}setMinOpenness(e){this.minOpenness=e,this.isLidOpen||this.setLidAngle(e*O$)}closeLid(){this.setLidOpen(!1)}click(){this.hasContents()&&!this.workspace.isDragging()&&this.openFlyout()}fireUiEvent(e){e=new(Ce(ge.TRASHCAN_OPEN))(e,this.workspace.id),te(e)}blockMouseDownWhenOpenable(e){!this.contentsIsOpen()&&this.hasContents()&&e.stopPropagation()}mouseOver(){this.hasContents()&&this.setLidOpen(!0)}mouseOut(){this.setLidOpen(!1)}onDelete(e){if(!(0>=this.workspace.options.maxTrashcanContents||!R(e)||e.wasShadow)){if(!e.oldJson)throw Error("Encountered a delete event without proper oldJson");if(e=JSON.stringify(this.cleanBlockJson(e.oldJson)),!this.contents.includes(e)){for(this.contents.unshift(e);this.contents.length>this.workspace.options.maxTrashcanContents;)this.contents.pop();this.setMinOpenness(Uy)}}}cleanBlockJson(e){function t(r){if(r){if(delete r.id,delete r.x,delete r.y,delete r.enabled,delete r.disabledReasons,r.icons&&r.icons.comment){var l=r.icons.comment;delete l.height,delete l.width,delete l.pinned}l=r.inputs;for(var p in l){var v=l[p];const O=v.block;v=v.shadow,O&&t(O),v&&t(v)}r.next&&(p=r.next,r=p.block,p=p.shadow,r&&t(r),p&&t(p))}}return e=JSON.parse(JSON.stringify(e)),t(e),Object.assign({},{kind:"BLOCK"},e)}},nc=47,gh=44,sc=16,D$=20,zy=20,rc=10,fh=0,mh=32,Uy=.1,Hy=80,Wy=4,bh=.4,Vy=.8,O$=45,an=class{constructor(){this.shortcuts=new Map,this.keyMap=new Map,this.reset()}reset(){this.shortcuts.clear(),this.keyMap.clear()}register(e,t){if(this.shortcuts.get(e.name)&&!t)throw Error(`Shortcut named "${e.name}" already exists.`);if(this.shortcuts.set(e.name,e),t=e.keyCodes,t!=null&&t.length)for(const r of t)this.addKeyMapping(r,e.name,!!e.allowCollision)}unregister(e){return this.shortcuts.get(e)?(this.removeAllKeyMappings(e),this.shortcuts.delete(e),!0):(console.warn(`Keyboard shortcut named "${e}" not found.`),!1)}addKeyMapping(e,t,r){e=`${e}`;const l=this.keyMap.get(e);if(l&&!r)throw Error(`Shortcut named "${t}" collides with shortcuts "${l}"`);l&&r?l.unshift(t):this.keyMap.set(e,[t])}removeKeyMapping(e,t,r){const l=this.keyMap.get(e);if(!l)return r||console.warn(`No keyboard shortcut named "${t}" registered with key code "${e}"`),!1;const p=l.indexOf(t);return-1<p?(l.splice(p,1),l.length===0&&this.keyMap.delete(e),!0):(r||console.warn(`No keyboard shortcut named "${t}" registered with key code "${e}"`),!1)}removeAllKeyMappings(e){for(const t of this.keyMap.keys())this.removeKeyMapping(t,e,!0)}setKeyMap(e){this.keyMap.clear();for(const t in e)this.keyMap.set(t,e[t])}getKeyMap(){const e=Object.create(null);for(const[t,r]of this.keyMap)e[t]=r;return e}getRegistry(){const e=Object.create(null);for(const[t,r]of this.shortcuts)e[t]=r;return ns(Object.create(null),e)}onKeyDown(e,t){var r=this.serializeKeyEvent(t);if(r=this.getShortcutNamesByKeyCode(r),!r)return!1;for(const l of r){if(r=this.shortcuts.get(l),!r||r.preconditionFn&&!r.preconditionFn(e))continue;let p,v;if((v=(p=r).callback)!=null&&v.call(p,e,t,r))return!0}return!1}getShortcutNamesByKeyCode(e){return this.keyMap.get(e)||[]}getKeyCodesByShortcutName(e){const t=[];for(const[r,l]of this.keyMap)-1<l.indexOf(e)&&t.push(r);return t}serializeKeyEvent(e){let t="";for(const r in an.modifierKeys)e.getModifierState(r)&&(t!==""&&(t+="+"),t+=r);return t!==""&&e.keyCode?t+="+"+e.keyCode:e.keyCode&&(t=String(e.keyCode)),t}checkModifiers(e){for(const t of e)if(!(t in an.modifierKeys))throw Error(t+" is not a valid modifier key.")}createSerializedKey(e,t){let r="";if(t){this.checkModifiers(t);for(const l in an.modifierKeys)t.includes(an.modifierKeys[l])&&(r!==""&&(r+="+"),r+=l)}return r!==""&&e?r+="+"+e:e&&(r=`${e}`),r}};an.registry=new an,function(e){e=e.modifierKeys||(e.modifierKeys={}),e[e.Shift=16]="Shift",e[e.Control=17]="Control",e[e.Alt=18]="Alt",e[e.Meta=91]="Meta"}(an);var Ms=null,Eu=null,Gy={duplicateInternal:$b,copyInternal:$d},ku={};ku.BlockPaster=Cu,ku.TEST_ONLY=Gy,ku.paste=Fo,ku.registry=zg;var Oi;(function(e){e.ESCAPE="escape",e.DELETE="delete",e.COPY="copy",e.CUT="cut",e.PASTE="paste",e.UNDO="undo",e.REDO="redo"})(Oi||(Oi={}));var Yo=null,Ri=null,ic=null;ag();var Kr={};Kr.names=Oi,Kr.registerCopy=vd,Kr.registerCut=rg,Kr.registerDefaultShortcuts=ag,Kr.registerDelete=Ea,Kr.registerEscape=sg,Kr.registerPaste=ig,Kr.registerRedo=og,Kr.registerUndo=ka;var qy=class{constructor(e,t){this.procedureModelClass=e,this.parameterModelClass=t,this.priority=Mb}save(e){return e=e.getProcedureMap().getProcedures().map(t=>Fc(t)),e.length?e:null}load(e,t){const r=t.getProcedureMap();for(const l of e)r.add(yd(this.procedureModelClass,this.parameterModelClass,l,t))}clear(e){e.getProcedureMap().clear()}},$h={};$h.ProcedureSerializer=qy,$h.loadProcedure=yd,$h.saveProcedure=Fc;var R$=class{constructor(){this.priority=Nb}save(e){const t=[];for(const r of e.getAllVariables())e={name:r.name,id:r.getId()},r.type&&(e.type=r.type),t.push(e);return t.length?t:null}load(e,t){for(const r of e)t.createVariable(r.name,r.type,r.id)}clear(e){e.getVariableMap().clear()}};bn("variables",new R$);var A$={};A$.VariableSerializer=R$;var vh={};vh.load=yb,vh.save=vb;var Ky={blocks:ou,exceptions:Ba,priorities:Ry,procedures:$h,registry:jg,variables:A$,workspaceComments:Vd,workspaces:vh},xf=class{constructor(e,t,r,l,p){this.workspace=e,this.oldHostMetrics=this.corner_=this.vScroll=this.hScroll=null,t=t===void 0?!0:t,r=r===void 0?!0:r;const v=t&&r;t&&(this.hScroll=new Un(e,!0,v,l,p)),r&&(this.vScroll=new Un(e,!1,v,l,p)),v&&(this.corner_=ie(ae.RECT,{height:Un.scrollbarThickness,width:Un.scrollbarThickness,class:"blocklyScrollbarBackground"}),yn(this.corner_,e.getBubbleCanvas()))}dispose(){lt(this.corner_),this.oldHostMetrics=this.corner_=null,this.hScroll&&(this.hScroll.dispose(),this.hScroll=null),this.vScroll&&(this.vScroll.dispose(),this.vScroll=null)}resize(){const e=this.workspace.getMetrics();if(e){var t=!1,r=!1;if(this.oldHostMetrics&&this.oldHostMetrics.viewWidth===e.viewWidth&&this.oldHostMetrics.viewHeight===e.viewHeight&&this.oldHostMetrics.absoluteTop===e.absoluteTop&&this.oldHostMetrics.absoluteLeft===e.absoluteLeft?(this.oldHostMetrics&&this.oldHostMetrics.scrollWidth===e.scrollWidth&&this.oldHostMetrics.viewLeft===e.viewLeft&&this.oldHostMetrics.scrollLeft===e.scrollLeft||(t=!0),this.oldHostMetrics&&this.oldHostMetrics.scrollHeight===e.scrollHeight&&this.oldHostMetrics.viewTop===e.viewTop&&this.oldHostMetrics.scrollTop===e.scrollTop||(r=!0)):r=t=!0,t||r){try{s.disable$$module$build$src$core$events$utils(),this.hScroll&&t&&this.hScroll.resize(e),this.vScroll&&r&&this.vScroll.resize(e)}finally{s.enable$$module$build$src$core$events$utils()}this.workspace.maybeFireViewportChangeEvent()}if(this.hScroll&&this.vScroll){if(!this.oldHostMetrics||this.oldHostMetrics.viewWidth!==e.viewWidth||this.oldHostMetrics.absoluteLeft!==e.absoluteLeft){let l;(l=this.corner_)==null||l.setAttribute("x",String(this.vScroll.position.x))}if(!this.oldHostMetrics||this.oldHostMetrics.viewHeight!==e.viewHeight||this.oldHostMetrics.absoluteTop!==e.absoluteTop){let l;(l=this.corner_)==null||l.setAttribute("y",String(this.hScroll.position.y))}}this.oldHostMetrics=e}}canScrollHorizontally(){return!!this.hScroll}canScrollVertically(){return!!this.vScroll}setOrigin(e,t){this.hScroll&&this.hScroll.setOrigin(e,t),this.vScroll&&this.vScroll.setOrigin(e,t)}set(e,t,r){this.hScroll&&this.hScroll.set(e,!1),this.vScroll&&this.vScroll.set(t,!1),(r||r===void 0)&&(e={},this.hScroll&&(e.x=this.hScroll.getRatio_()),this.vScroll&&(e.y=this.vScroll.getRatio_()),this.workspace.setMetrics(e))}setX(e){this.hScroll&&this.hScroll.set(e,!0)}setY(e){this.vScroll&&this.vScroll.set(e,!0)}setContainerVisible(e){this.hScroll&&this.hScroll.setContainerVisible(e),this.vScroll&&this.vScroll.setContainerVisible(e)}isVisible(){let e=!1;return this.hScroll&&(e=this.hScroll.isVisible()),this.vScroll&&(e=e||this.vScroll.isVisible()),e}setVisible(e){this.hScroll&&this.hScroll.setVisibleInternal(e),this.vScroll&&this.vScroll.setVisibleInternal(e)}resizeContent(e){this.hScroll&&this.hScroll.resizeContentHorizontal(e),this.vScroll&&this.vScroll.resizeContentVertical(e)}resizeView(e){this.hScroll&&this.hScroll.resizeViewHorizontal(e),this.vScroll&&this.vScroll.resizeViewVertical(e)}},Df=class{constructor(e){this.workspace_=e}getDimensionsPx_(e){let t=0,r=0;return e&&(t=e.getWidth(),r=e.getHeight()),new Pt(t,r)}getFlyoutMetrics(e){return e=this.getDimensionsPx_(this.workspace_.getFlyout(e)),{width:e.width,height:e.height,position:this.workspace_.toolboxPosition}}getToolboxMetrics(){const e=this.getDimensionsPx_(this.workspace_.getToolbox());return{width:e.width,height:e.height,position:this.workspace_.toolboxPosition}}getSvgMetrics(){return this.workspace_.getCachedParentSvgSize()}getAbsoluteMetrics(){let e=0,t=0;const r=this.getToolboxMetrics(),l=this.getFlyoutMetrics(),p=!!this.workspace_.getToolbox();var v;const O=!((v=this.workspace_.getFlyout())!=null&&v.autoClose);v=p?r.position:l.position;const G=v===wt.TOP;return v===wt.LEFT&&(p&&(e+=r.width),O&&(e+=l.width)),G&&(p&&(t+=r.height),O&&(t+=l.height)),{top:t,left:e}}getViewMetrics(e){e=e?this.workspace_.scale:1;const t=this.getSvgMetrics(),r=this.getToolboxMetrics(),l=this.getFlyoutMetrics(),p=!!this.workspace_.getToolbox();var v;const O=!((v=this.workspace_.getFlyout())!=null&&v.autoClose);v=p?r.position:l.position;const G=v===wt.LEFT||v===wt.RIGHT;return(v===wt.TOP||v===wt.BOTTOM)&&(p&&(t.height-=r.height),O&&(t.height-=l.height)),G&&(p&&(t.width-=r.width),O&&(t.width-=l.width)),{height:t.height/e,width:t.width/e,top:-this.workspace_.scrollY/e,left:-this.workspace_.scrollX/e}}getContentMetrics(e){e=e?1:this.workspace_.scale;const t=this.workspace_.getBlocksBoundingBox();return{height:(t.bottom-t.top)*e,width:(t.right-t.left)*e,top:t.top*e,left:t.left*e}}hasFixedEdges(){return!this.workspace_.isMovableHorizontally()||!this.workspace_.isMovableVertically()}getComputedFixedEdges_(e){if(!this.hasFixedEdges())return{};const t=this.workspace_.isMovableHorizontally(),r=this.workspace_.isMovableVertically();e=e||this.getViewMetrics(!1);const l={};return r||(l.top=e.top,l.bottom=e.top+e.height),t||(l.left=e.left,l.right=e.left+e.width),l}getPaddedContent_(e,t){const r=t.top+t.height,l=t.left+t.width,p=e.width;e=e.height;const v=p/2,O=e/2;return{top:Math.min(t.top-O,r-e),bottom:Math.max(r+O,t.top+e),left:Math.min(t.left-v,l-p),right:Math.max(l+v,t.left+p)}}getScrollMetrics(e,t,r){e=e?this.workspace_.scale:1,t=t||this.getViewMetrics(!1);var l=r||this.getContentMetrics();r=this.getComputedFixedEdges_(t),t=this.getPaddedContent_(t,l),l=r.top!==void 0?r.top:t.top;const p=r.left!==void 0?r.left:t.left;return{top:l/e,left:p/e,width:((r.right!==void 0?r.right:t.right)-p)/e,height:((r.bottom!==void 0?r.bottom:t.bottom)-l)/e}}getUiMetrics(){return{viewMetrics:this.getViewMetrics(),absoluteMetrics:this.getAbsoluteMetrics(),toolboxMetrics:this.getToolboxMetrics()}}getMetrics(){const e=this.getToolboxMetrics(),t=this.getFlyoutMetrics(!0),r=this.getSvgMetrics(),l=this.getAbsoluteMetrics(),p=this.getViewMetrics(),v=this.getContentMetrics(),O=this.getScrollMetrics(!1,p,v);return{contentHeight:v.height,contentWidth:v.width,contentTop:v.top,contentLeft:v.left,scrollHeight:O.height,scrollWidth:O.width,scrollTop:O.top,scrollLeft:O.left,viewHeight:p.height,viewWidth:p.width,viewTop:p.top,viewLeft:p.left,absoluteTop:l.top,absoluteLeft:l.left,svgHeight:r.height,svgWidth:r.width,toolboxWidth:e.width,toolboxHeight:e.height,toolboxPosition:e.position,flyoutWidth:t.width,flyoutHeight:t.height}}};i(Ne.METRICS_MANAGER,Pr,Df),"Blockly"in globalThis||(globalThis.Blockly={Msg:Gb});var yh=class extends lh{constructor(){super(),this.GRID_UNIT=4,this.CURSOR_COLOUR="#ffa200",this.CURSOR_RADIUS=5,this.JAGGED_TEETH_WIDTH=this.JAGGED_TEETH_HEIGHT=0,this.START_HAT_HEIGHT=22,this.START_HAT_WIDTH=96,this.SHAPES={HEXAGONAL:1,ROUND:2,SQUARE:3,PUZZLE:4,NOTCH:5},this.SHAPE_IN_SHAPE_PADDING={1:{0:5*this.GRID_UNIT,1:2*this.GRID_UNIT,2:5*this.GRID_UNIT,3:5*this.GRID_UNIT},2:{0:3*this.GRID_UNIT,1:3*this.GRID_UNIT,2:1*this.GRID_UNIT,3:2*this.GRID_UNIT},3:{0:2*this.GRID_UNIT,1:2*this.GRID_UNIT,2:2*this.GRID_UNIT,3:2*this.GRID_UNIT}},this.FULL_BLOCK_FIELDS=!0,this.FIELD_TEXT_FONTWEIGHT="bold",this.FIELD_TEXT_FONTFAMILY='"Helvetica Neue", "Segoe UI", Helvetica, sans-serif',this.FIELD_COLOUR_FULL_BLOCK=this.FIELD_TEXTINPUT_BOX_SHADOW=this.FIELD_DROPDOWN_SVG_ARROW=this.FIELD_DROPDOWN_COLOURED_DIV=this.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW=!0,this.SELECTED_GLOW_COLOUR="#fff200",this.SELECTED_GLOW_SIZE=.5,this.REPLACEMENT_GLOW_COLOUR="#fff200",this.REPLACEMENT_GLOW_SIZE=2,this.selectedGlowFilterId="",this.selectedGlowFilter=null,this.replacementGlowFilterId="",this.SQUARED=this.ROUNDED=this.HEXAGONAL=this.replacementGlowFilter=null,this.SMALL_PADDING=this.GRID_UNIT,this.MEDIUM_PADDING=2*this.GRID_UNIT,this.MEDIUM_LARGE_PADDING=3*this.GRID_UNIT,this.LARGE_PADDING=4*this.GRID_UNIT,this.CORNER_RADIUS=1*this.GRID_UNIT,this.NOTCH_WIDTH=9*this.GRID_UNIT,this.NOTCH_HEIGHT=2*this.GRID_UNIT,this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT=3*this.GRID_UNIT,this.MIN_BLOCK_WIDTH=2*this.GRID_UNIT,this.MIN_BLOCK_HEIGHT=12*this.GRID_UNIT,this.EMPTY_STATEMENT_INPUT_HEIGHT=6*this.GRID_UNIT,this.TOP_ROW_MIN_HEIGHT=this.CORNER_RADIUS,this.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.BOTTOM_ROW_MIN_HEIGHT=this.CORNER_RADIUS,this.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT=6*this.GRID_UNIT,this.STATEMENT_BOTTOM_SPACER=-this.NOTCH_HEIGHT,this.STATEMENT_INPUT_SPACER_MIN_WIDTH=40*this.GRID_UNIT,this.STATEMENT_INPUT_PADDING_LEFT=4*this.GRID_UNIT,this.EMPTY_INLINE_INPUT_PADDING=4*this.GRID_UNIT,this.EMPTY_INLINE_INPUT_HEIGHT=8*this.GRID_UNIT,this.DUMMY_INPUT_MIN_HEIGHT=8*this.GRID_UNIT,this.DUMMY_INPUT_SHADOW_MIN_HEIGHT=6*this.GRID_UNIT,this.CURSOR_WS_WIDTH=20*this.GRID_UNIT,this.FIELD_TEXT_FONTSIZE=3*this.GRID_UNIT,this.FIELD_BORDER_RECT_RADIUS=this.CORNER_RADIUS,this.FIELD_BORDER_RECT_X_PADDING=2*this.GRID_UNIT,this.FIELD_BORDER_RECT_Y_PADDING=1.625*this.GRID_UNIT,this.FIELD_BORDER_RECT_HEIGHT=8*this.GRID_UNIT,this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=8*this.GRID_UNIT,this.FIELD_DROPDOWN_SVG_ARROW_PADDING=this.FIELD_BORDER_RECT_X_PADDING,this.FIELD_COLOUR_DEFAULT_WIDTH=6*this.GRID_UNIT,this.FIELD_COLOUR_DEFAULT_HEIGHT=8*this.GRID_UNIT,this.FIELD_CHECKBOX_X_OFFSET=1*this.GRID_UNIT,this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH=12*this.GRID_UNIT}setFontConstants_(e){super.setFontConstants_(e),this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT=this.FIELD_TEXT_HEIGHT+2*this.FIELD_BORDER_RECT_Y_PADDING}init(){super.init(),this.HEXAGONAL=this.makeHexagonal(),this.ROUNDED=this.makeRounded(),this.SQUARED=this.makeSquared(),this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT+this.INSIDE_CORNERS.rightWidth}setDynamicProperties_(e){super.setDynamicProperties_(e),this.SELECTED_GLOW_COLOUR=e.getComponentStyle("selectedGlowColour")||this.SELECTED_GLOW_COLOUR;const t=Number(e.getComponentStyle("selectedGlowSize"));this.SELECTED_GLOW_SIZE=t&&!isNaN(t)?t:this.SELECTED_GLOW_SIZE,this.REPLACEMENT_GLOW_COLOUR=e.getComponentStyle("replacementGlowColour")||this.REPLACEMENT_GLOW_COLOUR,this.REPLACEMENT_GLOW_SIZE=(e=Number(e.getComponentStyle("replacementGlowSize")))&&!isNaN(e)?e:this.REPLACEMENT_GLOW_SIZE}dispose(){super.dispose(),this.selectedGlowFilter&&lt(this.selectedGlowFilter),this.replacementGlowFilter&&lt(this.replacementGlowFilter)}makeStartHat(){const e=this.START_HAT_HEIGHT,t=this.START_HAT_WIDTH,r=sr("c",[nt(25,-e),nt(71,-e),nt(t,0)]);return{height:e,width:t,path:r}}makeHexagonal(){function e(r,l,p){var v=r/2;return v=v>t?t:v,p=p?-1:1,r=(l?-1:1)*r/2,wi(-p*v,r)+wi(p*v,r)}const t=this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH;return{type:this.SHAPES.HEXAGONAL,isDynamic:!0,width(r){return r/=2,r>t?t:r},height(r){return r},connectionOffsetY(r){return r/2},connectionOffsetX(r){return-r},pathDown(r){return e(r,!1,!1)},pathUp(r){return e(r,!0,!1)},pathRightDown(r){return e(r,!1,!0)},pathRightUp(r){return e(r,!1,!0)}}}makeRounded(){function e(l,p,v){const O=l>r?l-r:0;l=(l>r?r:l)/2;const G=v===p?"0":"1";return qn("a","0 0,"+G,l,nt((v?1:-1)*l,(p?-1:1)*l))+Ye("v",(p?-1:1)*O)+qn("a","0 0,"+G,l,nt((v?-1:1)*l,(p?-1:1)*l))}const t=this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH,r=2*t;return{type:this.SHAPES.ROUND,isDynamic:!0,width(l){return l/=2,l>t?t:l},height(l){return l},connectionOffsetY(l){return l/2},connectionOffsetX(l){return-l},pathDown(l){return e(l,!1,!1)},pathUp(l){return e(l,!0,!1)},pathRightDown(l){return e(l,!1,!0)},pathRightUp(l){return e(l,!1,!0)}}}makeSquared(){function e(r,l,p){r-=2*t;const v=p===l?"0":"1";return qn("a","0 0,"+v,t,nt((p?1:-1)*t,(l?-1:1)*t))+Ye("v",(l?-1:1)*r)+qn("a","0 0,"+v,t,nt((p?-1:1)*t,(l?-1:1)*t))}const t=this.CORNER_RADIUS;return{type:this.SHAPES.SQUARE,isDynamic:!0,width(r){return t},height(r){return r},connectionOffsetY(r){return r/2},connectionOffsetX(r){return-r},pathDown(r){return e(r,!1,!1)},pathUp(r){return e(r,!0,!1)},pathRightDown(r){return e(r,!1,!0)},pathRightUp(r){return e(r,!1,!0)}}}shapeFor(e){let t=e.getCheck();switch(!t&&e.targetConnection&&(t=e.targetConnection.getCheck()),e.type){case Ge.INPUT_VALUE:case Ge.OUTPUT_VALUE:if(e=e.getSourceBlock().getOutputShape(),e!==null)switch(e){case this.SHAPES.HEXAGONAL:return this.HEXAGONAL;case this.SHAPES.ROUND:return this.ROUNDED;case this.SHAPES.SQUARE:return this.SQUARED}return t&&t.includes("Boolean")?this.HEXAGONAL:t&&t.includes("Number")?this.ROUNDED:(t&&t.includes("String"),this.ROUNDED);case Ge.PREVIOUS_STATEMENT:case Ge.NEXT_STATEMENT:return this.NOTCH;default:throw Error("Unknown type")}}makeNotch(){function e(qe){return sr("c",[nt(qe*p/2,0),nt(qe*p*3/4,O/2),nt(qe*p,O)])+Br([nt(qe*p,v)])+sr("c",[nt(qe*p/4,O/2),nt(qe*p/2,O),nt(qe*p,O)])+Ye("h",qe*l)+sr("c",[nt(qe*p/2,0),nt(qe*p*3/4,-(O/2)),nt(qe*p,-O)])+Br([nt(qe*p,-v)])+sr("c",[nt(qe*p/4,-(O/2)),nt(qe*p/2,-O),nt(qe*p,-O)])}const t=this.NOTCH_WIDTH,r=this.NOTCH_HEIGHT,l=t/3,p=l/3,v=r/2,O=v/2,G=e(1),_e=e(-1);return{type:this.SHAPES.NOTCH,width:t,height:r,pathLeft:G,pathRight:_e}}makeInsideCorners(){const e=this.CORNER_RADIUS,t=qn("a","0 0,0",e,nt(-e,e)),r=qn("a","0 0,1",e,nt(-e,e)),l=qn("a","0 0,0",e,nt(e,e)),p=qn("a","0 0,1",e,nt(e,e));return{width:e,height:e,pathTop:t,pathBottom:l,rightWidth:e,rightHeight:e,pathTopRight:r,pathBottomRight:p}}generateSecondaryColour_(e){return Je("#000",e,.15)||e}generateTertiaryColour_(e){return Je("#000",e,.25)||e}createDom(e,t,r){super.createDom(e,t,r),e=ie(ae.DEFS,{},e),t=ie(ae.FILTER,{id:"blocklySelectedGlowFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},e),ie(ae.FEGAUSSIANBLUR,{in:"SourceGraphic",stdDeviation:this.SELECTED_GLOW_SIZE},t),r=ie(ae.FECOMPONENTTRANSFER,{result:"outBlur"},t),ie(ae.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},r),ie(ae.FEFLOOD,{"flood-color":this.SELECTED_GLOW_COLOUR,"flood-opacity":1,result:"outColor"},t),ie(ae.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},t),this.selectedGlowFilterId=t.id,this.selectedGlowFilter=t,e=ie(ae.FILTER,{id:"blocklyReplacementGlowFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},e),ie(ae.FEGAUSSIANBLUR,{in:"SourceGraphic",stdDeviation:this.REPLACEMENT_GLOW_SIZE},e),t=ie(ae.FECOMPONENTTRANSFER,{result:"outBlur"},e),ie(ae.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},t),ie(ae.FEFLOOD,{"flood-color":this.REPLACEMENT_GLOW_COLOUR,"flood-opacity":1,result:"outColor"},e),ie(ae.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},e),ie(ae.FECOMPOSITE,{in:"SourceGraphic",in2:"outGlow",operator:"over"},e),this.replacementGlowFilterId=e.id,this.replacementGlowFilter=e}getCSS_(e){return[`${e} .blocklyText,`,`${e} .blocklyFlyoutLabelText {`,`font: ${this.FIELD_TEXT_FONTWEIGHT} ${this.FIELD_TEXT_FONTSIZE}pt ${this.FIELD_TEXT_FONTFAMILY};`,"}",`${e} .blocklyTextInputBubble textarea {`,"font-weight: normal;","}",`${e} .blocklyText {`,"fill: #fff;","}",`${e} .blocklyNonEditableText>rect:not(.blocklyDropdownRect),`,`${e} .blocklyEditableText>rect:not(.blocklyDropdownRect) {`,`fill: ${this.FIELD_BORDER_RECT_COLOUR};`,"}",`${e} .blocklyNonEditableText>text,`,`${e} .blocklyEditableText>text,`,`${e} .blocklyNonEditableText>g>text,`,`${e} .blocklyEditableText>g>text {`,"fill: #575E75;","}",`${e} .blocklyFlyoutLabelText {`,"fill: #575E75;","}",`${e} .blocklyText.blocklyBubbleText {`,"fill: #575E75;","}",`${e} .blocklyDraggable:not(.blocklyDisabled)`," .blocklyEditableText:not(.editing):hover>rect,",`${e} .blocklyDraggable:not(.blocklyDisabled)`," .blocklyEditableText:not(.editing):hover>.blocklyPath {","stroke: #fff;","stroke-width: 2;","}",`${e} .blocklyHtmlInput {`,`font-family: ${this.FIELD_TEXT_FONTFAMILY};`,`font-weight: ${this.FIELD_TEXT_FONTWEIGHT};`,"color: #575E75;","}",`${e} .blocklyDropdownText {`,"fill: #fff !important;","}",`${e}.blocklyWidgetDiv .goog-menuitem,`,`${e}.blocklyDropDownDiv .goog-menuitem {`,`font-family: ${this.FIELD_TEXT_FONTFAMILY};`,"}",`${e}.blocklyDropDownDiv .goog-menuitem-content {`,"color: #fff;","}",`${e} .blocklyHighlightedConnectionPath {`,`stroke: ${this.SELECTED_GLOW_COLOUR};`,"}",`${e} .blocklyDisabled > .blocklyOutlinePath {`,`fill: url(#blocklyDisabledPattern${this.randomIdentifier})`,"}",`${e} .blocklyInsertionMarker>.blocklyPath {`,`fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,"stroke: none;","}"]}},_h=class extends Ql{constructor(e,t){super(e,t)}draw(){const e=this.block_.pathObject;e.beginDrawing(),this.drawOutline_(),this.drawInternals_(),this.updateConnectionHighlights(),e.setPath(this.outlinePath_+`
`+this.inlinePath_),this.info_.RTL&&e.flipRTL(),this.recordSizeOnBlock_(),this.info_.outputConnection&&(e.outputShapeType=this.info_.outputConnection.shape.type),e.endDrawing()}drawOutline_(){this.info_.outputConnection&&this.info_.outputConnection.isDynamicShape&&!this.info_.hasStatementInput&&!this.info_.bottomRow.hasNextConnection?(this.drawFlatTop_(),this.drawRightDynamicConnection_(),this.drawFlatBottom_(),this.drawLeftDynamicConnection_()):super.drawOutline_()}drawLeft_(){this.info_.outputConnection&&this.info_.outputConnection.isDynamicShape?this.drawLeftDynamicConnection_():super.drawLeft_()}drawRightSideRow_(e){if(!(0>=e.height)){if(X.isSpacer(e)){const l=e.precedesStatement;var t=e.followsStatement;if(l||t){const p=this.constants_.INSIDE_CORNERS;var r=p.rightHeight;r=e.height-(l?r:0),t=t?p.pathBottomRight:"",e=0<r?Ye("V",e.yPos+r):"",this.outlinePath_+=t+e+(l?p.pathTopRight:"");return}}this.outlinePath_+=Ye("V",e.yPos+e.height)}}drawRightDynamicConnection_(){if(!this.info_.outputConnection)throw Error("Cannot draw the output connection of a block that doesn't have one");this.outlinePath_+=this.info_.outputConnection.shape.pathRightDown(this.info_.outputConnection.height)}drawLeftDynamicConnection_(){if(!this.info_.outputConnection)throw Error("Cannot draw the output connection of a block that doesn't have one");this.positionOutputConnection_(),this.outlinePath_+=this.info_.outputConnection.shape.pathUp(this.info_.outputConnection.height),this.outlinePath_+="z"}drawFlatTop_(){const e=this.info_.topRow;this.positionPreviousConnection_(),this.outlinePath_+=In(e.xPos,this.info_.startY),this.outlinePath_+=Ye("h",e.width)}drawFlatBottom_(){const e=this.info_.bottomRow;this.positionNextConnection_(),this.outlinePath_+=Ye("V",e.baseline),this.outlinePath_+=Ye("h",-e.width)}drawInlineInput_(e){this.positionInlineInputConnection_(e);const t=e.input.name;e.connectedBlock||this.info_.isInsertionMarker||(e=us(e.xPos+e.connectionWidth,e.centerline-e.height/2)+this.getInlineInputPath(e),this.block_.pathObject.setOutlinePath(t,e))}getInlineInputPath(e){const t=e.width-2*e.connectionWidth,r=e.height;return Ye("h",t)+e.shape.pathRightDown(r)+Ye("h",-t)+e.shape.pathUp(r)+"z"}drawStatementInput_(e){var t=e.getLastInput();const r=t.xPos+t.notchOffset+t.shape.width,l=this.constants_.INSIDE_CORNERS,p=t.shape.pathRight+Ye("h",-(t.notchOffset-l.width))+l.pathTop,v=e.height-2*l.height;t=l.pathBottom+Ye("h",t.notchOffset-l.width)+(t.connectedBottomNextConnection?"":t.shape.pathLeft),this.outlinePath_+=Ye("H",r)+p+Ye("v",v)+t+Ye("H",e.xPos+e.width),this.positionStatementInputConnection_(e)}drawConnectionHighlightPath(e){const t=e.connectionModel;if(t.type===Ge.NEXT_STATEMENT||t.type===Ge.PREVIOUS_STATEMENT||t.type===Ge.OUTPUT_VALUE&&!e.isDynamicShape)super.drawConnectionHighlightPath(e);else{e=t.type===Ge.INPUT_VALUE?us(e.connectionWidth,-e.height/2)+this.getInlineInputPath(e):us(e.width,-e.height/2)+e.shape.pathDown(e.height);var r=t.getSourceBlock(),l,p;(p=(l=r.pathObject).addConnectionHighlight)==null||p.call(l,t,e,t.getOffsetInBlock(),r.RTL)}}},Qa=class extends fn{constructor(e,t,r,l,p,v,O){if(super(fn.SKIP_SETUP),this.imageElement=this.clickHandler=null,this.flipRtl=this.isDirty_=this.EDITABLE=!1,this.altText="",r=Number(bt(r)),t=Number(bt(t)),isNaN(r)||isNaN(t))throw Error("Height and width values of an image field must cast to numbers.");if(0>=r||0>=t)throw Error("Height and width values of an image field must be greater than 0.");this.size_=new Pt(t,r+Qa.Y_PADDING),this.imageHeight=r,typeof p=="function"&&(this.clickHandler=p),e!==fn.SKIP_SETUP&&(O?this.configure_(O):(this.flipRtl=!!v,this.altText=bt(l)||""),this.setValue(bt(e)))}configure_(e){super.configure_(e),e.flipRtl&&(this.flipRtl=e.flipRtl),e.alt&&(this.altText=bt(e.alt))}initView(){this.imageElement=ie(ae.IMAGE,{height:this.imageHeight+"px",width:this.size_.width+"px",alt:this.altText},this.fieldGroup_),this.imageElement.setAttributeNS(ar,"xlink:href",this.value_),this.clickHandler&&(this.imageElement.style.cursor="pointer")}updateSize_(){}doClassValidation_(e){return typeof e!="string"?null:e}doValueUpdate_(e){this.value_=e,this.imageElement&&this.imageElement.setAttributeNS(ar,"xlink:href",this.value_)}getFlipRtl(){return this.flipRtl}setAlt(e){e!==this.altText&&(this.altText=e||"",this.imageElement&&this.imageElement.setAttribute("alt",this.altText))}showEditor_(){this.clickHandler&&this.clickHandler(this)}setOnClickHandler(e){this.clickHandler=e}getText_(){return this.altText}static fromJson(e){if(!e.src||!e.width||!e.height)throw Error("src, width, and height values for an image field arerequired. The width and height must be non-zero.");return new this(e.src,e.width,e.height,void 0,void 0,void 0,e)}};Qa.Y_PADDING=1,_t("field_image",Qa),Qa.prototype.DEFAULT_VALUE="";var wh=class extends fn{constructor(e,t,r){super(fn.SKIP_SETUP),this.spellcheck_=!0,this.htmlInput_=null,this.isTextValid_=this.isBeingEdited_=!1,this.onKeyInputWrapper=this.onKeyDownWrapper=this.valueWhenEditorWasOpened_=null,this.fullBlockClickTarget_=!1,this.workspace_=null,this.SERIALIZABLE=!0,this.CURSOR="text",e!==fn.SKIP_SETUP&&(r&&this.configure_(r),this.setValue(e),t&&this.setValidator(t))}configure_(e){super.configure_(e),e.spellcheck!==void 0&&(this.spellcheck_=e.spellcheck)}initView(){if(!this.getSourceBlock())throw new Jn;super.initView(),this.isFullBlockField()&&(this.clickTarget_=this.sourceBlock_.getSvgRoot())}isFullBlockField(){const e=this.getSourceBlock();if(!e)throw new Jn;let t;return this.fullBlockClickTarget_=!((t=this.getConstants())==null||!t.FULL_BLOCK_FIELDS)&&e.isSimpleReporter()}doValueInvalid_(e,t=!0){this.isBeingEdited_&&(this.isDirty_=!0,this.isTextValid_=!1,e=this.value_,this.value_=this.valueWhenEditorWasOpened_,this.sourceBlock_&&re()&&this.value_!==e&&t&&te(new(Ce(ge.BLOCK_CHANGE))(this.sourceBlock_,"field",this.name||null,e,this.value_)))}doValueUpdate_(e){this.isTextValid_=this.isDirty_=!0,this.value_=e}applyColour(){const e=this.getSourceBlock();if(!e)throw new Jn;this.getConstants().FULL_BLOCK_FIELDS&&this.fieldGroup_&&(!this.isFullBlockField()&&this.borderRect_?(this.borderRect_.style.display="block",this.borderRect_.setAttribute("stroke",e.style.colourTertiary)):(this.borderRect_.style.display="none",e.pathObject.svgPath.setAttribute("fill",this.getConstants().FIELD_BORDER_RECT_COLOUR)))}getSize(){let e;return(e=this.getConstants())!=null&&e.FULL_BLOCK_FIELDS&&(this.render_(),this.isDirty_=!1),super.getSize()}onLocationChange(){this.isBeingEdited_&&this.resizeEditor_()}render_(){if(super.render_(),this.isBeingEdited_){var e=this.htmlInput_;this.isTextValid_?(it(e,"blocklyInvalidInput"),qt(e,hs.INVALID,!1)):(Pe(e,"blocklyInvalidInput"),qt(e,hs.INVALID,!0))}if(e=this.getSourceBlock(),!e)throw new Jn;this.getConstants().FULL_BLOCK_FIELDS&&e.applyColour()}setSpellcheck(e){e!==this.spellcheck_&&(this.spellcheck_=e,this.htmlInput_&&this.htmlInput_.setAttribute("spellcheck",this.spellcheck_))}showEditor_(e,t=!1){this.workspace_=this.sourceBlock_.workspace,!t&&this.workspace_.options.modalInputs&&(Fd||Rg||Pd)?this.showPromptEditor():this.showInlineEditor(t)}showPromptEditor(){vc(s.Msg$$module$build$src$core$msg.CHANGE_VALUE_TITLE,this.getText(),e=>{e!==null&&this.setValue(this.getValueFromEditorText_(e)),this.onFinishEditing_(this.value_)})}showInlineEditor(e){const t=this.getSourceBlock();if(!t)throw new Jn;Wi(this,t.RTL,this.widgetDispose_.bind(this),this.workspace_),this.htmlInput_=this.widgetCreate_(),this.isBeingEdited_=!0,this.valueWhenEditorWasOpened_=this.value_,e||(this.htmlInput_.focus({preventScroll:!0}),this.htmlInput_.select())}widgetCreate_(){var e=this.getSourceBlock();if(!e)throw new Jn;s.setGroup$$module$build$src$core$events$utils(!0);const t=vs();var r=this.getClickTarget_();if(!r)throw Error("A click target has not been set.");Pe(r,"editing"),r=document.createElement("input"),r.className="blocklyHtmlInput",r.setAttribute("spellcheck",this.spellcheck_);const l=this.workspace_.getScale();var p=this.getConstants().FIELD_TEXT_FONTSIZE*l+"pt";return t.style.fontSize=p,r.style.fontSize=p,p=wh.BORDERRADIUS*l+"px",this.isFullBlockField()&&(p=this.getScaledBBox(),p=(p.bottom-p.top)/2+"px",e=e.getParent()?e.getParent().style.colourTertiary:this.sourceBlock_.style.colourTertiary,r.style.border=1*l+"px solid "+e,t.style.borderRadius=p,t.style.transition="box-shadow 0.25s ease 0s",this.getConstants().FIELD_TEXTINPUT_BOX_SHADOW&&(t.style.boxShadow="rgba(255, 255, 255, 0.3) 0 0 0 "+4*l+"px")),r.style.borderRadius=p,t.appendChild(r),r.value=r.defaultValue=this.getEditorText_(this.value_),r.setAttribute("data-untyped-default-value",String(this.value_)),this.resizeEditor_(),this.bindInputEvents_(r),r}widgetDispose_(){this.isBeingEdited_=!1,this.isTextValid_=!0,this.forceRerender(),this.onFinishEditing_(this.value_),this.sourceBlock_&&re()&&this.valueWhenEditorWasOpened_!==null&&this.valueWhenEditorWasOpened_!==this.value_&&(te(new(Ce(ge.BLOCK_CHANGE))(this.sourceBlock_,"field",this.name||null,this.valueWhenEditorWasOpened_,this.value_)),this.valueWhenEditorWasOpened_=null),s.setGroup$$module$build$src$core$events$utils(!1),this.unbindInputEvents_();var e=vs().style;if(e.width="auto",e.height="auto",e.fontSize="",e.transition="",e.boxShadow="",this.htmlInput_=null,e=this.getClickTarget_(),!e)throw Error("A click target has not been set.");it(e,"editing")}onFinishEditing_(e){}bindInputEvents_(e){this.onKeyDownWrapper=He(e,"keydown",this,this.onHtmlInputKeyDown_),this.onKeyInputWrapper=He(e,"input",this,this.onHtmlInputChange)}unbindInputEvents_(){this.onKeyDownWrapper&&(St(this.onKeyDownWrapper),this.onKeyDownWrapper=null),this.onKeyInputWrapper&&(St(this.onKeyInputWrapper),this.onKeyInputWrapper=null)}onHtmlInputKeyDown_(e){e.key==="Enter"?(Kt(this),ri()):e.key==="Escape"?(this.setValue(this.htmlInput_.getAttribute("data-untyped-default-value"),!1),Kt(this),ri()):e.key==="Tab"&&(Kt(this),ri(),this.sourceBlock_.tab(this,!e.shiftKey),e.preventDefault())}onHtmlInputChange(e){e=this.value_,this.setValue(this.getValueFromEditorText_(this.htmlInput_.value),!1),this.sourceBlock_&&re()&&this.value_!==e&&te(new(Ce(ge.BLOCK_FIELD_INTERMEDIATE_CHANGE))(this.sourceBlock_,this.name||null,e,this.value_))}setEditorValue_(e,t=!0){this.isDirty_=!0,this.isBeingEdited_&&(this.htmlInput_.value=this.getEditorText_(e)),this.setValue(e,t)}resizeEditor_(){cs().then(()=>{const e=this.getSourceBlock();if(!e)throw new Jn;const t=vs(),r=this.getScaledBBox();t.style.width=r.right-r.left+"px",t.style.height=r.bottom-r.top+"px";const l=r.top;t.style.left=`${e.RTL?r.right-t.offsetWidth:r.left}px`,t.style.top=`${l}px`})}repositionForWindowResize(){let e;const t=(e=this.getSourceBlock())==null?void 0:e.getRootBlock();return t instanceof qr?(Bo(this.workspace_,this.workspace_.getMetricsManager().getViewMetrics(!0),t)||this.resizeEditor_(),!0):!1}isTabNavigable(){return!0}getText_(){return this.isBeingEdited_&&this.htmlInput_?this.htmlInput_.value:null}getEditorText_(e){return`${e}`}getValueFromEditorText_(e){return e}};wh.BORDERRADIUS=4;var Sh=class extends wh{constructor(e,t,r){super(e,t,r)}doClassValidation_(e){return e===void 0?null:`${e}`}static fromJson(e){return new this(bt(e.text),void 0,e)}};_t("field_input",Sh),Sh.prototype.DEFAULT_VALUE="";var N$=class extends dr{constructor(e){super(e)}endsWithElemSpacer(){return!1}hasLeftSquareCorner(e){return!!e.outputConnection}hasRightSquareCorner(e){return!!e.outputConnection&&!e.statementInputCount&&!e.nextConnection}},Ch=class extends yu{constructor(e,t){if(super(e,t),this.connectedBottomNextConnection=!1,this.connectedBlock){for(e=this.connectedBlock;t=e.getNextBlock();)e=t;e.nextConnection||(this.height=this.connectedBlockHeight,this.connectedBottomNextConnection=!0)}}},M$=class extends ft{constructor(e){super(e),this.width=this.height=0,this.type|=X.getType("RIGHT_CONNECTION")}},L$=class extends $f{constructor(e){super(e)}endsWithElemSpacer(){return!1}hasLeftSquareCorner(e){const t=(e.hat?e.hat==="cap":this.constants_.ADD_START_HATS)&&!e.outputConnection&&!e.previousConnection;return!!e.outputConnection||t}hasRightSquareCorner(e){return!!e.outputConnection&&!e.statementInputCount&&!e.nextConnection}},B$=class extends ms{constructor(e,t){super(e,t),this.isInline=!0,this.renderer_=e,this.constants_=this.renderer_.getConstants(),this.topRow=new L$(this.constants_),this.bottomRow=new N$(this.constants_),this.isMultiRow=!t.getInputsInline()||t.isCollapsed(),this.hasStatementInput=0<t.statementInputCount,this.rightSide=this.outputConnection?new M$(this.constants_):null,this.rightAlignedDummyInputs=new WeakMap}getRenderer(){return this.renderer_}measure(){this.createRows_(),this.addElemSpacing_(),this.addRowSpacing_(),this.adjustXPosition_(),this.computeBounds_(),this.alignRowElements_(),this.finalize_()}shouldStartNewRow_(e,t){return t?t instanceof ho||e instanceof kr||t instanceof kr?!0:e instanceof s.ValueInput$$module$build$src$core$inputs$value_input||e instanceof Di||e instanceof ho?!this.isInline||this.isMultiRow:!1:!1}getDesiredRowWidth_(e){return e.hasStatement?this.width-this.startX-(this.constants_.INSIDE_CORNERS.rightWidth||0):super.getDesiredRowWidth_(e)}getInRowSpacing_(e,t){return e&&t||!this.outputConnection||!this.outputConnection.isDynamicShape||this.hasStatementInput||this.bottomRow.hasNextConnection?!e&&t&&X.isStatementInput(t)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:e&&X.isLeftRoundedCorner(e)&&t&&(X.isPreviousConnection(t)||X.isNextConnection(t))?t.notchOffset-this.constants_.CORNER_RADIUS:e&&X.isLeftSquareCorner(e)&&t&&X.isHat(t)?this.constants_.NO_PADDING:this.constants_.MEDIUM_PADDING:this.constants_.NO_PADDING}getSpacerRowHeight_(e,t){if(X.isTopRow(e)&&X.isBottomRow(t))return this.constants_.EMPTY_BLOCK_SPACER_HEIGHT;const r=X.isInputRow(e)&&e.hasStatement,l=X.isInputRow(t)&&t.hasStatement;return l||r?(e=Math.max(this.constants_.NOTCH_HEIGHT,this.constants_.INSIDE_CORNERS.rightHeight||0),l&&r?Math.max(e,this.constants_.DUMMY_INPUT_MIN_HEIGHT):e):X.isTopRow(e)?e.hasPreviousConnection||this.outputConnection&&!this.hasStatementInput?this.constants_.NO_PADDING:Math.abs(this.constants_.NOTCH_HEIGHT-this.constants_.CORNER_RADIUS):X.isBottomRow(t)?this.outputConnection?!t.hasNextConnection&&this.hasStatementInput?Math.abs(this.constants_.NOTCH_HEIGHT-this.constants_.CORNER_RADIUS):this.constants_.NO_PADDING:Math.max(this.topRow.minHeight,Math.max(this.constants_.NOTCH_HEIGHT,this.constants_.CORNER_RADIUS))-this.constants_.CORNER_RADIUS:this.constants_.MEDIUM_PADDING}getSpacerRowWidth_(e,t){const r=this.width-this.startX;return X.isInputRow(e)&&e.hasStatement||X.isInputRow(t)&&t.hasStatement?Math.max(r,this.constants_.STATEMENT_INPUT_SPACER_MIN_WIDTH):r}getElemCenterline_(e,t){if(e.hasStatement&&!X.isSpacer(t)&&!X.isStatementInput(t))return e.yPos+this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT/2;if(X.isInlineInput(t)&&t instanceof qo){const r=t.connectedBlock;if(r&&r.outputConnection&&r.nextConnection)return e.yPos+r.height/2}return super.getElemCenterline_(e,t)}addInput_(e,t){if((e instanceof Di||e instanceof ho)&&t.hasDummyInput&&t.align===s.Align$$module$build$src$core$inputs$align.LEFT&&e.align===s.Align$$module$build$src$core$inputs$align.RIGHT)this.rightAlignedDummyInputs.set(t,e);else if(e instanceof kr){t.elements.push(new Ch(this.constants_,e)),t.hasStatement=!0,t.align===null&&(t.align=e.align);return}super.addInput_(e,t)}addAlignmentPadding_(e,t){if(this.rightAlignedDummyInputs.get(e)){let r;for(let l=0;l<e.elements.length;l++){const p=e.elements[l];if(X.isSpacer(p)&&(r=p),X.isField(p)&&p instanceof Zl&&p.parentInput===this.rightAlignedDummyInputs.get(e))break}if(r){r.width+=t,e.width+=t;return}}super.addAlignmentPadding_(e,t)}adjustXPosition_(){const e=this.constants_.NOTCH_OFFSET_LEFT+this.constants_.NOTCH_WIDTH;let t=e;for(let p=2;p<this.rows.length-1;p+=2){var r=this.rows[p-1];const v=this.rows[p];var l=this.rows[p+1];if(r=p===2?!!this.topRow.hasPreviousConnection:!!r.followsStatement,l=p+2>=this.rows.length-1?!!this.bottomRow.hasNextConnection:!!l.precedesStatement,X.isInputRow(v)&&v.hasStatement){v.measure();let O,G;t=v.width-((G=(O=v.getLastInput())==null?void 0:O.width)!=null?G:0)+e}else if(r&&(p===2||l)&&X.isInputRow(v)&&!v.hasStatement){l=v.xPos,r=null;for(let O=0;O<v.elements.length;O++){const G=v.elements[O];X.isSpacer(G)&&(r=G),r&&(X.isField(G)||X.isInput(G))&&l<t&&!(X.isField(G)&&G instanceof Zl&&(G.field instanceof Ya||G.field instanceof Qa))&&(r.width+=t-l),l+=G.width}}}}finalizeOutputConnection_(){if(this.outputConnection&&this.outputConnection.isDynamicShape){var e=this.outputConnection.shape;if("isDynamic"in e&&e.isDynamic){for(var t=0,r=0;r<this.rows.length;r++){const l=this.rows[r];l.yPos=t,t+=l.height}this.height=t,r=this.bottomRow.hasNextConnection?this.height-this.bottomRow.descenderHeight:this.height,t=e.height(r),r=e.width(r),this.outputConnection.height=t,this.outputConnection.width=r,this.outputConnection.startX=r,this.outputConnection.connectionOffsetY=e.connectionOffsetY(t),this.outputConnection.connectionOffsetX=e.connectionOffsetX(r),e=0,this.hasStatementInput||this.bottomRow.hasNextConnection||(e=r,this.rightSide.height=t,this.rightSide.width=e,this.rightSide.centerline=t/2,this.rightSide.xPos=this.width+e),this.startX=r,this.width+=r+e,this.widthWithChildren+=r+e}}}finalizeHorizontalAlignment_(){if(this.outputConnection&&!this.hasStatementInput&&!this.bottomRow.hasNextConnection){for(var e=0,t=0;t<this.rows.length;t++){var r=this.rows[t];if(!X.isInputRow(r))continue;e=r.elements[r.elements.length-2];let l=this.getNegativeSpacing_(r.elements[1]),p=this.getNegativeSpacing_(e);e=l+p;const v=this.constants_.MIN_BLOCK_WIDTH+2*this.outputConnection.width;this.width-e<v&&(e=this.width-v,l=e/2,p=e/2),r.elements.unshift(new Er(this.constants_,-l)),r.elements.push(new Er(this.constants_,-p))}if(e)for(this.width-=e,this.widthWithChildren-=e,this.rightSide.xPos-=e,t=0;t<this.rows.length;t++)r=this.rows[t],X.isTopOrBottomRow(r)&&(r.elements[1].width-=e),r.width-=e,r.widthWithConnectedBlocks-=e}}getNegativeSpacing_(e){if(!e||!this.outputConnection)return 0;const t=this.outputConnection.width;var r=this.outputConnection.shape.type;const l=this.constants_;if(1<this.inputRows.length)switch(r){case l.SHAPES.ROUND:return r=this.constants_.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH,r=this.height/2>r?r:this.height/2,t-r*(1-Math.sin(Math.acos((r-this.constants_.SMALL_PADDING)/r)));default:return 0}if(X.isInlineInput(e)&&e instanceof qo){const p=e.connectedBlock;return e=p?p.pathObject.outputShapeType:e.shape.type,e==null||p&&p.outputConnection&&(p.statementInputCount||p.nextConnection)||r===l.SHAPES.HEXAGONAL&&r!==e?0:t-this.constants_.SHAPE_IN_SHAPE_PADDING[r][e]}return X.isField(e)&&e instanceof Zl?r===l.SHAPES.ROUND&&e.field instanceof Sh?t-2.75*l.GRID_UNIT:t-this.constants_.SHAPE_IN_SHAPE_PADDING[r][0]:X.isIcon(e)?this.constants_.SMALL_PADDING:0}finalizeVerticalAlignment_(){if(!this.outputConnection)for(let l=2;l<this.rows.length-1;l+=2){const p=this.rows[l-1],v=this.rows[l],O=this.rows[l+1];var e=l===2,t=l+2>=this.rows.length-1?!!this.bottomRow.hasNextConnection:!!O.precedesStatement;if(e?this.topRow.hasPreviousConnection:p.followsStatement){var r=v.elements[1];if(r=v.elements.length===3&&r instanceof Zl&&(r.field instanceof Ya||r.field instanceof Qa),!e&&r)p.height-=this.constants_.SMALL_PADDING,O.height-=this.constants_.SMALL_PADDING,v.height-=this.constants_.MEDIUM_PADDING;else if(!e&&!t)p.height+=this.constants_.SMALL_PADDING;else if(t){for(e=!1,t=0;t<v.elements.length;t++)if(r=v.elements[t],r instanceof qo&&X.isInlineInput(r)&&r.connectedBlock&&!r.connectedBlock.isShadow()&&40<=r.connectedBlock.getHeightWidth().height){e=!0;break}e&&(p.height-=this.constants_.SMALL_PADDING,O.height-=this.constants_.SMALL_PADDING)}}}}finalize_(){this.finalizeOutputConnection_(),this.finalizeHorizontalAlignment_(),this.finalizeVerticalAlignment_(),super.finalize_(),this.rightSide&&(this.widthWithChildren+=this.rightSide.width)}},P$=class extends _f{constructor(e,t,r){super(e,t,r),this.markerCircle=null}showWithInputOutput(e){const t=e.getSourceBlock();e=e.getLocation().getOffsetInBlock(),this.positionCircle(e.x,e.y),this.setParent_(t),this.showCurrent_()}showWithOutput_(e){this.showWithInputOutput(e)}showWithInput_(e){this.showWithInputOutput(e)}showWithBlock_(e){e=e.getLocation();const t=e.getHeightWidth();this.positionRect_(0,0,t.width,t.height),this.setParent_(e),this.showCurrent_()}positionCircle(e,t){let r;(r=this.markerCircle)==null||r.setAttribute("cx",`${e}`);let l;(l=this.markerCircle)==null||l.setAttribute("cy",`${t}`),this.currentMarkerSvg=this.markerCircle}hide(){super.hide(),this.markerCircle&&(this.markerCircle.style.display="none")}createDomInternal_(){if(super.createDomInternal_(),this.markerCircle=ie(ae.CIRCLE,{r:this.constants_.CURSOR_RADIUS,"stroke-width":this.constants_.CURSOR_STROKE_WIDTH},this.markerSvg_),this.hide(),this.isCursor()){const e=this.getBlinkProperties_();ie(ae.ANIMATE,e,this.markerCircle)}return this.markerSvg_}applyColour_(e){super.applyColour_(e);let t;(t=this.markerCircle)==null||t.setAttribute("fill",this.colour_);let r;if((r=this.markerCircle)==null||r.setAttribute("stroke",this.colour_),this.isCursor()){e=this.colour_+";transparent;transparent;";let l;(l=this.markerCircle)==null||l.firstElementChild.setAttribute("values",e)}}},F$=class extends ch{constructor(e,t,r){super(e,t,r),this.svgPathSelected=null,this.outlines=new Map,this.remainingOutlines=new Set,this.outputShapeType=null,this.constants=r}setPath(e){super.setPath(e),this.svgPathSelected&&this.svgPathSelected.setAttribute("d",e)}applyColour(e){super.applyColour(e);const t=e.getParent();e.isShadow()&&t&&this.svgPath.setAttribute("stroke",t.style.colourTertiary);for(const r of this.outlines.values())r.setAttribute("fill",this.style.colourTertiary)}flipRTL(){super.flipRTL();for(const e of this.outlines.values())e.setAttribute("transform","scale(-1 1)")}updateSelected(e){this.setClass_("blocklySelected",e),e?this.svgPathSelected||(this.svgPathSelected=this.svgPath.cloneNode(!0),this.svgPathSelected.setAttribute("fill","none"),this.svgPathSelected.setAttribute("filter","url(#"+this.constants.selectedGlowFilterId+")"),this.svgRoot.appendChild(this.svgPathSelected)):this.svgPathSelected&&(this.svgRoot.removeChild(this.svgPathSelected),this.svgPathSelected=null)}updateReplacementFade(e){this.setClass_("blocklyReplaceable",e),e?this.svgPath.setAttribute("filter","url(#"+this.constants.replacementGlowFilterId+")"):this.svgPath.removeAttribute("filter")}updateShapeForInputHighlight(e,t){e=e.getParentInput().name,(e=this.getOutlinePath(e))&&(t?e.setAttribute("filter","url(#"+this.constants.replacementGlowFilterId+")"):e.removeAttribute("filter"))}beginDrawing(){this.remainingOutlines.clear();for(const e of this.outlines.keys())this.remainingOutlines.add(e)}endDrawing(){if(this.remainingOutlines.size)for(const e of this.remainingOutlines)this.removeOutlinePath(e);this.remainingOutlines.clear()}setOutlinePath(e,t){e=this.getOutlinePath(e),e.setAttribute("d",t),e.setAttribute("fill",this.style.colourTertiary)}getOutlinePath(e){return this.outlines.has(e)||this.outlines.set(e,ie(ae.PATH,{class:"blocklyOutlinePath",d:""},this.svgRoot)),this.remainingOutlines.delete(e),this.outlines.get(e)}removeOutlinePath(e){let t,r;(t=this.outlines.get(e))==null||(r=t.parentNode)==null||r.removeChild(this.outlines.get(e)),this.outlines.delete(e)}},Of=class extends Su{constructor(e){super(e)}makeConstants_(){return new yh}makeRenderInfo_(e){return new B$(this,e)}makeDrawer_(e,t){return new _h(e,t)}makeMarkerDrawer(e,t){return new P$(e,this.getConstants(),t)}makePathObject(e,t){return new F$(e,t,this.getConstants())}getConstants(){return this.constants_}getConnectionPreviewMethod(e,t,r){return C("getConnectionPreviewMethod","v10","v12","an IConnectionPreviewer, if it fulfills your use case."),t.type===Ge.OUTPUT_VALUE?e.isConnected()?Vr.PREVIEW_TYPE.REPLACEMENT_FADE:Vr.PREVIEW_TYPE.INPUT_OUTLINE:super.getConnectionPreviewMethod(e,t,r)}};Yi("zelos",Of);var j$=class{constructor(e){this.staticConn=this.draggedConn=this.markerConn=this.fadedBlock=null,this.workspace=e.workspace}previewReplacement(e,t,r){s.disable$$module$build$src$core$events$utils();try{this.hidePreview(),this.fadedBlock=r,r.fadeForReplacement(!0),this.workspace.getRenderer().shouldHighlightConnection(t)&&(t.highlight(),this.staticConn=t)}finally{s.enable$$module$build$src$core$events$utils()}}previewConnection(e,t){if(e!==this.draggedConn||t!==this.staticConn){s.disable$$module$build$src$core$events$utils();try{this.hidePreview(),this.shouldUseMarkerPreview(e,t)&&(this.markerConn=this.previewMarker(e,t)),this.workspace.getRenderer().shouldHighlightConnection(t)&&t.highlight(),this.draggedConn=e,this.staticConn=t}finally{s.enable$$module$build$src$core$events$utils()}}}shouldUseMarkerPreview(e,t){return t.type===Ge.PREVIOUS_STATEMENT||t.type===Ge.NEXT_STATEMENT||!(this.workspace.getRenderer()instanceof Of)}previewMarker(e,t){const r=e.getSourceBlock(),l=this.createInsertionMarker(r),p=this.getMatchingConnection(r,l,e);if(!p)return null;l.queueRender(),js(),p.connect(t);const v={x:t.x-p.x,y:t.y-p.y},O=p.getOffsetInBlock().clone();return cs().then(()=>{if(!l.isDeadOrDying()){s.disable$$module$build$src$core$events$utils();try{l==null||l.positionNearConnection(p,v,O),l==null||l.getSvgRoot().setAttribute("visibility","visible")}finally{s.enable$$module$build$src$core$events$utils()}}}),p}createInsertionMarker(e){const t=Vt(e,{addCoordinates:!1,addInputBlocks:!1,addNextBlocks:!1,doFullSerialization:!1});if(!t)throw Error(`Failed to serialize source block. ${e.toDevString()}`);e=Ui(t,this.workspace);for(const r of e.getDescendants(!1))r.setInsertionMarker(!0);return e.initSvg(),e.getSvgRoot().setAttribute("visibility","hidden"),e}getMatchingConnection(e,t,r){if(e=e.getConnections_(!0),t=t.getConnections_(!0),e.length!==t.length)return null;for(let l=0;l<e.length;l++)if(e[l]===r)return t[l];return null}hidePreview(){s.disable$$module$build$src$core$events$utils();try{this.staticConn&&(this.staticConn.unhighlight(),this.staticConn=null),this.fadedBlock&&(this.fadedBlock.fadeForReplacement(!1),this.fadedBlock=null),this.markerConn&&(this.hideInsertionMarker(this.markerConn),this.draggedConn=this.markerConn=null)}finally{s.enable$$module$build$src$core$events$utils()}}hideInsertionMarker(e){const t=e.getSourceBlock(),r=t.outputConnection;let l;if((l=t.previousConnection)!=null&&l.targetConnection||r!=null&&r.targetConnection)t.unplug(!0);else{let p;(p=e.targetBlock())==null||p.unplug(!1)}t.dispose()}dispose(){this.hidePreview()}};i(Ne.CONNECTION_PREVIEWER,Pr,j$);var Xo={};Xo.Align=s.Align$$module$build$src$core$inputs$align,Xo.DummyInput=Di,Xo.EndRowInput=ho,Xo.Input=Ko,Xo.StatementInput=kr,Xo.ValueInput=s.ValueInput$$module$build$src$core$inputs$value_input,Xo.inputTypes=s.inputTypes$$module$build$src$core$inputs$input_types;var z$=!1,U$;s.CodeGenerator$$module$build$src$core$generator=class{constructor(e){this.forBlock=Object.create(null),this.FUNCTION_NAME_PLACEHOLDER_="{leCUI8hutHZI4480Dc}",this.STATEMENT_SUFFIX=this.STATEMENT_PREFIX=this.INFINITE_LOOP_TRAP=null,this.INDENT="  ",this.COMMENT_WRAP=60,this.ORDER_OVERRIDES=[],this.isInitialized=null,this.RESERVED_WORDS_="",this.definitions_=Object.create(null),this.functionNames_=Object.create(null),this.nameDB_=void 0,this.name_=e,this.FUNCTION_NAME_PLACEHOLDER_REGEXP_=new RegExp(this.FUNCTION_NAME_PLACEHOLDER_,"g")}workspaceToCode(e){e||(console.warn("No workspace specified in workspaceToCode call.  Guessing."),e=Ke());var t=[];this.init(e),e=e.getTopBlocks(!0);for(let r=0,l;l=e[r];r++){let p=this.blockToCode(l);Array.isArray(p)&&(p=p[0]),p&&(l.outputConnection&&(p=this.scrubNakedValue(p),this.STATEMENT_PREFIX&&!l.suppressPrefixSuffix&&(p=this.injectId(this.STATEMENT_PREFIX,l)+p),this.STATEMENT_SUFFIX&&!l.suppressPrefixSuffix&&(p+=this.injectId(this.STATEMENT_SUFFIX,l))),t.push(p))}return t=t.join(`
`),t=this.finish(t),t=t.replace(/^\s+\n/,""),t=t.replace(/\n\s+$/,`
`),t=t.replace(/[ \t]+\n/g,`
`)}prefixLines(e,t){return t+e.replace(/(?!\n$)\n/g,`
`+t)}allNestedComments(e){const t=[];e=e.getDescendants(!0);for(let r=0;r<e.length;r++){const l=e[r].getCommentText();l&&t.push(l)}return t.length&&t.push(""),t.join(`
`)}blockToCode(e,t){if(this.isInitialized===!1&&console.warn("CodeGenerator init was not called before blockToCode was called."),!e)return"";if(!e.isEnabled())return t?"":this.blockToCode(e.getNextBlock());if(e.isInsertionMarker())return t?"":this.blockToCode(e.getChildren(!1)[0]);var r=this.forBlock[e.type];if(typeof r!="function")throw Error(`${this.name_} generator does not know how to generate code for block type "${e.type}".`);if(r=r.call(e,e,this),Array.isArray(r)){if(!e.outputConnection)throw TypeError("Expecting string from statement block: "+e.type);return[this.scrub_(e,r[0],t),r[1]]}if(typeof r=="string")return this.STATEMENT_PREFIX&&!e.suppressPrefixSuffix&&(r=this.injectId(this.STATEMENT_PREFIX,e)+r),this.STATEMENT_SUFFIX&&!e.suppressPrefixSuffix&&(r+=this.injectId(this.STATEMENT_SUFFIX,e)),this.scrub_(e,r,t);if(r===null)return"";throw SyntaxError("Invalid code generated: "+r)}valueToCode(e,t,r){if(isNaN(r))throw TypeError("Expecting valid order from block: "+e.type);var l=e.getInputTargetBlock(t);if(!l&&!e.getInput(t))throw ReferenceError(`Input "${t}" doesn't exist on "${e.type}"`);if(!l||(t=this.blockToCode(l),t===""))return"";if(!Array.isArray(t))throw TypeError(`Expecting tuple from value block: ${l.type} See developers.google.com/blockly/guides/create-custom-blocks/generating-code for more information`);if(e=t[0],t=t[1],isNaN(t))throw TypeError("Expecting valid order from value block: "+l.type);if(!e)return"";l=!1;var p=Math.floor(r);const v=Math.floor(t);if(p<=v&&(p!==v||p!==0&&p!==99)){for(l=!0,p=0;p<this.ORDER_OVERRIDES.length;p++)if(this.ORDER_OVERRIDES[p][0]===r&&this.ORDER_OVERRIDES[p][1]===t){l=!1;break}}return l&&(e="("+e+")"),e}statementToCode(e,t){const r=e.getInputTargetBlock(t);if(!r&&!e.getInput(t))throw ReferenceError(`Input "${t}" doesn't exist on "${e.type}"`);if(e=this.blockToCode(r),typeof e!="string")throw TypeError("Expecting code from statement block: "+(r&&r.type));return e&&(e=this.prefixLines(e,this.INDENT)),e}addLoopTrap(e,t){return this.INFINITE_LOOP_TRAP&&(e=this.prefixLines(this.injectId(this.INFINITE_LOOP_TRAP,t),this.INDENT)+e),this.STATEMENT_SUFFIX&&!t.suppressPrefixSuffix&&(e=this.prefixLines(this.injectId(this.STATEMENT_SUFFIX,t),this.INDENT)+e),this.STATEMENT_PREFIX&&!t.suppressPrefixSuffix&&(e+=this.prefixLines(this.injectId(this.STATEMENT_PREFIX,t),this.INDENT)),e}injectId(e,t){return t=t.id.replace(/\$/g,"$$$$"),e.replace(/%1/g,"'"+t+"'")}addReservedWords(e){this.RESERVED_WORDS_+=e+","}provideFunction_(e,t){if(!this.definitions_[e]){const r=this.nameDB_.getDistinctName(e,s.NameType$$module$build$src$core$names.PROCEDURE);this.functionNames_[e]=r,Array.isArray(t)&&(t=t.join(`
`)),t=t.trim().replace(this.FUNCTION_NAME_PLACEHOLDER_REGEXP_,r);let l;for(;l!==t;)l=t,t=t.replace(/^(( {2})*) {2}/gm,"$1\0");t=t.replace(/\0/g,this.INDENT),this.definitions_[e]=t}return this.functionNames_[e]}getVariableName(e){return this.getName(e,s.NameType$$module$build$src$core$names.VARIABLE)}getProcedureName(e){return this.getName(e,s.NameType$$module$build$src$core$names.PROCEDURE)}getName(e,t){if(!this.nameDB_)throw Error("Name database is not defined. You must initialize `nameDB_` in your generator class and call `init` first.");return this.nameDB_.getName(e,t)}init(e){this.definitions_=Object.create(null),this.functionNames_=Object.create(null)}scrub_(e,t,r){return t}finish(e){return this.definitions_=Object.create(null),this.functionNames_=Object.create(null),e}scrubNakedValue(e){return e}},U$={},U$.CodeGenerator=s.CodeGenerator$$module$build$src$core$generator;var H$=class extends Df{constructor(e,t){super(e),this.flyout_=t}getBoundingBox(){let e;try{e=this.workspace_.getCanvas().getBBox()}catch{e={height:0,y:0,width:0,x:0}}return e}getContentMetrics(e){const t=this.getBoundingBox();return e=e?1:this.workspace_.scale,{height:t.height*e,width:t.width*e,top:t.y*e,left:t.x*e}}getScrollMetrics(e,t,r){return t=r||this.getContentMetrics(),r=this.flyout_.MARGIN*this.workspace_.scale,e=e?this.workspace_.scale:1,{height:(t.height+2*r)/e,width:(t.width+t.left+r)/e,top:0,left:0}}},oc;(function(e){e.BLOCK="block",e.BUTTON="button"})(oc||(oc={}));var Jy="WORKSPACE_AT_BLOCK_CAPACITY",Th=class extends ph{constructor(e){super(),this.horizontalLayout=!1,this.boundEvents=[],this.filterWrapper=this.reflowWrapper=null,this.mats=[],this.buttons_=[],this.contents=[],this.listeners=[],this.permanentlyDisabled=[],this.recycledBlocks=[],this.autoClose=!0,this.visible=!1,this.containerVisible=!0,this.CORNER_RADIUS=8,this.SCROLLBAR_MARGIN=2.5,this.height_=this.width_=0,this.dragAngleRange_=70,this.svgGroup_=this.svgBackground_=null,e.setMetrics=this.setMetrics_.bind(this),this.workspace_=new Gr(e),this.workspace_.setMetricsManager(new H$(this.workspace_,this)),this.workspace_.internalIsFlyout=!0,this.workspace_.setVisible(this.visible),this.id=k(),this.RTL=!!e.RTL,this.toolboxPosition_=e.toolboxPosition,this.tabWidth_=this.workspace_.getRenderer().getConstants().TAB_WIDTH,this.rectMap_=new WeakMap,this.MARGIN=this.CORNER_RADIUS,this.GAP_X=3*this.MARGIN,this.GAP_Y=3*this.MARGIN}createDom(e){return this.svgGroup_=ie(e,{class:"blocklyFlyout"}),this.svgGroup_.style.display="none",this.svgBackground_=ie(ae.PATH,{class:"blocklyFlyoutBackground"},this.svgGroup_),this.svgGroup_.appendChild(this.workspace_.createDom()),this.workspace_.getThemeManager().subscribe(this.svgBackground_,"flyoutBackgroundColour","fill"),this.workspace_.getThemeManager().subscribe(this.svgBackground_,"flyoutOpacity","fill-opacity"),this.svgGroup_}init(e){this.targetWorkspace=e,this.workspace_.targetWorkspace=e,this.workspace_.scrollbar=new xf(this.workspace_,this.horizontalLayout,!this.horizontalLayout,"blocklyFlyoutScrollbar",this.SCROLLBAR_MARGIN),this.hide(),this.boundEvents.push(He(this.svgGroup_,"wheel",this,this.wheel_)),this.filterWrapper=this.filterForCapacity.bind(this),this.targetWorkspace.addChangeListener(this.filterWrapper),this.boundEvents.push(He(this.svgBackground_,"pointerdown",this,this.onMouseDown)),this.workspace_.getGesture=this.targetWorkspace.getGesture.bind(this.targetWorkspace),this.workspace_.setVariableMap(this.targetWorkspace.getVariableMap()),this.workspace_.createPotentialVariableMap(),e.getComponentManager().addComponent({component:this,weight:un.ComponentWeight.FLYOUT_WEIGHT,capabilities:[un.Capability.AUTOHIDEABLE,un.Capability.DELETE_AREA,un.Capability.DRAG_TARGET]})}dispose(){this.hide(),this.targetWorkspace.getComponentManager().removeComponent(this.id);for(const e of this.boundEvents)St(e);this.boundEvents.length=0,this.filterWrapper&&this.targetWorkspace.removeChangeListener(this.filterWrapper),this.workspace_&&(this.workspace_.getThemeManager().unsubscribe(this.svgBackground_),this.workspace_.dispose()),this.svgGroup_&&lt(this.svgGroup_)}getWidth(){return this.width_}getHeight(){return this.height_}getFlyoutScale(){return this.targetWorkspace.scale}getWorkspace(){return this.workspace_}setAutoClose(e){this.autoClose=e,this.targetWorkspace.recordDragTargets(),this.targetWorkspace.resizeContents()}autoHide(e){!e&&this.targetWorkspace.getFlyout(!0)===this&&this.autoClose&&this.hide()}getTargetWorkspace(){return this.targetWorkspace}isVisible(){return this.visible}setVisible(e){const t=e!==this.isVisible();this.visible=e,t&&(this.autoClose||this.targetWorkspace.recordDragTargets(),this.updateDisplay())}setContainerVisible(e){const t=e!==this.containerVisible;this.containerVisible=e,t&&this.updateDisplay()}getContents(){return this.contents}setContents(e){this.contents=e}updateDisplay(){let e;e=this.containerVisible?this.isVisible():!1,this.svgGroup_&&(this.svgGroup_.style.display=e?"block":"none");let t;(t=this.workspace_.scrollbar)==null||t.setContainerVisible(e)}positionAt_(e,t,r,l){let p;(p=this.svgGroup_)==null||p.setAttribute("width",`${e}`);let v;(v=this.svgGroup_)==null||v.setAttribute("height",`${t}`),this.workspace_.setCachedParentSvgSize(e,t),this.svgGroup_&&gn(this.svgGroup_,"translate("+r+"px,"+l+"px)"),(e=this.workspace_.scrollbar)&&(e.setOrigin(r,l),e.resize(),e.hScroll&&e.hScroll.setPosition(e.hScroll.position.x,e.hScroll.position.y),e.vScroll&&e.vScroll.setPosition(e.vScroll.position.x,e.vScroll.position.y))}hide(){if(this.isVisible()){this.setVisible(!1);for(const e of this.listeners)St(e);this.listeners.length=0,this.reflowWrapper&&(this.workspace_.removeChangeListener(this.reflowWrapper),this.reflowWrapper=null)}}show(e){this.workspace_.setResizesEnabled(!1),this.hide(),this.clearOldBlocks(),typeof e=="string"&&(e=this.getDynamicCategoryContents(e)),this.setVisible(!0),e=de(e),e=this.createFlyoutInfo(e),js(this.workspace_),this.setContents(e.contents),this.layout_(e.contents,e.gaps),this.horizontalLayout?this.height_=0:this.width_=0,this.workspace_.setResizesEnabled(!0),this.reflow(),this.filterForCapacity(),this.position(),this.reflowWrapper=this.reflow.bind(this),this.workspace_.addChangeListener(this.reflowWrapper),this.emptyRecycledBlocks()}createFlyoutInfo(e){const t=[],r=[];this.permanentlyDisabled.length=0;const l=this.horizontalLayout?this.GAP_X:this.GAP_Y;for(const p of e){if("custom"in p){e=this.getDynamicCategoryContents(p.custom),e=de(e);const{contents:v,gaps:O}=this.createFlyoutInfo(e);t.push(...v),r.push(...O)}switch(p.kind.toUpperCase()){case"BLOCK":e=p;const v=this.createFlyoutBlock(e);t.push({type:oc.BLOCK,block:v}),this.addBlockGap(e,r,l);break;case"SEP":this.addSeparatorGap(p,r,l);break;case"LABEL":e=this.createButton(p,!0),t.push({type:oc.BUTTON,button:e}),r.push(l);break;case"BUTTON":e=this.createButton(p,!1),t.push({type:oc.BUTTON,button:e}),r.push(l)}}return{contents:t,gaps:r}}getDynamicCategoryContents(e){if(e=this.workspace_.targetWorkspace.getToolboxCategoryCallback(e),typeof e!="function")throw TypeError("Couldn't find a callback function when opening a toolbox category.");return e(this.workspace_.targetWorkspace)}createButton(e,t){return new Ir(this.workspace_,this.targetWorkspace,e,t)}createFlyoutBlock(e){let t;return e.blockxml?(e=typeof e.blockxml=="string"?s.textToDom$$module$build$src$core$utils$xml(e.blockxml):e.blockxml,(t=this.getRecycledBlock(e.getAttribute("type")))||(t=Ao(e,this.workspace_))):(t=this.getRecycledBlock(e.type),t||(e.enabled===void 0&&(e.enabled=e.disabled!=="true"&&e.disabled!==!0),e.disabledReasons===void 0&&e.enabled===!1&&(e.disabledReasons=[Hs]),t=Gn(e,this.workspace_))),t.isEnabled()||this.permanentlyDisabled.push(t),t}getRecycledBlock(e){let t=-1;for(let r=0;r<this.recycledBlocks.length;r++)if(this.recycledBlocks[r].type===e){t=r;break}return t===-1?void 0:this.recycledBlocks.splice(t,1)[0]}addBlockGap(e,t,r){let l;e.gap?l=parseInt(String(e.gap)):e.blockxml&&(e=typeof e.blockxml=="string"?s.textToDom$$module$build$src$core$utils$xml(e.blockxml):e.blockxml,l=parseInt(e.getAttribute("gap"))),t.push(!l||isNaN(l)?r:l)}addSeparatorGap(e,t,r){e=parseInt(String(e.gap)),!isNaN(e)&&0<t.length?t[t.length-1]=e:t.push(r)}clearOldBlocks(){var e=this.workspace_.getTopBlocks(!1);for(let r=0,l;l=e[r];r++)this.blockIsRecyclable_(l)?this.recycleBlock(l):l.dispose(!1,!1);for(e=0;e<this.mats.length;e++){const r=this.mats[e];r&&(Zu(r),lt(r))}this.mats.length=0;for(let r=0,l;l=this.buttons_[r];r++)l.dispose();this.buttons_.length=0;let t;(t=this.workspace_.getPotentialVariableMap())==null||t.clear()}emptyRecycledBlocks(){for(let e=0;e<this.recycledBlocks.length;e++)this.recycledBlocks[e].dispose();this.recycledBlocks=[]}blockIsRecyclable_(e){return!1}recycleBlock(e){const t=e.getRelativeToSurfaceXY();e.moveBy(-t.x,-t.y),this.recycledBlocks.push(e)}addBlockListeners_(e,t,r){this.listeners.push(He(e,"pointerdown",null,this.blockMouseDown(t))),this.listeners.push(He(r,"pointerdown",null,this.blockMouseDown(t))),this.listeners.push(Ft(e,"pointerenter",t,()=>{this.targetWorkspace.isDragging()||t.addSelect()})),this.listeners.push(Ft(e,"pointerleave",t,()=>{this.targetWorkspace.isDragging()||t.removeSelect()})),this.listeners.push(Ft(r,"pointerenter",t,()=>{this.targetWorkspace.isDragging()||t.addSelect()})),this.listeners.push(Ft(r,"pointerleave",t,()=>{this.targetWorkspace.isDragging()||t.removeSelect()}))}blockMouseDown(e){return t=>{const r=this.targetWorkspace.getGesture(t);r&&(r.setStartBlock(e),r.handleFlyoutStart(t,this))}}onMouseDown(e){const t=this.targetWorkspace.getGesture(e);t&&t.handleFlyoutStart(e,this)}isBlockCreatable(e){return e.isEnabled()}createBlock(e){let t=null;s.disable$$module$build$src$core$events$utils();var r=this.targetWorkspace.getAllVariables();this.targetWorkspace.setResizesEnabled(!1);try{t=this.placeNewBlock(e)}finally{s.enable$$module$build$src$core$events$utils()}if(this.targetWorkspace.hideChaff(),e=Sc(this.targetWorkspace,r),re()){for(s.setGroup$$module$build$src$core$events$utils(!0),r=0;r<e.length;r++){const l=e[r];te(new(Ce(ge.VAR_CREATE))(l))}te(new(Ce(ge.BLOCK_CREATE))(t))}return this.autoClose?this.hide():this.filterForCapacity(),t}initFlyoutButton_(e,t,r){const l=e.createDom();e.moveTo(t,r),e.show(),this.listeners.push(He(l,"pointerdown",this,this.onMouseDown)),this.buttons_.push(e)}createRect_(e,t,r,l,p){return t=ie(ae.RECT,{"fill-opacity":0,x:t,y:r,height:l.height,width:l.width}),t.tooltip=e,$l(t),this.workspace_.getCanvas().insertBefore(t,e.getSvgRoot()),this.rectMap_.set(e,t),this.mats[p]=t}moveRectToBlock_(e,t){const r=t.getHeightWidth();e.setAttribute("width",String(r.width)),e.setAttribute("height",String(r.height)),t=t.getRelativeToSurfaceXY(),e.setAttribute("y",String(t.y)),e.setAttribute("x",String(this.RTL?t.x-r.width:t.x))}filterForCapacity(){const e=this.workspace_.getTopBlocks(!1);for(let t=0,r;r=e[t];t++)if(!this.permanentlyDisabled.includes(r)){const l=this.targetWorkspace.isCapacityAvailable(It(r));for(;r;)r.setDisabledReason(!l,Jy),r=r.getNextBlock()}}reflow(){this.reflowWrapper&&this.workspace_.removeChangeListener(this.reflowWrapper),this.reflowInternal_(),this.reflowWrapper&&this.workspace_.addChangeListener(this.reflowWrapper)}isScrollable(){return this.workspace_.scrollbar?this.workspace_.scrollbar.isVisible():!1}placeNewBlock(e){var t=this.targetWorkspace;if(!e.getSvgRoot())throw Error("oldBlock is not rendered");const r=this.serializeBlock(e);return t.setResizesEnabled(!1),t=Ui(r,t),this.positionNewBlock(e,t),t}serializeBlock(e){return Vt(e)}positionNewBlock(e,t){const r=this.targetWorkspace;var l=r.getOriginOffsetInPixels(),p=this.workspace_.getOriginOffsetInPixels();e=e.getRelativeToSurfaceXY(),e.scale(this.workspace_.scale),p=Ae.sum(p,e),l=Ae.difference(p,l),l.scale(1/r.scale),t.moveTo(new Ae(l.x,l.y))}};Th.FlyoutItemType=oc;var Rf=class extends Th{constructor(e){super(e)}setMetrics_(e){if(this.isVisible()){var t=this.workspace_.getMetricsManager(),r=t.getScrollMetrics(),l=t.getViewMetrics();t=t.getAbsoluteMetrics(),typeof e.y=="number"&&(this.workspace_.scrollY=-(r.top+(r.height-l.height)*e.y)),this.workspace_.translate(this.workspace_.scrollX+t.left,this.workspace_.scrollY+t.top)}}getX(){if(!this.isVisible())return 0;var e=this.targetWorkspace.getMetricsManager();const t=e.getAbsoluteMetrics(),r=e.getViewMetrics();return e=e.getToolboxMetrics(),this.targetWorkspace.toolboxPosition===this.toolboxPosition_?this.targetWorkspace.getToolbox()?this.toolboxPosition_===wt.LEFT?e.width:r.width-this.width_:this.toolboxPosition_===wt.LEFT?0:r.width:this.toolboxPosition_===wt.LEFT?0:r.width+t.left-this.width_}getY(){return 0}position(){if(this.isVisible()&&this.targetWorkspace.isVisible()){var e=this.targetWorkspace.getMetricsManager().getViewMetrics();this.height_=e.height,this.setBackgroundPath(this.width_-this.CORNER_RADIUS,e.height-2*this.CORNER_RADIUS),e=this.getX();var t=this.getY();this.positionAt_(this.width_,this.height_,e,t)}}setBackgroundPath(e,t){const r=this.toolboxPosition_===wt.RIGHT;var l=e+this.CORNER_RADIUS;l=["M "+(r?l:0)+",0"],l.push("h",r?-e:e),l.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,r?0:1,r?-this.CORNER_RADIUS:this.CORNER_RADIUS,this.CORNER_RADIUS),l.push("v",Math.max(0,t)),l.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,r?0:1,r?this.CORNER_RADIUS:-this.CORNER_RADIUS,this.CORNER_RADIUS),l.push("h",r?e:-e),l.push("z"),this.svgBackground_.setAttribute("d",l.join(" "))}scrollToStart(){let e;(e=this.workspace_.scrollbar)==null||e.setY(0)}wheel_(e){var t=fe(e);if(t.y){const r=this.workspace_.getMetricsManager(),l=r.getScrollMetrics();t=r.getViewMetrics().top-l.top+t.y;let p;(p=this.workspace_.scrollbar)==null||p.setY(t),Dc(this.workspace_),ri()}e.preventDefault(),e.stopPropagation()}layout_(e,t){this.workspace_.scale=this.targetWorkspace.scale;var r=this.MARGIN;const l=this.RTL?r:r+this.tabWidth_;for(let G=0,_e;_e=e[G];G++)if(_e.type==="block"){var p=_e.block;if(!p)continue;var v=p.getDescendants(!1);for(let Nn=0,On;On=v[Nn];Nn++)On.isInFlyout=!0;v=p.getSvgRoot();const qe=p.getHeightWidth();var O=p.outputConnection?l-this.tabWidth_:l;p.moveBy(O,r),O=this.createRect_(p,this.RTL?O-qe.width:O,r,qe,G),this.addBlockListeners_(v,p,O),r+=qe.height+t[G]}else _e.type==="button"&&(p=_e.button,this.initFlyoutButton_(p,l,r),r+=p.height+t[G])}isDragTowardWorkspace(e){e=Math.atan2(e.y,e.x)/Math.PI*180;const t=this.dragAngleRange_;return e<t&&e>-t||e<-180+t||e>180-t}getClientRect(){if(!this.svgGroup_||this.autoClose||!this.isVisible())return null;const e=this.svgGroup_.getBoundingClientRect(),t=e.left;return this.toolboxPosition_===wt.LEFT?new Tt(-1e9,1e9,-1e9,t+e.width):new Tt(-1e9,1e9,t,1e9)}reflowInternal_(){this.workspace_.scale=this.getFlyoutScale();let e=0;var t=this.workspace_.getTopBlocks(!1);for(let l=0,p;p=t[l];l++){var r=p.getHeightWidth().width;p.outputConnection&&(r-=this.tabWidth_),e=Math.max(e,r)}for(let l=0,p;p=this.buttons_[l];l++)e=Math.max(e,p.width);if(e+=1.5*this.MARGIN+this.tabWidth_,e*=this.workspace_.scale,e+=Un.scrollbarThickness,this.width_!==e){for(let l=0,p;p=t[l];l++){if(this.RTL){r=p.getRelativeToSurfaceXY().x;let v=e/this.workspace_.scale-this.MARGIN;p.outputConnection||(v-=this.tabWidth_),p.moveBy(v-r,0)}this.rectMap_.has(p)&&this.moveRectToBlock_(this.rectMap_.get(p),p)}if(this.RTL)for(let l=0,p;p=this.buttons_[l];l++)t=p.getPosition().y,p.moveTo(e/this.workspace_.scale-p.width-this.MARGIN-this.tabWidth_,t);this.targetWorkspace.scrollbar||this.autoClose||this.targetWorkspace.getFlyout()!==this||this.toolboxPosition_!==wt.LEFT||this.targetWorkspace.translate(this.targetWorkspace.scrollX+e,this.targetWorkspace.scrollY),this.width_=e,this.position(),this.targetWorkspace.resizeContents(),this.targetWorkspace.recordDragTargets()}}};Rf.registryName="verticalFlyout",i(Ne.FLYOUTS_VERTICAL_TOOLBOX,Pr,Rf);var W$=class extends Th{constructor(e){super(e),this.horizontalLayout=!0}setMetrics_(e){if(this.isVisible()){var t=this.workspace_.getMetricsManager(),r=t.getScrollMetrics(),l=t.getViewMetrics();t=t.getAbsoluteMetrics(),typeof e.x=="number"&&(this.workspace_.scrollX=-(r.left+(r.width-l.width)*e.x)),this.workspace_.translate(this.workspace_.scrollX+t.left,this.workspace_.scrollY+t.top)}}getX(){return 0}getY(){if(!this.isVisible())return 0;var e=this.targetWorkspace.getMetricsManager();const t=e.getAbsoluteMetrics(),r=e.getViewMetrics();e=e.getToolboxMetrics();const l=this.toolboxPosition_===wt.TOP;return this.targetWorkspace.toolboxPosition===this.toolboxPosition_?this.targetWorkspace.getToolbox()?l?e.height:r.height-this.height_:l?0:r.height:l?0:r.height+t.top-this.height_}position(){if(this.isVisible()&&this.targetWorkspace.isVisible()){var e=this.targetWorkspace.getMetricsManager().getViewMetrics();this.width_=e.width,this.setBackgroundPath(e.width-2*this.CORNER_RADIUS,this.height_-this.CORNER_RADIUS),e=this.getX();var t=this.getY();this.positionAt_(this.width_,this.height_,e,t)}}setBackgroundPath(e,t){const r=this.toolboxPosition_===wt.TOP,l=["M 0,"+(r?0:this.CORNER_RADIUS)];r?(l.push("h",e+2*this.CORNER_RADIUS),l.push("v",t),l.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,-this.CORNER_RADIUS,this.CORNER_RADIUS),l.push("h",-e),l.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,-this.CORNER_RADIUS,-this.CORNER_RADIUS)):(l.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,this.CORNER_RADIUS,-this.CORNER_RADIUS),l.push("h",e),l.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,this.CORNER_RADIUS,this.CORNER_RADIUS),l.push("v",t),l.push("h",-e-2*this.CORNER_RADIUS)),l.push("z"),this.svgBackground_.setAttribute("d",l.join(" "))}scrollToStart(){let e;(e=this.workspace_.scrollbar)==null||e.setX(this.RTL?1/0:0)}wheel_(e){var t=fe(e);if(t=t.x||t.y){const r=this.workspace_.getMetricsManager(),l=r.getScrollMetrics();t=r.getViewMetrics().left-l.left+t;let p;(p=this.workspace_.scrollbar)==null||p.setX(t),Dc(this.workspace_),ri()}e.preventDefault(),e.stopPropagation()}layout_(e,t){this.workspace_.scale=this.targetWorkspace.scale;const r=this.MARGIN;let l=r+this.tabWidth_;this.RTL&&(e=e.reverse());for(let G=0,_e;_e=e[G];G++)if(_e.type==="block"){var p=_e.block;if(p==null)continue;var v=p.getDescendants(!1);for(let Nn=0,On;On=v[Nn];Nn++)On.isInFlyout=!0;v=p.getSvgRoot();const qe=p.getHeightWidth();var O=p.outputConnection?this.tabWidth_:0;O=this.RTL?l+qe.width:l-O,p.moveBy(O,r),O=this.createRect_(p,O,r,qe,G),l+=qe.width+t[G],this.addBlockListeners_(v,p,O)}else _e.type==="button"&&(p=_e.button,this.initFlyoutButton_(p,l,r),l+=p.width+t[G])}isDragTowardWorkspace(e){e=Math.atan2(e.y,e.x)/Math.PI*180;const t=this.dragAngleRange_;return e<90+t&&e>90-t||e>-90-t&&e<-90+t}getClientRect(){if(!this.svgGroup_||this.autoClose||!this.isVisible())return null;const e=this.svgGroup_.getBoundingClientRect(),t=e.top;return this.toolboxPosition_===wt.TOP?new Tt(-1e9,t+e.height,-1e9,1e9):new Tt(t,1e9,-1e9,1e9)}reflowInternal_(){this.workspace_.scale=this.getFlyoutScale();let e=0;const t=this.workspace_.getTopBlocks(!1);for(let l=0,p;p=t[l];l++)e=Math.max(e,p.getHeightWidth().height);const r=this.buttons_;for(let l=0,p;p=r[l];l++)e=Math.max(e,p.height);if(e+=1.5*this.MARGIN,e*=this.workspace_.scale,e+=Un.scrollbarThickness,this.height_!==e){for(let l=0,p;p=t[l];l++)this.rectMap_.has(p)&&this.moveRectToBlock_(this.rectMap_.get(p),p);this.targetWorkspace.scrollbar||this.autoClose||this.targetWorkspace.getFlyout()!==this||this.toolboxPosition_!==wt.TOP||this.targetWorkspace.translate(this.targetWorkspace.scrollX,this.targetWorkspace.scrollY+e),this.height_=e,this.position(),this.targetWorkspace.resizeContents(),this.targetWorkspace.recordDragTargets()}}};i(Ne.FLYOUTS_HORIZONTAL_TOOLBOX,Pr,W$);var u=class extends cr{constructor(e,t,r,l,p){super(fn.SKIP_SETUP),this.defaultType="",this.variableTypes=[],this.variable=null,this.SERIALIZABLE=!0,this.menuGenerator_=u.dropdownCreate,this.defaultVariableName=typeof e=="string"?e:"",this.size_=new Pt(0,0),e!==fn.SKIP_SETUP&&(p?this.configure_(p):this.setTypes(r,l),t&&this.setValidator(t))}configure_(e){super.configure_(e),this.setTypes(e.variableTypes,e.defaultType)}initModel(){var e=this.getSourceBlock();if(!e)throw new Jn;this.variable||(e=s.getOrCreateVariablePackage$$module$build$src$core$variables(e.workspace,null,this.defaultVariableName,this.defaultType),this.doValueUpdate_(e.getId()))}shouldAddBorderRect_(){const e=this.getSourceBlock();if(!e)throw new Jn;return super.shouldAddBorderRect_()&&(!this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW||e.type!=="variables_get")}fromXml(e){var t=this.getSourceBlock();if(!t)throw new Jn;const r=e.getAttribute("id"),l=e.textContent,p=e.getAttribute("variabletype")||e.getAttribute("variableType")||"";if(t=s.getOrCreateVariablePackage$$module$build$src$core$variables(t.workspace,r,l,p),p!==null&&p!==t.type)throw Error("Serialized variable type with id '"+t.getId()+"' had type "+t.type+", and does not match variable field that references it: "+vi(e)+".");this.setValue(t.getId())}toXml(e){return this.initModel(),e.id=this.variable.getId(),e.textContent=this.variable.name,this.variable.type&&e.setAttribute("variabletype",this.variable.type),e}saveState(e){var t=this.saveLegacyState(u);return t!==null||(this.initModel(),t={id:this.variable.getId()},e&&(t.name=this.variable.name,t.type=this.variable.type)),t}loadState(e){const t=this.getSourceBlock();if(!t)throw new Jn;this.loadLegacyState(u,e)||(e=s.getOrCreateVariablePackage$$module$build$src$core$variables(t.workspace,e.id||null,e.name,e.type||""),this.setValue(e.getId()))}setSourceBlock(e){if(e.isShadow())throw Error("Variable fields are not allowed to exist on shadow blocks.");super.setSourceBlock(e)}getValue(){return this.variable?this.variable.getId():null}getText(){return this.variable?this.variable.name:""}getVariable(){return this.variable}getValidator(){return this.variable?this.validator_:null}doClassValidation_(e){if(e===null)return null;var t=this.getSourceBlock();if(!t)throw new Jn;return t=s.getVariable$$module$build$src$core$variables(t.workspace,e),t?(t=t.type,this.typeIsAllowed(t)?e:(console.warn("Variable type doesn't match this field!  Type was "+t),null)):(console.warn("Variable id doesn't point to a real variable! ID was "+e),null)}doValueUpdate_(e){const t=this.getSourceBlock();if(!t)throw new Jn;this.variable=s.getVariable$$module$build$src$core$variables(t.workspace,e),super.doValueUpdate_(e)}typeIsAllowed(e){const t=this.getVariableTypes();if(!t)return!0;for(let r=0;r<t.length;r++)if(e===t[r])return!0;return!1}getVariableTypes(){var e=this.variableTypes;if(e===null&&this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying())return this.sourceBlock_.workspace.getVariableTypes();if(e=e||[""],e.length===0)throw e=this.getText(),Error("'variableTypes' of field variable "+e+" was an empty list");return e}setTypes(e=null,t=""){if(Array.isArray(e)){let r=!1;for(let l=0;l<e.length;l++)e[l]===t&&(r=!0);if(!r)throw Error("Invalid default type '"+t+"' in the definition of a FieldVariable")}else if(e!==null)throw Error("'variableTypes' was not an array in the definition of a FieldVariable");this.defaultType=t,this.variableTypes=e}refreshVariableName(){this.forceRerender()}onItemSelected_(e,t){if(e=t.getValue(),this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()){if(e===Sf){s.renameVariable$$module$build$src$core$variables(this.sourceBlock_.workspace,this.variable);return}if(e===Cf){this.sourceBlock_.workspace.deleteVariableById(this.variable.getId());return}}this.setValue(e)}referencesVariables(){return!0}static fromJson(e){return new this(bt(e.variable),void 0,void 0,void 0,e)}static dropdownCreate(){if(!this.variable)throw Error("Tried to call dropdownCreate on a variable field with no variable selected.");const e=this.getText();let t=[];if(this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying())for(var r=this.getVariableTypes(),l=0;l<r.length;l++){const p=this.sourceBlock_.workspace.getVariablesOfType(r[l]);t=t.concat(p)}for(t.sort(ru.compareByName),r=[],l=0;l<t.length;l++)r[l]=[t[l].name,t[l].getId()];return r.push([s.Msg$$module$build$src$core$msg.RENAME_VARIABLE,Sf]),s.Msg$$module$build$src$core$msg.DELETE_VARIABLE&&r.push([s.Msg$$module$build$src$core$msg.DELETE_VARIABLE.replace("%1",e),Cf]),r}};_t("field_variable",u);var d=class extends wh{constructor(e,t,r,l,p,v){super(fn.SKIP_SETUP),this.min_=-1/0,this.max_=1/0,this.precision_=0,this.decimalPlaces=null,this.spellcheck_=!1,e!==fn.SKIP_SETUP&&(v?this.configure_(v):this.setConstraints(t,r,l),this.setValue(e),p&&this.setValidator(p))}configure_(e){super.configure_(e),this.setMinInternal(e.min),this.setMaxInternal(e.max),this.setPrecisionInternal(e.precision)}setConstraints(e,t,r){this.setMinInternal(e),this.setMaxInternal(t),this.setPrecisionInternal(r),this.setValue(this.getValue())}setMin(e){this.setMinInternal(e),this.setValue(this.getValue())}setMinInternal(e){e==null?this.min_=-1/0:(e=Number(e),isNaN(e)||(this.min_=e))}getMin(){return this.min_}setMax(e){this.setMaxInternal(e),this.setValue(this.getValue())}setMaxInternal(e){e==null?this.max_=1/0:(e=Number(e),isNaN(e)||(this.max_=e))}getMax(){return this.max_}setPrecision(e){this.setPrecisionInternal(e),this.setValue(this.getValue())}setPrecisionInternal(e){this.precision_=Number(e)||0;let t=String(this.precision_);t.includes("e")&&(t=this.precision_.toLocaleString("en-US",{maximumFractionDigits:20}));const r=t.indexOf(".");this.decimalPlaces=r===-1?e?0:null:t.length-r-1}getPrecision(){return this.precision_}doClassValidation_(e){return e===null||(e=`${e}`.replace(/O/gi,"0"),e=e.replace(/,/g,""),e=e.replace(/infinity/i,"Infinity"),e=Number(e||0),isNaN(e))?null:(e=Math.min(Math.max(e,this.min_),this.max_),this.precision_&&isFinite(e)&&(e=Math.round(e/this.precision_)*this.precision_),this.decimalPlaces!==null&&(e=Number(e.toFixed(this.decimalPlaces))),e)}widgetCreate_(){const e=super.widgetCreate_();return-1/0<this.min_&&(e.min=`${this.min_}`,qt(e,hs.VALUEMIN,this.min_)),1/0>this.max_&&(e.max=`${this.max_}`,qt(e,hs.VALUEMAX,this.max_)),e}static fromJson(e){return new this(e.value,void 0,void 0,void 0,void 0,e)}};_t("field_number",d),d.prototype.DEFAULT_VALUE=0;var m=class extends Ya{constructor(e,t,r){super(String(e??""),t,r),this.EDITABLE=!1,this.SERIALIZABLE=!0}static fromJson(e){return new this(bt(e.text),void 0,e)}};_t("field_label_serializable",m);var _=class extends fn{constructor(e,t,r){super(fn.SKIP_SETUP),this.SERIALIZABLE=!0,this.CURSOR="default",this.value_=this.value_,this.checkChar=_.CHECK_CHAR,e!==fn.SKIP_SETUP&&(r&&this.configure_(r),this.setValue(e),t&&this.setValidator(t))}configure_(e){super.configure_(e),e.checkCharacter&&(this.checkChar=e.checkCharacter)}saveState(){const e=this.saveLegacyState(_);return e!==null?e:this.getValueBoolean()}initView(){super.initView();const e=this.getTextElement();Pe(e,"blocklyCheckbox"),e.style.display=this.value_?"block":"none"}render_(){this.textContent_&&(this.textContent_.nodeValue=this.getDisplayText_()),this.updateSize_(this.getConstants().FIELD_CHECKBOX_X_OFFSET)}getDisplayText_(){return this.checkChar}setCheckCharacter(e){this.checkChar=e||_.CHECK_CHAR,this.forceRerender()}showEditor_(){this.setValue(!this.value_)}doClassValidation_(e){return e===!0||e==="TRUE"?"TRUE":e===!1||e==="FALSE"?"FALSE":null}doValueUpdate_(e){this.value_=this.convertValueToBool(e),this.textElement_&&(this.textElement_.style.display=this.value_?"block":"none")}getValue(){return this.value_?"TRUE":"FALSE"}getValueBoolean(){return this.value_}getText(){return String(this.convertValueToBool(this.value_))}convertValueToBool(e){return typeof e=="string"?e==="TRUE":!!e}static fromJson(e){return new this(e.checked,void 0,e)}};_.CHECK_CHAR="✓",_t("field_checkbox",_),_.prototype.DEFAULT_VALUE=!1;var x=class{constructor(e,t){this.draggable=e,this.workspace=t,this.dragTarget=null,this.startLoc=e.getRelativeToSurfaceXY()}onDragStart(e){this.draggable.startDrag(e)}onDrag(e,t){this.moveDraggable(e,t),t=this.getRoot(this.draggable),xn(t)&&t.setDeleteStyle(this.wouldDeleteDraggable(e,t)),this.updateDragTarget(e)}updateDragTarget(e){e=this.workspace.getDragTarget(e);const t=this.getRoot(this.draggable);if(this.dragTarget!==e){let r;(r=this.dragTarget)==null||r.onDragExit(t),e==null||e.onDragEnter(t)}e==null||e.onDragOver(t),this.dragTarget=e}moveDraggable(e,t){t=this.pixelsToWorkspaceUnits(t),t=Ae.sum(this.startLoc,t),this.draggable.drag(t,e)}wouldDeleteDraggable(e,t){return(e=this.workspace.getDragTarget(e))&&this.workspace.getComponentManager().hasCapability(e.id,un.Capability.DELETE_AREA)?e.wouldDelete(t):!1}onDragEnd(e){const t=s.getGroup$$module$build$src$core$events$utils();var r=this.workspace.getDragTarget(e);const l=this.getRoot(this.draggable);if(r){let p;(p=this.dragTarget)==null||p.onDrop(l)}this.shouldReturnToStart(e,l)&&this.draggable.revertDrag(),(r=xn(l)&&this.wouldDeleteDraggable(e,l))&&this.draggable instanceof qr&&ad(this.draggable.getRootBlock()),this.draggable.endDrag(e),r&&xn(l)&&(e=s.getGroup$$module$build$src$core$events$utils(),s.setGroup$$module$build$src$core$events$utils(t),l.dispose(),s.setGroup$$module$build$src$core$events$utils(e))}getRoot(e){return e instanceof qr?e.getRootBlock():e}shouldReturnToStart(e,t){return(e=this.workspace.getDragTarget(e))?e.shouldPreventMove(t):!1}pixelsToWorkspaceUnits(e){return e=new Ae(e.x/this.workspace.scale,e.y/this.workspace.scale),this.workspace.isMutator&&e.scale(1/this.workspace.options.parentWorkspace.scale),e}};i(Ne.BLOCK_DRAGGER,Pr,x);var B={};B.BlockDragStrategy=C$,B.BubbleDragStrategy=d$,B.CommentDragStrategy=o$,B.Dragger=x;var W=class extends Os{constructor(e,t,r){super(e?e.workspace.id:void 0),this.type=ge.BLOCK_DRAG,e&&(this.blockId=e.id,this.isStart=t,this.blocks=r)}toJson(){const e=super.toJson();if(this.isStart===void 0)throw Error("Whether this event is the start of a drag is undefined. Either pass the value to the constructor, or call fromJson");if(this.blockId===void 0)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");return e.isStart=this.isStart,e.blockId=this.blockId,e.blocks=this.blocks,e}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new W),t.isStart=e.isStart,t.blockId=e.blockId,t.blocks=e.blocks,t}};i(Ne.EVENT,ge.BLOCK_DRAG,W);var Z=class extends Pa{constructor(e,t,r,l){super(e),this.type=ge.BLOCK_FIELD_INTERMEDIATE_CHANGE,this.recordUndo=!1,e&&(this.name=t,this.oldValue=r,this.newValue=l)}toJson(){const e=super.toJson();if(!this.name)throw Error("The changed field name is undefined. Either pass a name to the constructor, or call fromJson.");return e.name=this.name,e.oldValue=this.oldValue,e.newValue=this.newValue,e}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new Z),t.name=e.name,t.oldValue=e.oldValue,t.newValue=e.newValue,t}isNull(){return this.oldValue===this.newValue}run(e){var t=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");if(t=t.getBlockById(this.blockId),!t)throw Error("The associated block is undefined. Either pass a block to the constructor, or call fromJson");e=e?this.newValue:this.oldValue,(t=t.getField(this.name))?t.setValue(e):console.warn("Can't set non-existent field: "+this.name)}};i(Ne.EVENT,ge.BLOCK_FIELD_INTERMEDIATE_CHANGE,Z);var ce=class extends Pa{constructor(e){super(e),this.type=ge.BLOCK_MOVE,e&&(e.isShadow()&&(this.recordUndo=!1),e=this.currentLocation(),this.oldParentId=e.parentId,this.oldInputName=e.inputName,this.oldCoordinate=e.coordinate)}toJson(){const e=super.toJson();return e.oldParentId=this.oldParentId,e.oldInputName=this.oldInputName,this.oldCoordinate&&(e.oldCoordinate=`${Math.round(this.oldCoordinate.x)}, ${Math.round(this.oldCoordinate.y)}`),e.newParentId=this.newParentId,e.newInputName=this.newInputName,this.newCoordinate&&(e.newCoordinate=`${Math.round(this.newCoordinate.x)}, ${Math.round(this.newCoordinate.y)}`),this.reason&&(e.reason=this.reason),this.recordUndo||(e.recordUndo=this.recordUndo),e}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new ce),t.oldParentId=e.oldParentId,t.oldInputName=e.oldInputName,e.oldCoordinate&&(r=e.oldCoordinate.split(","),t.oldCoordinate=new Ae(Number(r[0]),Number(r[1]))),t.newParentId=e.newParentId,t.newInputName=e.newInputName,e.newCoordinate&&(r=e.newCoordinate.split(","),t.newCoordinate=new Ae(Number(r[0]),Number(r[1]))),e.reason!==void 0&&(t.reason=e.reason),e.recordUndo!==void 0&&(t.recordUndo=e.recordUndo),t}recordNew(){const e=this.currentLocation();this.newParentId=e.parentId,this.newInputName=e.inputName,this.newCoordinate=e.coordinate}setReason(e){this.reason=e}currentLocation(){var e=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");var t=e.getBlockById(this.blockId);if(!t)throw Error("The block associated with the block move event could not be found");e={};const r=t.getParent();return r?(e.parentId=r.id,(t=r.getInputWithBlock(t))&&(e.inputName=t.name)):e.coordinate=t.getRelativeToSurfaceXY(),e}isNull(){return this.oldParentId===this.newParentId&&this.oldInputName===this.newInputName&&Ae.equals(this.oldCoordinate,this.newCoordinate)}run(e){var t=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");var r=t.getBlockById(this.blockId);if(r){var l=e?this.newParentId:this.oldParentId,p=e?this.newInputName:this.oldInputName;if(e=e?this.newCoordinate:this.oldCoordinate,l){var v=t.getBlockById(l);if(!v){console.warn("Can't connect to non-existent block: "+l);return}}if(r.getParent()&&r.unplug(),e)p=r.getRelativeToSurfaceXY(),r.moveBy(e.x-p.x,e.y-p.y,this.reason);else{t=r.outputConnection,(!t||r.previousConnection&&r.previousConnection.isConnected())&&(t=r.previousConnection);let O,G;r=(G=t)==null?void 0:G.type,p?(r=v.getInput(p))&&(O=r.connection):r===Ge.PREVIOUS_STATEMENT&&(O=v.nextConnection),O&&t?t.connect(O):console.warn("Can't connect to non-existent input: "+p)}}else console.warn("Can't move non-existent block: "+this.blockId)}};i(Ne.EVENT,ge.BLOCK_MOVE,ce);var Oe=class extends Os{constructor(e,t,r){super(e?e.workspace.id:void 0),this.type=ge.BUBBLE_OPEN,e&&(this.blockId=e.id,this.isOpen=t,this.bubbleType=r)}toJson(){const e=super.toJson();if(this.isOpen===void 0)throw Error("Whether this event is for opening the bubble is undefined. Either pass the value to the constructor, or call fromJson");if(!this.bubbleType)throw Error("The type of bubble is undefined. Either pass the value to the constructor, or call fromJson");return e.isOpen=this.isOpen,e.bubbleType=this.bubbleType,e.blockId=this.blockId||"",e}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new Oe),t.isOpen=e.isOpen,t.bubbleType=e.bubbleType,t.blockId=e.blockId,t}},Re;(function(e){e.MUTATOR="mutator",e.COMMENT="comment",e.WARNING="warning"})(Re||(Re={})),i(Ne.EVENT,ge.BUBBLE_OPEN,Oe);var Me=class extends Oa{constructor(e){super(),this.isBlank=!e,e&&(this.commentId=e.id,this.workspaceId=e.workspace.id,this.group=s.getGroup$$module$build$src$core$events$utils(),this.recordUndo=Y())}toJson(){const e=super.toJson();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");return e.commentId=this.commentId,e}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new Me),t.commentId=e.commentId,t}static CommentCreateDeleteHelper(e,t){const r=e.getEventWorkspace_();if(t){if(!e.json)throw Error("Encountered a comment event without proper json");ls(e.json,r)}else{if(!e.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");(t=r.getCommentById(e.commentId))?t.dispose():console.warn("Can't delete non-existent comment: "+e.commentId)}}},We=class extends Me{constructor(e,t,r){super(e),this.type=ge.COMMENT_CHANGE,e&&(this.oldContents_=typeof t>"u"?"":t,this.newContents_=typeof r>"u"?"":r)}toJson(){const e=super.toJson();if(!this.oldContents_)throw Error("The old contents is undefined. Either pass a value to the constructor, or call fromJson");if(!this.newContents_)throw Error("The new contents is undefined. Either pass a value to the constructor, or call fromJson");return e.oldContents=this.oldContents_,e.newContents=this.newContents_,e}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new We),t.oldContents_=e.oldContents,t.newContents_=e.newContents,t}isNull(){return this.oldContents_===this.newContents_}run(e){var t=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");if(t=t.getCommentById(this.commentId)){var r=e?this.newContents_:this.oldContents_;if(r===void 0)throw Error(e?"The new contents is undefined. Either pass a value to the constructor, or call fromJson":"The old contents is undefined. Either pass a value to the constructor, or call fromJson");t.setText(r)}else console.warn("Can't change non-existent comment: "+this.commentId)}};i(Ne.EVENT,ge.COMMENT_CHANGE,We);var st=class extends Me{constructor(e,t){super(e),this.newCollapsed=t,this.type=ge.COMMENT_COLLAPSE}toJson(){const e=super.toJson();if(this.newCollapsed===void 0)throw Error("The new collapse value undefined. Either call recordNew, or call fromJson");return e.newCollapsed=this.newCollapsed,e}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new st),t.newCollapsed=e.newCollapsed,t}run(e){var t=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");(t=t.getCommentById(this.commentId))?t.setCollapsed(e?!!this.newCollapsed:!this.newCollapsed):console.warn("Can't collapse or uncollapse non-existent comment: "+this.commentId)}};i(Ne.EVENT,ge.COMMENT_COLLAPSE,st);var ht=class extends Me{constructor(e){super(e),this.type=ge.COMMENT_CREATE,e&&(this.xml=Ac(e),this.json=kn(e,{addCoordinates:!0}))}toJson(){const e=super.toJson();if(!this.xml)throw Error("The comment XML is undefined. Either pass a comment to the constructor, or call fromJson");if(!this.json)throw Error("The comment JSON is undefined. Either pass a block to the constructor, or call fromJson");return e.xml=vi(this.xml),e.json=this.json,e}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new ht),t.xml=s.textToDom$$module$build$src$core$utils$xml(e.xml),t.json=e.json,t}run(e){Me.CommentCreateDeleteHelper(this,e)}};i(Ne.EVENT,ge.COMMENT_CREATE,ht);var Dt=class extends Me{constructor(e){super(e),this.type=ge.COMMENT_DELETE,e&&(this.xml=Ac(e),this.json=kn(e,{addCoordinates:!0}))}run(e){Me.CommentCreateDeleteHelper(this,!e)}toJson(){const e=super.toJson();if(!this.xml)throw Error("The comment XML is undefined. Either pass a comment to the constructor, or call fromJson");if(!this.json)throw Error("The comment JSON is undefined. Either pass a block to the constructor, or call fromJson");return e.xml=vi(this.xml),e.json=this.json,e}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new Dt),t.xml=s.textToDom$$module$build$src$core$utils$xml(e.xml),t.json=e.json,t}};i(Ne.EVENT,ge.COMMENT_DELETE,Dt);var pt=class extends Os{constructor(e,t){super(e?e.workspace.id:void 0),this.type=ge.COMMENT_DRAG,e&&(this.commentId=e.id,this.isStart=t)}toJson(){const e=super.toJson();if(this.isStart===void 0)throw Error("Whether this event is the start of a drag is undefined. Either pass the value to the constructor, or call fromJson");if(this.commentId===void 0)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");return e.isStart=this.isStart,e.commentId=this.commentId,e}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new pt),t.isStart=e.isStart,t.commentId=e.commentId,t}};i(Ne.EVENT,ge.COMMENT_DRAG,pt);var zt=class extends Me{constructor(e){super(e),this.type=ge.COMMENT_MOVE,e&&(this.comment_=e,this.oldCoordinate_=e.getRelativeToSurfaceXY())}recordNew(){if(this.newCoordinate_)throw Error("Tried to record the new position of a comment on the same event twice.");if(!this.comment_)throw Error("The comment is undefined. Pass a comment to the constructor if you want to use the record functionality");this.newCoordinate_=this.comment_.getRelativeToSurfaceXY()}setReason(e){this.reason=e}setOldCoordinate(e){this.oldCoordinate_=e}toJson(){const e=super.toJson();if(!this.oldCoordinate_)throw Error("The old comment position is undefined. Either pass a comment to the constructor, or call fromJson");if(!this.newCoordinate_)throw Error("The new comment position is undefined. Either call recordNew, or call fromJson");return e.oldCoordinate=`${Math.round(this.oldCoordinate_.x)}, ${Math.round(this.oldCoordinate_.y)}`,e.newCoordinate=Math.round(this.newCoordinate_.x)+","+Math.round(this.newCoordinate_.y),e}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new zt),r=e.oldCoordinate.split(","),t.oldCoordinate_=new Ae(Number(r[0]),Number(r[1])),r=e.newCoordinate.split(","),t.newCoordinate_=new Ae(Number(r[0]),Number(r[1])),t}isNull(){return Ae.equals(this.oldCoordinate_,this.newCoordinate_)}run(e){var t=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");if(t=t.getCommentById(this.commentId)){if(e=e?this.newCoordinate_:this.oldCoordinate_,!e)throw Error("Either oldCoordinate_ or newCoordinate_ is undefined. Either pass a comment to the constructor and call recordNew, or call fromJson");t.moveTo(e)}else console.warn("Can't move non-existent comment: "+this.commentId)}};i(Ne.EVENT,ge.COMMENT_MOVE,zt);var Gt=class extends Me{constructor(e){super(e),this.type=ge.COMMENT_RESIZE,e&&(this.oldSize=e.getSize())}recordCurrentSizeAsNewSize(){if(this.newSize)throw Error("Tried to record the new size of a comment on the same event twice.");var e=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");if(e=e.getCommentById(this.commentId),!e)throw Error("The comment associated with the comment resize event could not be found");this.newSize=e.getSize()}toJson(){const e=super.toJson();if(!this.oldSize)throw Error("The old comment size is undefined. Either pass a comment to the constructor, or call fromJson");if(!this.newSize)throw Error("The new comment size is undefined. Either call recordCurrentSizeAsNewSize, or call fromJson");return e.oldWidth=Math.round(this.oldSize.width),e.oldHeight=Math.round(this.oldSize.height),e.newWidth=Math.round(this.newSize.width),e.newHeight=Math.round(this.newSize.height),e}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new Gt),t.oldSize=new Pt(e.oldWidth,e.oldHeight),t.newSize=new Pt(e.newWidth,e.newHeight),t}isNull(){return Pt.equals(this.oldSize,this.newSize)}run(e){var t=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");if(t=t.getCommentById(this.commentId)){if(e=e?this.newSize:this.oldSize,!e)throw Error("Either oldSize or newSize is undefined. Either pass a comment to the constructor and call recordCurrentSizeAsNewSize, or call fromJson");t.setSize(e)}else console.warn("Can't resize non-existent comment: "+this.commentId)}};i(Ne.EVENT,ge.COMMENT_RESIZE,Gt);var Gs=class extends Os{constructor(e,t,r){super(r),this.type=ge.TOOLBOX_ITEM_SELECT,this.oldItem=e??void 0,this.newItem=t??void 0}toJson(){const e=super.toJson();return e.oldItem=this.oldItem,e.newItem=this.newItem,e}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new Gs),t.oldItem=e.oldItem,t.newItem=e.newItem,t}};i(Ne.EVENT,ge.TOOLBOX_ITEM_SELECT,Gs);var Ls=class extends Oa{constructor(e){super(),this.isBlank=!0,this.recordUndo=!1,this.type=ge.FINISHED_LOADING,this.isBlank=!!e,e&&(this.workspaceId=e.id)}};i(Ne.EVENT,ge.FINISHED_LOADING,Ls);var pr,Yn,Jr,Ai,Af,WS,VS,GS,qS,KS,JS,YS,XS,ZS,QS,e0,t0,n0,s0,r0,i0,o0,a0,l0,c0,Ve;s.BLOCK_CHANGE$$module$build$src$core$events$events=ge.BLOCK_CHANGE,s.BLOCK_CREATE$$module$build$src$core$events$events=ge.BLOCK_CREATE,s.BLOCK_DELETE$$module$build$src$core$events$events=ge.BLOCK_DELETE,pr=ge.BLOCK_DRAG,s.BLOCK_MOVE$$module$build$src$core$events$events=ge.BLOCK_MOVE,Yn=ge.BLOCK_FIELD_INTERMEDIATE_CHANGE,Jr=ge.BUBBLE_OPEN,Ai=ge.BLOCK_CHANGE,Af=ge.CLICK,WS=ge.COMMENT_CHANGE,VS=ge.COMMENT_CREATE,GS=ge.COMMENT_DELETE,qS=ge.COMMENT_MOVE,KS=ge.COMMENT_RESIZE,JS=ge.COMMENT_DRAG,YS=ge.BLOCK_CREATE,XS=ge.BLOCK_DELETE,ZS=ge.FINISHED_LOADING,QS=ge.MARKER_MOVE,e0=ge.BLOCK_MOVE,t0=ge.SELECTED,n0=ge.THEME_CHANGE,s0=ge.TOOLBOX_ITEM_SELECT,r0=ge.TRASHCAN_OPEN,i0=ge.UI,o0=ge.VAR_CREATE,a0=ge.VAR_DELETE,l0=ge.VAR_RENAME,c0=ge.VIEWPORT_CHANGE,Ve={},Ve.Abstract=Oa,Ve.BLOCK_CHANGE=s.BLOCK_CHANGE$$module$build$src$core$events$events,Ve.BLOCK_CREATE=s.BLOCK_CREATE$$module$build$src$core$events$events,Ve.BLOCK_DELETE=s.BLOCK_DELETE$$module$build$src$core$events$events,Ve.BLOCK_DRAG=pr,Ve.BLOCK_FIELD_INTERMEDIATE_CHANGE=Yn,Ve.BLOCK_MOVE=s.BLOCK_MOVE$$module$build$src$core$events$events,Ve.BUBBLE_OPEN=Jr,Ve.BUMP_EVENTS=_g,Ve.BlockBase=Pa,Ve.BlockChange=ro,Ve.BlockCreate=uf,Ve.BlockDelete=vf,Ve.BlockDrag=W,Ve.BlockFieldIntermediateChange=Z,Ve.BlockMove=ce,Ve.BubbleOpen=Oe,Ve.BubbleType=Re,Ve.CHANGE=Ai,Ve.CLICK=Af,Ve.COMMENT_CHANGE=WS,Ve.COMMENT_CREATE=VS,Ve.COMMENT_DELETE=GS,Ve.COMMENT_DRAG=JS,Ve.COMMENT_MOVE=qS,Ve.COMMENT_RESIZE=KS,Ve.CREATE=YS,Ve.Click=Ra,Ve.ClickTarget=Tg,Ve.CommentBase=Me,Ve.CommentChange=We,Ve.CommentCollapse=st,Ve.CommentCreate=ht,Ve.CommentDelete=Dt,Ve.CommentDrag=pt,Ve.CommentMove=zt,Ve.CommentResize=Gt,Ve.DELETE=XS,Ve.FINISHED_LOADING=ZS,Ve.FinishedLoading=Ls,Ve.MARKER_MOVE=QS,Ve.MOVE=e0,Ve.MarkerMove=yf,Ve.SELECTED=t0,Ve.Selected=Ef,Ve.THEME_CHANGE=n0,Ve.TOOLBOX_ITEM_SELECT=s0,Ve.TRASHCAN_OPEN=r0,Ve.ThemeChange=df,Ve.ToolboxItemSelect=Gs,Ve.TrashcanOpen=If,Ve.UI=i0,Ve.UiBase=Os,Ve.VAR_CREATE=o0,Ve.VAR_DELETE=a0,Ve.VAR_RENAME=l0,Ve.VIEWPORT_CHANGE=c0,Ve.VarBase=su,Ve.VarCreate=qg,Ve.VarDelete=Tf,Ve.VarRename=uh,Ve.ViewportChange=hf,Ve.clearPendingUndo=q,Ve.disable=s.disable$$module$build$src$core$events$utils,Ve.disableOrphans=Ze,Ve.enable=s.enable$$module$build$src$core$events$utils,Ve.filter=he,Ve.fire=te,Ve.fromJson=Fe,Ve.get=Ce,Ve.getDescendantIds=ee,Ve.getGroup=s.getGroup$$module$build$src$core$events$utils,Ve.getRecordUndo=Y,Ve.isEnabled=re,Ve.setGroup=s.setGroup$$module$build$src$core$events$utils,Ve.setRecordUndo=s.setRecordUndo$$module$build$src$core$events$utils;var po={};po.BottomRow=N$,po.ConstantProvider=yh,po.Drawer=_h,po.MarkerSvg=P$,po.PathObject=F$,po.RenderInfo=B$,po.Renderer=Of,po.RightConnectionShape=M$,po.StatementInput=Ch,po.TopRow=L$,Rd();var Cs={};Cs.registerCleanup=dg,Cs.registerCollapse=Td,Cs.registerCollapseExpandBlock=gg,Cs.registerComment=jc,Cs.registerCommentCreate=rr,Cs.registerCommentDelete=mg,Cs.registerCommentDuplicate=bg,Cs.registerCommentOptions=Od,Cs.registerDefaultOptions=Rd,Cs.registerDelete=xa,Cs.registerDeleteAll=Id,Cs.registerDisable=fg,Cs.registerDuplicate=pg,Cs.registerExpand=hg,Cs.registerHelp=Dd,Cs.registerInline=Rt,Cs.registerRedo=Ll,Cs.registerUndo=Sd;var V$={};V$.CommentView=eh,V$.RenderedWorkspaceComment=th,V$.WorkspaceComment=gu;var Nf={};Nf.Bubble=dn,Nf.MiniWorkspaceBubble=Ss,Nf.TextBubble=ur,Nf.TextInputBubble=p$;var u0=class extends lh{constructor(){super(),this.FIELD_TEXT_BASELINE_CENTER=!1,this.DARK_PATH_OFFSET=1,this.MAX_BOTTOM_WIDTH=30,this.STATEMENT_BOTTOM_SPACER=-this.NOTCH_HEIGHT/2}getCSS_(e){return super.getCSS_(e).concat([`${e} .blocklyInsertionMarker>.blocklyPathLight,`,`${e} .blocklyInsertionMarker>.blocklyPathDark {`,`fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,"stroke: none;","}"])}},d0=class{constructor(e){this.inlineSteps_=this.steps_="",this.info_=e,this.RTL_=this.info_.RTL,e=e.getRenderer(),this.constants_=e.getConstants(),this.highlightConstants_=e.getHighlightConstants(),this.highlightOffset=this.highlightConstants_.OFFSET,this.outsideCornerPaths_=this.highlightConstants_.OUTSIDE_CORNER,this.insideCornerPaths_=this.highlightConstants_.INSIDE_CORNER,this.puzzleTabPaths_=this.highlightConstants_.PUZZLE_TAB,this.notchPaths_=this.highlightConstants_.NOTCH,this.startPaths_=this.highlightConstants_.START_HAT,this.jaggedTeethPaths_=this.highlightConstants_.JAGGED_TEETH}getPath(){return this.steps_+`
`+this.inlineSteps_}drawTopCorner(e){this.steps_+=In(e.xPos,this.info_.startY);for(let t=0,r;r=e.elements[t];t++)X.isLeftSquareCorner(r)?this.steps_+=this.highlightConstants_.START_POINT:X.isLeftRoundedCorner(r)?this.steps_+=this.outsideCornerPaths_.topLeft(this.RTL_):X.isPreviousConnection(r)?this.steps_+=this.notchPaths_.pathLeft:X.isHat(r)?this.steps_+=this.startPaths_.path(this.RTL_):X.isSpacer(r)&&r.width!==0&&(this.steps_+=Ye("H",r.xPos+r.width-this.highlightOffset));this.steps_+=Ye("H",e.xPos+e.width-this.highlightOffset)}drawJaggedEdge_(e){this.info_.RTL&&(this.steps_+=this.jaggedTeethPaths_.pathLeft+Ye("v",e.height-this.jaggedTeethPaths_.height-this.highlightOffset))}drawValueInput(e){const t=e.getLastInput();if(this.RTL_){const r=e.height-t.connectionHeight;this.steps_+=us(t.xPos+t.width-this.highlightOffset,e.yPos)+this.puzzleTabPaths_.pathDown(this.RTL_)+Ye("v",r)}else this.steps_+=us(t.xPos+t.width,e.yPos)+this.puzzleTabPaths_.pathDown(this.RTL_)}drawStatementInput(e){const t=e.getLastInput();if(t)if(this.RTL_){const r=e.height-2*this.insideCornerPaths_.height;this.steps_+=us(t.xPos,e.yPos)+this.insideCornerPaths_.pathTop(this.RTL_)+Ye("v",r)+this.insideCornerPaths_.pathBottom(this.RTL_)+wi(e.width-t.xPos-this.insideCornerPaths_.width,0)}else this.steps_+=us(t.xPos,e.yPos+e.height)+this.insideCornerPaths_.pathBottom(this.RTL_)+wi(e.width-t.xPos-this.insideCornerPaths_.width,0)}drawRightSideRow(e){const t=e.xPos+e.width-this.highlightOffset;e instanceof bf&&e.followsStatement&&(this.steps_+=Ye("H",t)),this.RTL_&&(this.steps_+=Ye("H",t),e.height>this.highlightOffset&&(this.steps_+=Ye("V",e.yPos+e.height-this.highlightOffset)))}drawBottomRow(e){if(this.RTL_)this.steps_+=Ye("V",e.baseline-this.highlightOffset);else{const t=this.info_.bottomRow.elements[0];X.isLeftSquareCorner(t)?this.steps_+=us(e.xPos+this.highlightOffset,e.baseline-this.highlightOffset):X.isLeftRoundedCorner(t)&&(this.steps_+=us(e.xPos,e.baseline),this.steps_+=this.outsideCornerPaths_.bottomLeft())}}drawLeft(){var e=this.info_.outputConnection;e&&(e=e.connectionOffsetY+e.height,this.RTL_?this.steps_+=us(this.info_.startX,e):(this.steps_+=us(this.info_.startX+this.highlightOffset,this.info_.bottomRow.baseline-this.highlightOffset),this.steps_+=Ye("V",e)),this.steps_+=this.puzzleTabPaths_.pathUp(this.RTL_)),this.RTL_||(e=this.info_.topRow,X.isLeftRoundedCorner(e.elements[0])?this.steps_+=Ye("V",this.outsideCornerPaths_.height):this.steps_+=Ye("V",e.capline+this.highlightOffset))}drawInlineInput(e){const t=this.highlightOffset,r=e.xPos+e.connectionWidth;var l=e.centerline-e.height/2;const p=e.width-e.connectionWidth,v=l+t;this.RTL_?(l=e.connectionOffsetY-t,e=e.height-(e.connectionOffsetY+e.connectionHeight)+t,this.inlineSteps_+=us(r-t,v)+Ye("v",l)+this.puzzleTabPaths_.pathDown(this.RTL_)+Ye("v",e)+Ye("h",p)):this.inlineSteps_+=us(e.xPos+e.width+t,v)+Ye("v",e.height)+Ye("h",-p)+us(r,l+e.connectionOffsetY)+this.puzzleTabPaths_.pathDown(this.RTL_)}},h0=class extends Ql{constructor(e,t){super(e,t),this.highlighter_=new d0(t)}draw(){this.drawOutline_(),this.drawInternals_(),this.updateConnectionHighlights();const e=this.block_.pathObject;e.setPath(this.outlinePath_+`
`+this.inlinePath_),e.setHighlightPath(this.highlighter_.getPath()),this.info_.RTL&&e.flipRTL(),this.recordSizeOnBlock_()}drawTop_(){this.highlighter_.drawTopCorner(this.info_.topRow),this.highlighter_.drawRightSideRow(this.info_.topRow),super.drawTop_()}drawJaggedEdge_(e){this.highlighter_.drawJaggedEdge_(e),super.drawJaggedEdge_(e)}drawValueInput_(e){this.highlighter_.drawValueInput(e),super.drawValueInput_(e)}drawStatementInput_(e){this.highlighter_.drawStatementInput(e),super.drawStatementInput_(e)}drawRightSideRow_(e){this.highlighter_.drawRightSideRow(e),this.outlinePath_+=Ye("H",e.xPos+e.width)+Ye("V",e.yPos+e.height)}drawBottom_(){this.highlighter_.drawBottomRow(this.info_.bottomRow),super.drawBottom_()}drawLeft_(){this.highlighter_.drawLeft(),super.drawLeft_()}drawInlineInput_(e){this.highlighter_.drawInlineInput(e),super.drawInlineInput_(e)}positionInlineInputConnection_(e){const t=e.centerline-e.height/2;if(e.connectionModel){let r=e.xPos+e.connectionWidth+this.constants_.DARK_PATH_OFFSET;this.info_.RTL&&(r*=-1),e.connectionModel.setOffsetInBlock(r,t+e.connectionOffsetY+this.constants_.DARK_PATH_OFFSET)}}positionStatementInputConnection_(e){const t=e.getLastInput();if(t!=null&&t.connectionModel){let r=e.xPos+e.statementEdge+t.notchOffset;r=this.info_.RTL?-1*r:r+this.constants_.DARK_PATH_OFFSET,t.connectionModel.setOffsetInBlock(r,e.yPos+this.constants_.DARK_PATH_OFFSET)}}positionExternalValueConnection_(e){const t=e.getLastInput();if(t&&t.connectionModel){let r=e.xPos+e.width+this.constants_.DARK_PATH_OFFSET;this.info_.RTL&&(r*=-1),t.connectionModel.setOffsetInBlock(r,e.yPos)}}positionNextConnection_(){const e=this.info_.bottomRow;if(e.connection){const t=e.connection,r=t.xPos;t.connectionModel.setOffsetInBlock((this.info_.RTL?-r:r)+this.constants_.DARK_PATH_OFFSET/2,e.baseline+this.constants_.DARK_PATH_OFFSET)}}},p0=class{constructor(e){this.OFFSET=.5,this.constantProvider=e,this.START_POINT=In(this.OFFSET,this.OFFSET)}init(){this.INSIDE_CORNER=this.makeInsideCorner(),this.OUTSIDE_CORNER=this.makeOutsideCorner(),this.PUZZLE_TAB=this.makePuzzleTab(),this.NOTCH=this.makeNotch(),this.JAGGED_TEETH=this.makeJaggedTeeth(),this.START_HAT=this.makeStartHat()}makeInsideCorner(){const e=this.constantProvider.CORNER_RADIUS,t=this.OFFSET,r=(1-Math.SQRT1_2)*(e+t)-t,l=In(r,r)+qn("a","0 0,0",e,nt(-r-t,e-r)),p=qn("a","0 0,0",e+t,nt(e+t,e+t)),v=In(r,-r)+qn("a","0 0,0",e+t,nt(e-r,r+t));return{width:e+t,height:e,pathTop(O){return O?l:""},pathBottom(O){return O?p:v}}}makeOutsideCorner(){const e=this.constantProvider.CORNER_RADIUS,t=this.OFFSET,r=(1-Math.SQRT1_2)*(e-t)+t,l=In(r,r)+qn("a","0 0,1",e-t,nt(e-r,-r+t)),p=In(t,e)+qn("a","0 0,1",e-t,nt(e,-e+t)),v=-r,O=In(r,v)+qn("a","0 0,1",e-t,nt(-r+t,-v-e));return{height:e,topLeft(G){return G?l:p},bottomLeft(){return O}}}makePuzzleTab(){const e=this.constantProvider.TAB_WIDTH,t=this.constantProvider.TAB_HEIGHT,r=In(-2,-t+3.4)+wi(-.45*e,-2.1),l=Ye("v",2.5)+In(.97*-e,2.5)+sr("q",[nt(.05*-e,10),nt(.3*e,9.5)])+In(.67*e,-1.9)+Ye("v",2.5),p=Ye("v",-1.5)+In(-.92*e,-.5)+sr("q",[nt(-.19*e,-5.5),nt(0,-11)])+In(.92*e,1),v=In(-5,t-.7)+wi(.46*e,-2.1);return{width:e,height:t,pathUp(O){return O?r:p},pathDown(O){return O?l:v}}}makeNotch(){return{pathLeft:Ye("h",this.OFFSET)+this.constantProvider.NOTCH.pathLeft}}makeJaggedTeeth(){return{pathLeft:wi(5.1,2.6)+In(-10.2,6.8)+wi(5.1,2.6),height:12,width:10.2}}makeStartHat(){const e=this.constantProvider.START_HAT.height,t=In(25,-8.7)+sr("c",[nt(29.7,-6.2),nt(57.2,-.5),nt(75,8.7)]),r=sr("c",[nt(17.8,-9.2),nt(45.3,-14.9),nt(75,-8.7)])+us(100.5,e+.5);return{path(l){return l?t:r}}}},g0=class extends ff{constructor(e,t){super(e,t),this.constants_=e,this.connectedBlock&&(this.width+=this.constants_.DARK_PATH_OFFSET,this.height+=this.constants_.DARK_PATH_OFFSET)}},f0=class extends yu{constructor(e,t){super(e,t),this.constants_=e,this.connectedBlock&&(this.height+=this.constants_.DARK_PATH_OFFSET)}},m0=class extends ms{constructor(e,t){super(e,t),this.renderer_=e}getRenderer(){return this.renderer_}populateBottomRow_(){super.populateBottomRow_(),this.block_.inputList.length&&this.block_.inputList[this.block_.inputList.length-1]instanceof kr||(this.bottomRow.minHeight=this.constants_.MEDIUM_PADDING-this.constants_.DARK_PATH_OFFSET)}addInput_(e,t){this.isInline&&e instanceof s.ValueInput$$module$build$src$core$inputs$value_input?(t.elements.push(new g0(this.constants_,e)),t.hasInlineInput=!0):e instanceof kr?(t.elements.push(new f0(this.constants_,e)),t.hasStatement=!0):e instanceof s.ValueInput$$module$build$src$core$inputs$value_input?(t.elements.push(new rn(this.constants_,e)),t.hasExternalInput=!0):(e instanceof Di||e instanceof ho)&&(t.minHeight=Math.max(t.minHeight,this.constants_.DUMMY_INPUT_MIN_HEIGHT),t.hasDummyInput=!0),this.isInline||t.align!==null||(t.align=e.align)}addElemSpacing_(){let e=!1;for(let r=0,l;l=this.rows[r];r++)l.hasExternalInput&&(e=!0);for(let r=0,l;l=this.rows[r];r++){var t=l.elements;if(l.elements=[],l.startsWithElemSpacer()&&l.elements.push(new Er(this.constants_,this.getInRowSpacing_(null,t[0]))),t.length){for(let p=0;p<t.length-1;p++){l.elements.push(t[p]);const v=this.getInRowSpacing_(t[p],t[p+1]);l.elements.push(new Er(this.constants_,v))}l.elements.push(t[t.length-1]),l.endsWithElemSpacer()&&(t=this.getInRowSpacing_(t[t.length-1],null),e&&l.hasDummyInput&&(t+=this.constants_.TAB_WIDTH),l.elements.push(new Er(this.constants_,t)))}}}getInRowSpacing_(e,t){if(!e)return t&&X.isField(t)&&t.isEditable?this.constants_.MEDIUM_PADDING:t&&X.isInlineInput(t)?this.constants_.MEDIUM_LARGE_PADDING:t&&X.isStatementInput(t)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:this.constants_.LARGE_PADDING;if(!X.isInput(e)&&(!t||X.isStatementInput(t)))return X.isField(e)&&e.isEditable?this.constants_.MEDIUM_PADDING:X.isIcon(e)?2*this.constants_.LARGE_PADDING+1:X.isHat(e)?this.constants_.NO_PADDING:X.isPreviousOrNextConnection(e)?this.constants_.LARGE_PADDING:X.isLeftRoundedCorner(e)?this.constants_.MIN_BLOCK_WIDTH:X.isJaggedEdge(e)?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING;if(X.isInput(e)&&!t){if(X.isExternalInput(e))return this.constants_.NO_PADDING;if(X.isInlineInput(e))return this.constants_.LARGE_PADDING;if(X.isStatementInput(e))return this.constants_.NO_PADDING}if(!X.isInput(e)&&t&&X.isInput(t)){if(X.isField(e)&&e.isEditable){if(X.isInlineInput(t)||X.isExternalInput(t))return this.constants_.SMALL_PADDING}else{if(X.isInlineInput(t)||X.isExternalInput(t))return this.constants_.MEDIUM_LARGE_PADDING;if(X.isStatementInput(t))return this.constants_.LARGE_PADDING}return this.constants_.LARGE_PADDING-1}if(X.isIcon(e)&&t&&!X.isInput(t))return this.constants_.LARGE_PADDING;if(X.isInlineInput(e)&&t&&X.isField(t))return t.isEditable?this.constants_.MEDIUM_PADDING:this.constants_.LARGE_PADDING;if(X.isLeftSquareCorner(e)&&t){if(X.isHat(t))return this.constants_.NO_PADDING;if(X.isPreviousConnection(t))return t.notchOffset;if(X.isNextConnection(t))return t.notchOffset+(this.RTL?1:-1)*this.constants_.DARK_PATH_OFFSET/2}if(X.isLeftRoundedCorner(e)&&t){if(X.isPreviousConnection(t))return t.notchOffset-this.constants_.CORNER_RADIUS;if(X.isNextConnection(t))return t.notchOffset-this.constants_.CORNER_RADIUS+(this.RTL?1:-1)*this.constants_.DARK_PATH_OFFSET/2}return X.isField(e)&&t&&X.isField(t)&&e.isEditable===t.isEditable||t&&X.isJaggedEdge(t)?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getSpacerRowHeight_(e,t){return X.isTopRow(e)&&X.isBottomRow(t)?this.constants_.EMPTY_BLOCK_SPACER_HEIGHT:X.isTopRow(e)||X.isBottomRow(t)?this.constants_.NO_PADDING:e.hasExternalInput&&t.hasExternalInput?this.constants_.LARGE_PADDING:!e.hasStatement&&t.hasStatement?this.constants_.BETWEEN_STATEMENT_PADDING_Y:e.hasStatement&&t.hasStatement||!e.hasStatement&&t.hasDummyInput||e.hasDummyInput?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getElemCenterline_(e,t){if(X.isSpacer(t))return e.yPos+t.height/2;if(X.isBottomRow(e))return e=e.yPos+e.height-e.descenderHeight,X.isNextConnection(t)?e+t.height/2:e-t.height/2;if(X.isTopRow(e))return X.isHat(t)?e.capline-t.height/2:e.capline+t.height/2;let r=e.yPos;return X.isField(t)||X.isIcon(t)?(r+=t.height/2,(e.hasInlineInput||e.hasStatement)&&t.height+this.constants_.TALL_INPUT_FIELD_OFFSET_Y<=e.height&&(r+=this.constants_.TALL_INPUT_FIELD_OFFSET_Y)):r=X.isInlineInput(t)?r+t.height/2:r+e.height/2,r}alignRowElements_(){if(this.isInline){var e=0,t=new WeakMap,r=null;for(let l=this.rows.length-1,p;p=this.rows[l];l--)t.set(p,e),X.isInputRow(p)&&(p.hasStatement&&this.alignStatementRow_(p),r&&r.hasStatement&&p.width<r.width?t.set(p,r.width):e=p.hasStatement?p.width:Math.max(e,p.width),r=p);e=0;for(let l=0,p;p=this.rows[l];l++)p.hasStatement?e=this.getDesiredRowWidth_(p):X.isSpacer(p)?p.width=Math.max(e,t.get(p)):(r=p.width,e=Math.max(e,t.get(p))-r,0<e&&this.addAlignmentPadding_(p,e),e=p.width)}else super.alignRowElements_()}getDesiredRowWidth_(e){return this.isInline&&e.hasStatement?this.statementEdge+this.constants_.MAX_BOTTOM_WIDTH+this.startX:super.getDesiredRowWidth_(e)}finalize_(){let e=0,t=0;for(let l=0,p;p=this.rows[l];l++){p.yPos=t,p.xPos=this.startX,t+=p.height,e=Math.max(e,p.widthWithConnectedBlocks);var r=t-this.topRow.ascenderHeight;p===this.bottomRow&&r<this.constants_.MIN_BLOCK_HEIGHT&&(r=this.constants_.MIN_BLOCK_HEIGHT-r,this.bottomRow.height+=r,t+=r),this.recordElemPositions_(p)}this.outputConnection&&this.block_.nextConnection&&this.block_.nextConnection.isConnected()&&(r=this.block_.nextConnection.targetBlock())&&(e=Math.max(e,r.getHeightWidth().width-this.constants_.DARK_PATH_OFFSET)),this.bottomRow.baseline=t-this.bottomRow.descenderHeight,this.widthWithChildren=e+this.startX+this.constants_.DARK_PATH_OFFSET,this.width+=this.constants_.DARK_PATH_OFFSET,this.height=t+this.constants_.DARK_PATH_OFFSET,this.startY=this.topRow.capline}},b0=class extends ch{constructor(e,t,r){super(e,t,r),this.constants=r,this.colourDark="#000000",this.svgPathDark=ie(ae.PATH,{class:"blocklyPathDark",transform:"translate(1,1)"}),this.svgRoot.insertBefore(this.svgPathDark,this.svgPath),this.svgPathLight=ie(ae.PATH,{class:"blocklyPathLight"},this.svgRoot)}setPath(e){this.svgPath.setAttribute("d",e),this.svgPathDark.setAttribute("d",e)}setHighlightPath(e){this.svgPathLight.setAttribute("d",e)}flipRTL(){this.svgPath.setAttribute("transform","scale(-1 1)"),this.svgPathLight.setAttribute("transform","scale(-1 1)"),this.svgPathDark.setAttribute("transform","translate(1,1) scale(-1 1)")}applyColour(e){if(this.svgPathLight.style.display="",this.svgPathDark.style.display="",!this.style.colourTertiary)throw Error("The renderer did not properly initialize the tertiary colour of the block style");this.svgPathLight.setAttribute("stroke",this.style.colourTertiary),this.svgPathDark.setAttribute("fill",this.colourDark),super.applyColour(e),this.svgPath.setAttribute("stroke","none")}setStyle(e){this.style=e,this.colourDark=Je("#000",this.style.colourPrimary,.2)||this.colourDark}updateHighlighted(e){e?(this.svgPath.setAttribute("filter","url(#"+this.constants.embossFilterId+")"),this.svgPathLight.style.display="none"):(this.svgPath.setAttribute("filter","none"),this.svgPathLight.style.display="inline")}updateShadow_(e){if(e){if(this.svgPathLight.style.display="none",!this.style.colourSecondary)throw Error("The renderer did not properly initialize the secondary colour of the block style block style");this.svgPathDark.setAttribute("fill",this.style.colourSecondary),this.svgPath.setAttribute("stroke","none"),this.svgPath.setAttribute("fill",this.style.colourSecondary)}}updateDisabled_(e){super.updateDisabled_(e),e&&this.svgPath.setAttribute("stroke","none")}},$0=class extends Su{constructor(e){super(e),this.highlightConstants=null}init(e,t){super.init(e,t),this.highlightConstants=this.makeHighlightConstants_(),this.highlightConstants.init()}refreshDom(e,t){super.refreshDom(e,t),this.getHighlightConstants().init()}makeConstants_(){return new u0}makeRenderInfo_(e){return new m0(this,e)}makeDrawer_(e,t){return new h0(e,t)}makePathObject(e,t){return new b0(e,t,this.getConstants())}makeHighlightConstants_(){return new p0(this.getConstants())}getHighlightConstants(){if(!this.highlightConstants)throw Error("Cannot access the highlight constants because init has not been called");return this.highlightConstants}};Yi("geras",$0);var Zo={};Zo.ConstantProvider=u0,Zo.Drawer=h0,Zo.HighlightConstantProvider=p0,Zo.Highlighter=d0,Zo.InlineInput=g0,Zo.PathObject=b0,Zo.RenderInfo=m0,Zo.Renderer=$0,Zo.StatementInput=f0;var v0=class extends ms{constructor(e,t){super(e,t)}getRenderer(){return this.renderer_}addElemSpacing_(){let e=!1;for(var t=0;t<this.rows.length;t++)if(this.rows[t].hasExternalInput){e=!0;break}for(t=0;t<this.rows.length;t++){const l=this.rows[t];var r=l.elements;if(l.elements=[],l.startsWithElemSpacer()&&l.elements.push(new Er(this.constants_,this.getInRowSpacing_(null,r[0]))),r.length){for(let p=0;p<r.length-1;p++){l.elements.push(r[p]);const v=this.getInRowSpacing_(r[p],r[p+1]);l.elements.push(new Er(this.constants_,v))}l.elements.push(r[r.length-1]),l.endsWithElemSpacer()&&(r=this.getInRowSpacing_(r[r.length-1],null),e&&l.hasDummyInput&&(r+=this.constants_.TAB_WIDTH),l.elements.push(new Er(this.constants_,r)))}}}getInRowSpacing_(e,t){if(!e)return t&&X.isField(t)&&t.isEditable?this.constants_.MEDIUM_PADDING:t&&X.isInlineInput(t)?this.constants_.MEDIUM_LARGE_PADDING:t&&X.isStatementInput(t)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:this.constants_.LARGE_PADDING;if(!X.isInput(e)&&!t)return X.isField(e)&&e.isEditable?this.constants_.MEDIUM_PADDING:X.isIcon(e)?2*this.constants_.LARGE_PADDING+1:X.isHat(e)?this.constants_.NO_PADDING:X.isPreviousOrNextConnection(e)?this.constants_.LARGE_PADDING:X.isLeftRoundedCorner(e)?this.constants_.MIN_BLOCK_WIDTH:X.isJaggedEdge(e)?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING;if(X.isInput(e)&&!t){if(X.isExternalInput(e))return this.constants_.NO_PADDING;if(X.isInlineInput(e))return this.constants_.LARGE_PADDING;if(X.isStatementInput(e))return this.constants_.NO_PADDING}if(!X.isInput(e)&&t&&X.isInput(t)){if(X.isField(e)&&e.isEditable){if(X.isInlineInput(t)||X.isExternalInput(t))return this.constants_.SMALL_PADDING}else{if(X.isInlineInput(t)||X.isExternalInput(t))return this.constants_.MEDIUM_LARGE_PADDING;if(X.isStatementInput(t))return this.constants_.LARGE_PADDING}return this.constants_.LARGE_PADDING-1}if(X.isIcon(e)&&t&&!X.isInput(t))return this.constants_.LARGE_PADDING;if(X.isInlineInput(e)&&t&&X.isField(t))return t.isEditable?this.constants_.MEDIUM_PADDING:this.constants_.LARGE_PADDING;if(X.isLeftSquareCorner(e)&&t){if(X.isHat(t))return this.constants_.NO_PADDING;if(X.isPreviousConnection(t)||X.isNextConnection(t))return t.notchOffset}return X.isLeftRoundedCorner(e)&&t?t.notchOffset-this.constants_.CORNER_RADIUS:X.isField(e)&&t&&X.isField(t)&&e.isEditable===t.isEditable||t&&X.isJaggedEdge(t)?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getSpacerRowHeight_(e,t){return X.isTopRow(e)&&X.isBottomRow(t)?this.constants_.EMPTY_BLOCK_SPACER_HEIGHT:X.isTopRow(e)||X.isBottomRow(t)?this.constants_.NO_PADDING:e.hasExternalInput&&t.hasExternalInput?this.constants_.LARGE_PADDING:!e.hasStatement&&t.hasStatement?this.constants_.BETWEEN_STATEMENT_PADDING_Y:e.hasStatement&&t.hasStatement||e.hasDummyInput||t.hasDummyInput?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getElemCenterline_(e,t){if(X.isSpacer(t))return e.yPos+t.height/2;if(X.isBottomRow(e))return e=e.yPos+e.height-e.descenderHeight,X.isNextConnection(t)?e+t.height/2:e-t.height/2;if(X.isTopRow(e))return X.isHat(t)?e.capline-t.height/2:e.capline+t.height/2;let r=e.yPos;return r=X.isField(t)&&e.hasStatement?r+(this.constants_.TALL_INPUT_FIELD_OFFSET_Y+t.height/2):r+e.height/2}finalize_(){let e=0,t=0;for(var r=0;r<this.rows.length;r++){const p=this.rows[r];p.yPos=t,p.xPos=this.startX,t+=p.height,e=Math.max(e,p.widthWithConnectedBlocks);var l=t-this.topRow.ascenderHeight;p===this.bottomRow&&l<this.constants_.MIN_BLOCK_HEIGHT&&(l=this.constants_.MIN_BLOCK_HEIGHT-l,this.bottomRow.height+=l,t+=l),this.recordElemPositions_(p)}this.outputConnection&&this.block_.nextConnection&&this.block_.nextConnection.isConnected()&&(r=this.block_.nextConnection.targetBlock())&&(e=Math.max(e,r.getHeightWidth().width)),this.bottomRow.baseline=t-this.bottomRow.descenderHeight,this.widthWithChildren=e+this.startX,this.height=t,this.startY=this.topRow.capline}},y0=class extends Su{constructor(e){super(e)}makeRenderInfo_(e){return new v0(this,e)}};Yi("thrasos",y0);var Yy={};Yy.RenderInfo=v0,Yy.Renderer=y0;var gx={colour_blocks:{colourPrimary:"#CF63CF",colourSecondary:"#C94FC9",colourTertiary:"#BD42BD"},list_blocks:{colourPrimary:"#9966FF",colourSecondary:"#855CD6",colourTertiary:"#774DCB"},logic_blocks:{colourPrimary:"#4C97FF",colourSecondary:"#4280D7",colourTertiary:"#3373CC"},loop_blocks:{colourPrimary:"#0fBD8C",colourSecondary:"#0DA57A",colourTertiary:"#0B8E69"},math_blocks:{colourPrimary:"#59C059",colourSecondary:"#46B946",colourTertiary:"#389438"},procedure_blocks:{colourPrimary:"#FF6680",colourSecondary:"#FF4D6A",colourTertiary:"#FF3355"},text_blocks:{colourPrimary:"#FFBF00",colourSecondary:"#E6AC00",colourTertiary:"#CC9900"},variable_blocks:{colourPrimary:"#FF8C1A",colourSecondary:"#FF8000",colourTertiary:"#DB6E00"},variable_dynamic_blocks:{colourPrimary:"#FF8C1A",colourSecondary:"#FF8000",colourTertiary:"#DB6E00"},hat_blocks:{colourPrimary:"#4C97FF",colourSecondary:"#4280D7",colourTertiary:"#3373CC",hat:"cap"}},fx={colour_category:{colour:"#CF63CF"},list_category:{colour:"#9966FF"},logic_category:{colour:"#4C97FF"},loop_category:{colour:"#0fBD8C"},math_category:{colour:"#59C059"},procedure_category:{colour:"#FF6680"},text_category:{colour:"#FFBF00"},variable_category:{colour:"#FF8C1A"},variable_dynamic_category:{colour:"#FF8C1A"}},mx=new is("zelos",gx,fx),bx={Classic:ui,Zelos:mx},Xy=class{constructor(e,t,r){this.id_=e.toolboxitemid||S(),this.level_=(this.parent_=r||null)?this.parent_.getLevel()+1:0,this.toolboxItemDef_=e,this.parentToolbox_=t,this.workspace_=this.parentToolbox_.getWorkspace()}init(){}getDiv(){return null}getClickTarget(){return null}getId(){return this.id_}getParent(){return null}getLevel(){return this.level_}isSelectable(){return!1}isCollapsible(){return!1}dispose(){}setVisible_(e){}},go=class extends Xy{constructor(e,t,r){super(e,t,r),this.colour_=this.name_="",this.labelDom_=this.iconDom_=this.rowContents_=this.rowDiv_=this.htmlDiv_=null,this.isDisabled_=this.isHidden_=!1,this.flyoutItems_=[],this.cssConfig_=this.makeDefaultCssConfig_()}init(){this.parseCategoryDef_(this.toolboxItemDef_),this.parseContents_(this.toolboxItemDef_),this.createDom_(),this.toolboxItemDef_.hidden==="true"&&this.hide()}makeDefaultCssConfig_(){return{container:"blocklyToolboxCategory",row:"blocklyTreeRow",rowcontentcontainer:"blocklyTreeRowContentContainer",icon:"blocklyTreeIcon",label:"blocklyTreeLabel",contents:"blocklyToolboxContents",selected:"blocklyTreeSelected",openicon:"blocklyTreeIconOpen",closedicon:"blocklyTreeIconClosed"}}parseContents_(e){if("custom"in e)this.flyoutItems_=e.custom;else if(e=e.contents)for(let t=0;t<e.length;t++){const r=e[t];Array.isArray(this.flyoutItems_)&&this.flyoutItems_.push(r)}}parseCategoryDef_(e){this.name_="name"in e?bt(e.name):"",this.colour_=this.getColour_(e),Object.assign(this.cssConfig_,e.cssconfig||e.cssConfig)}createDom_(){this.htmlDiv_=this.createContainer_(),xs(this.htmlDiv_,zr.TREEITEM),qt(this.htmlDiv_,hs.SELECTED,!1),qt(this.htmlDiv_,hs.LEVEL,this.level_+1),this.rowDiv_=this.createRowContainer_(),this.rowDiv_.style.pointerEvents="auto",this.htmlDiv_.appendChild(this.rowDiv_),this.rowContents_=this.createRowContentsContainer_(),this.rowContents_.style.pointerEvents="none",this.rowDiv_.appendChild(this.rowContents_),this.iconDom_=this.createIconDom_(),xs(this.iconDom_,zr.PRESENTATION),this.rowContents_.appendChild(this.iconDom_),this.labelDom_=this.createLabelDom_(this.name_),this.rowContents_.appendChild(this.labelDom_);const e=this.labelDom_.getAttribute("id");return e&&qt(this.htmlDiv_,hs.LABELLEDBY,e),this.addColourBorder_(this.colour_),this.htmlDiv_}createContainer_(){const e=document.createElement("div"),t=this.cssConfig_.container;return t&&Pe(e,t),e}createRowContainer_(){const e=document.createElement("div");var t=this.cssConfig_.row;return t&&Pe(e,t),t=`${go.nestedPadding*this.getLevel()}px`,this.workspace_.RTL?e.style.paddingRight=t:e.style.paddingLeft=t,e}createRowContentsContainer_(){const e=document.createElement("div"),t=this.cssConfig_.rowcontentcontainer;return t&&Pe(e,t),e}createIconDom_(){const e=document.createElement("span");if(!this.parentToolbox_.isHorizontal()){const t=this.cssConfig_.icon;t&&Pe(e,t)}return e.style.display="inline-block",e}createLabelDom_(e){const t=document.createElement("span");return t.setAttribute("id",this.getId()+".label"),t.textContent=e,(e=this.cssConfig_.label)&&Pe(t,e),t}refreshTheme(){this.colour_=this.getColour_(this.toolboxItemDef_),this.addColourBorder_(this.colour_)}addColourBorder_(e){e&&(e=go.borderWidth+"px solid "+(e||"#ddd"),this.workspace_.RTL?this.rowDiv_.style.borderRight=e:this.rowDiv_.style.borderLeft=e)}getColour_(e){const t=e.categorystyle||e.categoryStyle;if((e=e.colour)&&t)console.warn('Toolbox category "'+this.name_+'" must not have both a style and a colour');else{if(t)return this.getColourfromStyle(t);if(e)return this.parseColour(e)}return""}getColourfromStyle(e){var t=this.workspace_.getTheme();if(e&&t){if((t=t.categoryStyles[e])&&t.colour)return this.parseColour(t.colour);console.warn('Style "'+e+'" must exist and contain a colour value')}return""}getClickTarget(){return this.rowDiv_}parseColour(e){if(e=bt(e),e==null||e==="")return"";var t=Number(e);return isNaN(t)?(t=Mr(e))?t:(console.warn('Toolbox category "'+this.name_+'" has unrecognized colour attribute: '+e),""):yt(t)}openIcon_(e){if(e){var t=this.cssConfig_.closedicon;t&&vt(e,t),(t=this.cssConfig_.openicon)&&Pe(e,t)}}closeIcon_(e){if(e){var t=this.cssConfig_.openicon;t&&vt(e,t),(t=this.cssConfig_.closedicon)&&Pe(e,t)}}setVisible_(e){this.htmlDiv_.style.display=e?"block":"none",this.isHidden_=!e,this.parentToolbox_.getSelectedItem()===this&&this.parentToolbox_.clearSelection()}hide(){this.setVisible_(!1)}show(){this.setVisible_(!0)}isVisible(){return!this.isHidden_&&this.allAncestorsExpanded_()}allAncestorsExpanded_(){let e=this;for(;e.getParent();)if(e=e.getParent(),!e.isExpanded())return!1;return!0}isSelectable(){return this.isVisible()&&!this.isDisabled_}onClick(e){}setSelected(e){if(this.rowDiv_){var t=this.cssConfig_.selected;if(e){const r=this.parseColour(go.defaultBackgroundColour);this.rowDiv_.style.backgroundColor=this.colour_||r,t&&Pe(this.rowDiv_,t)}else this.rowDiv_.style.backgroundColor="",t&&it(this.rowDiv_,t);qt(this.htmlDiv_,hs.SELECTED,e)}}setDisabled(e){this.isDisabled_=e,this.getDiv().setAttribute("disabled",`${e}`),e?this.getDiv().setAttribute("disabled","true"):this.getDiv().removeAttribute("disabled")}getName(){return this.name_}getParent(){return this.parent_}getDiv(){return this.htmlDiv_}getContents(){return this.flyoutItems_}updateFlyoutContents(e){this.flyoutItems_=[],this.toolboxItemDef_=typeof e=="string"?{kind:this.toolboxItemDef_.kind,custom:e,id:this.toolboxItemDef_.id,categorystyle:this.toolboxItemDef_.categorystyle,colour:this.toolboxItemDef_.colour,cssconfig:this.toolboxItemDef_.cssconfig,hidden:this.toolboxItemDef_.hidden}:{kind:this.toolboxItemDef_.kind,name:"name"in this.toolboxItemDef_?this.toolboxItemDef_.name:"",contents:de(e),id:this.toolboxItemDef_.id,categorystyle:this.toolboxItemDef_.categorystyle,colour:this.toolboxItemDef_.colour,cssconfig:this.toolboxItemDef_.cssconfig,hidden:this.toolboxItemDef_.hidden},this.parseContents_(this.toolboxItemDef_)}dispose(){lt(this.htmlDiv_)}};go.registrationName="category",go.nestedPadding=19,go.borderWidth=8,go.defaultBackgroundColour="#57e",we(`
.blocklyTreeRow:not(.blocklyTreeSelected):hover {
  background-color: rgba(255, 255, 255, .2);
}

.blocklyToolboxDiv[layout="h"] .blocklyToolboxCategory {
  margin: 1px 5px 1px 0;
}

.blocklyToolboxDiv[dir="RTL"][layout="h"] .blocklyToolboxCategory {
  margin: 1px 0 1px 5px;
}

.blocklyTreeRow {
  height: 22px;
  line-height: 22px;
  margin-bottom: 3px;
  padding-right: 8px;
  white-space: nowrap;
}

.blocklyToolboxDiv[dir="RTL"] .blocklyTreeRow {
  margin-left: 8px;
  padding-right: 0;
}

.blocklyTreeIcon {
  background-image: url(<<<PATH>>>/sprites.png);
  height: 16px;
  vertical-align: middle;
  visibility: hidden;
  width: 16px;
}

.blocklyTreeIconClosed {
  background-position: -32px -1px;
}

.blocklyToolboxDiv[dir="RTL"] .blocklyTreeIconClosed {
  background-position: 0 -1px;
}

.blocklyTreeSelected>.blocklyTreeIconClosed {
  background-position: -32px -17px;
}

.blocklyToolboxDiv[dir="RTL"] .blocklyTreeSelected>.blocklyTreeIconClosed {
  background-position: 0 -17px;
}

.blocklyTreeIconOpen {
  background-position: -16px -1px;
}

.blocklyTreeSelected>.blocklyTreeIconOpen {
  background-position: -16px -17px;
}

.blocklyTreeLabel {
  cursor: default;
  font: 16px sans-serif;
  padding: 0 3px;
  vertical-align: middle;
}

.blocklyToolboxDelete .blocklyTreeLabel {
  cursor: url("<<<PATH>>>/handdelete.cur"), auto;
}

.blocklyTreeSelected .blocklyTreeLabel {
  color: #fff;
}
`),i(Ne.TOOLBOX_ITEM,go.registrationName,go);var Mf=class extends Xy{constructor(e,t){super(e,t),this.cssConfig_={container:"blocklyTreeSeparator"},this.htmlDiv=null,Object.assign(this.cssConfig_,e.cssconfig||e.cssConfig)}init(){this.createDom_()}createDom_(){const e=document.createElement("div"),t=this.cssConfig_.container;return t&&Pe(e,t),this.htmlDiv=e}getDiv(){return this.htmlDiv}dispose(){lt(this.htmlDiv)}};Mf.registrationName="sep",we(`
.blocklyTreeSeparator {
  border-bottom: solid #e5e5e5 1px;
  height: 0;
  margin: 5px 0;
}

.blocklyToolboxDiv[layout="h"] .blocklyTreeSeparator {
  border-right: solid #e5e5e5 1px;
  border-bottom: none;
  height: auto;
  margin: 0 5px 0 5px;
  padding: 5px 0;
  width: 0;
}
`),i(Ne.TOOLBOX_ITEM,Mf.registrationName,Mf);var Eh=class extends go{constructor(e,t,r){super(e,t,r),this.subcategoriesDiv_=null,this.expanded_=!1,this.toolboxItems_=[]}makeDefaultCssConfig_(){const e=super.makeDefaultCssConfig_();return e.contents="blocklyToolboxContents",e}parseContents_(e){if("custom"in e)this.flyoutItems_=e.custom;else{const t=e.contents;if(t){this.flyoutItems_=[],e=!0;for(let r=0;r<t.length;r++){const l=t[r];!g(Ne.TOOLBOX_ITEM,l.kind)||l.kind.toLowerCase()===Mf.registrationName&&e?(this.flyoutItems_.push(l),e=!0):(this.createToolboxItem(l),e=!1)}}}}createToolboxItem(e){let t=e.kind;t.toUpperCase()==="CATEGORY"&&le(e)&&(t=Eh.registrationName),e=new(b(Ne.TOOLBOX_ITEM,t))(e,this.parentToolbox_,this),this.toolboxItems_.push(e)}init(){super.init(),this.setExpanded(this.toolboxItemDef_.expanded==="true"||this.toolboxItemDef_.expanded===!0)}createDom_(){super.createDom_();const e=this.getChildToolboxItems();return this.subcategoriesDiv_=this.createSubCategoriesDom_(e),xs(this.subcategoriesDiv_,zr.GROUP),this.htmlDiv_.appendChild(this.subcategoriesDiv_),this.closeIcon_(this.iconDom_),qt(this.htmlDiv_,hs.EXPANDED,!1),this.htmlDiv_}createIconDom_(){const e=document.createElement("span");if(!this.parentToolbox_.isHorizontal()){const t=this.cssConfig_.icon;t&&Pe(e,t),e.style.visibility="visible"}return e.style.display="inline-block",e}createSubCategoriesDom_(e){const t=document.createElement("div");t.style.display="none";var r=this.cssConfig_.contents;for(r&&Pe(t,r),r=0;r<e.length;r++){const l=e[r];l.init();const p=l.getDiv();if(t.appendChild(p),l.getClickTarget){let v;(v=l.getClickTarget())==null||v.setAttribute("id",l.getId())}}return t}setExpanded(e){if(this.expanded_!==e){if(this.expanded_=e)this.subcategoriesDiv_.style.display="block",this.openIcon_(this.iconDom_);else{let t;(t=this.parentToolbox_.getFlyout())==null||t.setVisible(!1),this.subcategoriesDiv_.style.display="none",this.closeIcon_(this.iconDom_)}qt(this.htmlDiv_,hs.EXPANDED,e),this.parentToolbox_.handleToolboxItemResize()}}setVisible_(e){this.htmlDiv_.style.display=e?"block":"none";const t=this.getChildToolboxItems();for(let r=0;r<t.length;r++)t[r].setVisible_(e);this.isHidden_=!e,this.parentToolbox_.getSelectedItem()===this&&this.parentToolbox_.clearSelection()}isExpanded(){return this.expanded_}isCollapsible(){return!0}onClick(e){this.toggleExpanded()}toggleExpanded(){this.setExpanded(!this.expanded_)}getDiv(){return this.htmlDiv_}getChildToolboxItems(){return this.toolboxItems_}};Eh.registrationName="collapsibleCategory",i(Ne.TOOLBOX_ITEM,Eh.registrationName,Eh);var _0=class extends ph{constructor(e){super(),this.id="toolbox",this.contentsDiv_=this.HtmlDiv=null,this.isVisible_=!1,this.contents_=[],this.height_=this.width_=0,this.previouslySelectedItem_=this.selectedItem_=this.flyout=null,this.boundEvents_=[],this.workspace_=e,this.toolboxDef_=e.options.languageTree||{contents:[]},this.horizontalLayout=e.options.horizontalLayout,this.RTL=e.options.RTL,this.contentMap_=Object.create(null),this.toolboxPosition=e.options.toolboxPosition}onShortcut(e){return!1}init(){var e=this.workspace_;const t=e.getParentSvg();this.flyout=this.createFlyout_(),this.HtmlDiv=this.createDom_(this.workspace_),yn(this.flyout.createDom("svg"),t),this.setVisible(!0),this.flyout.init(e),this.render(this.toolboxDef_),e=e.getThemeManager(),e.subscribe(this.HtmlDiv,"toolboxBackgroundColour","background-color"),e.subscribe(this.HtmlDiv,"toolboxForegroundColour","color"),this.workspace_.getComponentManager().addComponent({component:this,weight:un.ComponentWeight.TOOLBOX_WEIGHT,capabilities:[un.Capability.AUTOHIDEABLE,un.Capability.DELETE_AREA,un.Capability.DRAG_TARGET]})}createDom_(e){e=e.getParentSvg();const t=this.createContainer_();return this.contentsDiv_=this.createContentsContainer_(),this.contentsDiv_.tabIndex=0,xs(this.contentsDiv_,zr.TREE),t.appendChild(this.contentsDiv_),e.parentNode.insertBefore(t,e),this.attachEvents_(t,this.contentsDiv_),t}createContainer_(){const e=document.createElement("div");return e.setAttribute("layout",this.isHorizontal()?"h":"v"),Pe(e,"blocklyToolboxDiv"),e.setAttribute("dir",this.RTL?"RTL":"LTR"),e}createContentsContainer_(){const e=document.createElement("div");return Pe(e,"blocklyToolboxContents"),this.isHorizontal()&&(e.style.flexDirection="row"),e}attachEvents_(e,t){e=He(e,"pointerdown",this,this.onClick_,!1),this.boundEvents_.push(e),t=He(t,"keydown",this,this.onKeyDown_,!1),this.boundEvents_.push(t)}onClick_(e){if(os(e)||e.target===this.HtmlDiv)Ke().hideChaff(!1);else{var t=e.target.getAttribute("id");t&&(t=this.getToolboxItemById(t),t.isSelectable()&&(this.setSelectedItem(t),t.onClick(e))),Ke().hideChaff(!0)}Ot()}onKeyDown_(e){let t=!1;switch(e.key){case"ArrowDown":t=this.selectNext();break;case"ArrowUp":t=this.selectPrevious();break;case"ArrowLeft":t=this.selectParent();break;case"ArrowRight":t=this.selectChild();break;case"Enter":case" ":this.selectedItem_&&this.selectedItem_.isCollapsible()&&(this.selectedItem_.toggleExpanded(),t=!0);break;default:t=!1}!t&&this.selectedItem_&&this.selectedItem_.onKeyDown&&(t=this.selectedItem_.onKeyDown(e)),t&&e.preventDefault()}createFlyout_(){const e=this.workspace_,t=new Wr({parentWorkspace:e,rtl:e.RTL,oneBasedIndex:e.options.oneBasedIndex,horizontalLayout:e.horizontalLayout,renderer:e.options.renderer,rendererOverrides:e.options.rendererOverrides,move:{scrollbars:!0}});return t.toolboxPosition=e.options.toolboxPosition,new(e.horizontalLayout?w(Ne.FLYOUTS_HORIZONTAL_TOOLBOX,e.options,!0):w(Ne.FLYOUTS_VERTICAL_TOOLBOX,e.options,!0))(t)}render(e){this.toolboxDef_=e;for(let t=0;t<this.contents_.length;t++){const r=this.contents_[t];r&&r.dispose()}this.contents_=[],this.contentMap_=Object.create(null),this.renderContents_(e.contents),this.position(),this.handleToolboxItemResize()}renderContents_(e){const t=document.createDocumentFragment();for(let r=0;r<e.length;r++)this.createToolboxItem(e[r],t);this.contentsDiv_.appendChild(t)}createToolboxItem(e,t){var r=e.kind;r.toUpperCase()==="CATEGORY"&&le(e)&&(r=Eh.registrationName),(r=b(Ne.TOOLBOX_ITEM,r.toLowerCase()))&&(e=new r(e,this),e.init(),this.addToolboxItem_(e),(r=e.getDiv())&&t.appendChild(r),e.getClickTarget()&&e.getClickTarget().setAttribute("id",e.getId()))}addToolboxItem_(e){if(this.contents_.push(e),this.contentMap_[e.getId()]=e,e.isCollapsible()){e=e.getChildToolboxItems();for(let t=0;t<e.length;t++)this.addToolboxItem_(e[t])}}getToolboxItems(){return this.contents_}addStyle(e){e&&this.HtmlDiv&&Pe(this.HtmlDiv,e)}removeStyle(e){e&&this.HtmlDiv&&it(this.HtmlDiv,e)}getClientRect(){if(!this.HtmlDiv||!this.isVisible_)return null;var e=this.HtmlDiv.getBoundingClientRect();const t=e.top,r=t+e.height,l=e.left;return e=l+e.width,this.toolboxPosition===wt.TOP?new Tt(-1e7,r,-1e7,1e7):this.toolboxPosition===wt.BOTTOM?new Tt(t,1e7,-1e7,1e7):this.toolboxPosition===wt.LEFT?new Tt(-1e7,1e7,-1e7,e):new Tt(-1e7,1e7,l,1e7)}wouldDelete(e){return e instanceof qr?this.updateWouldDelete_(!e.getParent()&&e.isDeletable()):this.updateWouldDelete_(xn(e)&&e.isDeletable()),this.wouldDelete_}onDragEnter(e){this.updateCursorDeleteStyle_(!0)}onDragExit(e){this.updateCursorDeleteStyle_(!1)}onDrop(e){this.updateCursorDeleteStyle_(!1)}updateWouldDelete_(e){e!==this.wouldDelete_&&(this.updateCursorDeleteStyle_(!1),this.wouldDelete_=e,this.updateCursorDeleteStyle_(!0))}updateCursorDeleteStyle_(e){const t=this.wouldDelete_?"blocklyToolboxDelete":"blocklyToolboxGrab";e?this.addStyle(t):this.removeStyle(t)}getToolboxItemById(e){return this.contentMap_[e]||null}getWidth(){return this.width_}getHeight(){return this.height_}getFlyout(){return this.flyout}getWorkspace(){return this.workspace_}getSelectedItem(){return this.selectedItem_}getPreviouslySelectedItem(){return this.previouslySelectedItem_}isHorizontal(){return this.horizontalLayout}position(){const e=this.workspace_.getMetrics(),t=this.HtmlDiv;t&&(this.horizontalLayout?(t.style.left="0",t.style.height="auto",t.style.width="100%",this.height_=t.offsetHeight,this.width_=e.viewWidth,this.toolboxPosition===wt.TOP?t.style.top="0":t.style.bottom="0"):(this.toolboxPosition===wt.RIGHT?t.style.right="0":t.style.left="0",t.style.height="100%",this.width_=t.offsetWidth,this.height_=e.viewHeight),this.flyout.position())}handleToolboxItemResize(){const e=this.workspace_,t=this.HtmlDiv.getBoundingClientRect();e.translate(this.toolboxPosition===wt.LEFT?e.scrollX+t.width:e.scrollX,this.toolboxPosition===wt.TOP?e.scrollY+t.height:e.scrollY),tt(e)}clearSelection(){this.setSelectedItem(null)}refreshTheme(){for(let e=0;e<this.contents_.length;e++){const t=this.contents_[e];t.refreshTheme&&t.refreshTheme()}}refreshSelection(){this.selectedItem_&&this.selectedItem_.isSelectable()&&this.selectedItem_.getContents().length&&this.flyout.show(this.selectedItem_.getContents())}setVisible(e){this.isVisible_!==e&&(this.HtmlDiv.style.display=e?"block":"none",this.isVisible_=e,this.workspace_.recordDragTargets())}autoHide(e){!e&&this.flyout&&this.flyout.autoClose&&this.clearSelection()}setSelectedItem(e){const t=this.selectedItem_;!e&&!t||e&&!Ad(e)||(this.shouldDeselectItem_(t,e)&&t!==null&&this.deselectItem_(t),this.shouldSelectItem_(t,e)&&e!==null&&this.selectItem_(t,e),this.updateFlyout_(t,e),this.fireSelectEvent(t,e))}shouldDeselectItem_(e,t){return e!==null&&(!e.isCollapsible()||e!==t)}shouldSelectItem_(e,t){return t!==null&&t!==e}deselectItem_(e){this.selectedItem_=null,this.previouslySelectedItem_=e,e.setSelected(!1),qt(this.contentsDiv_,hs.ACTIVEDESCENDANT,"")}selectItem_(e,t){this.selectedItem_=t,this.previouslySelectedItem_=e,t.setSelected(!0),qt(this.contentsDiv_,hs.ACTIVEDESCENDANT,t.getId())}selectItemByPosition(e){-1<e&&e<this.contents_.length&&(e=this.contents_[e],e.isSelectable()&&this.setSelectedItem(e))}updateFlyout_(e,t){t&&(e!==t||t.isCollapsible())&&t.getContents().length?(this.flyout.show(t.getContents()),this.flyout.scrollToStart()):this.flyout.hide()}fireSelectEvent(e,t){const r=e&&e.getName();let l=t&&t.getName();e===t&&(l=null),e=new(Ce(ge.TOOLBOX_ITEM_SELECT))(r,l,this.workspace_.id),te(e)}selectParent(){return this.selectedItem_?this.selectedItem_.isCollapsible()&&this.selectedItem_.isExpanded()?(this.selectedItem_.toggleExpanded(),!0):this.selectedItem_.getParent()&&this.selectedItem_.getParent().isSelectable()?(this.setSelectedItem(this.selectedItem_.getParent()),!0):!1:!1}selectChild(){if(!this.selectedItem_||!this.selectedItem_.isCollapsible())return!1;const e=this.selectedItem_;return e.isExpanded()?this.selectNext():e.toggleExpanded(),!0}selectNext(){if(!this.selectedItem_)return!1;let e=this.contents_.indexOf(this.selectedItem_)+1;if(-1<e&&e<this.contents_.length){let t=this.contents_[e];for(;t&&!t.isSelectable();)t=this.contents_[++e];if(t&&t.isSelectable())return this.setSelectedItem(t),!0}return!1}selectPrevious(){if(!this.selectedItem_)return!1;let e=this.contents_.indexOf(this.selectedItem_)-1;if(-1<e&&e<this.contents_.length){let t=this.contents_[e];for(;t&&!t.isSelectable();)t=this.contents_[--e];if(t&&t.isSelectable())return this.setSelectedItem(t),!0}return!1}dispose(){this.workspace_.getComponentManager().removeComponent("toolbox"),this.flyout.dispose();for(var e=0;e<this.contents_.length;e++)this.contents_[e].dispose();for(e=0;e<this.boundEvents_.length;e++)St(this.boundEvents_[e]);this.boundEvents_=[],this.contents_=[],this.HtmlDiv&&(this.workspace_.getThemeManager().unsubscribe(this.HtmlDiv),lt(this.HtmlDiv))}};we(`
.blocklyToolboxDelete {
  cursor: url("<<<PATH>>>/handdelete.cur"), auto;
}

.blocklyToolboxGrab {
  cursor: url("<<<PATH>>>/handclosed.cur"), auto;
  cursor: grabbing;
  cursor: -webkit-grabbing;
}

/* Category tree in Toolbox. */
.blocklyToolboxDiv {
  background-color: #ddd;
  overflow-x: visible;
  overflow-y: auto;
  padding: 4px 0 4px 0;
  position: absolute;
  z-index: 70;  /* so blocks go under toolbox when dragging */
  -webkit-tap-highlight-color: transparent;  /* issue #1345 */
}

.blocklyToolboxContents {
  display: flex;
  flex-wrap: wrap;
  flex-direction: column;
}

.blocklyToolboxContents:focus {
  outline: none;
}
`),i(Ne.TOOLBOX,Pr,_0);var $x="11.2.0",vx=Ge.INPUT_VALUE,yx=Ge.OUTPUT_VALUE,_x=Ge.NEXT_STATEMENT,wx=Ge.PREVIOUS_STATEMENT,Sx=wt.TOP,Cx=wt.BOTTOM,Tx=wt.LEFT,Ex=wt.RIGHT;tc.prototype.newBlock=function(e,t){return new Jo(this,e,t)},Gr.prototype.newBlock=function(e,t){return new qr(this,e,t)},tc.prototype.newComment=function(e){return new gu(this,e)},Gr.prototype.newComment=function(e){return new th(this,e)},Gr.newTrashcan=function(e){return new x$(e)},Ss.prototype.newWorkspaceSvg=function(e){return new Gr(e)},s.Names$$module$build$src$core$names.prototype.populateProcedures=function(e){e=hd(e),e=e[0].concat(e[1]);for(let t=0;t<e.length;t++)this.getName(e[t][0],s.Names$$module$build$src$core$names.NameType.PROCEDURE)};var be={};return be.ASTNode=Ie,be.BasicCursor=Tu,be.Block=Jo,be.BlockSvg=qr,be.Blocks=or,be.COLLAPSED_FIELD_NAME=Kd,be.COLLAPSED_INPUT_NAME=tu,be.COLLAPSE_CHARS=Xa,be.CodeGenerator=s.CodeGenerator$$module$build$src$core$generator,be.CollapsibleToolboxCategory=Eh,be.ComponentManager=un,be.Connection=Jt,be.ConnectionChecker=w$,be.ConnectionDB=Jl,be.ConnectionType=Ge,be.ContextMenu=qa,be.ContextMenuItems=Cs,be.ContextMenuRegistry=At,be.Css=jd,be.Cursor=kf,be.DELETE_VARIABLE_ID=Cf,be.DeleteArea=ph,be.DragTarget=I$,be.DropDownDiv=As,be.Events=Ve,be.Extensions=di,be.Field=fn,be.FieldCheckbox=_,be.FieldDropdown=cr,be.FieldImage=Qa,be.FieldLabel=Ya,be.FieldLabelSerializable=m,be.FieldNumber=d,be.FieldTextInput=Sh,be.FieldVariable=u,be.Flyout=Th,be.FlyoutButton=Ir,be.FlyoutMetricsManager=H$,be.Generator=s.CodeGenerator$$module$build$src$core$generator,be.Gesture=oo,be.Grid=ao,be.HorizontalFlyout=W$,be.INPUT_VALUE=vx,be.Input=Ko,be.InsertionMarkerManager=Vr,be.InsertionMarkerPreviewer=j$,be.Marker=T$,be.MarkerManager=cu,be.Menu=Hg,be.MenuItem=qd,be.MetricsManager=Df,be.Msg=s.Msg$$module$build$src$core$msg,be.NEXT_STATEMENT=_x,be.Names=s.Names$$module$build$src$core$names,be.OPPOSITE_TYPE=Za,be.OUTPUT_VALUE=yx,be.Options=Wr,be.PREVIOUS_STATEMENT=wx,be.PROCEDURE_CATEGORY_NAME=oh,be.Procedures=Vs,be.RENAME_VARIABLE_ID=Sf,be.RenderedConnection=hr,be.Scrollbar=Un,be.ScrollbarPair=xf,be.ShortcutItems=Kr,be.ShortcutRegistry=an,be.TOOLBOX_AT_BOTTOM=Cx,be.TOOLBOX_AT_LEFT=Tx,be.TOOLBOX_AT_RIGHT=Ex,be.TOOLBOX_AT_TOP=Sx,be.TabNavigateCursor=E$,be.Theme=is,be.ThemeManager=_$,be.Themes=bx,be.Toolbox=_0,be.ToolboxCategory=go,be.ToolboxItem=Xy,be.ToolboxSeparator=Mf,be.Tooltip=Cr,be.Touch=eo,be.Trashcan=x$,be.UnattachedFieldError=Jn,be.VARIABLE_CATEGORY_NAME=Kg,be.VARIABLE_DYNAMIC_CATEGORY_NAME=wf,be.VERSION=$x,be.VariableMap=dh,be.VariableModel=ru,be.Variables=Rs,be.VariablesDynamic=ec,be.VerticalFlyout=Rf,be.WidgetDiv=Hr,be.Workspace=tc,be.WorkspaceAudio=S$,be.WorkspaceDragger=l$,be.WorkspaceSvg=Gr,be.Xml=Ns,be.ZoomControls=Fg,be.blockAnimations=mu,be.blockRendering=on,be.browserEvents=ot,be.bubbles=Nf,be.bumpObjects=hh,be.clipboard=ku,be.comments=V$,be.common=_s,be.config=s.config$$module$build$src$core$config,be.constants=Ay,be.defineBlocksWithJsonArray=Ut,be.dialog=so,be.dragging=B,be.fieldRegistry=sh,be.geras=Zo,be.getMainWorkspace=Ke,be.getSelected=Ue,be.hasBubble=ul,be.hideChaff=vg,be.icons=Go,be.inject=_b,be.inputs=Xo,be.isCopyable=Ta,be.isDeletable=xn,be.isDraggable=yi,be.isIcon=Xp,be.isObservable=dd,be.isPaster=$g,be.isRenderedElement=ir,be.isSelectable=Zi,be.isSerializable=er,be.isVariableBackedParameterModel=Wu,be.layers=Qd,be.procedures=Vs,be.registry=Ds,be.renderManagement=nu,be.serialization=Ky,be.setLocale=Gg,be.setParentContainer=rt,be.svgResize=tt,be.thrasos=Yy,be.uiPosition=wr,be.utils=Bn,be.zelos=po,be.__namespace__=s,be})})(Ik);var qM=Ik.exports;const KM=aa(qM),{ASTNode:oue,BasicCursor:aue,Block:lue,BlockSvg:cue,Blocks:uue,COLLAPSED_FIELD_NAME:due,COLLAPSED_INPUT_NAME:hue,COLLAPSE_CHARS:pue,CodeGenerator:gue,CollapsibleToolboxCategory:fue,ComponentManager:mue,Connection:bue,ConnectionChecker:$ue,ConnectionDB:vue,ConnectionType:yue,ContextMenu:_ue,ContextMenuItems:wue,ContextMenuRegistry:Sue,Css:Cue,Cursor:Tue,DELETE_VARIABLE_ID:Eue,DeleteArea:kue,DragTarget:Iue,DropDownDiv:xue,Events:Due,Extensions:Oue,Field:Rue,FieldCheckbox:Aue,FieldDropdown:Nue,FieldImage:Mue,FieldLabel:Lue,FieldLabelSerializable:Bue,FieldNumber:Pue,FieldTextInput:Fue,FieldVariable:jue,Flyout:zue,FlyoutButton:Uue,FlyoutMetricsManager:Hue,Generator:Wue,Gesture:Vue,Grid:Gue,HorizontalFlyout:que,INPUT_VALUE:Kue,Input:Jue,InsertionMarkerManager:Yue,InsertionMarkerPreviewer:Xue,Marker:Zue,MarkerManager:Que,Menu:ede,MenuItem:tde,MetricsManager:nde,Msg:sde,NEXT_STATEMENT:rde,Names:ide,OPPOSITE_TYPE:ode,OUTPUT_VALUE:ade,Options:lde,PREVIOUS_STATEMENT:cde,PROCEDURE_CATEGORY_NAME:ude,Procedures:dde,RENAME_VARIABLE_ID:hde,RenderedConnection:pde,Scrollbar:gde,ScrollbarPair:fde,ShortcutItems:mde,ShortcutRegistry:bde,TOOLBOX_AT_BOTTOM:$de,TOOLBOX_AT_LEFT:vde,TOOLBOX_AT_RIGHT:yde,TOOLBOX_AT_TOP:_de,TabNavigateCursor:wde,Theme:JM,ThemeManager:Sde,Themes:YM,Toolbox:Cde,ToolboxCategory:Tde,ToolboxItem:Ede,ToolboxSeparator:kde,Tooltip:Ide,Touch:xde,Trashcan:Dde,UnattachedFieldError:Ode,VARIABLE_CATEGORY_NAME:Rde,VARIABLE_DYNAMIC_CATEGORY_NAME:Ade,VERSION:Nde,VariableMap:Mde,VariableModel:Lde,Variables:Bde,VariablesDynamic:Pde,VerticalFlyout:Fde,WidgetDiv:jde,Workspace:zde,WorkspaceAudio:Ude,WorkspaceDragger:Hde,WorkspaceSvg:Wde,Xml:Vde,ZoomControls:Gde,blockAnimations:qde,blockRendering:Kde,browserEvents:Jde,bubbles:Yde,bumpObjects:Xde,clipboard:Zde,comments:Qde,common:ehe,config:the,constants:nhe,defineBlocksWithJsonArray:she,dialog:rhe,dragging:ihe,fieldRegistry:ohe,geras:ahe,getMainWorkspace:lhe,getSelected:che,hasBubble:uhe,hideChaff:dhe,icons:hhe,inject:phe,inputs:ghe,isCopyable:fhe,isDeletable:mhe,isDraggable:bhe,isIcon:$he,isObservable:vhe,isPaster:yhe,isRenderedElement:_he,isSelectable:whe,isSerializable:She,isVariableBackedParameterModel:Che,layers:The,procedures:Ehe,registry:khe,renderManagement:Ihe,serialization:xhe,setLocale:Dhe,setParentContainer:Ohe,svgResize:Rhe,thrasos:Ahe,uiPosition:Nhe,utils:Mhe,zelos:Lhe}=KM;/**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const PC=JM.defineTheme("dark",{base:YM.Classic,componentStyles:{workspaceBackgroundColour:"#1e1e1e",toolboxBackgroundColour:"blackBackground",toolboxForegroundColour:"#fff",flyoutBackgroundColour:"#252526",flyoutForegroundColour:"#ccc",flyoutOpacity:1,scrollbarColour:"#797979",insertionMarkerColour:"#fff",insertionMarkerOpacity:.3,scrollbarOpacity:.4,cursorColour:"#d0d0d0",blackBackground:"#333"}}),jf={textArea:{width:"100%",height:"100%",overflow:"auto"},textAreaLight:{background:"lightgray"},dialog:{height:"95%"},typography:{padding:16},overflowY:{overflowY:"hidden"}};class xk extends Le.Component{constructor(n){super(n),this.state={anchorEl:null,popper:""}}handleCancel(){this.props.onClose()}onCopy(n){I.Utils.copyToClipboard(this.props.text);const s=n.currentTarget;setTimeout(()=>{this.setState({popper:I.I18n.t("Copied"),anchorEl:s}),setTimeout(()=>this.setState({popper:"",anchorEl:null}),1e3)},50)}render(){const n=new Blob([this.props.text],{type:"application/xml"}),s=`${this.props.scriptId.substring(10)}.xml`;return f.jsxs(D.Dialog,{onClose:()=>!1,maxWidth:"lg",sx:{"& .MuiDialog-paper":jf.dialog},fullWidth:!0,open:!0,"aria-labelledby":"export-dialog-title",children:[f.jsx(D.DialogTitle,{id:"export-dialog-title",children:I.I18n.t("Export selected blocks")}),f.jsx(D.DialogContent,{style:jf.overflowY,children:f.jsx("pre",{id:"export-text",style:{...jf.textArea,...this.props.themeType==="dark"?void 0:jf.textAreaLight},children:this.props.text})}),f.jsxs(D.DialogActions,{children:[f.jsx(D.Button,{variant:"contained",color:"secondary",startIcon:f.jsx(xv,{}),children:f.jsx("a",{download:s,target:"_blank",rel:"noreferrer",href:URL.createObjectURL(n),style:{textDecoration:"inherit",color:"inherit"},children:I.I18n.t("Download as file")})}),f.jsx(D.Button,{variant:"contained",onClick:i=>this.onCopy(i),color:"secondary",startIcon:f.jsx(pE,{}),children:I.I18n.t("Copy to clipboard")}),f.jsx(D.Button,{variant:"contained",onClick:()=>this.handleCancel(),color:"primary",startIcon:f.jsx(la,{}),children:I.I18n.t("Close")}),f.jsx(D.Popper,{id:"popper",style:{zIndex:1e4},open:!!this.state.popper,placement:"top",anchorEl:this.state.anchorEl,transition:!0,children:({TransitionProps:i})=>f.jsx(D.Fade,{...i,timeout:350,children:f.jsx(D.Paper,{children:f.jsx("p",{style:jf.typography,children:this.state.popper})})})}),f.jsx("textarea",{id:"copy_input",readOnly:!0,style:{position:"absolute",left:-9999},tabIndex:-1,"aria-hidden":!0,value:this.props.text})]})]},"export-dialog")}}const Ks={textArea:{width:"calc(100% - 10px)",height:"80%",resize:"none",fontFamily:"monospace",fontSize:"1em"},dropzone:{marginTop:20,width:"100%",borderWidth:5,borderStyle:"dashed",borderColor:"#d0cccc",textAlign:"center",boxSizing:"border-box",paddingTop:45,borderRadius:10,height:"calc(100% - 10px)"},dropzoneDiv:{width:"100%",height:"20%",position:"relative"},dropzoneRejected:{borderColor:"#970000"},dropzoneAccepted:{borderColor:"#17cd02"},icon:{height:"30%",width:"30%",color:"#eeeeee",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%,-50%)",zIndex:0},iconError:{color:"#ffc3c6"},iconOk:{color:"#aaeebc"},text:{top:"50%",left:"50%",transform:"translate(-50%,-50%)",color:"#868686",position:"absolute",zIndex:1},dialog:{height:"95%"},fullHeight:{height:"100%",overflow:"hidden"}};class Sy extends Le.Component{constructor(n){super(n),this.state={text:"",imageStatus:"",error:""}}componentDidMount(){setTimeout(()=>{var n;try{(n=window.document.getElementById("import-text-area"))==null||n.focus()}catch{}},100)}static readFileDataUrl(n,s){const i=new FileReader;i.onload=()=>{s(null,{data:i.result,name:n.name})},i.onabort=()=>{console.error("file reading was aborted"),s(I.I18n.t("file reading was aborted"))},i.onerror=a=>{console.error("file reading has failed"),s(I.I18n.t("file reading has failed: %s",a))},i.readAsText(n)}handleDropFile(n){if(!(n!=null&&n.length))return;const s=n[n.length-1];s&&Sy.readFileDataUrl(s,(i,a)=>{var c;i||!a?this.setState({error:i||"No data"}):this.setState({text:((c=a.data)==null?void 0:c.toString())||""})})}handleCancel(){this.props.onClose()}handleOk(){this.props.onClose(this.state.text)}onChange(n){this.setState({text:n.target.value})}render(){const n={...Ks.dropzone,...this.state.imageStatus==="accepted"?Ks.dropzoneAccepted:this.state.imageStatus==="rejected"?Ks.dropzoneRejected:void 0};return f.jsxs(D.Dialog,{onClose:()=>!1,maxWidth:"lg",sx:{"& .MuiDialog-paper":Ks.dialog},fullWidth:!0,open:!0,"aria-labelledby":"import-dialog-title",children:[f.jsx(D.DialogTitle,{id:"import-dialog-title",children:I.I18n.t("Import blocks")}),f.jsxs(D.DialogContent,{style:Ks.fullHeight,children:[f.jsx("textarea",{autoFocus:!0,id:"import-text-area",style:Ks.textArea,onChange:s=>this.onChange(s),value:this.state.text}),f.jsx(xT,{maxSize:5e7,onDrop:(s,i)=>{var a,c,h;s.length?this.handleDropFile(s):window.alert(((h=(c=(a=i==null?void 0:i[0])==null?void 0:a.errors)==null?void 0:c[0])==null?void 0:h.message)||I.I18n.t("ra_Cannot upload"))},multiple:!1,accept:{"text/plain":[],"text/xml":[],"application/xml":[]},children:({getRootProps:s,getInputProps:i,isDragActive:a,isDragReject:c})=>c?(this.state.imageStatus!=="rejected"&&this.setState({imageStatus:"rejected"}),f.jsxs("div",{style:{...n,...Ks.dropzoneDiv},...s(),children:[f.jsx("input",{...i()}),f.jsx("span",{style:Ks.text,children:I.I18n.t("Some files will be rejected")},"text"),f.jsx(uy,{style:{...Ks.icon,...Ks.iconError}},"icon")]})):a?(this.state.imageStatus!=="accepted"&&this.setState({imageStatus:"accepted"}),f.jsxs("div",{style:{...n,...Ks.dropzoneDiv},...s(),children:[f.jsx("input",{...i()}),f.jsx("span",{style:Ks.text,children:I.I18n.t("All files will be accepted")},"text"),f.jsx(cy,{style:{...Ks.icon,...Ks.iconOk}},"icon")]})):(this.state.imageStatus!=="wait"&&this.setState({imageStatus:"wait"}),f.jsxs("div",{style:{...n,...Ks.dropzoneDiv},...s(),children:[f.jsx("input",{...i()}),f.jsx("span",{style:Ks.text,children:I.I18n.t("Drop some files here or click...")},"text"),f.jsx(HT,{style:Ks.icon},"icon")]}))})]}),f.jsxs(D.DialogActions,{children:[f.jsx(D.Button,{variant:"contained",disabled:!this.state.text,onClick:()=>this.handleOk(),color:"primary",startIcon:f.jsx(ol,{}),children:I.I18n.t("Import")}),f.jsx(D.Button,{color:"grey",variant:"contained",onClick:()=>this.handleCancel(),startIcon:f.jsx(la,{}),children:I.I18n.t("Close")})]})]})}}/**
 * @license
 * Copyright 2023 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const gt=window.Blockly;class y_ extends Error{constructor(){super("The field has not yet been attached to its input. Call appendField to attach it.")}}class Bv extends gt.Field{textGroup=null;borderRect_=null;maxLines_=1/0;isOverflowedY_=!1;constructor(n,s,i){super(n),n!==Symbol("SKIP_SETUP")&&(i&&this.configure_(i),this.SERIALIZABLE=!0,this.setValue((n==null?void 0:n.toString())||""),s&&this.setValidator(s))}configure_(n){super.configure_(n),n.maxLines&&this.setMaxLines(n.maxLines)}toXml(n){return n.textContent=this.getValue().replace(/\n/g,"&#10;"),n}fromXml(n){this.setValue(n.textContent.replace(/&#10;/g,`
`))}saveState(){const n=this.saveLegacyState(Bv);return n!==null?n:this.getValue()}loadState(n){this.loadLegacyState(gt.Field,n)||this.setValue(n)}initView(){this.createBorderRect_(),this.textGroup=gt.utils.dom.createSvgElement(gt.utils.Svg.G,{class:"blocklyEditableText"},this.fieldGroup_)}onHtmlInputKeyDownSuper_(n){n.key==="Enter"?(gt.WidgetDiv.hideIfOwner(this),gt.dropDownDiv.hideWithoutAnimation()):n.key==="Escape"?(this.setValue(this.htmlInput_.getAttribute("data-untyped-default-value"),!1),gt.WidgetDiv.hideIfOwner(this),gt.dropDownDiv.hideWithoutAnimation()):n.key==="Tab"&&(gt.WidgetDiv.hideIfOwner(this),gt.dropDownDiv.hideWithoutAnimation(),this.sourceBlock_.tab(this,!n.shiftKey),n.preventDefault())}onHtmlInputChange_(n){const s=this.value_;this.setValue(this.getValueFromEditorText_(this.htmlInput_.value),!1),this.sourceBlock_&&gt.Events.isEnabled()&&this.value_!==s&&gt.Events.fire(new(gt.Events.get("block_field_intermediate_change"))(this.sourceBlock_,this.name||null,s,this.value_))}onFinishEditing_(n){}getValueFromEditorText_(n){return n}bindInputEvents_(n){this.onKeyDownWrapper_=gt.browserEvents.conditionalBind(n,"keydown",this,this.onHtmlInputKeyDown_),this.onKeyInputWrapper_=gt.browserEvents.conditionalBind(n,"input",this,this.onHtmlInputChange_)}getDisplayText_(){const n=this.getSourceBlock();if(!n)throw new Error("The field has not yet been attached to its input. Call appendField to attach it.");let s=this.getText();if(!s)return gt.Field.NBSP;const i=s.split(`
`);s="";const a=this.isOverflowedY_?this.maxLines_:i.length;for(let c=0;c<a;c++){let h=i[c]||"";h.length>this.maxDisplayLength?h=`${h.substring(0,this.maxDisplayLength-4)}...`:this.isOverflowedY_&&c===a-1&&(h=`${h.substring(0,h.length-3)}...`),h=h.replace(/\s/g,gt.Field.NBSP),s+=h,c!==a-1&&(s+=`
`)}return n.RTL&&(s+="‏"),s}doValueUpdate_(n){super.doValueUpdate_(n),this.value_!==null&&(this.isOverflowedY_=this.value_.split(`
`).length>this.maxLines_)}render_(){const n=this.getSourceBlock();if(!n)throw new Error("The field has not yet been attached to its input. Call appendField to attach it.");let s;const i=this.textGroup;for(;s=i.firstChild;)i.removeChild(s);const a=this.getConstants();if(!a)throw Error("Constants not found");const c=this.getDisplayText_().split(`
`);let h=0;for(let g=0;g<c.length;g++){const b=a.FIELD_TEXT_HEIGHT+a.FIELD_BORDER_RECT_Y_PADDING;gt.utils.dom.createSvgElement(gt.utils.Svg.TEXT,{class:"blocklyText blocklyMultilineText",x:a.FIELD_BORDER_RECT_X_PADDING,y:h+a.FIELD_BORDER_RECT_Y_PADDING,dy:a.FIELD_TEXT_BASELINE},i).appendChild(document.createTextNode(c[g])),h+=b}if(this.isBeingEdited_){const g=this.htmlInput_;this.isOverflowedY_?gt.utils.dom.addClass(g,"blocklyHtmlTextAreaInputOverflowedY"):gt.utils.dom.removeClass(g,"blocklyHtmlTextAreaInputOverflowedY")}if(this.updateSize_(),this.isBeingEdited_){n.RTL?setTimeout(this.resizeEditor_.bind(this),0):this.resizeEditor_();const g=this.htmlInput_;this.isTextValid_?(gt.utils.dom.removeClass(g,"blocklyInvalidInput"),gt.utils.aria.setState(g,gt.utils.aria.State.INVALID,!1)):(gt.utils.dom.addClass(g,"blocklyInvalidInput"),gt.utils.aria.setState(g,gt.utils.aria.State.INVALID,!0))}}updateSize_(){const n=this.getConstants();if(!n)throw Error("Constants not found");const s=this.textGroup.childNodes,i=n.FIELD_TEXT_FONTSIZE,a=n.FIELD_TEXT_FONTWEIGHT,c=n.FIELD_TEXT_FONTFAMILY;let h=0,g=0;for(let b=0;b<s.length;b++){const $=s[b],y=gt.utils.dom.getFastTextWidth($,i,a,c);y>h&&(h=y),g+=n.FIELD_TEXT_HEIGHT+(b>0?n.FIELD_BORDER_RECT_Y_PADDING:0)}if(this.isBeingEdited_){const b=String(this.value_).split(`
`),$=gt.utils.dom.createSvgElement(gt.utils.Svg.TEXT,{class:"blocklyText blocklyMultilineText"});for(let C=0;C<b.length;C++){b[C].length>this.maxDisplayLength&&(b[C]=b[C].substring(0,this.maxDisplayLength)),$.textContent=b[C];const S=gt.utils.dom.getFastTextWidth($,i,a,c);S>h&&(h=S)}const y=this.htmlInput_,w=y.offsetWidth-y.clientWidth;h+=w}this.borderRect_&&(g+=n.FIELD_BORDER_RECT_Y_PADDING*2,h+=n.FIELD_BORDER_RECT_X_PADDING*2+1,this.borderRect_.setAttribute("width",`${h}`),this.borderRect_.setAttribute("height",`${g}`)),this.size_.width=h,this.size_.height=g,this.positionBorderRect_()}showInlineEditor_(n){const s=this.getSourceBlock();if(!s)throw new y_;gt.WidgetDiv.show(this,s.RTL,this.widgetDispose_.bind(this),this.workspace_),this.htmlInput_=this.widgetCreate_(),this.isBeingEdited_=!0,this.valueWhenEditorWasOpened_=this.value_,n||(this.htmlInput_.focus({preventScroll:!0}),this.htmlInput_.select())}getEditorText_(n){return`${n}`}getScaledBBox(){let n,s,i;const a=this.getSourceBlock();if(!a)throw new y_;if(this.isFullBlockField()){const c=this.sourceBlock_.getHeightWidth(),h=a.workspace.scale;i=this.getAbsoluteXY_(),n=(c.width+1)*h,s=(c.height+1)*h,gt.utils.userAgent.GECKO?(i.x+=1.5*h,i.y+=1.5*h):(i.x-=.5*h,i.y-=.5*h)}else{const c=this.borderRect_.getBoundingClientRect();i=gt.utils.style.getPageOffset(this.borderRect_),n=c.width,s=c.height}return new gt.utils.Rect(i.y,i.y+s,i.x,i.x+n)}resizeEditor_(){gt.renderManagement.finishQueuedRenders().then(()=>{const n=this.getSourceBlock();if(!n)throw new y_;const s=gt.WidgetDiv.getDiv(),i=this.getScaledBBox();s.style.width=`${i.right-i.left}px`,s.style.height=`${i.bottom-i.top}px`;const a=n.RTL?i.right-s.offsetWidth:i.left,c=i.top;s.style.left=`${a}px`,s.style.top=`${c}px`})}unbindInputEvents_(){this.onKeyDownWrapper_&&(gt.browserEvents.unbind(this.onKeyDownWrapper_),this.onKeyDownWrapper_=null),this.onKeyInputWrapper_&&(gt.browserEvents.unbind(this.onKeyInputWrapper_),this.onKeyInputWrapper_=null)}getClickTarget_(){return this.clickTarget_||this.getSvgRoot()}widgetDispose_(){this.isBeingEdited_=!1,this.isTextValid_=!0,this.forceRerender(),this.onFinishEditing_(this.value_),this.sourceBlock_&&gt.Events.isEnabled()&&this.valueWhenEditorWasOpened_!==null&&this.valueWhenEditorWasOpened_!==this.value_&&(gt.Events.fire(new(gt.Events.get("change"))(this.sourceBlock_,"field",this.name||null,this.valueWhenEditorWasOpened_,this.value_)),this.valueWhenEditorWasOpened_=null),gt.Events.setGroup(!1),this.unbindInputEvents_();const n=gt.WidgetDiv.getDiv().style;n.width="auto",n.height="auto",n.fontSize="",n.transition="",n.boxShadow="",this.htmlInput_=null;const s=this.getClickTarget_();if(!s)throw new Error("A click target has not been set.");gt.utils.dom.removeClass(s,"editing")}showEditor_(n,s){this.workspace_=this.sourceBlock_.workspace,!s&&this.workspace_.options.modalInputs&&(gt.utils.userAgent.MOBILE||gt.utils.userAgent.ANDROID||gt.utils.userAgent.IPAD)?this.showPromptEditor_():this.showInlineEditor_(!!s),this.forceRerender()}widgetCreate_(){const n=gt.WidgetDiv.getDiv(),s=this.workspace_.getScale(),i=this.getConstants();if(!i)throw Error("Constants not found");const a=document.createElement("textarea");a.className="blocklyHtmlInput blocklyHtmlTextAreaInput",a.setAttribute("spellcheck",String(this.spellcheck_));const c=`${i.FIELD_TEXT_FONTSIZE*s}pt`;n.style.fontSize=c,a.style.fontSize=c;const h=`${gt.FieldTextInput.BORDERRADIUS*s}px`;a.style.borderRadius=h;const g=i.FIELD_BORDER_RECT_X_PADDING*s,b=i.FIELD_BORDER_RECT_Y_PADDING*s/2;a.style.padding=`${b}px ${g}px ${b}px ${g}px`;const $=i.FIELD_TEXT_HEIGHT+i.FIELD_BORDER_RECT_Y_PADDING;return a.style.lineHeight=`${$*s}px`,n.appendChild(a),a.value=a.defaultValue=this.getEditorText_(this.value_),a.setAttribute("data-untyped-default-value",String(this.value_)),a.setAttribute("data-old-value",""),gt.utils.userAgent.GECKO?setTimeout(this.resizeEditor_.bind(this),0):this.resizeEditor_(),this.bindInputEvents_(a),a}setMaxLines(n){typeof n=="number"&&n>0&&n!==this.maxLines_&&(this.maxLines_=n,this.forceRerender())}getMaxLines(){return this.maxLines_}onHtmlInputKeyDown_(n){n.key!=="Enter"&&this.onHtmlInputKeyDownSuper_(n)}static fromJson(n){const s=gt.utils.parsing.replaceMessageReferences(n.text);return new this(s,void 0,n)}}gt.Css.register(`
.blocklyHtmlTextAreaInput {
  font-family: monospace;
  resize: none;
  overflow: hidden;
  height: 100%;
  text-align: left;
}

.blocklyHtmlTextAreaInputOverflowedY {
  overflow-y: scroll;
}
`);/**
 * @license
 * Copyright 2024 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Dk="text_multiline",XM={type:Dk,message0:"%1 %2",args0:[{type:"field_image",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAARCAYAAADpPU2iAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAdhgAAHYYBXaITgQAAABh0RVh0U29mdHdhcmUAcGFpbnQubmV0IDQuMS42/U4J6AAAAP1JREFUOE+Vks0KQUEYhjmRIja4ABtZ2dm5A3t3Ia6AUm7CylYuQRaUhZSlLZJiQbFAyRnPN33y01HOW08z8873zpwzM4F3GWOCruvGIE4/rLaV+Nq1hVGMBqzhqlxgCys4wJA65xnogMHsQ5lujnYHTejBBCK2mE4abjCgMGhNxHgDFWjDSG07kdfVa2pZMf4ZyMAdWmpZMfYOsLiDMYMjlMB+K613QISRhTnITnsYg5yUd0DETmEoMlkFOeIT/A58iyK5E18BuTBfgYXfwNJv4P9/oEBerLylOnRhygmGdPpTTBZAPkde61lbQe4moWUvYUZYLfUNftIY4zwA5X2Z9AYnQrEAAAAASUVORK5CYII=",width:12,height:17,alt:"¶"},{type:"field_multilinetext",name:"TEXT",text:""}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_TEXT_HELPURL}",tooltip:"%{BKY_TEXT_TEXT_TOOLTIP}",extensions:["parent_tooltip_when_inline"]};function ZM(o,n){const s=n.multiline_quote_(o.getFieldValue("TEXT")),i=s.indexOf("+")!==-1?JavascriptOrder.ADDITION:JavascriptOrder.ATOMIC;return[s,i]}const QM=window.Blockly.common.createBlockDefinitionsFromJsonArray([XM]);QM[Dk];/**
 * @license
 * Copyright 2023 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Ht=window.Blockly;class Cw extends Ht.Field{picker=null;highlightedIndex=null;boundEvents=[];SERIALIZABLE=!0;CURSOR="default";isDirty_=!1;colours=["#ffffff","#cccccc","#c0c0c0","#999999","#666666","#333333","#000000","#ffcccc","#ff6666","#ff0000","#cc0000","#990000","#660000","#330000","#ffcc99","#ff9966","#ff9900","#ff6600","#cc6600","#993300","#663300","#ffff99","#ffff66","#ffcc66","#ffcc33","#cc9933","#996633","#663333","#ffffcc","#ffff33","#ffff00","#ffcc00","#999900","#666600","#333300","#99ff99","#66ff99","#33ff33","#33cc00","#009900","#006600","#003300","#99ffff","#33ffff","#66cccc","#00cccc","#339999","#336666","#003333","#ccffff","#66ffff","#33ccff","#3366ff","#3333ff","#000099","#000066","#ccccff","#9999ff","#6666cc","#6633ff","#6600cc","#333399","#330099","#ffccff","#ff99ff","#cc66cc","#cc33cc","#993399","#663366","#330033"];titles=[];columns=7;constructor(n,s,i){super(n),n!==Symbol("SKIP_SETUP")&&(i&&this.configure_(i),this.setValue(n),s&&this.setValidator(s))}configure_(n){super.configure_(n),n.colourOptions&&(this.colours=n.colourOptions),n.colourTitles&&(this.titles=n.colourTitles),n.columns&&(this.columns=n.columns)}initView(){const n=this.getConstants();if(!n)throw Error("Constants not found");this.size_=new Ht.utils.Size(n.FIELD_COLOUR_DEFAULT_WIDTH,n.FIELD_COLOUR_DEFAULT_HEIGHT),this.createBorderRect_(),this.getBorderRect().style.fillOpacity="1",this.getBorderRect().setAttribute("stroke","#fff"),this.isFullBlockField()&&(this.clickTarget_=this.sourceBlock_.getSvgRoot())}isFullBlockField(){if(!this.getSourceBlock())throw new Ht.UnattachedFieldError;const s=this.getConstants();return this.blockIsSimpleReporter()&&!!(s!=null&&s.FIELD_COLOUR_FULL_BLOCK)}blockIsSimpleReporter(){const n=this.getSourceBlock();if(!n)throw new Ht.UnattachedFieldError;if(!n.outputConnection)return!1;for(const s of n.inputList)if(s.connection||s.fieldRow.length>1)return!1;return!0}applyColour(){const n=this.getSourceBlock();if(!n)throw new Ht.UnattachedFieldError;if(!this.fieldGroup_)return;const s=this.borderRect_;if(!s)throw new Error("The border rect has not been initialized");this.isFullBlockField()?(s.style.display="none",n.pathObject.svgPath.setAttribute("fill",this.getValue()),n.pathObject.svgPath.setAttribute("stroke","#fff")):(s.style.display="block",s.style.fill=this.getValue())}getSize(){var n;return(n=this.getConstants())!=null&&n.FIELD_COLOUR_FULL_BLOCK&&(this.render_(),this.isDirty_=!1),super.getSize()}render_(){super.render_();const n=this.getSourceBlock();if(!n)throw new Ht.UnattachedFieldError;n.applyColour()}updateSize_(n){const s=this.getConstants();if(!s)return;let i,a;this.isFullBlockField()?(i=(n??0)*2,a=s.FIELD_TEXT_HEIGHT):(i=s.FIELD_COLOUR_DEFAULT_WIDTH,a=s.FIELD_COLOUR_DEFAULT_HEIGHT),this.size_.height=a,this.size_.width=i,this.positionBorderRect_()}doClassValidation_(n){return typeof n!="string"?null:Ht.utils.colour.parse(n)}getText(){let n=this.value_;return/^#(.)\1(.)\2(.)\3$/.test(n)&&(n=`#${n[1]}${n[3]}${n[5]}`),n}setColours(n,s){return this.colours=n,s&&(this.titles=s),this}setColumns(n){return this.columns=n,this}showEditor_(){if(this.dropdownCreate(),!this.picker)throw Error("Picker not found");Ht.DropDownDiv.getContentDiv().appendChild(this.picker),Ht.DropDownDiv.showPositionedByField(this,this.dropdownDispose.bind(this)),this.picker.focus({preventScroll:!0})}onClick(n){const s=n.target,i=s==null?void 0:s.getAttribute("data-colour");i!==null&&(this.setValue(i),Ht.DropDownDiv.hideIfOwner(this))}onKeyDown(n){let s=!0,i;switch(n.key){case"ArrowUp":this.moveHighlightBy(0,-1);break;case"ArrowDown":this.moveHighlightBy(0,1);break;case"ArrowLeft":this.moveHighlightBy(-1,0);break;case"ArrowRight":this.moveHighlightBy(1,0);break;case"Enter":if(i=this.getHighlighted(),i){const a=i.getAttribute("data-colour");a!==null&&this.setValue(a)}Ht.DropDownDiv.hideWithoutAnimation();break;default:s=!1}s&&n.stopPropagation()}moveHighlightBy(n,s){if(!this.highlightedIndex)return;const i=this.colours,a=this.columns;let c=this.highlightedIndex%a,h=Math.floor(this.highlightedIndex/a);c+=n,h+=s,n<0?c<0&&h>0?(c=a-1,h--):c<0&&(c=0):n>0?c>a-1&&h<Math.floor(i.length/a)-1?(c=0,h++):c>a-1&&c--:s<0?h<0&&(h=0):s>0&&h>Math.floor(i.length/a)-1&&(h=Math.floor(i.length/a)-1);const g=this.picker.childNodes[h].childNodes[c],b=h*a+c;this.setHighlightedCell(g,b)}onMouseMove(n){const s=n.target,i=s&&Number(s.getAttribute("data-index"));i!==null&&i!==this.highlightedIndex&&this.setHighlightedCell(s,i)}onMouseEnter(){var n;(n=this.picker)==null||n.focus({preventScroll:!0})}onMouseLeave(){var s;(s=this.picker)==null||s.blur();const n=this.getHighlighted();n&&Ht.utils.dom.removeClass(n,"blocklyColourHighlighted")}getHighlighted(){var a;if(!this.highlightedIndex)return null;const n=this.highlightedIndex%this.columns,s=Math.floor(this.highlightedIndex/this.columns),i=(a=this.picker)==null?void 0:a.childNodes[s];return i?i.childNodes[n]:null}setHighlightedCell(n,s){const i=this.getHighlighted();i&&Ht.utils.dom.removeClass(i,"blocklyColourHighlighted"),Ht.utils.dom.addClass(n,"blocklyColourHighlighted"),this.highlightedIndex=s;const a=n.getAttribute("id");a&&this.picker&&Ht.utils.aria.setState(this.picker,Ht.utils.aria.State.ACTIVEDESCENDANT,a)}dropdownCreate(){const n=this.columns,s=this.colours,i=this.getValue(),a=document.createElement("table");a.className="blocklyColourTable",a.tabIndex=0,a.dir="ltr",Ht.utils.aria.setRole(a,Ht.utils.aria.Role.GRID),Ht.utils.aria.setState(a,Ht.utils.aria.State.EXPANDED,!0),Ht.utils.aria.setState(a,Ht.utils.aria.State.ROWCOUNT,Math.floor(s.length/n)),Ht.utils.aria.setState(a,Ht.utils.aria.State.COLCOUNT,n);let c=null;for(let h=0;h<s.length;h++){h%n===0&&(c=document.createElement("tr"),Ht.utils.aria.setRole(c,Ht.utils.aria.Role.ROW),a.appendChild(c));const g=document.createElement("td");c.appendChild(g),g.setAttribute("data-colour",s[h]),g.title=this.titles[h]||s[h],g.id=Ht.utils.idGenerator.getNextUniqueId(),g.setAttribute("data-index",`${h}`),Ht.utils.aria.setRole(g,Ht.utils.aria.Role.GRIDCELL),Ht.utils.aria.setState(g,Ht.utils.aria.State.LABEL,s[h]),Ht.utils.aria.setState(g,Ht.utils.aria.State.SELECTED,s[h]===i),g.style.backgroundColor=s[h],s[h]===i&&(g.className="blocklyColourSelected",this.highlightedIndex=h)}this.boundEvents.push(Ht.browserEvents.conditionalBind(a,"pointerdown",this,this.onClick,!0)),this.boundEvents.push(Ht.browserEvents.conditionalBind(a,"pointermove",this,this.onMouseMove,!0)),this.boundEvents.push(Ht.browserEvents.conditionalBind(a,"pointerenter",this,this.onMouseEnter,!0)),this.boundEvents.push(Ht.browserEvents.conditionalBind(a,"pointerleave",this,this.onMouseLeave,!0)),this.boundEvents.push(Ht.browserEvents.conditionalBind(a,"keydown",this,this.onKeyDown,!1)),this.picker=a}dropdownDispose(){for(const n of this.boundEvents)Ht.browserEvents.unbind(n);this.boundEvents.length=0,this.picker=null,this.highlightedIndex=null}static fromJson(n){return new this(n.colour,void 0,n)}}Cw.prototype.DEFAULT_VALUE="#ffffff";Ht.Css.register(`
.blocklyColourTable {
  border-collapse: collapse;
  display: block;
  outline: none;
  padding: 1px;
}

.blocklyColourTable>tr>td {
  border: 0.5px solid #888;
  box-sizing: border-box;
  cursor: pointer;
  display: inline-block;
  height: 20px;
  padding: 0;
  width: 20px;
}

.blocklyColourTable>tr>td.blocklyColourHighlighted {
  border-color: #eee;
  box-shadow: 2px 2px 7px 2px rgba(0, 0, 0, 0.3);
  position: relative;
}

.blocklyColourSelected, .blocklyColourSelected:hover {
  border-color: #eee !important;
  outline: 1px solid #333;
  position: relative;
}
`);/**
 * @license
 * Copyright 2024 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Ok="colour_picker",eL={type:Ok,message0:"%1",args0:[{type:"field_colour",name:"COLOUR",colour:"#ff0000"}],output:"Colour",helpUrl:"%{BKY_COLOUR_PICKER_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_PICKER_TOOLTIP}",extensions:["parent_tooltip_when_inline"]};function tL(o,n){return[n.quote_(o.getFieldValue("COLOUR")),0]}const nL=window.Blockly.common.createBlockDefinitionsFromJsonArray([eL]);nL[Ok];/**
 * @license
 * Copyright 2024 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Rk="colour_random",sL={type:Rk,message0:"%{BKY_COLOUR_RANDOM_TITLE}",output:"Colour",helpUrl:"%{BKY_COLOUR_RANDOM_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_RANDOM_TOOLTIP}"};function rL(o,n){return[`${n.provideFunction_("colourRandom",`
function ${n.FUNCTION_NAME_PLACEHOLDER_}() {
  var num = Math.floor(Math.random() * 0x1000000);
  return '#' + ('00000' + num.toString(16)).substr(-6);
}
`)}()`,2]}const iL=window.Blockly.common.createBlockDefinitionsFromJsonArray([sL]);iL[Rk];/**
 * @license
 * Copyright 2024 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Ak="colour_rgb",oL={type:Ak,message0:"%{BKY_COLOUR_RGB_TITLE} %{BKY_COLOUR_RGB_RED} %1 %{BKY_COLOUR_RGB_GREEN} %2 %{BKY_COLOUR_RGB_BLUE} %3",args0:[{type:"input_value",name:"RED",check:"Number",align:"RIGHT"},{type:"input_value",name:"GREEN",check:"Number",align:"RIGHT"},{type:"input_value",name:"BLUE",check:"Number",align:"RIGHT"}],output:"Colour",helpUrl:"%{BKY_COLOUR_RGB_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_RGB_TOOLTIP}"};function aL(o,n){const s=n.valueToCode(o,"RED",99)||0,i=n.valueToCode(o,"GREEN",99)||0,a=n.valueToCode(o,"BLUE",99)||0;return[`${n.provideFunction_("colourRgb",`
function ${n.FUNCTION_NAME_PLACEHOLDER_}(r, g, b) {
  r = Math.max(Math.min(Number(r), 100), 0) * 2.55;
  g = Math.max(Math.min(Number(g), 100), 0) * 2.55;
  b = Math.max(Math.min(Number(b), 100), 0) * 2.55;
  r = ('0' + (Math.round(r) || 0).toString(16)).slice(-2);
  g = ('0' + (Math.round(g) || 0).toString(16)).slice(-2);
  b = ('0' + (Math.round(b) || 0).toString(16)).slice(-2);
  return '#' + r + g + b;
}
`)}(${s}, ${i}, ${a})`,2]}const lL=window.Blockly.common.createBlockDefinitionsFromJsonArray([oL]);lL[Ak];/**
 * @license
 * Copyright 2024 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Nk="colour_blend",cL={type:Nk,message0:"%{BKY_COLOUR_BLEND_TITLE} %{BKY_COLOUR_BLEND_COLOUR1} %1 %{BKY_COLOUR_BLEND_COLOUR2} %2 %{BKY_COLOUR_BLEND_RATIO} %3",args0:[{type:"input_value",name:"COLOUR1",check:"Colour",align:"RIGHT"},{type:"input_value",name:"COLOUR2",check:"Colour",align:"RIGHT"},{type:"input_value",name:"RATIO",check:"Number",align:"RIGHT"}],output:"Colour",helpUrl:"%{BKY_COLOUR_BLEND_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_BLEND_TOOLTIP}"};function uL(o,n){const s=n.valueToCode(o,"COLOUR1",99)||"'#000000'",i=n.valueToCode(o,"COLOUR2",99)||"'#000000'",a=n.valueToCode(o,"RATIO",99)||.5;return[`${n.provideFunction_("colourBlend",`
function ${n.FUNCTION_NAME_PLACEHOLDER_}(c1, c2, ratio) {
  ratio = Math.max(Math.min(Number(ratio), 1), 0);
  var r1 = parseInt(c1.substring(1, 3), 16);
  var g1 = parseInt(c1.substring(3, 5), 16);
  var b1 = parseInt(c1.substring(5, 7), 16);
  var r2 = parseInt(c2.substring(1, 3), 16);
  var g2 = parseInt(c2.substring(3, 5), 16);
  var b2 = parseInt(c2.substring(5, 7), 16);
  var r = Math.round(r1 * (1 - ratio) + r2 * ratio);
  var g = Math.round(g1 * (1 - ratio) + g2 * ratio);
  var b = Math.round(b1 * (1 - ratio) + b2 * ratio);
  r = ('0' + (r || 0).toString(16)).slice(-2);
  g = ('0' + (g || 0).toString(16)).slice(-2);
  b = ('0' + (b || 0).toString(16)).slice(-2);
  return '#' + r + g + b;
}
`)}(${s}, ${i}, ${a})`,2]}const dL=window.Blockly.common.createBlockDefinitionsFromJsonArray([cL]);dL[Nk];function hL(){window.Blockly.FieldMultilineInput||(window.Blockly.fieldRegistry.register("field_multilinetext",Bv),window.Blockly.JavaScript.forBlock.text_multiline=ZM,window.Blockly.FieldMultilineInput=Bv,Object.assign(window.Blockly.Blocks,window.Blockly.common.createBlockDefinitionsFromJsonArray([{type:"text_multiline",message0:"%1 %2",args0:[{type:"field_image",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAARCAYAAADpPU2iAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAdhgAAHYYBXaITgQAAABh0RVh0U29mdHdhcmUAcGFpbnQubmV0IDQuMS42/U4J6AAAAP1JREFUOE+Vks0KQUEYhjmRIja4ABtZ2dm5A3t3Ia6AUm7CylYuQRaUhZSlLZJiQbFAyRnPN33y01HOW08z8873zpwzM4F3GWOCruvGIE4/rLaV+Nq1hVGMBqzhqlxgCys4wJA65xnogMHsQ5lujnYHTejBBCK2mE4abjCgMGhNxHgDFWjDSG07kdfVa2pZMf4ZyMAdWmpZMfYOsLiDMYMjlMB+K613QISRhTnITnsYg5yUd0DETmEoMlkFOeIT/A58iyK5E18BuTBfgYXfwNJv4P9/oEBerLylOnRhygmGdPpTTBZAPkde61lbQe4moWUvYUZYLfUNftIY4zwA5X2Z9AYnQrEAAAAASUVORK5CYII=",width:12,height:17,alt:"¶"},{type:"field_multilinetext",name:"TEXT",text:""}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_TEXT_HELPURL}",tooltip:"%{BKY_TEXT_TEXT_TOOLTIP}",extensions:["parent_tooltip_when_inline"]}]))),window.Blockly.FieldColour||(window.Blockly.fieldRegistry.register("field_colour",Cw),window.Blockly.JavaScript.forBlock.colour_picker=tL,window.Blockly.JavaScript.forBlock.colour_blend=uL,window.Blockly.JavaScript.forBlock.colour_random=rL,window.Blockly.JavaScript.forBlock.colour_rgb=aL,window.Blockly.FieldColour=Cw,Object.assign(window.Blockly.Blocks,window.Blockly.common.createBlockDefinitionsFromJsonArray([{type:"colour_picker",message0:"%1",args0:[{type:"field_colour",name:"COLOUR",colour:"#ff0000"}],output:"Colour",helpUrl:"%{BKY_COLOUR_PICKER_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_PICKER_TOOLTIP}",extensions:["parent_tooltip_when_inline"]}])),Object.assign(window.Blockly.Blocks,window.Blockly.common.createBlockDefinitionsFromJsonArray([{type:"colour_random",message0:"%{BKY_COLOUR_RANDOM_TITLE}",output:"Colour",helpUrl:"%{BKY_COLOUR_RANDOM_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_RANDOM_TOOLTIP}"}])),Object.assign(window.Blockly.Blocks,window.Blockly.common.createBlockDefinitionsFromJsonArray([{type:"colour_rgb",message0:"%{BKY_COLOUR_RGB_TITLE} %{BKY_COLOUR_RGB_RED} %1 %{BKY_COLOUR_RGB_GREEN} %2 %{BKY_COLOUR_RGB_BLUE} %3",args0:[{type:"input_value",name:"RED",check:"Number",align:"RIGHT"},{type:"input_value",name:"GREEN",check:"Number",align:"RIGHT"},{type:"input_value",name:"BLUE",check:"Number",align:"RIGHT"}],output:"Colour",helpUrl:"%{BKY_COLOUR_RGB_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_RGB_TOOLTIP}"}])),Object.assign(window.Blockly.Blocks,window.Blockly.common.createBlockDefinitionsFromJsonArray([{type:"colour_blend",message0:"%{BKY_COLOUR_BLEND_TITLE} %{BKY_COLOUR_BLEND_COLOUR1} %1 %{BKY_COLOUR_BLEND_COLOUR2} %2 %{BKY_COLOUR_BLEND_RATIO} %3",args0:[{type:"input_value",name:"COLOUR1",check:"Colour",align:"RIGHT"},{type:"input_value",name:"COLOUR2",check:"Colour",align:"RIGHT"},{type:"input_value",name:"RATIO",check:"Number",align:"RIGHT"}],output:"Colour",helpUrl:"%{BKY_COLOUR_BLEND_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_BLEND_TOOLTIP}"}])))}let X$=!1,Z$=!1,__=null,w_=null;const FC=[];function Mk(o,n,s,i){var a;if(i=i||[],(o.tagName==="BLOCK"||o.tagName==="block")&&(s=o.id),o.tagName==="FIELD"||o.tagName==="field")for(let c=0;c<o.attributes.length;c++){const h=(o.attributes[c].value||"").toLowerCase();o.attributes[c].nodeName==="name"&&(h==="oid"||h==="text"||h==="var")&&s&&(a=o.innerHTML)!=null&&a.toLowerCase().includes(n)&&i.push(s)}return o.childNodes.forEach(c=>Mk(c,n,s,i)),i}class hn extends Le.Component{blockly=null;blocklyWorkspace=null;originalCode;someSelected=null;changeTimer=null;someSelectedTime=0;ignoreChanges=!1;blinkBlock;onResizeBind;didUpdate=null;lastCommand="";lastSearch;static Blockly=window.Blockly;constructor(n){super(n),this.state={languageOwnLoaded:Z$,languageBlocklyLoaded:X$,changed:!1,message:"",error:"",themeType:this.props.themeType,exportText:"",importText:!1,searchText:this.props.searchText||"",showInputPrompt:null},this.originalCode=n.code||"",this.someSelected=null,this.onResizeBind=this.onResize.bind(this),this.lastSearch=this.props.searchText||"",this.blinkBlock=null,hL(),hn.Blockly.dialog.setPrompt(this.onShowNameDialog),this.loadLanguages()}onShowNameDialog=(n,s,i)=>{this.setState({showInputPrompt:{promptText:n,defaultText:s,callback:i,value:s}})};static loadJS(n,s,i){const a=document.createElement("script");try{a.src=n,a.onload=s,a.onerror=s,(i||window.document.body).appendChild(a)}catch(c){console.error(`Cannot load ${n}: ${c}`),s&&s()}}static loadScripts(n,s){if(!(n!=null&&n.length)){s&&s();return}const i=n.pop();i&&!FC.includes(i)?(FC.push(i),hn.loadJS(`../../adapter/${i}/blockly.js`,()=>setTimeout(()=>hn.loadScripts(n,s),0))):setTimeout(()=>hn.loadScripts(n,s),0)}static loadCustomBlockly(n,s){var a;const i=[];for(const c in n)!Object.prototype.hasOwnProperty.call(n,c)||!n[c]||!c.match(/^system\.adapter\./)||n[c].type!=="adapter"||(a=n[c].common)!=null&&a.blockly&&(console.log(`Detected custom blockly: ${n[c].common.name}`),i.push(n[c].common.name));hn.loadScripts(i,s)}static loadXMLDoc(n){let s;return window.DOMParser?s=i=>new window.DOMParser().parseFromString(i,"text/xml"):typeof window.ActiveXObject<"u"&&new window.ActiveXObject("Microsoft.XMLDOM")?s=i=>{const a=new window.ActiveXObject("Microsoft.XMLDOM");return a.async="false",a.loadXML(i),a}:s=()=>null,s(n)}searchBlocks(n){if(this.blocklyWorkspace){const s=hn.Blockly.Xml.workspaceToDom(this.blocklyWorkspace),i=Mk(s,n.toLowerCase());return console.log(`Search "${n}" found blocks: ${i.length?JSON.stringify(i):"none"}`),i}return[]}searchId(){const n=this.lastSearch?this.searchBlocks(this.lastSearch):null;n!=null&&n.length?(this.someSelected=n,this.someSelected.forEach(s=>{var i;return(i=this.blocklyWorkspace)==null?void 0:i.highlightBlock(s,!0)}),this.someSelectedTime=Date.now()):this.someSelected&&(this.someSelected.forEach(s=>{var i;return(i=this.blocklyWorkspace)==null?void 0:i.highlightBlock(s,!1)}),this.someSelected=null)}UNSAFE_componentWillReceiveProps(n){n.command&&this.lastCommand!==n.command&&(this.lastCommand=n.command,setTimeout(()=>this.lastCommand="",300),this.lastCommand==="check"?this.blocklyCheckBlocks((s,i)=>{s?(i&&hn.blocklyBlinkBlock(i),this.setState({error:{text:I.I18n.t(s),title:I.I18n.t("Error was found")}}),this.blinkBlock=i):this.setState({message:I.I18n.t("Ok")})}):this.lastCommand==="export"?this.exportBlocks():this.lastCommand==="import"&&this.importBlocks()),n.searchText!==this.lastSearch&&(this.lastSearch=n.searchText,this.searchId()),this.state.themeType!==n.themeType&&this.setState({themeType:n.themeType},()=>this.updateBackground()),this.originalCode!==n.code&&(this.originalCode=n.code||"",this.loadCode(),this.searchId())}loadLanguages(){if(!X$){const n=window.document.createElement("script");n.setAttribute("type","text/javascript"),n.setAttribute("src",`google-blockly/msg/js/${I.I18n.getLanguage()}.js`),n.onload=()=>{X$=!0,this.setState({languageBlocklyLoaded:X$})},window.document.getElementsByTagName("head")[0].appendChild(n)}if(!Z$){const n=window.document.createElement("script");n.setAttribute("type","text/javascript"),n.setAttribute("src",`google-blockly/own/msg/${I.I18n.getLanguage()}.js`),n.onload=()=>{Z$=!0,this.setState({languageOwnLoaded:Z$})},window.document.getElementsByTagName("head")[0].appendChild(n)}}onResize(){this.blocklyWorkspace&&hn.Blockly.svgResize(this.blocklyWorkspace)}static jsCode2Blockly(n){n=n||"";const s=n.split(/[\r\n]+|\r|\n/g);let i="";for(let c=s.length-1;c>=0;c--)if(s[c].substring(0,2)==="//"){i=s[c].substring(2);break}if(i.substring(0,4)==="<xml")return i;let a;try{a=window.decodeURIComponent(window.atob(i))}catch(c){a=null,console.error(`cannot decode: ${i}`),console.error(c)}return a}static blocklyBlinkBlock(n){for(let s=300;s<3e3;s+=300)setTimeout(()=>n.select(),s),setTimeout(()=>n.unselect(),s+150)}blocklyRemoveOrphanedShadows(){if(this.blocklyWorkspace){const n=this.blocklyWorkspace.getAllBlocks();let s;for(let i=0;s=n[i];i++)if(s.isShadow()){const a=s.getConnections_(!0);let c;for(let h=0;c=a[h];h++)if(!c.targetConnection){s.dispose();break}}}}blocklyCheckBlocks(n){let s;if(!this.blocklyWorkspace||this.blocklyWorkspace.getAllBlocks().length===0)return n&&n("no blocks found"),!1;let i=this.blocklyGetUnconnectedBlock();return i?s="not properly connected":(i=this.blocklyGetBlockWithWarning(),i&&(s="warning on this block")),i?(n?n(s,i):hn.blocklyBlinkBlock(i),!1):(n(),!0)}blocklyGetUnconnectedBlock(){var i;const n=(i=this.blocklyWorkspace)==null?void 0:i.getAllBlocks();let s;if(n)for(let a=0;s=n[a];a++){const c=s.getConnections_(!0);let h;for(let g=0;h=c[g];g++)if(!h.sourceBlock_||(h.type===hn.Blockly.INPUT_VALUE||h.type===hn.Blockly.OUTPUT_VALUE)&&!h.targetConnection&&!h._optional)return s}return null}blocklyGetBlockWithWarning(){var i;const n=(i=this.blocklyWorkspace)==null?void 0:i.getAllBlocks();let s;if(n){for(let a=0;s=n[a];a++)if(s.warning)return s}return null}blocklyCode2JSCode(n){if(!this.blocklyWorkspace)return"";let s=hn.Blockly.JavaScript.workspaceToCode(this.blocklyWorkspace);if(!n){s+=`
`;const i=hn.Blockly.Xml.workspaceToDom(this.blocklyWorkspace),a=hn.Blockly.Xml.domToText(i);s+=`//${btoa(encodeURIComponent(a))}`}return s}exportBlocks(){if(!this.blocklyWorkspace)return;let n;const s=hn.Blockly.getSelected();if(s){const i=hn.Blockly.Xml.blockToDom(s),a=s.getRelativeToSurfaceXY();i.setAttribute("x",(s.RTL?-a.x:a.x).toString()),i.setAttribute("y",a.y.toString()),n=hn.Blockly.Xml.domToPrettyText(i)}else{const i=hn.Blockly.Xml.workspaceToDom(this.blocklyWorkspace);n=hn.Blockly.Xml.domToPrettyText(i)}this.setState({exportText:n})}importBlocks(){this.setState({importText:!0})}onImportBlocks(n){if(this.blocklyWorkspace&&(n=(n||"").trim(),n))try{n.startsWith("<xml")||(n=`<xml xmlns="https://developers.google.com/blockly/xml">${n}</xml>`),n=n.replace(/[\n\r]/g,"").replace(/<variables>.*<\/variables>/g,""),window.scripts.loading=!0;const s=hn.Blockly.utils.xml.textToDom(n);if(s.nodeName==="xml")for(let i=0;i<s.children.length;i++)this.blocklyWorkspace.paste(s.children[i]);else this.blocklyWorkspace.paste(s);window.scripts.loading=!1,this.onBlocklyChanged()}catch(s){this.setState({error:{text:s.toString(),title:I.I18n.t("Import error")}})}}loadCode(){if(this.blocklyWorkspace){this.ignoreChanges=!0,this.blocklyWorkspace.clear();try{const n=hn.jsCode2Blockly(this.originalCode)||'<xml xmlns="https://developers.google.com/blockly/xml"></xml>';window.scripts.loading=!0;const s=hn.Blockly.utils.xml.textToDom(n);hn.Blockly.Xml.domToWorkspace(s,this.blocklyWorkspace),window.scripts.loading=!1}catch(n){console.error(n),setTimeout(()=>this.setState({error:I.I18n.t("Cannot extract Blockly code!")}))}setTimeout(()=>this.ignoreChanges=!1,100)}}onBlocklyChanged(){this.blocklyRemoveOrphanedShadows(),this.setState({changed:!0}),this.onChange()}async componentDidUpdate(){if(!this.blockly||(this.didUpdate&&(clearTimeout(this.didUpdate),this.didUpdate=null),this.blocklyWorkspace))return;window.addEventListener("resize",this.onResizeBind,!1),__=__||await this.getToolbox(),w_=w_||hn.Blockly.utils.xml.textToDom(__),this.blocklyWorkspace=hn.Blockly.inject(this.blockly,{renderer:"thrasos",theme:this.state.themeType==="dark"?PC:"classic",media:"google-blockly/media/",toolbox:w_,zoom:{controls:!0,wheel:!1,startScale:1,maxScale:3,minScale:.3,scaleSpeed:1.2,pinch:!0},move:{scrollbars:{horizontal:!0,vertical:!0},drag:!0,wheel:!0},trashcan:!0,grid:{spacing:25,length:1,snap:!0},sounds:!1}),window.scripts={blocklyWorkspace:this.blocklyWorkspace},this.blocklyWorkspace.registerToolboxCategoryCallback("PROCEDURE",window.Blockly.Procedures.flyoutCategoryNew),this.blocklyWorkspace.addChangeListener(s=>{var i;if(this.someSelected&&Date.now()-this.someSelectedTime>500){const a=(i=this.blocklyWorkspace)==null?void 0:i.getAllBlocks();this.someSelected=null,a==null||a.forEach(c=>c.removeSelect())}[hn.Blockly.Events.UI,hn.Blockly.Events.CREATE,hn.Blockly.Events.VIEWPORT_CHANGE].includes(s.type)||this.ignoreChanges||(this.changeTimer&&clearTimeout(this.changeTimer),this.changeTimer=setTimeout(()=>{this.changeTimer=null,this.onBlocklyChanged()},200))}),this.loadCode(),this.onResize();const n=document.getElementsByClassName("blocklyToolboxDiv")[0];this.blockly.appendChild(n),this.updateBackground(),setTimeout(()=>this.searchId(),200)}updateBackground(){var n;this.state.themeType==="dark"?(n=this.blocklyWorkspace)==null||n.setTheme(PC):this.blocklyWorkspace&&(this.blocklyWorkspace.getThemeManager(),this.blocklyWorkspace.setTheme(hn.Blockly.Themes.Classic))}componentWillUnmount(){this.blocklyWorkspace&&(this.blocklyWorkspace.dispose(),this.blocklyWorkspace=null,this.changeTimer&&clearTimeout(this.changeTimer),this.changeTimer=null,window.removeEventListener("resize",this.onResizeBind))}onChange(){this.originalCode=this.blocklyCode2JSCode(),this.props.onChange&&this.props.onChange(this.originalCode)}async getToolbox(n){const s=window.document.getElementById("toolbox");let i=s==null?void 0:s.outerHTML;if(!i)return n?(console.error("Cannot load blocks!"),""):new Promise(a=>{setTimeout(()=>a(this.getToolbox(!0)),500)});if(i=i.replace(/{(\w+)}/g,(a,c)=>window.MSG[c]),window.Blockly.CustomBlocks){let a="";const c=I.I18n.getLanguage();for(let h=0;h<window.Blockly.CustomBlocks.length;h++){const g=window.Blockly.CustomBlocks[h],b=window.Blockly[g];a+=`<category name="${window.Blockly.Words[g][c]}" colour="${b.HUE}">`;for(const $ in b.blocks)Object.prototype.hasOwnProperty.call(b.blocks,$)&&(a+=b.blocks[$]);a+="</category>"}i=i.replace("<category><block>%%CUSTOM_BLOCKS%%</block></category>",a)}return i}renderMessageDialog(){return this.state.message?f.jsx(I.Message,{text:typeof this.state.message=="object"?this.state.message.text:this.state.message,title:typeof this.state.message=="object"?this.state.message.title:"",onClose:()=>this.setState({message:""})},"dialogMessage"):null}renderErrorDialog(){return this.state.error?f.jsx(Sm,{text:typeof this.state.error=="object"?this.state.error.text.toString():this.state.error,title:typeof this.state.error=="object"?this.state.error.title:"",onClose:()=>{this.blinkBlock&&(hn.blocklyBlinkBlock(this.blinkBlock),this.blinkBlock=null),this.setState({error:""})}},"dialogError"):null}renderExportDialog(){return this.state.exportText?f.jsx(xk,{themeType:this.state.themeType,onClose:()=>this.setState({exportText:""}),text:this.state.exportText,scriptId:this.props.scriptId},"dialogExport"):null}renderImportDialog(){return this.state.importText?f.jsx(Sy,{onClose:n=>{this.setState({importText:!1}),this.onImportBlocks(n)}},"dialogImport"):null}renderDialogPrompt(){return this.state.showInputPrompt?f.jsxs(D.Dialog,{onClose:()=>{var s;const n=(s=this.state.showInputPrompt)==null?void 0:s.callback;n&&n(null),this.setState({showInputPrompt:null})},maxWidth:"sm",fullWidth:!0,open:!0,children:[f.jsx(D.DialogTitle,{children:this.state.showInputPrompt.promptText}),f.jsx(D.DialogContent,{children:f.jsx(D.TextField,{variant:"standard",fullWidth:!0,value:this.state.showInputPrompt.value,onKeyUp:n=>{var s,i;if(n.key==="Enter"){const a=(s=this.state.showInputPrompt)==null?void 0:s.callback,c=(i=this.state.showInputPrompt)==null?void 0:i.value;a&&a(c===void 0?null:c),this.setState({showInputPrompt:null})}},onChange:n=>{var i,a;const s={...this.state.showInputPrompt};(i=this.state.showInputPrompt)!=null&&i.callback&&(s.callback=(a=this.state.showInputPrompt)==null?void 0:a.callback),s.value=n.target.value,this.setState({showInputPrompt:s})}})}),f.jsxs(D.DialogActions,{children:[f.jsx(D.Button,{variant:"contained",disabled:!this.state.showInputPrompt.value,onClick:()=>{var i,a;const n=(i=this.state.showInputPrompt)==null?void 0:i.callback,s=(a=this.state.showInputPrompt)==null?void 0:a.value;n&&n(s===void 0?null:s),this.setState({showInputPrompt:null})},color:"primary",startIcon:f.jsx(ol,{}),children:I.I18n.t("Apply")}),f.jsx(D.Button,{color:"grey",variant:"contained",onClick:()=>{var s;const n=(s=this.state.showInputPrompt)==null?void 0:s.callback;n&&n(null),this.setState({showInputPrompt:null})},startIcon:f.jsx(la,{}),children:I.I18n.t("Close")})]})]},"inputDialog"):null}render(){return this.state.languageBlocklyLoaded&&this.state.languageOwnLoaded?(this.didUpdate=setTimeout(()=>{this.didUpdate=null,this.componentDidUpdate()},100),[f.jsx("div",{ref:n=>this.blockly=n,style:{width:"100%",height:"100%",position:"relative"}},"blocklyDOM"),this.renderDialogPrompt(),this.renderMessageDialog(),this.renderErrorDialog(),this.renderExportDialog(),this.renderImportDialog()]):null}}const Ah={textArea:{width:"calc(100% - 10px)",resize:"none"},dialog:{height:"95%"},fullHeight:{height:"100%",overflow:"hidden"},args:o=>({color:o.palette.mode==="dark"?"white":"black",height:30,width:"100%",fontSize:16}),argsTitle:o=>({color:o.palette.mode==="dark"?"white":"black",fontWeight:"bold"})};class pL extends Le.Component{constructor(n){super(n),this.state={changed:!1,source:!this.state.source&&this.props.isReturn?`
return false`:this.props.source}}componentDidMount(){setTimeout(()=>{var n;try{(n=window.document.getElementById("source-text-area"))==null||n.focus()}catch{}},100)}handleCancel(){this.props.onClose(!1)}handleOk(){(!this.props.isReturn||this.state.source.includes("return "))&&this.props.onClose(this.state.source)}onChange(n){this.setState({changed:!0,source:n})}render(){return f.jsxs(D.Dialog,{onClose:()=>!1,maxWidth:"lg",sx:{"& .MuiDialog-paper":Ah.dialog},fullWidth:!0,open:!0,"aria-labelledby":"source-dialog-title",children:[f.jsx(D.DialogTitle,{id:"source-dialog-title",children:I.I18n.t("Function editor")}),f.jsxs(D.DialogContent,{style:Ah.fullHeight,children:[this.props.args&&f.jsxs(D.Box,{sx:Ah.args,children:[f.jsx(D.Box,{component:"span",sx:Ah.argsTitle,children:I.I18n.t("function (")}),this.props.args,f.jsx(D.Box,{component:"span",sx:Ah.argsTitle,children:")"})]},"arguments"),f.jsx(wy,{adapterName:this.props.adapterName,runningInstances:this.props.runningInstances,style:{...Ah.textArea,height:this.props.args?"calc(100% - 30px)":"100%"},name:"blockly",socket:this.props.socket,readOnly:!1,checkJs:!1,changed:this.state.changed,code:this.state.source,isDark:this.props.themeType==="dark",onChange:n=>this.onChange(n),language:"javascript"},"scriptEditor")]}),f.jsxs(D.DialogActions,{children:[f.jsx(D.Button,{variant:"contained",onClick:()=>this.handleOk(),color:"primary",startIcon:f.jsx(Fx,{}),children:I.I18n.t("Save")}),f.jsx(D.Button,{color:"grey",variant:"contained",onClick:()=>this.handleCancel(),startIcon:f.jsx(la,{}),children:I.I18n.t("Cancel")})]})]})}}const gL="_wrapperRules_nnott_1",fL="_rootWrapper_nnott_9",mL="_addClass_nnott_14",S_={wrapperRules:gL,rootWrapper:fL,addClass:mL},bL="_switchesItem_10ls3_1",$L="_switchesItemActive_10ls3_28",vL="_iconTheme_10ls3_36",C_={switchesItem:bL,switchesItemActive:$L,iconTheme:vL},T_={},yL={Shuffle:cR,Apps:nR,Functions:iR,Language:zx,AddBox:tR,Pause:oR,Subject:dR,PlayForWork:lR,Brightness3:sR,HelpOutline:Jw,Storage:uR,AccessTime:eR,PlayArrow:aR,FlashOn:rR};function Mu({iconName:o,className:n,adapter:s,socket:i,onClick:a,style:c}){const[h,g]=ve.useState("");if(ve.useEffect(()=>{s&&i&&(T_[s]instanceof Promise||(T_[s]=i.getObject(`system.adapter.${s}`)),T_[s].then($=>{var y;return((y=$==null?void 0:$.common)==null?void 0:y.icon)&&g(`../../adapter/${s}/${$.common.icon}`)}))},[s,i]),s)return f.jsx("img",{onClick:$=>a&&a($),src:h||"",className:n,style:c,alt:""});const b=o&&yL[o]||jx;return f.jsx(b,{className:n,style:c,onClick:$=>a&&a($)})}const Lk=({name:o,id:n,active:s,icon:i,adapter:a,socket:c,onDoubleClick:h,title:g,onTouchMove:b,style:$})=>f.jsxs("div",{onDoubleClick:h,onTouchMove:b,title:g?I.I18n.t(g):void 0,className:I.Utils.clsx(C_.switchesItem,s&&C_.switchesItemActive,`block-${n}`),children:[f.jsx(Mu,{iconName:i,className:C_.iconTheme,adapter:a,socket:c,style:$}),f.jsx("span",{children:o?I.I18n.t(o):""})]},n),_L="_cardStyle_8rq8v_1",wL="_cardStyleActive_8rq8v_17",SL="_controlMenu_8rq8v_22",CL="_closeBtn_8rq8v_31",TL="_isDelete_8rq8v_73",EL="_drag_mobile_8rq8v_90",Nh={cardStyle:_L,cardStyleActive:wL,controlMenu:SL,closeBtn:CL,isDelete:TL,drag_mobile:EL};function ap(o,n,s){let i;switch(o){case"actions":if(s==="else")return i={...n,actions:{...n[o],else:[...n[o].else]}},i;if(s==="then")return i={...n,actions:{...n[o],then:[...n[o].then]}},i;throw console.error(`Unknown additionalParameter: ${s}`),new Error(`Unknown additionalParameter: ${s}`);case"triggers":return i={...n,triggers:[...n.triggers]},i;case"conditions":return i={...n,conditions:[...n.conditions]},i;default:throw new Error(`Unknown name: ${o}`)}}function Iu(o,n,s,i){var a;switch(o){case"actions":return n.actions[s]=n.actions[s].filter(c=>c._id!==i),n;case"conditions":return n.conditions[s]=(a=n.conditions[s])==null?void 0:a.filter(c=>c._id!==i),n;case"triggers":default:return n.triggers=n.triggers.filter(c=>c._id!==i),n}}const kL="_cardStyle_15el3_12",IL="_nameCard_15el3_28",xL="_cardStyleActive_15el3_35",DL="_iconThemCard_15el3_40",OL="_iconThemCardSelectable_15el3_49",RL="_iconHelp_15el3_53",AL="_inputCard_15el3_60",NL="_blockName_15el3_64",ML="_controlMenu_15el3_72",LL="_closeBtn_15el3_81",BL="_controlMenuTop_15el3_123",PL="_debugInfo_15el3_132",FL="_fadeIn_15el3_1",jL="_tagCard_15el3_142",zL="_displayFlex_15el3_161",UL="_blockMarginTop_15el3_166",HL="_nameBlock_15el3_167",WL="_frontText_15el3_171",VL="_backText_15el3_177",GL="_iconTag_15el3_181",qL="_displayItalic_15el3_191",et={cardStyle:kL,nameCard:IL,cardStyleActive:xL,iconThemCard:DL,iconThemCardSelectable:OL,iconHelp:RL,inputCard:AL,blockName:NL,controlMenu:ML,closeBtn:LL,controlMenuTop:BL,debugInfo:PL,fadeIn:FL,tagCard:jL,displayFlex:zL,blockMarginTop:UL,nameBlock:HL,frontText:WL,backText:VL,iconTag:GL,displayItalic:qL},KL="_root_1dr6a_1",JL="_square_1dr6a_11",YL="_icon_1dr6a_16",E_={root:KL,square:JL,icon:YL},em=({fullWidth:o,size:n,onClick:s,style:i,className:a,value:c,square:h,icon:g})=>f.jsx(D.Button,{variant:"outlined",color:"primary",onClick:s,fullWidth:o,style:i,className:I.Utils.clsx(E_.root,a,h?E_.square:""),size:n||"medium",children:g?f.jsx(I.Icon,{className:E_.icon,src:g}):c}),XL="_root_1ucda_1",ZL={root:XL},QL=({size:o,value:n,title:s,onChange:i,className:a,customValue:c,disabled:h})=>{const[g,b]=ve.useState(!1);return f.jsxs(f.Fragment,{children:[f.jsx(D.Checkbox,{disabled:h,checked:!!(c?n:g),className:I.Utils.clsx(ZL.root,a),onChange:$=>{c&&b($.target.checked),i&&i($.target.checked)},size:o||"medium"}),s||null]})},Bk=ve.memo(QL),eB="_root_19roy_1",jC={root:eB},hc=o=>{const[n,s]=ve.useState(""),{value:i,type:a,error:c,className:h,icon:g,label:b,style:$,onChange:y,fullWidth:w,autoComplete:C,customValue:S,autoFocus:k,rows:E,size:R,variant:F,multiline:M,disabled:L}=Object.assign({value:"",type:"text",error:"",className:null,table:!1,native:{},variant:"standard",size:"medium",component:null,styleComponentBlock:null,fullWidth:!1,autoComplete:"",customValue:!1,autoFocus:!1,rows:1},o);return f.jsx(D.TextField,{error:!!c,autoFocus:k,fullWidth:w,label:b,disabled:L,variant:F,multiline:M,rows:E,value:S?i:n,type:a,helperText:c,style:$,className:I.Utils.clsx(jC.root,h),autoComplete:C,onChange:T=>{!S&&s(T.target.value),y&&y(T.target.value)},slotProps:{input:{endAdornment:g?f.jsx(D.InputAdornment,{position:"end",children:f.jsx(I.Icon,{className:jC.icon,src:g})}):null}},margin:"normal",size:R})},tB={formControl:{m:"10px 0","& .MuiFormControl-marginNormal":{mt:0,mb:0},"& > *":{color:"#2d0440 !important"},"& .MuiSelect-icon":{color:"#81688c"},"& label.Mui-focused":{color:"#81688c"},"& .MuiInput-underline:after":{borderBottomColor:"#510573"},"& .MuiInput-underline:before":{borderBottomColor:"#81688c"},"& .MuiInput-underline:hover:before":{borderBottomColor:"#81688c"}}},nB=({multiple:o,value:n,customValue:s,socket:i,title:a,attr:c,adapter:h,style:g,onChange:b,onInstanceHide:$})=>{const[y,w]=ve.useState(n||"test1"),[C,S]=ve.useState([]);return ve.useEffect(()=>{i==null||i.getAdapterInstances(h).then(k=>{const E=k.map(R=>({value:R._id.replace("system.adapter.",""),title:R._id.replace("system.adapter.","")}));E.length===1?$(E[0].value):E.unshift({value:h,title:I.I18n.t("All")}),S(E)})},[i,h,$]),f.jsxs(D.FormControl,{sx:tB.formControl,fullWidth:!0,style:g,children:[f.jsx(D.Select,{variant:"standard",value:(s?n:y)||"_",fullWidth:!0,multiple:o,renderValue:k=>o&&Array.isArray(k)?k.join(", "):k,onChange:k=>{!s&&w(k.target.value),b(k.target.value)},input:c?f.jsx(D.Input,{name:c,id:`${c}-helper`}):f.jsx(D.Input,{name:c}),children:C.map(k=>f.jsx(D.MenuItem,{style:{placeContent:"space-between"},value:k.value||"_",children:I.I18n.t(k.title)},`key-${k.value}`))}),a?f.jsx(D.FormHelperText,{children:I.I18n.t(a)}):null]})},sB="_modalContentWrapper_587ci_1",rB="_modalButtonBlock_587ci_8",iB="_modalButtonBlockTwo_587ci_23",oB="_modalWrapper_587ci_33",aB="_modalDialog_587ci_40",lB="_close_587ci_44",zC={modalContentWrapper:sB,modalButtonBlock:rB,modalButtonBlockTwo:iB,modalWrapper:oB,modalDialog:aB,close:lB},Tw=({onClose:o,children:n,titleButtonApply:s,titleButtonClose:i,onApply:a,className:c,textInput:h,defaultValue:g})=>{const[b,$]=ve.useState(g||""),[y]=ve.useState(g||"");return f.jsxs(D.Dialog,{open:!0,maxWidth:"md",disableEscapeKeyDown:!1,onClose:o,classes:{paper:zC.modalDialog},className:zC.modalWrapper,children:[f.jsxs(D.DialogContent,{children:[h&&f.jsx(hc,{className:c,autoComplete:"off",fullWidth:!0,variant:"outlined",size:"medium",rows:10,multiline:!0,value:b,onChange:$,customValue:!0}),!h&&n]}),f.jsxs(D.DialogActions,{children:[f.jsx(D.Button,{disabled:y===b,onClick:()=>a(h?b:null),variant:"contained",color:"primary",children:I.I18n.t(s||"Ok")}),f.jsx(D.Button,{color:"grey",onClick:o,variant:"contained",children:I.I18n.t(i||"Cancel")})]})]})},cB="_root_15mo1_1",uB={root:cB},dB=({multiple:o,value:n,customValue:s,title:i,attr:a,options:c,style:h,onChange:g,className:b,doNotTranslate:$,doNotTranslate2:y})=>{const[w,C]=ve.useState(n===void 0?c[0].value:n),S=s?n:w,k=S===""||S===null||S===void 0?"_":S;return f.jsxs(D.FormControl,{variant:"standard",className:I.Utils.clsx(uB.root,b),fullWidth:!0,style:h,children:[f.jsxs(D.Select,{variant:"standard",value:k,fullWidth:!0,multiple:o,renderValue:E=>{if(o&&Array.isArray(E)){E.sort();let F=E.indexOf("0");F!==-1&&(E.splice(F,1),E.push("0")),F=E.indexOf("_"),F!==-1&&(E.splice(F,1),E.unshift("_"));const M=c.find(T=>T.only);return M&&E.includes(M.value)?M.titleShort?$?M.titleShort:I.I18n.t(M.titleShort):$?M.title:I.I18n.t(M.title):E.map(T=>c.find(V=>V.value===T||T==="_"&&V.value==="")||T).map(T=>typeof T=="object"?T.titleShort?$?T.titleShort:I.I18n.t(T.titleShort):$?T.title:I.I18n.t(T.title):$?T:I.I18n.t(T)).join(", ")}const R=c?c.find(F=>F.value===E||E==="_"&&F.value===""):null;return R!=null&&R.title?$?R==null?void 0:R.title:I.I18n.t(R==null?void 0:R.title):E},onChange:E=>{if(!s&&C(E.target.value),o){const R=E.target.value,F=c.find(M=>M.only);if(F){const M=F.value;if(R.length===c.length-1&&R.includes(M))return g(R.filter(L=>L!==M),a);if(R.includes(M))return g(c.map(L=>L.value),a)}}g(E.target.value,a)},input:a?f.jsx(D.Input,{name:a,id:`${a}-helper`}):f.jsx(D.Input,{name:a}),children:[!o&&c&&c.map(E=>f.jsxs(D.MenuItem,{style:{placeContent:"space-between"},value:E.value===""||E.value===null||E.value===void 0?"_":E.value,children:[$?E.title:I.I18n.t(E.title),E.title2&&f.jsx("div",{children:y?E.title2:I.I18n.t(E.title2)})]},`key-${E.value}`)),o&&(c==null?void 0:c.map(E=>f.jsxs(D.MenuItem,{style:{placeContent:"space-between"},value:E.value||"_",children:[$?E.title:I.I18n.t(E.title)," ",f.jsx(Bk,{customValue:!0,value:n==null?void 0:n.includes(E.value)})]},`key-${E.value}`)))]}),i?f.jsx(D.FormHelperText,{children:I.I18n.t(i)}):null]})},hB="_root_1gt4d_1",pB="_mark_1gt4d_27",UC={root:hB,mark:pB},gB=({size:o,value:n,style:s,onChange:i,className:a,customValue:c,min:h,max:g,step:b,unit:$})=>{const[y,w]=ve.useState(0);h=h!==void 0?h:0,g=g!==void 0?g:0,b=b!==void 0?b:(g-h)/100;const C=[{value:h,label:h+($||"")},{value:g,label:g+($||"")}];return f.jsx(D.Slider,{defaultValue:c?n:y,"aria-labelledby":"discrete-slider",valueLabelDisplay:"auto",classes:{mark:UC.mark},marks:C,step:b,min:h,max:g,value:c?n:y,style:s,className:I.Utils.clsx(UC.root,a),onChange:(S,k)=>{Array.isArray(k)?(!c&&w(k[0]),i(k[0])):(!c&&w(k),i(k))},size:o||"medium"})},fB="_root_rzul6_1",mB={root:fB},bB=({label:o,size:n,value:s,style:i,onChange:a,className:c,customValue:h})=>{const[g,b]=ve.useState(!1);return f.jsx(D.FormControlLabel,{className:mB.root,control:f.jsx(D.Switch,{checked:h?s:g,style:i,className:c,onChange:$=>{h||b($.target.checked),a($.target.checked)},size:n||"medium"}),label:o||"all"})},$B=ve.memo(bB),vB="_root_135pm_1",yB={root:vB},_B=({value:o,style:n,onChange:s,className:i})=>f.jsx(D.TextField,{variant:"standard",id:"time",type:"time",onChange:a=>s(a.currentTarget.value),value:o,className:I.Utils.clsx(yB.root,i),fullWidth:!0,style:n,slotProps:{htmlInput:{step:300},inputLabel:{shrink:!0}}}),wB="_root_135pm_1",Q$={root:wB},k_=[31,29,31,30,31,30,31,31,30,31,30,31],SB=({value:o,onChange:n,className:s,style:i})=>{const[a,c]=(o||"01.01").toString().split(".");let h=parseInt(c,10)||0,g=parseInt(a,10)||0;g>12?g=12:g<0&&(g=0),h>k_[g]?h=k_[g]:h<0&&(h=0);const b=[];for(let $=0;$<k_[g];$++)b.push($+1);return f.jsxs("div",{children:[f.jsx(D.FormControl,{variant:"standard",className:I.Utils.clsx(Q$.root,s),style:i,children:f.jsxs(D.Select,{variant:"standard",className:I.Utils.clsx(Q$.root,s),margin:"dense",label:I.I18n.t("Month"),onChange:$=>n(`${$.target.value.toString().padStart(2,"0")}.${h.toString().padStart(2,"0")}`),value:g,children:[f.jsx(D.MenuItem,{style:{placeContent:"space-between"},value:0,children:I.I18n.t("Any month")},0),f.jsx(D.MenuItem,{style:{placeContent:"space-between"},value:1,children:I.I18n.t("January")},1),f.jsx(D.MenuItem,{style:{placeContent:"space-between"},value:2,children:I.I18n.t("February")},2),f.jsx(D.MenuItem,{style:{placeContent:"space-between"},value:3,children:I.I18n.t("March")},3),f.jsx(D.MenuItem,{style:{placeContent:"space-between"},value:4,children:I.I18n.t("April")},4),f.jsx(D.MenuItem,{style:{placeContent:"space-between"},value:5,children:I.I18n.t("May")},5),f.jsx(D.MenuItem,{style:{placeContent:"space-between"},value:6,children:I.I18n.t("June")},6),f.jsx(D.MenuItem,{style:{placeContent:"space-between"},value:7,children:I.I18n.t("July")},7),f.jsx(D.MenuItem,{style:{placeContent:"space-between"},value:8,children:I.I18n.t("August")},8),f.jsx(D.MenuItem,{style:{placeContent:"space-between"},value:9,children:I.I18n.t("September")},9),f.jsx(D.MenuItem,{style:{placeContent:"space-between"},value:10,children:I.I18n.t("October")},10),f.jsx(D.MenuItem,{style:{placeContent:"space-between"},value:11,children:I.I18n.t("November")},11),f.jsx(D.MenuItem,{style:{placeContent:"space-between"},value:12,children:I.I18n.t("December")},12)]})}),f.jsx(D.FormControl,{variant:"standard",className:I.Utils.clsx(Q$.root,s),style:i,children:f.jsxs(D.Select,{variant:"standard",className:I.Utils.clsx(Q$.root,s),margin:"dense",label:I.I18n.t("Date"),onChange:$=>n(`${g.toString().padStart(2,"0")}.${$.target.value.toString().padStart(2,"0")}`),value:h,children:[f.jsx(D.MenuItem,{style:{placeContent:"space-between"},value:0,children:I.I18n.t("Any")},"A"),b.map($=>f.jsx(D.MenuItem,{style:{placeContent:"space-between"},value:$,children:$},$))]})})]})};let I_;function CB(o){return I_=I_||I.I18n.getLanguage(),o&&typeof o=="object"?o[I_]||o.en:o||""}function Yh(o){return o===null?"null":o===void 0?"undefined":Array.isArray(o)?o.join(", "):typeof o=="object"?JSON.stringify(o):o.toString()}const Is={selectTriggers:0,addScheduleByDoubleClick:1,openTagsMenu:2,selectIntervalTag:3,selectActions:4,addActionPrintText:5,showJavascript:6,switchBackToRules:7,saveTheScript:8},TB=[{selector:".blocks-triggers",content:"Select triggers"},{selector:".block-TriggerScheduleBlock",content:"Double click to add the block"},{selector:".tag-card",content:"Open drop down menu"},{selector:".tag-card-interval",content:"Select interval"},{selector:".blocks-actions",content:"Select action blocks"},{selector:".block-ActionPrintText",content:"Double click to add the block"},{selector:".button-js-code",content:"Check the script"},{selector:".button-js-code",content:"Switch back to rules"},{selector:".button-save",content:"Save the script"}];class ln extends ve.PureComponent{debugHideTimeout=null;lastObjectIdChange=0;enableSimulationProcessing=!1;lastDebugMessage=0;debugMessageTimeout=null;static getStaticData(){return{acceptedBy:"actions",name:"Not found",id:"ActionEmpty",icon:"Shuffle"}}static compile(n,s){return""}constructor(n,s){super(n),s=s||{};const i=n.settings||{tagCard:s.tagCardArray?typeof s.tagCardArray[0]!="string"?s.tagCardArray[0].title:s.tagCardArray[0]:""};!i.tagCard&&s.tagCardArray&&(i.tagCard=typeof s.tagCardArray[0]!="string"?s.tagCardArray[0].title:s.tagCardArray[0]),this.state={inputs:s.inputs||n.inputs||[],name:s.name||n.name||"",icon:s.icon||n.icon||"",adapter:s.adapter||n.adapter||"",helpDialog:s.helpDialog||n.helpDialog||"",tagCardArray:s.tagCardArray||[],openTagMenu:!1,openModal:!1,iconTag:!1,error:"",helpText:"",instanceSelectionOptions:[],instanceSelectionDef:"",hideAttributes:[],settings:i,debugMessage:null,enableSimulation:this.props.enableSimulation}}static getDerivedStateFromProps(n,s){if(!n||!n.settings)return console.log(JSON.stringify(n)),null;const i=JSON.parse(JSON.stringify(n.settings));return!i.tagCard&&s.tagCardArray&&s.tagCardArray.length&&(i.tagCard=typeof s.tagCardArray[0]!="string"?s.tagCardArray[0].title:s.tagCardArray[0]),JSON.stringify(i)!==JSON.stringify(s.settings)?{settings:i}:null}componentWillUnmount(){this.debugMessageTimeout&&(clearTimeout(this.debugMessageTimeout),this.debugMessageTimeout=null),this.debugHideTimeout&&(clearTimeout(this.debugHideTimeout),this.debugHideTimeout=null)}onTagChange(n,s,i,a,c){let h=!1;const g=JSON.parse(JSON.stringify(this.state.settings));this.state.inputs.forEach(b=>{const $=b.attr,y=b.defaultValue;$&&y!==void 0&&$&&g[$]===void 0&&(h=!0,g[$]=y)}),h?(this.setState({settings:g},()=>s&&s()),this.props.onChange(g)):s&&s()}onUpdate(){}onValueChanged(n,s){}renderText=(n,s,i)=>{const{className:a}=this.props,{attr:c,frontText:h,backText:g,nameBlock:b,name:$,doNotTranslate:y,doNotTranslateBack:w}=n;return f.jsxs(ve.Fragment,{children:[f.jsxs("div",{className:I.Utils.clsx(et.displayFlex,et.blockMarginTop),children:[h&&f.jsx("div",{className:et.frontText,children:y?h:I.I18n.t(h)}),f.jsx(hc,{className:a,autoComplete:"off",label:CB($),variant:"outlined",size:"small",fullWidth:!0,value:s,onChange:i,customValue:!0}),g&&f.jsx("div",{className:et.backText,children:w?g:I.I18n.t(g)})]}),b&&f.jsx("div",{className:et.nameBlock,children:I.I18n.t(b)})]},c)};renderSwitch=(n,s,i)=>{const{className:a}=this.props,{attr:c,frontText:h,backText:g,nameBlock:b,doNotTranslate:$,doNotTranslateBack:y}=n;return f.jsxs("div",{children:[f.jsxs("div",{className:I.Utils.clsx(et.displayFlex,et.blockMarginTop),children:[h&&f.jsx("div",{className:et.frontText,children:$?h:I.I18n.t(h)}),f.jsx($B,{className:a,label:"",customValue:!0,value:s,onChange:i}),g&&f.jsx("div",{className:et.backText,children:y?g:I.I18n.t(g)})]}),b&&f.jsx("div",{className:et.nameBlock,children:I.I18n.t(b)})]},c)};renderNameText=({attr:n,signature:s,doNotTranslate:i,defaultValue:a},c)=>f.jsx("div",{className:I.Utils.clsx(s?et.displayItalic:et.displayFlex,et.blockMarginTop),children:c?i?c:I.I18n.t(c):i?a:I.I18n.t(a)},n);renderNumber=(n,s,i)=>{const{className:a}=this.props,{settings:c}=this.state,{attr:h,backText:g,frontText:b,openCheckbox:$,doNotTranslate:y,doNotTranslateBack:w}=n;let C=!0;return $&&(C=typeof c.offset=="boolean"?c.offset:!0),C?f.jsxs("div",{className:I.Utils.clsx(et.displayFlex,et.blockMarginTop),children:[b&&f.jsx("div",{className:et.frontText,children:y?b:I.I18n.t(b)}),f.jsx(hc,{className:I.Utils.clsx(a,n.className),fullWidth:!0,autoComplete:"off",label:n.noHelperText?"":"number",variant:"outlined",size:"small",type:"number",value:s,onChange:i,customValue:!0}),g&&f.jsx("div",{className:et.backText,children:w?g:I.I18n.t(g)})]},h):null};renderColor=(n,s,i)=>{const{className:a}=this.props,{attr:c,backText:h,frontText:g,doNotTranslate:b,doNotTranslateBack:$}=n;return f.jsxs("div",{className:I.Utils.clsx(et.displayFlex,et.blockMarginTop),children:[g&&f.jsx("div",{className:et.frontText,children:b?g:I.I18n.t(g)}),f.jsx(hc,{className:a,autoComplete:"off",fullWidth:!0,variant:"outlined",size:"small",type:"color",value:s,onChange:i}),h&&f.jsx("div",{className:et.backText,children:$?h:I.I18n.t(h)})]},c)};renderCheckbox=(n,s,i)=>{const{className:a}=this.props,{settings:c}=this.state,{attr:h,backText:g,frontText:b,defaultValue:$,doNotTranslate:y,doNotTranslateBack:w}=n;return f.jsxs("div",{className:et.displayFlex,children:[b&&f.jsx("div",{className:et.frontText,children:y?b:I.I18n.t(b)}),f.jsx(Bk,{className:a,size:"small",value:typeof c[h]=="boolean"?!!c[h]:!!$,customValue:!0,onChange:i}),g&&f.jsx("div",{onClick:()=>i(typeof c[h]=="boolean"?!c[h]:!$),className:et.backText,children:w?g:I.I18n.t(g)})]},h)};renderSlider=(n,s,i)=>{const{className:a}=this.props,{attr:c,frontText:h,backText:g,nameBlock:b,min:$,max:y,step:w,unit:C,doNotTranslate:S,doNotTranslateBack:k}=n;return f.jsxs("div",{children:[f.jsxs("div",{className:et.displayFlex,style:{marginRight:20},children:[h&&f.jsx("div",{className:et.frontText,children:S?h:I.I18n.t(h)}),f.jsx(gB,{customValue:!0,min:$,max:y,step:w,unit:C,className:a,autoComplete:"off",label:"number",variant:"outlined",size:"small",value:s,onChange:E=>{console.log(E),i(E)}}),g&&f.jsx("div",{style:{marginLeft:20},className:et.backText,children:k?g:I.I18n.t(g)})]}),b&&f.jsx("div",{className:et.nameBlock,children:I.I18n.t(b)})]},c)};renderButton=(n,s,i)=>{const{className:a}=this.props,{attr:c,frontText:h,backText:g,doNotTranslate:b,doNotTranslateBack:$}=n;return f.jsxs("div",{className:I.Utils.clsx(et.displayFlex,et.blockMarginTop),children:[h&&f.jsx("div",{className:et.frontText,children:b?h:I.I18n.t(h)}),f.jsx(em,{fullWidth:!0,value:s.toString(),className:a,onClick:()=>i(s)}),g&&f.jsx("div",{className:et.backText,children:$?g:I.I18n.t(g)})]},c)};findIcon(n){var s;if(!n)return Promise.resolve(null);if((s=n.common)!=null&&s.icon)return Promise.resolve(I.getSelectIdIcon(n,"../.."));if(n.type==="state"||n.type==="channel"){const i=n._id.split(".");i.pop();const a=i.join(".");return this.props.socket.getObject(a).then(c=>this.findIcon(c)).catch(()=>null)}return Promise.resolve(null)}renderObjectID=(n,s,i)=>{const{attr:a,openCheckbox:c,checkReadOnly:h}=n,{settings:g}=this.state,b=this.state[`showSelectId${a}`],{className:$,socket:y,style:w}=this.props;let C=!0;c&&(C=typeof g.offset=="boolean"?g.offset:!0);const S=g[a],k=S?this.state[S]:void 0;return S&&!k&&k!==!1&&setTimeout(async E=>{var L;const R=await y.getObject(s),F=await this.findIcon(R),M={[E]:R||!1,[`${E}___icon`]:F,error:h&&this.lastObjectIdChange&&Date.now()-this.lastObjectIdChange<1e3&&((L=R==null?void 0:R.common)==null?void 0:L.write)===!1?I.I18n.t("Read only ID selected: %s",g[E]):""};this.setState(M)},0,S),C?f.jsxs("div",{className:et.blockMarginTop,children:[f.jsxs("div",{className:et.displayFlex,children:[n.title?f.jsx("div",{children:I.I18n.t(n.title)}):null,f.jsx(hc,{className:$,style:w,autoComplete:"off",fullWidth:!0,disabled:!0,variant:"outlined",size:"small",value:s,customValue:!0}),f.jsx(em,{icon:this.state[`${S}___icon`],square:!0,style:{...w||void 0,marginLeft:7},value:"...",className:$,onClick:()=>{const E={};E[`showSelectId${a}`]=!0,this.setState(E)}})]}),k?f.jsx("div",{className:I.Utils.clsx(et.nameBlock,et.displayItalic),children:I.Utils.getObjectNameFromObj(k,I.I18n.getLanguage())}):null,b?f.jsx(I.SelectID,{theme:this.props.theme,imagePrefix:"../..",dialogName:"javascript",themeType:I.Utils.getThemeName(),socket:y,selected:s,onClose:()=>{const E={};E[`showSelectId${a}`]=!1,this.setState(E)},onOk:(E,R)=>{const F={};F[`showSelectId${a}`]=!1;const M=Array.isArray(E)?E[0]:E;this.setState(F,async()=>{var T,V,K,Y,te,J,ne,Q,he,q;const L=M?await y.getObject(M):void 0;this.lastObjectIdChange=Date.now(),i({[a]:E,[`${a}Role`]:(T=L==null?void 0:L.common)==null?void 0:T.role,[`${a}Type`]:(V=L==null?void 0:L.common)==null?void 0:V.type,[`${a}Unit`]:(K=L==null?void 0:L.common)==null?void 0:K.unit,[`${a}States`]:(Y=L==null?void 0:L.common)==null?void 0:Y.states,[`${a}Min`]:(te=L==null?void 0:L.common)==null?void 0:te.min,[`${a}Max`]:(J=L==null?void 0:L.common)==null?void 0:J.max,[`${a}Step`]:(ne=L==null?void 0:L.common)==null?void 0:ne.step,[`${a}Def`]:(Q=L==null?void 0:L.common)==null?void 0:Q.def,[`${a}Write`]:(he=L==null?void 0:L.common)==null?void 0:he.write,[`${a}Read`]:(q=L==null?void 0:L.common)==null?void 0:q.read},()=>this.props.setOnUpdate&&this.props.setOnUpdate(!0))})}}):null]},a):null};renderIconTag=()=>f.jsx("div",{className:et.iconTag,onClick:n=>{this.state.settings.tagCard&&(this.state.tagCardArray.length<3?this.onChangeTag():this.setState({openTagMenu:n.currentTarget}))},children:this.state.settings.tagCard});renderTime=(n,s,i)=>{const{attr:a,backText:c,frontText:h,doNotTranslate:g,doNotTranslateBack:b}=n;return f.jsxs("div",{className:et.displayFlex,style:{whiteSpace:"nowrap"},children:[h&&f.jsx("div",{className:et.frontText,children:g?h:I.I18n.t(h)}),f.jsx(_B,{value:s,onChange:i}),c&&f.jsx("div",{className:et.backText,children:b?c:I.I18n.t(c)})]},a)};renderSelect=(n,s,i)=>{const{className:a,style:c}=this.props,{name:h,options:g,frontText:b,backText:$,attr:y,multiple:w,doNotTranslate:C,doNotTranslate2:S,doNotTranslateBack:k}=n;return f.jsxs("div",{className:I.Utils.clsx(et.displayFlex,et.blockMarginTop),style:{whiteSpace:"nowrap"},children:[b&&f.jsx("div",{className:et.frontText,children:I.I18n.t(b)}),f.jsx(dB,{attr:y,doNotTranslate:C,doNotTranslate2:S,title:h,className:a,style:c,options:g,value:s,onChange:i,multiple:w,customValue:!0}),$&&f.jsx("div",{className:et.backText,children:k?$:I.I18n.t($)})]},y)};renderInstance=(n,s,i)=>{const{socket:a}=this.props,{name:c,frontText:h,backText:g,attr:b,adapter:$,doNotTranslate:y,doNotTranslateBack:w}=n;return this.state.hideAttributes.includes(b)?null:f.jsxs("div",{className:I.Utils.clsx(et.displayFlex,et.blockMarginTop),style:{whiteSpace:"nowrap"},children:[h&&f.jsx("div",{className:et.frontText,children:y?h:I.I18n.t(h)}),f.jsx(nB,{attr:b,socket:a,adapter:$,title:c,value:s,onChange:C=>{i(Array.isArray(C)?C[0]:C)},customValue:!0,onInstanceHide:C=>this.setState({hideAttributes:[...this.state.hideAttributes,b]},()=>i(C))}),g&&f.jsx("div",{className:et.backText,children:w?g:I.I18n.t(g)})]},b)};renderDialog=n=>{const{onShowDialog:s,frontText:i,backText:a,attr:c,icon:h,doNotTranslate:g,doNotTranslateBack:b}=n;return f.jsxs("div",{className:I.Utils.clsx(et.displayFlex,et.blockMarginTop),style:{whiteSpace:"nowrap"},children:[i&&f.jsx("div",{className:et.frontText,children:g?i:I.I18n.t(i)}),f.jsx(Mu,{iconName:h,className:I.Utils.clsx(et.iconDialog),onClick:()=>s&&s()}),a&&f.jsx("div",{className:et.backText,children:b?a:I.I18n.t(a)})]},c)};renderModalInput=(n,s,i)=>{const{openModal:a}=this.state,{className:c}=this.props,{attr:h,nameBlock:g,frontText:b,backText:$,noTextEdit:y,doNotTranslate:w,doNotTranslateBack:C}=n;return f.jsxs("div",{children:[f.jsxs("div",{className:I.Utils.clsx(et.displayFlex,et.blockMarginTop),children:[b&&f.jsx("div",{className:et.frontText,children:w?b:I.I18n.t(b)}),f.jsx(hc,{disabled:!!y,className:c,autoComplete:"off",fullWidth:!0,variant:"outlined",size:"small",value:s,onChange:i,customValue:!0}),f.jsx(em,{square:!0,style:{marginLeft:5},value:"...",className:c,onClick:()=>this.setState({openModal:!0})}),$&&f.jsx("div",{className:et.backText,children:C?$:I.I18n.t($)})]}),a?f.jsx(Tw,{onApply:S=>this.setState({openModal:!1},()=>S!=null&&i(S)),onClose:()=>this.setState({openModal:!1}),defaultValue:s,textInput:!0}):null,g&&f.jsx("div",{className:et.nameBlock,children:I.I18n.t(g)})]},h)};renderDate=(n,s,i)=>{const{attr:a,backText:c,frontText:h,doNotTranslate:g,doNotTranslateBack:b}=n;return f.jsxs("div",{className:et.displayFlex,style:{whiteSpace:"nowrap"},children:[h&&f.jsx("div",{className:et.frontText,children:g?h:I.I18n.t(h)}),f.jsx(SB,{value:s,onChange:i}),c&&f.jsx("div",{className:et.backText,children:b?c:I.I18n.t(c)})]},a)};static getReplacesInText(n){var i;let s="";return(i=n.trigger)!=null&&i.oidType?s=".replace(/%s/g, obj.state.val).replace(/%id/g, obj.id).replace(/%name/g, obj.common && obj.common.name).replace(/%old/g, obj.oldState.val)":n.conditionsStates.length&&(s=`.replace(/%s/g, ${n.conditionsStates[0].name}).replace(/%id/g, "${n.conditionsStates[0].id}")`),s}renderTags(){const{tagCardArray:n,openTagMenu:s}=this.state,{tagCard:i}=this.state.settings;let a=i!=="="&&i!=="<>"&&i!==">="&&i!=="()"&&i!=="."&&i!=="<="&&i!=="<"&&i!==">"&&i?I.I18n.t(i):i;return n.length>=3&&(a=f.jsxs("div",{children:[f.jsx("div",{"aria-controls":"simple-menu","aria-haspopup":"true",onClick:c=>{this.setState({openTagMenu:c.currentTarget},()=>{this.props.isTourOpen&&this.props.tourStep===Is.openTagsMenu&&setTimeout(()=>this.props.setTourStep&&this.props.setTourStep(Is.selectIntervalTag),300)})},children:a}),f.jsx(D.Menu,{id:"simple-menu",anchorEl:s,keepMounted:!0,open:!!s,onClose:()=>this.setState({openTagMenu:null}),children:n.map((c,h)=>{let g;return typeof c!="string"?g=c.title:g=c,f.jsxs(D.MenuItem,{selected:g===i,className:`tag-card-${g}`,style:{placeContent:"space-between"},onClick:()=>{const b={...this.state.settings,tagCard:g};this.setState({openTagMenu:null,settings:b},()=>{this.props.onChange(b),this.onTagChange(g)}),this.props.isTourOpen&&(this.props.tourStep===Is.openTagsMenu||this.props.tourStep===Is.selectIntervalTag)&&g==="interval"&&setTimeout(()=>this.props.setTourStep&&this.props.setTourStep(Is.selectActions),500)},children:[g.search(/>|<|<>|<=|>=|=/)!==-1?g:I.I18n.t(g),typeof c!="string"&&c.title2&&f.jsx("div",{style:{marginLeft:4},children:I.I18n.t(c.title2)})]},`${g}_${h}`)})})]})),a}getData(){return{acceptedBy:"triggers",name:"",id:""}}onChangeTag=()=>{const{tagCardArray:n,settings:s,settings:{tagCard:i}}=this.state;let a;if(typeof n[0]!="string"?a=n.map(c=>c.title):a=[...n],i&&a.length<3){const c={...s},h=a[(a.indexOf(i)+1)%a.length];c.tagCard=h,this.setState({settings:c},()=>{this.props.onChange(c),this.onTagChange(h)})}};componentDidMount=()=>{this.onTagChange()};componentDidUpdate(){this.props.acceptedBy!=="triggers"&&this.props.onUpdate&&setTimeout(()=>this.onUpdate(),0)}onChangeInput=n=>(s,i,a)=>{const c=JSON.parse(JSON.stringify(this.state.settings));typeof s=="object"&&(!i||typeof i=="function")?(Object.keys(s).forEach(h=>c[h]=s[h]),typeof i=="function"&&(a=i,i=void 0)):c[i||n]=s,c.id=this.getData().id,c._id=this.props._id,this.setState({settings:c},()=>{this.onValueChanged(s,i||n),this.props.onChange(c),a&&a()})};renderSpecific(){return null}renderDebug(n){return""}renderDebugInfo(){return this.state.debugMessage?f.jsx("div",{className:et.debugInfo,style:{opacity:1,height:22,bottom:-22},children:this.renderDebug?this.renderDebug(this.state.debugMessage):I.I18n.t("executed")},this.state.debugMessage.ts):null}renderCron(n,s,i){return null}renderWizard(n,s,i){return null}renderWriteState(){return null}renderInputElement(n,s){const{nameRender:i,defaultValue:a,attr:c}=n,{settings:h}=this.state;let g=c?h[c]:void 0;switch(g===void 0&&(g=a),i){case"renderTime":return c?this.renderTime(n,g,this.onChangeInput(c)):f.jsx("div",{children:I.I18n.t("Invalid renderTime")},`invalid_${s}`);case"renderNameText":return this.renderNameText(n,g);case"renderSelect":return c?this.renderSelect(n,g,this.onChangeInput(c)):f.jsx("div",{children:I.I18n.t("Invalid renderSelect")},`invalid_${s}`);case"renderModalInput":return c?this.renderModalInput(n,g,this.onChangeInput(c)):f.jsx("div",{children:I.I18n.t("Invalid renderModalInput")},`invalid_${s}`);case"renderObjectID":return c?this.renderObjectID(n,g,this.onChangeInput(c)):f.jsx("div",{children:I.I18n.t("Invalid renderObjectID")},`invalid_${s}`);case"renderDialog":return c?this.renderDialog(n):f.jsx("div",{children:I.I18n.t("Invalid renderDialog")},`invalid_${s}`);case"renderInstance":return c?this.renderInstance(n,g,this.onChangeInput(c)):f.jsx("div",{children:I.I18n.t("Invalid renderInstance")},`invalid_${s}`);case"renderText":return c?this.renderText(n,g,this.onChangeInput(c)):f.jsx("div",{children:I.I18n.t("Invalid renderText")},`invalid_${s}`);case"renderSlider":return c?this.renderSlider(n,g,this.onChangeInput(c)):f.jsx("div",{children:I.I18n.t("Invalid renderSlider")},`invalid_${s}`);case"renderCheckbox":return c?this.renderCheckbox(n,g,this.onChangeInput(c)):f.jsx("div",{children:I.I18n.t("Invalid renderCheckbox")},`invalid_${s}`);case"renderButton":return c?this.renderButton(n,g,this.onChangeInput(c)):f.jsx("div",{children:I.I18n.t("Invalid renderButton")},`invalid_${s}`);case"renderColor":return c?this.renderColor(n,g,this.onChangeInput(c)):f.jsx("div",{children:I.I18n.t("Invalid renderColor")},`invalid_${s}`);case"renderSwitch":return c?this.renderSwitch(n,g,this.onChangeInput(c)):f.jsx("div",{children:I.I18n.t("Invalid renderSwitch")},`invalid_${s}`);case"renderDate":return c?this.renderDate(n,g,this.onChangeInput(c)):f.jsx("div",{children:I.I18n.t("Invalid renderDate")},`invalid_${s}`);case"renderCron":return c?this.renderCron(n,g,this.onChangeInput(c)):f.jsx("div",{children:I.I18n.t("Invalid renderCron")},`invalid_${s}`);case"renderWizard":return c?this.renderWizard(n,g,this.onChangeInput(c)):f.jsx("div",{children:I.I18n.t("Invalid renderWizard")},`invalid_${s}`);case"renderWriteState":return this.renderWriteState();case"renderNumber":return c?this.renderNumber(n,g,this.onChangeInput(c)):f.jsx("div",{children:I.I18n.t("Invalid renderNumber")},`invalid_${s}`);default:return this[i]?this[i](n,g,c?this.onChangeInput(c):null):f.jsx("div",{children:I.I18n.t("Invalid input type: %s",i)},`invalid_${s}`)}}render(){const{inputs:n,name:s,icon:i,iconTag:a,settings:c,adapter:h,settings:{tagCard:g},helpDialog:b}=this.state,{socket:$,notFound:y}=this.props;this.state.enableSimulation!==this.props.enableSimulation&&!this.enableSimulationProcessing&&(this.enableSimulationProcessing=!0,setTimeout(()=>{this.setState({enableSimulation:this.props.enableSimulation},()=>{this.enableSimulationProcessing=!1})},50));let w;if(this.props.onDebugMessage)for(let C=this.props.onDebugMessage.length-1;C>=0;C--){const S=this.props.onDebugMessage[C];if(S.blockId===this.props._id&&S.ts>this.lastDebugMessage&&S.ts>Date.now()-1e3){w=S;break}}return w&&(this.lastDebugMessage=w.ts,this.debugMessageTimeout&&clearTimeout(this.debugMessageTimeout),this.debugHideTimeout&&(clearTimeout(this.debugHideTimeout),this.debugHideTimeout=null),this.debugMessageTimeout=setTimeout(C=>{const S=JSON.parse(C),k=S.hideTimeout||5e3;this.debugMessageTimeout=null,this.setState({debugMessage:S},()=>{this.debugHideTimeout&&clearTimeout(this.debugHideTimeout),this.debugHideTimeout=setTimeout(()=>{this.debugHideTimeout=null,this.setState({debugMessage:null})},k)})},50,JSON.stringify(w))),f.jsxs(ve.Fragment,{children:[a?this.renderIconTag():f.jsx(Mu,{iconName:i,className:I.Utils.clsx(et.iconThemCard,g&&this.state.tagCardArray.length&&et.iconThemCardSelectable),adapter:h,socket:$,onClick:C=>{g&&(this.state.tagCardArray.length<3?this.onChangeTag():this.setState({openTagMenu:C.currentTarget}))}}),f.jsxs("div",{className:et.blockName,children:[f.jsxs("span",{className:et.nameCard,children:[I.I18n.t(s),y?I.I18n.t("%s not found",c.id):"",b?f.jsx(D.IconButton,{className:et.iconHelp,size:"small",onClick:()=>this.setState({helpText:I.I18n.t(b)}),children:f.jsx(Jw,{})}):null]}),n.map((C,S)=>this.renderInputElement(C,S))]}),g&&f.jsx("div",{className:et.controlMenuTop,style:{opacity:1,height:22,top:-22},children:f.jsx("div",{onClick:()=>this.onChangeTag(),className:I.Utils.clsx(et.tagCard,"tag-card"),children:this.renderTags()})}),this.renderDebugInfo(),this.state.error?f.jsx(I.Error,{title:I.I18n.t("Warning"),text:this.state.error,onClose:()=>this.setState({error:""})}):null,this.state.helpText?f.jsx(I.Message,{title:I.I18n.t("Instructions"),text:this.state.helpText,onClose:()=>this.setState({helpText:""})}):null,this.renderSpecific()]})}}const HC={en:{name:"Google - English",engine:"google",params:[]},de:{name:"Google - Deutsch",engine:"google",params:[]},ru:{name:"Google - Русский",engine:"google",params:[]},it:{name:"Google - Italiano",engine:"google",params:[]},es:{name:"Google - Espaniol",engine:"google",params:[]},fr:{name:"Google - Français",engine:"google",params:[]},ru_YA:{name:"Yandex - Русский",engine:"yandex",params:["key","voice","emotion","ill","drunk","robot"],voice:["jane","zahar"],emotion:["none","good","neutral","evil","mixed"]},ru_YA_CLOUD:{name:"Yandex Cloud - Русский",engine:"yandexCloud",params:["key","folderID","voice","emotion"],voice:["alyss","oksana","jane","zahar"],emotion:["good","neutral","evil"]},"en-US":{name:"PicoTTS - Englisch US",engine:"PicoTTS",params:[]},"en-GB":{name:"PicoTTS - Englisch GB",engine:"PicoTTS",params:[]},"de-DE":{name:"PicoTTS - Deutsch",engine:"PicoTTS",params:[]},"it-IT":{name:"PicoTTS - Italiano",engine:"PicoTTS",params:[]},"es-ES":{name:"PicoTTS - Espaniol",engine:"PicoTTS",params:[]},"fr-FR":{name:"PicoTTS - Français",engine:"PicoTTS",params:[]},"ru-RU_CLOUD_Female":{gender:"Female",engine:"cloud",params:["cloud"],language:"ru-RU",ename:"Tatyana",ssml:!0,name:"Cloud - Русский - Татьяна"},"ru-RU_CLOUD_Male":{gender:"Male",engine:"cloud",params:["cloud"],language:"ru-RU",ename:"Maxim",ssml:!0,name:"Cloud - Русский - Максим"},"de-DE_CLOUD_Female":{gender:"Female",engine:"cloud",params:["cloud"],language:"de-DE",ename:"Marlene",ssml:!0,name:"Cloud - Deutsch - Marlene"},"de-DE_CLOUD_Male":{gender:"Male",engine:"cloud",params:["cloud"],language:"de-DE",ename:"Hans",ssml:!0,name:"Cloud - Deutsch - Hans"},"en-US_CLOUD_Female":{gender:"Female",engine:"cloud",params:["cloud"],language:"en-US",ename:"Salli",ssml:!0,name:"Cloud - en-US - Female - Salli"},"en-US_CLOUD_Male":{gender:"Male",engine:"cloud",params:["cloud"],language:"en-US",ename:"Joey",ssml:!0,name:"Cloud - en-US - Male - Joey"},"da-DK_CLOUD_Female":{gender:"Female",engine:"cloud",params:["cloud"],language:"da-DK",ename:"Naja",ssml:!0,name:"Cloud - da-DK - Female - Naja"},"da-DK_CLOUD_Male":{gender:"Male",engine:"cloud",params:["cloud"],language:"da-DK",ename:"Mads",ssml:!0,name:"Cloud - da-DK - Male - Mads"},"en-AU_CLOUD_Female":{gender:"Female",engine:"cloud",params:["cloud"],language:"en-AU",ename:"Nicole",ssml:!0,name:"Cloud - en-AU - Female - Nicole"},"en-AU_CLOUD_Male":{gender:"Male",engine:"cloud",params:["cloud"],language:"en-AU",ename:"Russell",ssml:!0,name:"Cloud - en-AU - Male - Russell"},"en-GB_CLOUD_Female_Amy":{gender:"Female",engine:"cloud",params:["cloud"],language:"en-GB",ename:"Amy",ssml:!0,name:"Cloud - en-GB - Female - Amy"},"en-GB_CLOUD_Male":{gender:"Male",engine:"cloud",params:["cloud"],language:"en-GB",ename:"Brian",ssml:!0,name:"Cloud - en-GB - Male - Brian"},"en-GB_CLOUD_Female_Emma":{gender:"Female",engine:"cloud",params:["cloud"],language:"en-GB",ename:"Emma",ssml:!0,name:"Cloud - en-GB - Female - Emma"},"en-GB-WLS_CLOUD_Female":{gender:"Female",engine:"cloud",params:["cloud"],language:"en-GB-WLS",ename:"Gwyneth",ssml:!0,name:"Cloud - en-GB-WLS - Female - Gwyneth"},"en-GB-WLS_CLOUD_Male":{gender:"Male",engine:"cloud",params:["cloud"],language:"en-GB-WLS",ename:"Geraint",ssml:!0,name:"Cloud - en-GB-WLS - Male - Geraint"},"cy-GB_CLOUD_Female":{gender:"Female",engine:"cloud",params:["cloud"],language:"cy-GB",ename:"Gwyneth",ssml:!0,name:"Cloud - cy-GB - Female - Gwyneth"},"cy-GB_CLOUD_Male":{gender:"Male",engine:"cloud",params:["cloud"],language:"cy-GB",ename:"Geraint",ssml:!0,name:"Cloud - cy-GB - Male - Geraint"},"en-IN_CLOUD_Female":{gender:"Female",engine:"cloud",params:["cloud"],language:"en-IN",ename:"Raveena",ssml:!0,name:"Cloud - en-IN - Female - Raveena"},"en-US_CLOUD_Male_Chipmunk":{gender:"Male",engine:"cloud",params:["cloud"],language:"en-US",ename:"Chipmunk",ssml:!0,name:"Cloud - en-US - Male - Chipmunk"},"en-US_CLOUD_Male_Eric":{gender:"Male",engine:"cloud",params:["cloud"],language:"en-US",ename:"Eric",ssml:!0,name:"Cloud - en-US - Male - Eric"},"en-US_CLOUD_Female_Ivy":{gender:"Female",engine:"cloud",params:["cloud"],language:"en-US",ename:"Ivy",ssml:!0,name:"Cloud - en-US - Female - Ivy"},"en-US_CLOUD_Female_Jennifer":{gender:"Female",engine:"cloud",params:["cloud"],language:"en-US",ename:"Jennifer",ssml:!0,name:"Cloud - en-US - Female - Jennifer"},"en-US_CLOUD_Male_Justin":{gender:"Male",engine:"cloud",params:["cloud"],language:"en-US",ename:"Justin",ssml:!0,name:"Cloud - en-US - Male - Justin"},"en-US_CLOUD_Female_Kendra":{gender:"Female",engine:"cloud",params:["cloud"],language:"en-US",ename:"Kendra",ssml:!0,name:"Cloud - en-US - Female - Kendra"},"en-US_CLOUD_Female_Kimberly":{gender:"Female",engine:"cloud",params:["cloud"],language:"en-US",ename:"Kimberly",ssml:!0,name:"Cloud - en-US - Female - Kimberly"},"es-ES_CLOUD_Female":{gender:"Female",engine:"cloud",params:["cloud"],language:"es-ES",ename:"Conchita",ssml:!0,name:"Cloud - es-ES - Female - Conchita"},"es-ES_CLOUD_Male":{gender:"Male",engine:"cloud",params:["cloud"],language:"es-ES",ename:"Enrique",ssml:!0,name:"Cloud - es-ES - Male - Enrique"},"es-US_CLOUD_Female":{gender:"Female",engine:"cloud",params:["cloud"],language:"es-US",ename:"Penelope",ssml:!0,name:"Cloud - es-US - Female - Penelope"},"es-US_CLOUD_Male":{gender:"Male",engine:"cloud",params:["cloud"],language:"es-US",ename:"Miguel",ssml:!0,name:"Cloud - es-US - Male - Miguel"},"fr-CA_CLOUD_Female":{gender:"Female",engine:"cloud",params:["cloud"],language:"fr-CA",ename:"Chantal",ssml:!0,name:"Cloud - fr-CA - Female - Chantal"},"fr-FR_CLOUD_Female":{gender:"Female",engine:"cloud",params:["cloud"],language:"fr-FR",ename:"Celine",ssml:!0,name:"Cloud - fr-FR - Female - Celine"},"fr-FR_CLOUD_Male":{gender:"Male",engine:"cloud",params:["cloud"],language:"fr-FR",ename:"Mathieu",ssml:!0,name:"Cloud - fr-FR - Male - Mathieu"},"is-IS_CLOUD_Female":{gender:"Female",engine:"cloud",params:["cloud"],language:"is-IS",ename:"Dora",ssml:!0,name:"Cloud - is-IS - Female - Dora"},"is-IS_CLOUD_Male":{gender:"Male",engine:"cloud",params:["cloud"],language:"is-IS",ename:"Karl",ssml:!0,name:"Cloud - is-IS - Male - Karl"},"it-IT_CLOUD_Female":{gender:"Female",engine:"cloud",params:["cloud"],language:"it-IT",ename:"Carla",ssml:!0,name:"Cloud - it-IT - Female - Carla"},"it-IT_CLOUD_Male":{gender:"Male",engine:"cloud",params:["cloud"],language:"it-IT",ename:"Giorgio",ssml:!0,name:"Cloud - it-IT - Male - Giorgio"},"nb-NO_CLOUD_Female":{gender:"Female",engine:"cloud",params:["cloud"],language:"nb-NO",ename:"Liv",ssml:!0,name:"Cloud - nb-NO - Female - Liv"},"nl-NL_CLOUD_Female":{gender:"Female",engine:"cloud",params:["cloud"],language:"nl-NL",ename:"Lotte",ssml:!0,name:"Cloud - nl-NL - Female - Lotte"},"nl-NL_CLOUD_Male":{gender:"Male",engine:"cloud",params:["cloud"],language:"nl-NL",ename:"Ruben",ssml:!0,name:"Cloud - nl-NL - Male - Ruben"},"pl-PL_CLOUD_Female_Agnieszka":{gender:"Female",engine:"cloud",params:["cloud"],language:"pl-PL",ename:"Agnieszka",ssml:!0,name:"Cloud - pl-PL - Female - Agnieszka"},"pl-PL_CLOUD_Male_Jacek":{gender:"Male",engine:"cloud",params:["cloud"],language:"pl-PL",ename:"Jacek",ssml:!0,name:"Cloud - pl-PL - Male - Jacek"},"pl-PL_CLOUD_Female_Ewa":{gender:"Female",engine:"cloud",params:["cloud"],language:"pl-PL",ename:"Ewa",ssml:!0,name:"Cloud - pl-PL - Female - Ewa"},"pl-PL_CLOUD_Male_Jan":{gender:"Male",engine:"cloud",params:["cloud"],language:"pl-PL",ename:"Jan",ssml:!0,name:"Cloud - pl-PL - Male - Jan"},"pl-PL_CLOUD_Female":{gender:"Female",engine:"cloud",params:["cloud"],language:"pl-PL",ename:"Maja",ssml:!0,name:"Cloud - pl-PL - Female - Maja"},"pt-BR_CLOUD_Female":{gender:"Female",engine:"cloud",params:["cloud"],language:"pt-BR",ename:"Vitoria",ssml:!0,name:"Cloud - pt-BR - Female - Vitoria"},"pt-BR_CLOUD_Male":{gender:"Male",engine:"cloud",params:["cloud"],language:"pt-BR",ename:"Ricardo",ssml:!0,name:"Cloud - pt-BR - Male - Ricardo"},"pt-PT_CLOUD_Male":{gender:"Male",engine:"cloud",params:["cloud"],language:"pt-PT",ename:"Cristiano",ssml:!0,name:"Cloud - pt-PT - Male - Cristiano"},"pt-PT_CLOUD_Female":{gender:"Female",engine:"cloud",params:["cloud"],language:"pt-PT",ename:"Ines",ssml:!0,name:"Cloud - pt-PT - Female - Ines"},"ro-RO_CLOUD_Female":{gender:"Female",engine:"cloud",params:["cloud"],language:"ro-RO",ename:"Carmen",ssml:!0,name:"Cloud - ro-RO - Female - Carmen"},"sv-SE_CLOUD_Female":{gender:"Female",engine:"cloud",params:["cloud"],language:"sv-SE",ename:"Astrid",ssml:!0,name:"Cloud - sv-SE - Female - Astrid"},"tr-TR_CLOUD_Female":{gender:"Female",engine:"cloud",params:["cloud"],language:"tr-TR",ename:"Filiz",ssml:!0,name:"Cloud - tr-TR - Female - Filiz"},"ru-RU_AP_Female":{gender:"Female",engine:"polly",params:["accessKey","secretKey","region"],language:"ru-RU",ename:"Tatyana",ssml:!0,name:"AWS Polly - Русский - Татьяна"},"ru-RU_AP_Male":{gender:"Male",engine:"polly",params:["accessKey","secretKey","region"],language:"ru-RU",ename:"Maxim",ssml:!0,name:"AWS Polly - Русский - Максим"},"de-DE_AP_Female":{gender:"Female",engine:"polly",params:["accessKey","secretKey","region"],language:"de-DE",ename:"Marlene",ssml:!0,name:"AWS Polly - Deutsch - Marlene"},"de-DE_AP_Female_Vicky":{gender:"Female",engine:"polly",params:["accessKey","secretKey","region"],language:"de-DE",ename:"Vicky",ssml:!0,name:"AWS Polly - Deutsch - Vicky"},"de-DE_AP_Male":{gender:"Male",engine:"polly",params:["accessKey","secretKey","region"],language:"de-DE",ename:"Hans",ssml:!0,name:"AWS Polly - Deutsch - Hans"},"en-US_AP_Female":{gender:"Female",engine:"polly",params:["accessKey","secretKey","region"],language:"en-US",ename:"Salli",ssml:!0,name:"AWS Polly - en-US - Female - Salli"},"en-US_AP_Male":{gender:"Male",engine:"polly",params:["accessKey","secretKey","region"],language:"en-US",ename:"Joey",ssml:!0,name:"AWS Polly - en-US - Male - Joey"},"da-DK_AP_Female":{gender:"Female",engine:"polly",params:["accessKey","secretKey","region"],language:"da-DK",ename:"Naja",ssml:!0,name:"AWS Polly - da-DK - Female - Naja"},"da-DK_AP_Male":{gender:"Male",engine:"polly",params:["accessKey","secretKey","region"],language:"da-DK",ename:"Mads",ssml:!0,name:"AWS Polly - da-DK - Male - Mads"},"en-AU_AP_Female":{gender:"Female",engine:"polly",params:["accessKey","secretKey","region"],language:"en-AU",ename:"Nicole",ssml:!0,name:"AWS Polly - en-AU - Female - Nicole"},"en-AU_AP_Male":{gender:"Male",engine:"polly",params:["accessKey","secretKey","region"],language:"en-AU",ename:"Russell",ssml:!0,name:"AWS Polly - en-AU - Male - Russell"},"en-GB_AP_Female_Amy":{gender:"Female",engine:"polly",params:["accessKey","secretKey","region"],language:"en-GB",ename:"Amy",ssml:!0,name:"AWS Polly - en-GB - Female - Amy"},"en-GB_AP_Male":{gender:"Male",engine:"polly",params:["accessKey","secretKey","region"],language:"en-GB",ename:"Brian",ssml:!0,name:"AWS Polly - en-GB - Male - Brian"},"en-GB_AP_Female_Emma":{gender:"Female",engine:"polly",params:["accessKey","secretKey","region"],language:"en-GB",ename:"Emma",ssml:!0,name:"AWS Polly - en-GB - Female - Emma"},"en-GB-WLS_AP_Female":{gender:"Female",engine:"polly",params:["accessKey","secretKey","region"],language:"en-GB-WLS",ename:"Gwyneth",ssml:!0,name:"AWS Polly - en-GB-WLS - Female - Gwyneth"},"en-GB-WLS_AP_Male":{gender:"Male",engine:"polly",params:["accessKey","secretKey","region"],language:"en-GB-WLS",ename:"Geraint",ssml:!0,name:"AWS Polly - en-GB-WLS - Male - Geraint"},"cy-GB_AP_Female":{gender:"Female",engine:"polly",params:["accessKey","secretKey","region"],language:"cy-GB",ename:"Gwyneth",ssml:!0,name:"AWS Polly - cy-GB - Female - Gwyneth"},"cy-GB_AP_Male":{gender:"Male",engine:"polly",params:["accessKey","secretKey","region"],language:"cy-GB",ename:"Geraint",ssml:!0,name:"AWS Polly - cy-GB - Male - Geraint"},"en-IN_AP_Female":{gender:"Female",engine:"polly",params:["accessKey","secretKey","region"],language:"en-IN",ename:"Raveena",ssml:!0,name:"AWS Polly - en-IN - Female - Raveena"},"en-US_AP_Male_Chipmunk":{gender:"Male",engine:"polly",params:["accessKey","secretKey","region"],language:"en-US",ename:"Chipmunk",ssml:!0,name:"AWS Polly - en-US - Male - Chipmunk"},"en-US_AP_Male_Eric":{gender:"Male",engine:"polly",params:["accessKey","secretKey","region"],language:"en-US",ename:"Eric",ssml:!0,name:"AWS Polly - en-US - Male - Eric"},"en-US_AP_Female_Ivy":{gender:"Female",engine:"polly",params:["accessKey","secretKey","region"],language:"en-US",ename:"Ivy",ssml:!0,name:"AWS Polly - en-US - Female - Ivy"},"en-US_AP_Female_Jennifer":{gender:"Female",engine:"polly",params:["accessKey","secretKey","region"],language:"en-US",ename:"Jennifer",ssml:!0,name:"AWS Polly - en-US - Female - Jennifer"},"en-US_AP_Male_Justin":{gender:"Male",engine:"polly",params:["accessKey","secretKey","region"],language:"en-US",ename:"Justin",ssml:!0,name:"AWS Polly - en-US - Male - Justin"},"en-US_AP_Female_Kendra":{gender:"Female",engine:"polly",params:["accessKey","secretKey","region"],language:"en-US",ename:"Kendra",ssml:!0,name:"AWS Polly - en-US - Female - Kendra"},"en-US_AP_Female_Kimberly":{gender:"Female",engine:"polly",params:["accessKey","secretKey","region"],language:"en-US",ename:"Kimberly",ssml:!0,name:"AWS Polly - en-US - Female - Kimberly"},"es-ES_AP_Female":{gender:"Female",engine:"polly",params:["accessKey","secretKey","region"],language:"es-ES",ename:"Conchita",ssml:!0,name:"AWS Polly - es-ES - Female - Conchita"},"es-ES_AP_Male":{gender:"Male",engine:"polly",params:["accessKey","secretKey","region"],language:"es-ES",ename:"Enrique",ssml:!0,name:"AWS Polly - es-ES - Male - Enrique"},"es-US_AP_Female":{gender:"Female",engine:"polly",params:["accessKey","secretKey","region"],language:"es-US",ename:"Penelope",ssml:!0,name:"AWS Polly - es-US - Female - Penelope"},"es-US_AP_Male":{gender:"Male",engine:"polly",params:["accessKey","secretKey","region"],language:"es-US",ename:"Miguel",ssml:!0,name:"AWS Polly - es-US - Male - Miguel"},"fr-CA_AP_Female":{gender:"Female",engine:"polly",params:["accessKey","secretKey","region"],language:"fr-CA",ename:"Chantal",ssml:!0,name:"AWS Polly - fr-CA - Female - Chantal"},"fr-FR_AP_Female":{gender:"Female",engine:"polly",params:["accessKey","secretKey","region"],language:"fr-FR",ename:"Celine",ssml:!0,name:"AWS Polly - fr-FR - Female - Celine"},"fr-FR_AP_Male":{gender:"Male",engine:"polly",params:["accessKey","secretKey","region"],language:"fr-FR",ename:"Mathieu",ssml:!0,name:"AWS Polly - fr-FR - Male - Mathieu"},"is-IS_AP_Female":{gender:"Female",engine:"polly",params:["accessKey","secretKey","region"],language:"is-IS",ename:"Dora",ssml:!0,name:"AWS Polly - is-IS - Female - Dora"},"is-IS_AP_Male":{gender:"Male",engine:"polly",params:["accessKey","secretKey","region"],language:"is-IS",ename:"Karl",ssml:!0,name:"AWS Polly - is-IS - Male - Karl"},"it-IT_AP_Female":{gender:"Female",engine:"polly",params:["accessKey","secretKey","region"],language:"it-IT",ename:"Carla",ssml:!0,name:"AWS Polly - it-IT - Female - Carla"},"it-IT_AP_Male":{gender:"Male",engine:"polly",params:["accessKey","secretKey","region"],language:"it-IT",ename:"Giorgio",ssml:!0,name:"AWS Polly - it-IT - Male - Giorgio"},"nb-NO_AP_Female":{gender:"Female",engine:"polly",params:["accessKey","secretKey","region"],language:"nb-NO",ename:"Liv",ssml:!0,name:"AWS Polly - nb-NO - Female - Liv"},"nl-NL_AP_Female":{gender:"Female",engine:"polly",params:["accessKey","secretKey","region"],language:"nl-NL",ename:"Lotte",ssml:!0,name:"AWS Polly - nl-NL - Female - Lotte"},"nl-NL_AP_Male":{gender:"Male",engine:"polly",params:["accessKey","secretKey","region"],language:"nl-NL",ename:"Ruben",ssml:!0,name:"AWS Polly - nl-NL - Male - Ruben"},"pl-PL_AP_Female_Agnieszka":{gender:"Female",engine:"polly",params:["accessKey","secretKey","region"],language:"pl-PL",ename:"Agnieszka",ssml:!0,name:"AWS Polly - pl-PL - Female - Agnieszka"},"pl-PL_AP_Male_Jacek":{gender:"Male",engine:"polly",params:["accessKey","secretKey","region"],language:"pl-PL",ename:"Jacek",ssml:!0,name:"AWS Polly - pl-PL - Male - Jacek"},"pl-PL_AP_Female_Ewa":{gender:"Female",engine:"polly",params:["accessKey","secretKey","region"],language:"pl-PL",ename:"Ewa",ssml:!0,name:"AWS Polly - pl-PL - Female - Ewa"},"pl-PL_AP_Male_Jan":{gender:"Male",engine:"polly",params:["accessKey","secretKey","region"],language:"pl-PL",ename:"Jan",ssml:!0,name:"AWS Polly - pl-PL - Male - Jan"},"pl-PL_AP_Female":{gender:"Female",engine:"polly",params:["accessKey","secretKey","region"],language:"pl-PL",ename:"Maja",ssml:!0,name:"AWS Polly - pl-PL - Female - Maja"},"pt-BR_AP_Female":{gender:"Female",engine:"polly",params:["accessKey","secretKey","region"],language:"pt-BR",ename:"Vitoria",ssml:!0,name:"AWS Polly - pt-BR - Female - Vitoria"},"pt-BR_AP_Male":{gender:"Male",engine:"polly",params:["accessKey","secretKey","region"],language:"pt-BR",ename:"Ricardo",ssml:!0,name:"AWS Polly - pt-BR - Male - Ricardo"},"pt-PT_AP_Male":{gender:"Male",engine:"polly",params:["accessKey","secretKey","region"],language:"pt-PT",ename:"Cristiano",ssml:!0,name:"AWS Polly - pt-PT - Male - Cristiano"},"pt-PT_AP_Female":{gender:"Female",engine:"polly",params:["accessKey","secretKey","region"],language:"pt-PT",ename:"Ines",ssml:!0,name:"AWS Polly - pt-PT - Female - Ines"},"ro-RO_AP_Female":{gender:"Female",engine:"polly",params:["accessKey","secretKey","region"],language:"ro-RO",ename:"Carmen",ssml:!0,name:"AWS Polly - ro-RO - Female - Carmen"},"sv-SE_AP_Female":{gender:"Female",engine:"polly",params:["accessKey","secretKey","region"],language:"sv-SE",ename:"Astrid",ssml:!0,name:"AWS Polly - sv-SE - Female - Astrid"},"tr-TR_AP_Female":{gender:"Female",engine:"polly",params:["accessKey","secretKey","region"],language:"tr-TR",ename:"Filiz",ssml:!0,name:"AWS Polly - tr-TR - Female - Filiz"}};class Pv extends ln{constructor(n){super(n,Pv.getStaticData())}static compile(n,s){return n.text?`// Sayit ${n.text||""}
		const subActionVar${n._id} = "${n.language&&n.language!=="_"?`${n.language};`:""}${n.volume?`${n.volume};`:""}${(n.text||"").replace(/"/g,'\\"')}"${ln.getReplacesInText(s)};
		_sendToFrontEnd(${n._id}, {text: subActionVar${n._id}});
		await setStateAsync("${n.instance}.tts.text", subActionVar${n._id});`:`// no text defined
_sendToFrontEnd(${n._id}, {text: 'No text defined'});`}renderDebug(n){return`${I.I18n.t("Say:")} ${n.data.text}`}onTagChange(){const n=I.I18n.getLanguage(),i=Object.keys(HC).filter(a=>a.startsWith(n)).map(a=>({title:HC[a].name,value:a}));i.unshift({title:"Default",value:"_"}),this.setState({inputs:[{attr:"instance",nameRender:"renderInstance",adapter:"sayit",defaultValue:"sayit.0",frontText:"Instance:"},{nameRender:"renderSelect",frontText:"Language:",options:i,defaultValue:"_",attr:"language"},{nameRender:"renderNameText",defaultValue:"Volume",attr:"textVol"},{nameRender:"renderSlider",attr:"volume",defaultValue:100,min:0,max:100},{attr:"text",nameRender:"renderModalInput",defaultValue:"Hallo",nameBlock:"",frontText:"Text:"}]},()=>super.onTagChange())}static getStaticData(){return{acceptedBy:"actions",name:"Say It",id:"ActionSayText",adapter:"sayit",title:"Say some text via sayit adapter",helpDialog:"You can use %s in the text to display current trigger value or %id to display the triggered object ID"}}getData(){return Pv.getStaticData()}}class Fv extends ln{constructor(n){super(n,Fv.getStaticData())}static compile(n,s){return n.recipients?`// Send Email ${n.text||""}
		const subActionVar${n._id} = "${(n.text||"").replace(/"/g,'\\"')}"${ln.getReplacesInText(s)};
		_sendToFrontEnd(${n._id}, {text: subActionVar${n._id}});
		sendTo("${n.instance||"email.0"}", {
		    to:      "${n.recipients||""}",
		    subject: "${(n.subject||"ioBroker").replace(/"/g,'\\"')}"${ln.getReplacesInText(s)},
		    text:    subActionVar${n._id}
		});`:`// no recipients defined'
_sendToFrontEnd(${n._id}, {text: 'No recipients defined'});`}renderDebug(n){return`${I.I18n.t("Sent:")} ${n.data.text}`}onTagChange(){this.setState({inputs:[{attr:"instance",nameRender:"renderInstance",defaultValue:"email.0",frontText:"Instance:",adapter:"email"},{attr:"recipients",nameRender:"renderText",defaultValue:"user@mail.ru",frontText:"To:"},{attr:"subject",nameRender:"renderText",defaultValue:"Email from iobroker",nameBlock:"",frontText:"Subject:"},{attr:"text",nameRender:"renderModalInput",defaultValue:"Email from iobroker",nameBlock:"",frontText:"Body:"}]},()=>super.onTagChange())}static getStaticData(){return{acceptedBy:"actions",name:"Send email",id:"ActionSendEmail",adapter:"email",title:"Sends an email",helpDialog:"You can use %s in the text to display current trigger value or %id to display the triggered object ID"}}getData(){return Fv.getStaticData()}}class jv extends ln{constructor(n){super(n,jv.getStaticData())}static compile(n,s){const i=(n.text||"").replace(/"/g,'\\"');return i?`// Pushover ${n.text||""}
		const subActionVar${n._id} = "${i}"${ln.getReplacesInText(s)};
		_sendToFrontEnd(${n._id}, {text: subActionVar${n._id}});            
		sendTo("${n.instance}", "send", {
		    message: subActionVar${n._id},
		    title: "${(n.title||"").replace(/"/g,'\\"')}"${ln.getReplacesInText(s)},
		    sound: "${n.sound}",
		    priority: ${n.priority}
		});`:`// no text defined
_sendToFrontEnd(${n._id}, {text: 'No text defined'});`}renderDebug(n){return`Sent: ${n.data.text}`}onTagChange(){this.setState({inputs:[{nameRender:"renderInstance",adapter:"pushover",frontText:"Instance:",defaultValue:"pushover.0",attr:"instance"},{nameRender:"renderModalInput",attr:"text",defaultValue:"Hello",nameBlock:"",frontText:"Text:"},{nameRender:"renderText",attr:"title",defaultValue:"ioBroker",frontText:"Title:"},{nameRender:"renderSelect",attr:"sound",defaultValue:"magic",frontText:"Sound:",doNotTranslate:!0,options:[{value:"pushover",title:"pushover"},{value:"bike",title:"bike"},{value:"bugle",title:"bugle"},{value:"cashregister",title:"cashregister"},{value:"classical",title:"classical"},{value:"cosmic",title:"cosmic"},{value:"falling",title:"falling"},{value:"gamelan",title:"gamelan"},{value:"incoming",title:"incoming"},{value:"intermission",title:"intermission"},{value:"magic",title:"magic"},{value:"mechanical",title:"mechanical"},{value:"pianobar",title:"pianobar"},{value:"siren",title:"siren"},{value:"spacealarm",title:"spacealarm"},{value:"tugboat",title:"tugboat"},{value:"alien",title:"alien"},{value:"climb",title:"climb"},{value:"persistent",title:"persistent"},{value:"echo",title:"echo"},{value:"updown",title:"updown"},{value:"none",title:"none"}]},{nameRender:"renderSelect",attr:"priority",defaultValue:-1,frontText:"Priority:",options:[{value:-1,title:"quiet"},{value:0,title:"normal"},{value:1,title:"high-priority"},{value:2,title:"acknowledgment"}]}]},()=>super.onTagChange())}static getStaticData(){return{acceptedBy:"actions",name:"Pushover",id:"ActionPushover",adapter:"pushover",title:"Sends message via pushover",helpDialog:"You can use %s in the text to display current trigger value or %id to display the triggered object ID"}}getData(){return jv.getStaticData()}}class zv extends ln{constructor(n){super(n,zv.getStaticData())}static compile(n,s){const i=(n.text||"").replace(/"/g,'\\"');return i?`// whatsapp ${i||""}
		const subActionVar${n._id} = "${(i||"").replace(/"/g,'\\"')}"${ln.getReplacesInText(s)};
		_sendToFrontEnd(${n._id}, {text: subActionVar${n._id}});
		sendTo("${n.instance}", "send", {text: subActionVar${n._id}${n.phone?`, phone: "${n.phone.replace(/"/g,'\\"')}"`:""}});`:`// no text defined
_sendToFrontEnd(${n._id}, {text: 'No text defined'});`}renderDebug(n){return`${I.I18n.t("Sent:")} ${n.data.text}`}onTagChange(){this.setState({inputs:[{nameRender:"renderInstance",adapter:"whatsapp-cmb",frontText:"Instance:",defaultValue:"whatsapp-cmb.0",attr:"instance"},{nameRender:"renderModalInput",attr:"text",defaultValue:"Hello",nameBlock:"",frontText:"Text:"},{nameRender:"renderText",attr:"phone",defaultValue:"",frontText:"Phone:",backText:"(optional)"}]},()=>super.onTagChange())}static getStaticData(){return{acceptedBy:"actions",name:"Whatsapp-cmb",id:"ActionWhatsappcmb",adapter:"whatsapp-cmb",title:"Sends message via whatsapp-cmb",helpDialog:"You can use %s in the text to display current trigger value or %id to display the triggered object ID"}}getData(){return zv.getStaticData()}}class Uv extends ln{constructor(n){super(n,Uv.getStaticData())}static compile(n,s){const i=(n.text||"").replace(/"/g,'\\"');return i?`// Pushsafer ${n.text||""}
		const subActionVar${n._id} = "${i}"${ln.getReplacesInText(s)};
		_sendToFrontEnd(${n._id}, {text: subActionVar${n._id}});            
		sendTo("${n.instance}", "send", {
		    message: subActionVar${n._id},
		    title: "${(n.title||"").replace(/"/g,'\\"')}"${ln.getReplacesInText(s)},
		    ${n.sound&&n.sound!=="_"?`sound: "${n.sound}",`:""}
		    priority: ${n.priority},
		    ${n.vibration&&n.vibration!=="_"?`vibration: ${n.vibration},`:""}
		});`:`// no text defined
_sendToFrontEnd(${n._id}, {text: 'No text defined'});`}renderDebug(n){return`Sent: ${n.data.text}`}onTagChange(){this.setState({inputs:[{nameRender:"renderInstance",adapter:"pushsafer",frontText:"Instance:",defaultValue:"pushsafer.0",attr:"instance"},{nameRender:"renderModalInput",attr:"text",defaultValue:"Hello",nameBlock:"",frontText:"Text:"},{nameRender:"renderText",attr:"title",defaultValue:"ioBroker",frontText:"Title:"},{nameRender:"renderSelect",attr:"sound",defaultValue:"magic",frontText:"Sound:",doNotTranslate:!0,options:[{value:"_",title:"Device Default"},{value:"0",title:"Silent"},{value:"1",title:"Ahem (IM)"},{value:"2",title:"Applause (Mail)"},{value:"3",title:"Arrow (Reminder)"},{value:"4",title:"Baby (SMS)"},{value:"5",title:"Bell (Alarm)"},{value:"6",title:"Bicycle (Alarm2)"},{value:"7",title:"Boing (Alarm3)"},{value:"8",title:"Buzzer (Alarm4)"},{value:"9",title:"Camera (Alarm5)"},{value:"10",title:"Car Horn (Alarm6)"},{value:"11",title:"Cash Register (Alarm7)"},{value:"12",title:"Chime (Alarm8)"},{value:"13",title:"Creaky Door (Alarm9)"},{value:"14",title:"Cuckoo Clock (Alarm10)"},{value:"15",title:"Disconnect (Call)"},{value:"16",title:"Dog (Call2)"},{value:"17",title:"Doorbell (Call3)"},{value:"18",title:"Fanfare (Call4)"},{value:"19",title:"Gun Shot (Call5)"},{value:"20",title:"Honk (Call6)"},{value:"21",title:"Jaw Harp (Call7)"},{value:"22",title:"Morse (Call8)"},{value:"23",title:"Electricity (Call9)"},{value:"24",title:"Radio Tuner (Call10)"},{value:"25",title:"Sirens"},{value:"26",title:"Military Trumpets"},{value:"27",title:"Ufo"},{value:"28",title:"Whah Whah Whah"},{value:"29",title:"Man Saying Goodbye"},{value:"30",title:"Man Saying Hello"},{value:"31",title:"Man Saying No"},{value:"32",title:"Man Saying Ok"},{value:"33",title:"Man Saying Ooohhhweee"},{value:"34",title:"Man Saying Warning"},{value:"35",title:"Man Saying Welcome"},{value:"36",title:"Man Saying Yeah"},{value:"37",title:"Man Saying Yes"},{value:"38",title:"Beep short"},{value:"39",title:"Weeeee short"},{value:"40",title:"Cut in and out short"},{value:"41",title:"Finger flicking glas short"},{value:"42",title:"Wa Wa Waaaa short"},{value:"43",title:"Laser short"},{value:"44",title:"Wind Chime short"},{value:"45",title:"Echo short"},{value:"46",title:"Zipper short"},{value:"47",title:"HiHat short"},{value:"48",title:"Beep 2 short"},{value:"49",title:"Beep 3 short"},{value:"50",title:"Beep 4 short"},{value:"51",title:"The Alarm is armed"},{value:"52",title:"The Alarm is disarmed"},{value:"53",title:"The Backup is ready"},{value:"54",title:"The Door is closed"},{value:"55",title:"The Door is opend"},{value:"56",title:"The Window is closed"},{value:"57",title:"The Window is open"},{value:"58",title:"The Light is off"},{value:"59",title:"The Light is on"},{value:"60",title:"The Doorbell rings"},{value:"61",title:"Pager short"},{value:"62",title:"Pager long"}]},{nameRender:"renderSelect",attr:"priority",defaultValue:0,frontText:"Priority:",options:[{value:-2,title:"lowest priority"},{value:-1,title:"lower priority"},{value:0,title:"normal priority"},{value:1,title:"high priority"},{value:2,title:"highest priority"}]},{nameRender:"renderSelect",attr:"vibration",defaultValue:0,frontText:"Vibration:",options:[{value:"_",title:"default"},{value:1,title:"1"},{value:2,title:"2"},{value:3,title:"3"}]}]},()=>super.onTagChange())}static getStaticData(){return{acceptedBy:"actions",name:"Pushsafer",id:"ActionPushsafer",adapter:"pushsafer",title:"Sends message via Pushsafer",helpDialog:"You can use %s in the text to display current trigger value or %id to display the triggered object ID"}}getData(){return Uv.getStaticData()}}const Pk=`async function (obj) {
    "__%%DEBUG_TRIGGER%%__";
    __%%CONDITIONS_VARS%%__
    const _cond = __%%CONDITION%%__;
    
    "__%%DEBUG_CONDITIONS%%__";
    
    if (_cond) {
__%%THEN%%__
    } else {
__%%ELSE%%__
    }
}`,Fk=`async function (obj) {
    "__%%DEBUG_TRIGGER%%__";
    __%%CONDITIONS_VARS%%__
    const _cond = __%%CONDITION%%__;
    
    "__%%DEBUG_CONDITIONS%%__";
    
    if (__%%STATE%%__ === false && _cond) {
        __%%STATE%%__ = true;    
__%%THEN%%__
    } else if (__%%STATE%%__ === true && !_cond) {
        __%%STATE%%__ = false;    
__%%ELSE%%__
    }
}`,EB=`"__%%DEBUG_TRIGGER%%__";
__%%CONDITIONS_VARS%%__
const _cond = __%%CONDITION%%__;

"__%%DEBUG_CONDITIONS%%__";

if (_cond) {
__%%THEN%%__
} else {
__%%ELSE%%__
}`,x_={triggers:[],conditions:[[]],justCheck:!1,actions:{then:[],else:[]}};function kB(o,n,s){const i=[];let a=o.triggers;a.length||(a=[{id:"TriggerScriptSave"}]);const c=[],h=[],g=o.conditions.find($=>$.find(y=>y.tagCard==="()"));a.forEach(($,y)=>{var C;const w=$S($.id,s);if(w){const S={trigger:$,condition:{index:0},justCheck:g?!1:o.justCheck||!o.conditions.length||!o.conditions[0].length,conditionsDebug:[],conditionsVars:[],conditionsStates:[]},k=w.compile($,S),E=IB(o.conditions,S,s),R=WC(o.actions.then,S,s),F=WC(o.actions.else,S,s);c.push(`cond${y}`),(C=S.prelines)!=null&&C.length&&S.prelines.forEach(M=>h.push(M)),k.includes("    __%%CONDITIONS_VARS%%__")&&(S.conditionsVars=S.conditionsVars.map((M,L)=>L?`    ${M}`:M),S.conditionsDebug=S.conditionsDebug.map((M,L)=>L?`    ${M}`:M)),i.push(k.replace("__%%CONDITIONS_VARS%%__",S.conditionsVars.join(`
`)).replace('"__%%DEBUG_CONDITIONS%%__";',S.conditionsDebug.join(`
`)).replace("__%%CONDITION%%__",E).replace("__%%THEN%%__",R||"// ignore").replace("__%%ELSE%%__",F||"// ignore").replace(/__%%STATE%%__/g,`cond${y}`))}});let b=i.join(`

`);return(!o.justCheck||g)&&(b=`${c.map($=>`let ${$} = false;`).join(`
`)}

${b}`),b=`${h.join(`
`)}

${b}`,b}function $S(o,n){return n.find(s=>s.getStaticData&&s.getStaticData().id===o)}function WC(o,n,s){const i=[];return o==null||o.forEach(a=>{const c=$S(a.id,s);c&&i.push(c.compile(a,n))}),`		${i.join(`

		`)}`}function IB(o,n,s){const i=[];let a=0;return o==null||o.forEach(c=>{const h=[];c==null||c.forEach(g=>{const b=$S(g.id,s);b&&(n.condition.index=a++,h.push(b.compile(g,n)))}),i.push(`(${h.join(`) &&
                  (`)})`)}),i.length?i.length===1?i[0]||"true":`(${i.join(") || (")})`:"true"}function xB(o,n){return kB(o,null,n)}function VC(o){if(!o)return x_;const n=o.split(`
`);try{const s=(n.pop()||"").replace(/^\/\//,"");let i=JSON.parse(s);return i.triggers||(i=x_),i}catch{return x_}}function DB(o,n){let s="";const i=xB(o,n);return s+=i,s+=`
/*
const demo = ${JSON.stringify(o,null,2).replace(/\*\//g,"* /")};
*/
`,`${s}
//${JSON.stringify(o)}`}class Hv extends ln{constructor(n){super(n,Hv.getStaticData())}static compile(n,s){return EB.replace('"__%%DEBUG_TRIGGER%%__"',`_sendToFrontEnd(${n._id}, {trigger: true})`)}renderDebug(){return I.I18n.t("Triggered")}onTagChange(n){this.setState({inputs:[{nameRender:"renderNameText",defaultValue:"On script save or adapter start",attr:"script"}]},()=>super.onTagChange())}static getStaticData(){return{acceptedBy:"triggers",name:"Start script",id:"TriggerScriptSave",icon:"PlayArrow",title:"Triggers the on script saving or the javascript instance restart"}}getData(){return Hv.getStaticData()}}var jk={exports:{}};(function(o,n){(function(){var s=Math.PI,i=Math.sin,a=Math.cos,c=Math.tan,h=Math.asin,g=Math.atan2,b=Math.acos,$=s/180,y=1e3*60*60*24,w=2440588,C=2451545;function S(pe){return pe.valueOf()/y-.5+w}function k(pe){return new Date((pe+.5-w)*y)}function E(pe){return S(pe)-C}var R=$*23.4397;function F(pe,Te){return g(i(pe)*a(R)-c(Te)*i(R),a(pe))}function M(pe,Te){return h(i(Te)*a(R)+a(Te)*i(R)*i(pe))}function L(pe,Te,ke){return g(i(pe),a(pe)*i(Te)-c(ke)*a(Te))}function T(pe,Te,ke){return h(i(Te)*i(ke)+a(Te)*a(ke)*a(pe))}function V(pe,Te){return $*(280.16+360.9856235*pe)-Te}function K(pe){return pe<0&&(pe=0),2967e-7/Math.tan(pe+.00312536/(pe+.08901179))}function Y(pe){return $*(357.5291+.98560028*pe)}function te(pe){var Te=$*(1.9148*i(pe)+.02*i(2*pe)+3e-4*i(3*pe)),ke=$*102.9372;return pe+Te+ke+s}function J(pe){var Te=Y(pe),ke=te(Te);return{dec:M(ke,0),ra:F(ke,0)}}var ne={};ne.getPosition=function(pe,Te,ke){var Xe=$*-ke,Ke=$*Te,at=E(pe),Ue=J(at),ut=V(at,Xe)-Ue.ra;return{azimuth:L(ut,Ke,Ue.dec),altitude:T(ut,Ke,Ue.dec)}};var Q=ne.times=[[-.833,"sunrise","sunset"],[-.3,"sunriseEnd","sunsetStart"],[-6,"dawn","dusk"],[-12,"nauticalDawn","nauticalDusk"],[-18,"nightEnd","night"],[6,"goldenHourEnd","goldenHour"]];ne.addTime=function(pe,Te,ke){Q.push([pe,Te,ke])};var he=9e-4;function q(pe,Te){return Math.round(pe-he-Te/(2*s))}function re(pe,Te,ke){return he+(pe+Te)/(2*s)+ke}function De(pe,Te,ke){return C+pe+.0053*i(Te)-.0069*i(2*ke)}function ee(pe,Te,ke){return b((i(pe)-i(Te)*i(ke))/(a(Te)*a(ke)))}function Fe(pe,Te,ke,Xe,Ke,at,Ue){var ut=ee(pe,ke,Xe),rt=re(ut,Te,Ke);return De(rt,at,Ue)}ne.getTimes=function(pe,Te,ke){var Xe=$*-ke,Ke=$*Te,at=E(pe),Ue=q(at,Xe),ut=re(0,Xe,Ue),rt=Y(ut),tt=te(rt),It=M(tt,0),Yt=De(ut,rt,tt),Ut,Fn,Xt,en,Ot,Lt={solarNoon:k(Yt),nadir:k(Yt+.5)};for(Ut=0,Fn=Q.length;Ut<Fn;Ut+=1)Xt=Q[Ut],en=Fe(Xt[0]*$,Xe,Ke,It,Ue,rt,tt),Ot=Yt-(en-Yt),Lt[Xt[1]]=k(Ot),Lt[Xt[2]]=k(en);return Lt};function Ce(pe){var Te=$*(218.316+13.176396*pe),ke=$*(134.963+13.064993*pe),Xe=$*(93.272+13.22935*pe),Ke=Te+$*6.289*i(ke),at=$*5.128*i(Xe),Ue=385001-20905*a(ke);return{ra:F(Ke,at),dec:M(Ke,at),dist:Ue}}ne.getMoonPosition=function(pe,Te,ke){var Xe=$*-ke,Ke=$*Te,at=E(pe),Ue=Ce(at),ut=V(at,Xe)-Ue.ra,rt=T(ut,Ke,Ue.dec),tt=g(i(ut),c(Ke)*a(Ue.dec)-i(Ue.dec)*a(ut));return rt=rt+K(rt),{azimuth:L(ut,Ke,Ue.dec),altitude:rt,distance:Ue.dist,parallacticAngle:tt}},ne.getMoonIllumination=function(pe){var Te=E(pe||new Date),ke=J(Te),Xe=Ce(Te),Ke=149598e3,at=b(i(ke.dec)*i(Xe.dec)+a(ke.dec)*a(Xe.dec)*a(ke.ra-Xe.ra)),Ue=g(Ke*i(at),Xe.dist-Ke*a(at)),ut=g(a(ke.dec)*i(ke.ra-Xe.ra),i(ke.dec)*a(Xe.dec)-a(ke.dec)*i(Xe.dec)*a(ke.ra-Xe.ra));return{fraction:(1+a(Ue))/2,phase:.5+.5*Ue*(ut<0?-1:1)/Math.PI,angle:ut}};function Ze(pe,Te){return new Date(pe.valueOf()+Te*y/24)}ne.getMoonTimes=function(pe,Te,ke,Xe){var Ke=new Date(pe);Xe?Ke.setUTCHours(0,0,0,0):Ke.setHours(0,0,0,0);for(var at=.133*$,Ue=ne.getMoonPosition(Ke,Te,ke).altitude-at,ut,rt,tt,It,Yt,Ut,Fn,Xt,en,Ot,Lt,vn,Ln,He=1;He<=24&&(ut=ne.getMoonPosition(Ze(Ke,He),Te,ke).altitude-at,rt=ne.getMoonPosition(Ze(Ke,He+1),Te,ke).altitude-at,Yt=(Ue+rt)/2-ut,Ut=(rt-Ue)/2,Fn=-Ut/(2*Yt),Xt=(Yt*Fn+Ut)*Fn+ut,en=Ut*Ut-4*Yt*ut,Ot=0,en>=0&&(Ln=Math.sqrt(en)/(Math.abs(Yt)*2),Lt=Fn-Ln,vn=Fn+Ln,Math.abs(Lt)<=1&&Ot++,Math.abs(vn)<=1&&Ot++,Lt<-1&&(Lt=vn)),Ot===1?Ue<0?tt=He+Lt:It=He+Lt:Ot===2&&(tt=He+(Xt<0?vn:Lt),It=He+(Xt<0?Lt:vn)),!(tt&&It));He+=2)Ue=rt;var Ft={};return tt&&(Ft.rise=Ze(Ke,tt)),It&&(Ft.set=Ze(Ke,It)),!tt&&!It&&(Ft[Xt>0?"alwaysUp":"alwaysDown"]=!0),Ft},o.exports=ne})()})(jk);var OB=jk.exports;const zk=aa(OB),RB='{"time":{"start":"00:00","end":"24:00","mode":"hours","interval":1},"period":{"days":1}}';class xu extends ln{coordinates=null;constructor(n){super(n,xu.getStaticData())}static compile(n,s){var c;let i="",a=s.justCheck?Pk:Fk;if(a=a.replace('"__%%DEBUG_TRIGGER%%__"',`_sendToFrontEnd(${n._id}, {trigger: true})`),n.tagCard==="interval")i=`setInterval(${a}, ${n.interval||1} * ${n.unit==="s"?1e3:n.unit==="m"?6e4:36e5});`;else if(n.tagCard==="cron")i=`schedule("${n.cron}", ${a});`;else if(n.tagCard==="at"){const[h,g]=(n.at||"").split(":");let b="*";if((c=n==null?void 0:n.dow)!=null&&c.length&&!n.dow.includes("_")){const $=[...n.dow].map(S=>parseInt(S,10));$.sort();const y=[];let w=$[0],C=1;for(;C<$.length;C++)$[C]-$[C-1]>1?(w===$[C-1]?y.push(w.toString()):$[C-1]-w===1?y.push(`${w},${$[C-1]}`):y.push(`${w}-${$[C-1]}`),w=$[C]):C===$.length-1&&(w===$[C-1]||$[C]-w===1?y.push(`${w},${$[C]}`):y.push(`${w}-${$[C]}`));b=y.join(",")}i=`schedule("${g||"0"} ${h||"0"} * * ${b}", ${a});`}else n.tagCard==="astro"?i=`schedule({astro: "${n.astro}", shift: ${n.offset?n.offsetValue:0}}, ${a});`:n.tagCard==="wizard"&&(i=`schedule('${n.wizard}', ${a});`);return i}static _time2String(n){return n?`${n.getHours().toString().padStart(2,"0")}:${n.getMinutes().toString().padStart(2,"0")}`:"--:--"}async _setAstro(n,s,i){var b,$;if(n=n||this.state.settings.astro||"solarNoon",s=s===void 0?this.state.settings.offset:s,i=i===void 0?this.state.settings.offsetValue:i,i=parseInt(i,10)||0,!this.coordinates){const y=await this.props.socket.getObject("system.adapter.javascript.0"),w=(b=y==null?void 0:y.native)==null?void 0:b.latitude,C=($=y==null?void 0:y.native)==null?void 0:$.longitude;if(!w&&!C){const S=await this.props.socket.getObject("system.config");S!=null&&S.common&&(S.common.latitude||S.common.longitude)?this.coordinates={latitude:parseFloat(S.common.latitude),longitude:parseFloat(S.common.longitude)}:this.coordinates=null}else this.coordinates={latitude:parseFloat(w),longitude:parseFloat(C)}}const a=this.coordinates&&zk.getTimes(new Date,this.coordinates.latitude,this.coordinates.longitude),c=a?Object.keys(a).map(y=>({value:y,title:y,title2:`[${xu._time2String(a[y])}]`,order:a?xu._time2String(a[y]):"??:??"})):[];c.sort((y,w)=>y.order>w.order?1:y.order<w.order?-1:0);let h="--:--";if(n&&a&&a[n]){const y=new Date(a[n]);s&&y.setMinutes(y.getMinutes()+parseInt(i,10)),h=`(at ${xu._time2String(y)})`}let g;s?g=[{frontText:"at",attr:"astro",nameRender:"renderSelect",options:c,defaultValue:"solarNoon"},{backText:"with offset",nameRender:"renderCheckbox",attr:"offset"},{backText:i===1?"minute":"minutes",frontText:"offset",nameRender:"renderNumber",defaultValue:0,attr:"offsetValue",noHelperText:!0},{nameRender:"renderNameText",attr:"textTime",defaultValue:h}]:g=[{frontText:"at",attr:"astro",nameRender:"renderSelect",options:c,defaultValue:"solarNoon"},{backText:"with offset",nameRender:"renderCheckbox",attr:"offset"},{nameRender:"renderNameText",attr:"textTime1",defaultValue:h}],this.setState({inputs:g},()=>super.onTagChange())}_setInterval(n){n=parseInt(n||this.state.settings.interval,10)||30;let s;n===1?s=[{value:"s",title:"second"},{value:"m",title:"minute"},{value:"h",title:"hour"}]:s=[{value:"s",title:"seconds"},{value:"m",title:"minutes"},{value:"h",title:"hours"}],this.setState({inputs:[{nameRender:"renderNumber",attr:"interval",frontText:"every",defaultValue:30,className:"block-input-interval"},{nameRender:"renderSelect",attr:"unit",defaultValue:"s",options:s}]},()=>super.onTagChange())}renderDebug(n){return I.I18n.t("Triggered")}onValueChanged(n,s){this.state.settings.tagCard==="astro"?s==="astro"?this._setAstro(n):s==="offset"?this._setAstro(void 0,n):s==="offsetValue"&&this._setAstro(void 0,void 0,n):this.state.settings.tagCard==="interval"&&s==="interval"&&this._setInterval(n)}renderCron(n,s,i){const{className:a}=this.props;let c="";const{settings:h}=this.state,{attr:g}=n;return f.jsxs("div",{children:[f.jsxs("div",{style:{display:"flex",alignItems:"baseline"},children:[f.jsx("div",{style:{width:"100%"},children:this.renderText({nameRender:"renderText",attr:g,defaultValue:s},h[g]?h[g]:s,i)}),f.jsx(em,{square:!0,style:{marginLeft:7},value:"...",className:a,onClick:()=>this.setState({openDialog:!0})})]}),this.state.openDialog?f.jsx(Tw,{onApply:()=>{i(c,g,()=>{i(I.convertCronToText(c,I.I18n.getLanguage()),"addText"),this.setState({openDialog:!1})})},onClose:()=>this.setState({openDialog:!1}),children:f.jsx(I.ComplexCron,{cronExpression:h[g]?h[g]:"",onChange:b=>c=b,language:I.I18n.getLanguage()})}):null,this.renderNameText({nameRender:"renderNameText",defaultValue:I.I18n.t("every hour at 0 minutes"),attr:"addText",signature:!0,doNotTranslate:!0},h.addText?h.addText:I.I18n.t("every hour at 0 minutes"))]},g)}renderWizard(n,s,i){const{className:a}=this.props,{attr:c}=n;let h="",g=null;return f.jsxs("div",{children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",marginTop:7},children:[f.jsx(hc,{className:a,autoComplete:"off",fullWidth:!0,variant:"outlined",size:"small",multiline:!0,rows:2,value:this.state.settings[`${c}Text`],onChange:b=>i(b),customValue:!0}),f.jsx(em,{square:!0,style:{marginLeft:7},value:"...",className:a,onClick:()=>this.setState({openDialog:!0})})]}),this.state.openDialog?f.jsx(Tw,{onApply:()=>this.setState({openDialog:!1},()=>i({[`${c}Text`]:h,[c]:g})),onClose:()=>this.setState({openDialog:!1}),children:f.jsx(I.Schedule,{theme:this.props.theme,schedule:s,onChange:(b,$)=>{h=$||"";const y=JSON.parse(b);y.valid=y.valid||{},y.valid.from=y.valid.from||I.Schedule.now2string(),g=JSON.stringify(y)}})}):null]},c)}onTagChange(n){switch(n=n||this.state.settings.tagCard,n){case"interval":this._setInterval();break;case"cron":this.setState({inputs:[{nameRender:"renderCron",attr:"cron",defaultValue:"0 * * * *"}]},()=>super.onTagChange());break;case"wizard":{const s=JSON.parse(RB);s.valid=s.valid||{},s.valid.from=s.valid.from||I.Schedule.now2string(),this.setState({inputs:[{nameRender:"renderWizard",attr:"wizard",defaultValue:JSON.stringify(s)}]},()=>super.onTagChange(null,()=>{const i=I.Schedule.state2text(this.state.settings.wizard||s);if(this.state.settings.wizard!==i){const a=JSON.parse(JSON.stringify(this.state.settings));a.wizardText=i,this.setState({settings:a}),this.props.onChange(a)}}));break}case"at":this.setState({inputs:[{nameRender:"renderTime",prefix:"at",attr:"at",defaultValue:"07:30"},{nameRender:"renderSelect",attr:"dow",default:"",multiple:!0,defaultValue:["_","1","2","3","4","5","6","0"],options:[{value:"_",title:"Every day",only:!0},{value:"1",title:"Monday",titleShort:"Mo"},{value:"2",title:"Tuesday",titleShort:"Tu"},{value:"3",title:"Wednesday",titleShort:"We"},{value:"4",title:"Thursday",titleShort:"Th"},{value:"5",title:"Friday",titleShort:"Fr"},{value:"6",title:"Saturday",titleShort:"Sa"},{value:"0",title:"Sunday",titleShort:"Su"}]}]},()=>super.onTagChange());break;case"astro":this._setAstro();break}}static getStaticData(){return{acceptedBy:"triggers",name:"Schedule",id:"TriggerScheduleBlock",icon:"AccessTime",tagCardArray:["cron","wizard","interval","at","astro"],title:"Triggers the rule periodically or on some specific time"}}getData(){return xu.getStaticData()}}const Mh={valueAck:{color:"#b02323"},valueNotAck:{color:"#12ac15"}},Uk=Le.forwardRef((o,n)=>f.jsx(D.Slide,{direction:"up",ref:n,...o}));Uk.displayName="Transition";class Wv extends ln{inputRef;constructor(n){super(n,Wv.getStaticData()),this.inputRef=Le.createRef()}static compile(n,s){let i=s.justCheck?Pk:Fk;return i=i.replace('"__%%DEBUG_TRIGGER%%__"',`_sendToFrontEnd(${n._id}, {val: obj.state.val, ack: obj.state.ack, valOld: obj.oldState && obj.oldState.val, ackOld: obj.oldState && obj.oldState.ack})`),`on({id: "${n.oid||""}", change: "${n.tagCard==="on update"?"any":"ne"}"}, ${i});`}renderDebug(n){return n.data.valOld!==void 0?f.jsxs("span",{children:[I.I18n.t("Triggered")," ",f.jsx("span",{style:n.data.ackOld?Mh.valueAck:Mh.valueNotAck,children:Yh(n.data.valOld)})," ","→"," ",f.jsx("span",{style:n.data.ack?Mh.valueAck:Mh.valueNotAck,children:Yh(n.data.val)})]}):f.jsxs("span",{children:[I.I18n.t("Triggered")," ",f.jsx("span",{style:n.data.ack?Mh.valueAck:Mh.valueNotAck,children:Yh(n.data.val)})]})}onWriteValue(){this.setState({openSimulate:!1});let n=this.state.simulateValue;window.localStorage.setItem(`javascript.app.${this.state.settings.oid}_ack`,this.state.simulateAck?"true":"false"),this.state.settings.oidType==="boolean"?(n=n===!0||n==="true"||n==="1",window.localStorage.setItem(`javascript.app.${this.state.settings.oid}`,n?"true":"false")):this.state.settings.oidType==="number"?(n=parseFloat(n)||0,window.localStorage.setItem(`javascript.app.${this.state.settings.oid}`,n.toString())):window.localStorage.setItem(`javascript.app.${this.state.settings.oid}`,(n==null?void 0:n.toString())||""),this.props.socket.setState(this.state.settings.oid,{val:n,ack:!!this.state.simulateAck})}renderWriteState(){return[f.jsx(D.Button,{disabled:!this.state.settings.oid||!this.state.enableSimulation,variant:"contained",color:"primary",onClick:()=>{this.setState({openSimulate:!0,simulateValue:this.state.settings.oidType==="boolean"?window.localStorage.getItem(`javascript.app.${this.state.settings.oid}`)==="true":window.localStorage.getItem(`javascript.app.${this.state.settings.oid}`)||"",simulateAck:window.localStorage.getItem(`javascript.app.${this.state.settings.oid}_ack`)==="true"}),setTimeout(()=>{var n;return(n=this.inputRef.current)==null?void 0:n.focus()},200)},children:I.I18n.t("Simulate")},"buttonWrite"),f.jsxs(D.Dialog,{open:!!this.state.openSimulate,TransitionComponent:Uk,keepMounted:!0,onClose:()=>this.setState({openSimulate:!1}),"aria-labelledby":"simulate-dialog-slide-title","aria-describedby":"simulate-dialog-slide-description",children:[f.jsx(D.DialogTitle,{id:"simulate-dialog-slide-title",children:I.I18n.t("Trigger with value")}),f.jsxs(D.DialogContent,{children:[this.state.settings.oidType==="boolean"?f.jsx(D.FormControlLabel,{control:f.jsx(D.Switch,{inputRef:this.inputRef,onKeyUp:n=>n.key==="Enter"&&this.onWriteValue(),value:!!this.state.simulateValue,onChange:n=>this.setState({simulateValue:n.target.checked})}),label:I.I18n.t("Value")}):f.jsx(D.TextField,{variant:"standard",inputRef:this.inputRef,label:I.I18n.t("Value"),fullWidth:!0,onKeyUp:n=>n.key==="Enter"&&this.onWriteValue(),value:!this.state.simulateValue&&this.state.simulateValue!==0?"":this.state.simulateValue,onChange:n=>this.setState({simulateValue:n.target.value})}),f.jsx("br",{}),f.jsx(D.FormControlLabel,{control:f.jsx(D.Checkbox,{checked:!!this.state.simulateAck,onChange:n=>this.setState({simulateAck:n.target.checked}),color:"primary"}),label:I.I18n.t("Ack")})]}),f.jsxs(D.DialogActions,{children:[f.jsxs(D.Button,{variant:"contained",onClick:()=>this.onWriteValue(),color:"primary",children:[f.jsx(X_,{}),I.I18n.t("Write")]}),f.jsxs(D.Button,{color:"grey",variant:"contained",onClick:()=>this.setState({openSimulate:!1}),children:[f.jsx(uy,{}),I.I18n.t("Close")]})]})]},"dialogWrite")]}onTagChange(n){this.setState({inputs:[{nameRender:"renderObjectID",attr:"oid",defaultValue:""},{nameRender:"renderWriteState"}]},()=>{super.onTagChange()})}static getStaticData(){return{acceptedBy:"triggers",name:"State",id:"TriggerState",icon:"FlashOn",tagCardArray:["on change","on update"],title:"Triggers the rule on update or change of some state"}}getData(){return Wv.getStaticData()}}const AB=""+new URL("hysteresis-CLhhemcG.png",import.meta.url).href,GC=`function __hysteresis(val, limit, state, hist, comp) {
    let cond1, cond2;
    if (comp === '>') {
        cond1 = val > limit + hist;
        cond2 = val <= limit - hist;
    } else if (comp === '<') {
        cond1 = val < limit - hist;
        cond2 = val >= limit + hist;
    } else if (comp === '>=') {
        cond1 = val >= limit + hist;
        cond2 = val < limit - hist;
    } else if (comp === '<=') {
        cond1 = val <= limit - hist;
        cond2 = val > limit + hist;
    } else if (comp === '=') {
        cond1 = val <= limit + hist && val > limit - hist;
        cond2 = val > limit + hist || val <= limit - hist;
    } else if (comp === '<>') {
        cond1 = val > limit + hist || val <= limit - hist;
        cond2 = val <= limit + hist && val > limit - hist;
    }
     
    if (!state && cond1) {
        return true;
    } else if (state && cond2) {
        return false;
    } else {
        return state;
    }
}`;class tm extends ln{constructor(n){super(n,tm.getStaticData())}isAllTriggersOnState(){var n,s,i,a;return!!((s=(n=this.props.userRules)==null?void 0:n.triggers)!=null&&s.find(c=>c.id==="TriggerState"))&&!((a=(i=this.props.userRules)==null?void 0:i.triggers)!=null&&a.find(c=>c.id!=="TriggerState"))}static compile(n,s){var h,g;let i=n.value;i==null&&(i=!1);let a,c;if(n.tagCard==="()")s.prelines=s.prelines||[],!s.prelines.find(b=>b!==GC)&&s.prelines.push(GC),n.useTrigger?(a="obj.state.val",i===""&&(i=0),c=`__hysteresis(subCondVar${n._id}, ${i}, __%%STATE%%__, ${n.hist}, "${n.histComp}")`):(a=`(await getStateAsync("${n.oid}")).val`,i===""&&(i=0),typeof i=="string"&&parseFloat(i.trim()).toString()!==i.trim()&&(i=`"${i}"`),c=`__hysteresis(subCondVar${n._id}, ${i}, __%%STATE%%__, ${n.hist}, "${n.histComp}")`);else if(n.tagCard!=="includes"){const b=n.tagCard==="="?"==":n.tagCard==="<>"?"!=":n.tagCard;n.useTrigger?(a="obj.state.val",((h=s==null?void 0:s.trigger)==null?void 0:h.oidType)==="string"?(i=i.replace(/"/g,'\\"'),c=`subCondVar${n._id} ${b} "${i}"`):(i===""&&(i=0),typeof i=="string"&&parseFloat(i.trim()).toString()!==i.trim()&&(i=`"${i}"`),c=`subCondVar${n._id} ${b} ${i}`)):(a=`(await getStateAsync("${n.oid}")).val`,n.oidType==="string"?(i=i.replace(/"/g,'\\"'),c=`subCondVar${n._id} ${b} "${i}"`):(i===""&&(i=0),typeof i=="string"&&parseFloat(i.trim()).toString()!==i.trim()&&(i=`"${i}"`),c=`subCondVar${n._id} ${b} ${i}`))}else n.useTrigger?(a="obj.state.val",((g=s==null?void 0:s.trigger)==null?void 0:g.oidType)==="string"?(i=i.replace(/"/g,'\\"'),c=`obj.state.val.includes("${i}")`):c="false"):(a=`(await getStateAsync("${n.oid}")).val`,n.oidType==="string"?(i=i.replace(/"/g,'\\"'),c=`subCondVar${n._id}.includes("${i}")`):c="false");return s.conditionsStates.push({name:`subCondVar${n._id}`,id:n.oid}),s.conditionsVars.push(`const subCondVar${n._id} = ${a};`),s.conditionsVars.push(`const subCond${n._id} = ${c};`),s.conditionsDebug.push(`_sendToFrontEnd(${n._id}, {result: subCond${n._id}, value: subCondVar${n._id}, compareWith: "${i}"});`),`subCond${n._id}`}renderDebug(n){const s=this.state.settings.tagCard;return s!=="()"?`${n.data.result.toString().toUpperCase()} [${n.data.value} ${s} ${n.data.compareWith}]`:I.I18n.t("Triggered")}onShowHelp=()=>this.setState({showHysteresisHelp:!0});_setInputs(n,s,i,a,c){var E,R;const h=this.isAllTriggersOnState();s=s||this.state.settings.tagCard,i=i||this.state.settings.oidType,a=a||this.state.settings.oidUnit,c=c||this.state.settings.oidStates,n===void 0&&(n=this.state.settings.useTrigger),h&&n&&((R=(E=this.props.userRules)==null?void 0:E.triggers)==null?void 0:R.length)===1&&(i=this.props.userRules.triggers[0].oidType,a=this.props.userRules.triggers[0].oidUnit,c=this.props.userRules.triggers[0].oidStates);const g=tm.getStaticData().tagCardArray,b=g.find(F=>F.title===s)||g[0];let $,y=null;i==="number"?($=[{title:"=",title2:"[equal]",text:"equal to"},{title:">=",title2:"[greater or equal]",text:"greater or equal"},{title:">",title2:"[greater]",text:"greater than"},{title:"<=",title2:"[less or equal]",text:"less or equal"},{title:"<",title2:"[less]",text:"less than"},{title:"<>",title2:"[not equal]",text:"not equal to"},{title:"()",title2:"[hysteresis]",text:"hysteresis"}],c&&(y=Object.keys(c).map(F=>c?{value:F,title:c[F]}:null).filter(F=>F))):i==="boolean"?($=[{title:"=",title2:"[equal]",text:"equal to"},{title:"<>",title2:"[not equal]",text:"not equal to"}],y=[{title:"false",value:!1},{title:"true",value:!0}]):($=[{title:"=",title2:"[equal]",text:"equal to"},{title:">=",title2:"[greater or equal]",text:"greater or equal"},{title:">",title2:"[greater]",text:"greater than"},{title:"<=",title2:"[less or equal]",text:"less or equal"},{title:"<",title2:"[less]",text:"less than"},{title:"<>",title2:"[not equal]",text:"not equal to"},{title:".",title2:"[includes]",text:"includes"}],c&&(y=Object.keys(c).map(F=>({value:F,title:c?c[F]:F.toString()}))));let w=null;$.find(F=>F.title===s)||(s=$[0].title,w=w||{...this.state.settings},w.tagCard=s);let C,S={nameRender:"renderText",defaultValue:"",attr:"value",frontText:s==="()"?"Limit":(b==null?void 0:b.text)||"compare with",doNotTranslateBack:!0,backText:a};y&&(S={nameRender:"renderSelect",defaultValue:y[0].value,options:y,attr:"value",frontText:(b==null?void 0:b.text)||"compare with",doNotTranslateBack:!0,backText:a},y.find(F=>F.value===this.state.settings.value)||(w=w||{...this.state.settings},w.value=y[0].value),y.length<=2&&($=[{title:"=",title2:"[equal]",text:"equal to"},{title:"<>",title2:"[not equal]",text:"not equal to"}])),h&&n?C=[{backText:"use trigger value",nameRender:"renderCheckbox",attr:"useTrigger",defaultValue:!1},S]:h?C=[{backText:"use trigger value",nameRender:"renderCheckbox",attr:"useTrigger"},{nameRender:"renderObjectID",attr:"oid",defaultValue:""},S]:C=[{nameRender:"renderObjectID",attr:"oid",defaultValue:""},S],s==="()"&&(C.splice(1,0,{nameRender:"renderDialog",icon:"HelpOutline",frontText:"Explanation",onShowDialog:this.onShowHelp}),C.splice(2,0,{nameRender:"renderSelect",attr:"histComp",defaultValue:">",frontText:"Condition",doNotTranslate:!0,options:[{title:">",value:">"},{title:">=",value:">="},{title:"<",value:"<"},{title:"<=",value:"<="},{title:"=",value:"="},{title:"<>",value:"<>"}]}),C.push({frontText:"Δ",doNotTranslate:!0,nameRender:"renderNumber",noHelperText:!0,attr:"hist",defaultValue:1,doNotTranslateBack:!0,backText:a}));const k={iconTag:!0,tagCardArray:$,inputs:C};this.setState(k,()=>super.onTagChange(null,()=>{w&&(this.setState({settings:w}),this.props.onChange(w))}))}onValueChanged(n,s){typeof n=="object"?this._setInputs(n.useTrigger,n.tagCard,n.oidType,n.states):s==="useTrigger"?this._setInputs(n):s==="oidType"?this._setInputs(void 0,void 0,n):s==="oidUnit"?this._setInputs(void 0,void 0,void 0,n):s==="oidStates"&&this._setInputs(void 0,void 0,void 0,void 0,n)}onUpdate(){this._setInputs(this.state.settings.useTrigger)}onTagChange(n){this._setInputs(this.state.settings.useTrigger,n)}static getStaticData(){return{acceptedBy:"conditions",name:"State condition",id:"ConditionState",icon:"Shuffle",tagCardArray:[{title:"=",title2:"[equal]",text:"equal to"},{title:">=",title2:"[greater or equal]",text:"greater or equal"},{title:">",title2:"[greater]",text:"greater than"},{title:"<=",title2:"[less or equal]",text:"less or equal"},{title:"<",title2:"[less]",text:"less than"},{title:"<>",title2:"[not equal]",text:"not equal to"},{title:".",title2:"[includes]",text:"includes"},{title:"()",title2:"[hysteresis]",text:"hysteresis"}],title:"Compares the state value with user defined value"}}getData(){return tm.getStaticData()}renderSpecific(){return this.state.showHysteresisHelp?f.jsxs(D.Dialog,{open:!0,maxWidth:"md",onClose:()=>this.setState({showHysteresisHelp:!1}),"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[f.jsx(D.DialogContent,{children:f.jsx(D.DialogContentText,{id:"alert-dialog-description",children:f.jsx("img",{src:AB,alt:"Hysteresis"})})}),f.jsx(D.DialogActions,{children:f.jsx(D.Button,{onClick:()=>this.setState({showHysteresisHelp:!1}),color:"primary",autoFocus:!0,children:I.I18n.t("OK")})})]}):null}}const qC=[31,29,31,30,31,30,31,31,30,31,30,31];class nm extends ln{constructor(n){super(n,nm.getStaticData())}static compile(n,s){const i=n.tagCard==="="?"===":n.tagCard==="<>"?"!==":n.tagCard;let a;if(n.withDate){const[c,h]=(n.date||"01.01").toString().split(".");let g=parseInt(h,10)||0,b=parseInt(c,10)||0;b>12?b=12:b<0&&(b=0),g>qC[b]?g=qC[b]:g<0&&(g=0),g&&b?a=`formatDate(Date.now(), 'MM.DD-hh:mm') ${i} "${n.date}-${n.time}"`:g===0&&b?a=`formatDate(Date.now(), 'MM-hh:mm') ${i} "${b.toString().padStart(2,"0")}-${n.time}"`:b===0&&g?a=`formatDate(Date.now(), 'DD-hh:mm') ${i} "${g.toString().padStart(2,"0")}-${n.time}"`:a=`formatDate(Date.now(), 'hh:mm') ${i} "${n.time}"`}else a=`formatDate(Date.now(), 'hh:mm') ${i} "${n.time}"`;return s.conditionsVars.push(`const subCond${n._id} = ${a};`),s.conditionsDebug.push(`_sendToFrontEnd(${n._id}, {result: subCond${n._id}});`),`subCond${n._id}`}_setInputs(n,s){s=s===void 0?this.state.settings.withDate:s,n=n||this.state.settings.tagCard;const i=nm.getStaticData().tagCardArray,a=i==null?void 0:i.find(h=>h.title===n),c=[{nameRender:"renderNameText",attr:"interval",defaultValue:"Actual time of day"},{frontText:(a==null?void 0:a.text)||n,nameRender:"renderTime",attr:"time",defaultValue:"12:00"},{frontText:"with date",nameRender:"renderCheckbox",attr:"withDate",defaultValue:!1}];s&&c.push({nameRender:"renderDate",attr:"date",defaultValue:"01.01"}),this.setState({inputs:c,iconTag:!0},()=>super.onTagChange())}onValueChanged(n,s){s==="withDate"&&this._setInputs(void 0,n)}onTagChange(n){this._setInputs(n)}static getStaticData(){return{acceptedBy:"conditions",name:"Time condition",id:"ConditionTime",icon:"Shuffle",tagCardArray:[{title:"=",title2:"[equal]",text:"equal to"},{title:">=",title2:"[greater or equal]",text:"greater or equal"},{title:">",title2:"[greater]",text:"greater than"},{title:"<=",title2:"[less or equal]",text:"less or equal"},{title:"<",title2:"[less]",text:"less than"},{title:"<>",title2:"[not equal]",text:"not equal to"}],title:"Compares current time with the user specific time"}}getData(){return nm.getStaticData()}}class dc extends ln{coordinates=null;constructor(n){super(n,dc.getStaticData())}static compile(n,s){const i=n.tagCard==="="?"===":n.tagCard==="<>"?"!==":n.tagCard;let a;n.offset&&(a=parseInt(n.offsetValue,10)||0);const c=`formatDate(Date.now(), 'hh:mm') ${i} formatDate(getAstroDate("${n.astro}"${a?`, undefined, ${a}`:""}), 'hh:mm')`;return s.conditionsVars.push(`const subCond${n._id} = ${c};`),s.conditionsDebug.push(`_sendToFrontEnd(${n._id}, {result: ${c}});`),c}static _time2String(n){return n?`${n.getHours().toString().padStart(2,"0")}:${n.getMinutes().toString().padStart(2,"0")}`:"--:--"}onValueChanged(n,s){s==="astro"?this._setAstro(n):s==="offset"?this._setAstro(void 0,n):s==="offsetValue"&&this._setAstro(void 0,void 0,n)}async _setAstro(n,s,i){if(n=n||this.state.settings.astro||"solarNoon",s=s===void 0?this.state.settings.offset:s,i=i===void 0?this.state.settings.offsetValue:i,i=parseInt(i,10)||0,!this.coordinates){const y=await this.props.socket.getObject("system.adapter.javascript.0");if(!(y!=null&&y.native.latitude)&&!(y!=null&&y.native.longitude)){const w=await this.props.socket.getObject("system.config");w&&(w.common.latitude||w.common.longitude)?this.coordinates={latitude:w.common.latitude,longitude:w.common.longitude}:this.coordinates=null}else this.coordinates={latitude:y==null?void 0:y.native.latitude,longitude:y==null?void 0:y.native.longitude}}const a=this.coordinates?zk.getTimes(new Date,this.coordinates.latitude,this.coordinates.longitude):null,c=a?Object.keys(a).map(y=>({value:y,title:y,title2:`[${dc._time2String(a[y])}]`,order:dc._time2String(a[y])})):[];c.sort((y,w)=>y.order>w.order?1:y.order<w.order?-1:0);const h=dc.getStaticData().tagCardArray,g=h.find(y=>y.title===this.state.settings.tagCard)||h[0];let b="--:--";if(n&&a&&a[n]){const y=new Date(a[n]);s&&y.setMinutes(y.getMinutes()+parseInt(i,10)),b=`(${I.I18n.t(g.text)} ${dc._time2String(y)})`}let $;s?$=[{nameRender:"renderNameText",defaultValue:"Actual time of day",attr:"text"},{frontText:g.text,attr:"astro",nameRender:"renderSelect",options:c,doNotTranslate2:!0,defaultValue:"solarNoon"},{backText:"with offset",nameRender:"renderCheckbox",attr:"offset"},{backText:i===1?"minute":"minutes",frontText:"offset",nameRender:"renderNumber",defaultValue:0,attr:"offsetValue",noHelperText:!0},{nameRender:"renderNameText",attr:"textTime",doNotTranslate:!0,defaultValue:b}]:$=[{nameRender:"renderNameText",defaultValue:"Actual time of day",attr:"text"},{frontText:g.text,attr:"astro",nameRender:"renderSelect",options:c,doNotTranslate2:!0,defaultValue:"solarNoon"},{backText:"with offset",nameRender:"renderCheckbox",attr:"offset"},{nameRender:"renderNameText",attr:"textTime",doNotTranslate:!0,defaultValue:b}],this.setState({inputs:$},()=>super.onTagChange())}onTagChange(){this._setAstro()}static getStaticData(){return{acceptedBy:"conditions",name:"Astronomical",id:"ConditionAstronomical",icon:"Brightness3",tagCardArray:[{title:"=",title2:"[equal]",text:"equal to"},{title:">=",title2:"[greater or equal]",text:"greater or equal to"},{title:">",title2:"[greater]",text:"greater than"},{title:"<=",title2:"[less or equal]",text:"less or equal to"},{title:"<",title2:"[less]",text:"less than"},{title:"<>",title2:"[not equal]",text:"not equal to"}],title:"Compares current time with astronomical event"}}getData(){return dc.getStaticData()}}const KC={valueAck:{color:"#b02323"},valueNotAck:{color:"#12ac15"}};class Vv extends ln{constructor(n){super(n,Vv.getStaticData())}isAllTriggersOnState(){var n,s,i,a;return!!((s=(n=this.props.userRules)==null?void 0:n.triggers)!=null&&s.find(c=>c.id==="TriggerState"))&&!((a=(i=this.props.userRules)==null?void 0:i.triggers)!=null&&a.find(c=>c.id!=="TriggerState"))}static compile(n,s){let i=n.value;n.useTrigger?i=n.toggle?"!obj.state.val":"obj.state.val":(i==null&&(i=""),typeof n.value=="string"&&parseFloat(n.value).toString()!==n.value&&n.value!=="true"&&n.value!=="false"&&(i=`"${i.replace(/"/g,'\\"')}"${ln.getReplacesInText(s)}`));let a;return n.toggle&&!n.useTrigger?a=`const subActionVar${n._id} = !(await getStateAsync("${n.oid}")).val`:a=`const subActionVar${n._id} = ${i}`,`// set state ${n.oid} to ${n.toggle&&!n.useTrigger?"toggle":i} 
		${a};
		_sendToFrontEnd(${n._id}, {val: subActionVar${n._id}, ack: ${n.tagCard==="update"}});
		await setStateAsync("${n.oid}", subActionVar${n._id}, ${n.tagCard==="update"});`}renderDebug(n){return f.jsxs("span",{children:[I.I18n.t("Set:")," ",f.jsx("span",{style:n.data.ack?KC.valueAck:KC.valueNotAck,children:Yh(n.data.val)})]})}_setInputs(n,s){const i=this.isAllTriggersOnState();s=s===void 0?this.state.settings.toggle:s,n=n===void 0?this.state.settings.useTrigger:n;let a="",c;const{oidType:h,oidUnit:g,oidStates:b,oidMax:$,oidMin:y,oidRole:w,oidWrite:C,oidStep:S}=this.state.settings;let k;h&&(h==="number"?(a="number",$!==void 0&&y!==void 0&&(a="slider")):h==="boolean"?(a="boolean",w&&w.includes("button")&&C&&(a="button")):(a="",w&&w.includes("color")&&(a="color")),b&&(c=Object.keys(b).map(R=>({value:R,title:b[R]})),a="select"));let E;if(i&&n)E=[{backText:"use trigger value",nameRender:"renderCheckbox",attr:"useTrigger",defaultValue:!1}],a==="boolean"&&E.push({backText:"toggle value",attr:"toggle",nameRender:"renderCheckbox",defaultValue:!1});else{switch(a){case"number":E=[{backText:g||"",frontText:"with",nameRender:"renderNumber",defaultValue:$===void 0?0:$,attr:"value"}],this.state.settings.value!==void 0&&isNaN(parseFloat(this.state.settings.value))&&(k={value:$===void 0?0:$});break;case"slider":{E=[{nameRender:"renderSlider",defaultValue:$,min:y,max:$,unit:g,step:S,attr:"value"}];const R=parseFloat(this.state.settings.value);this.state.settings.value!==void 0&&(isNaN(R)||R<y||R>$)&&(k={value:$});break}case"select":E=[{nameRender:"renderSelect",frontText:"with",options:c,defaultValue:(c==null?void 0:c[0].value)||"",attr:"value"}],this.state.settings.value!==void 0&&!(c!=null&&c.find(R=>R.value===this.state.settings.value))&&(k={value:(c==null?void 0:c[0].value)||""});break;case"boolean":E=[{backText:"toggle value",attr:"toggle",nameRender:"renderCheckbox",defaultValue:!1}],s||E.push({backText:"true",frontText:"false",nameRender:"renderSwitch",defaultValue:!1,attr:"value"}),this.state.settings.value!==void 0&&this.state.settings.value!==!1&&this.state.settings.value!==!0&&(k={value:!1});break;case"button":E=[{nameRender:"renderButton",defaultValue:!0,attr:"value"}],this.state.settings.value!==void 0&&this.state.settings.value!==!0&&(k={value:!0});break;case"color":E=[{nameRender:"renderColor",frontText:"with",defaultValue:"#FFFFFF",attr:"value"}],this.state.settings.value!==void 0&&(typeof this.state.settings.value!="string"||!this.state.settings.value.startsWith("#")&&!this.state.settings.value.startsWith("rgb"))&&(k={value:"#FFFFFF"});break;default:E=[{backText:g||"",frontText:"with",nameRender:"renderText",defaultValue:"",attr:"value"}];break}i&&E.unshift({backText:"use trigger value",nameRender:"renderCheckbox",attr:"useTrigger"})}return{inputs:E,newSettings:k}}onTagChange(n,s,i,a,c){c=c===void 0?this.state.settings.useTrigger:c;const{inputs:h,newSettings:g}=this._setInputs(c,a);h.unshift({nameRender:"renderObjectID",attr:"oid",defaultValue:"",checkReadOnly:!0}),this.setState({inputs:h},()=>super.onTagChange(null,()=>{if(g){const b=JSON.parse(JSON.stringify(this.state.settings));Object.assign(b,g),this.setState(b),this.props.onChange(b)}}))}onValueChanged(n,s){this.onTagChange(void 0,void 0,void 0,s==="toggle"?n:void 0,s==="useTrigger"?n:void 0)}onUpdate(){this.onTagChange()}static getStaticData(){return{acceptedBy:"actions",name:"Set state action",id:"ActionSetState",icon:"PlayForWork",tagCardArray:["control","update"],title:"Control or update some state",helpDialog:"You can use %s in the value to use the current trigger value or %id to display the triggered object ID"}}getData(){return Vv.getStaticData()}}class Gv extends ln{constructor(n){super(n,Gv.getStaticData())}static compile(n,s){return`// exec "${n.exec}"
		const subActionVar${n._id} = "${(n.exec||"").replace(/"/g,'\\"')}"${ln.getReplacesInText(s)};
		_sendToFrontEnd(${n._id}, {exec: subActionVar${n._id}});
		console.log(subActionVar${n._id});`}renderDebug(n){return`Exec: ${n.data.exec}`}onTagChange(n){this.setState({inputs:[{nameRender:"renderModalInput",attr:"exec",defaultValue:"ls /opt/iobroker",nameBlock:"Shell command"}]},()=>super.onTagChange(n))}static getStaticData(){return{acceptedBy:"actions",name:"Exec",id:"ActionExec",icon:"Apps",title:"Executes some shell command",helpDialog:"You can use %s in the command to use current trigger value or %id to use the triggered object ID"}}getData(){return Gv.getStaticData()}}class qv extends ln{constructor(n){super(n,qv.getStaticData())}static compile(n,s){return`// HTTP request ${n.url}
		const subActionVar${n._id} = "${(n.url||"").replace(/"/g,'\\"')}"${ln.getReplacesInText(s)};
		_sendToFrontEnd(${n._id}, {url: subActionVar${n._id}});
		request(subActionVar${n._id});`}renderDebug(n){return`URL: ${n.data.url}`}onTagChange(n){this.setState({inputs:[{nameRender:"renderModalInput",attr:"url",defaultValue:"http://mydevice.com?...",nameBlock:"URL"}]},()=>super.onTagChange(n))}static getStaticData(){return{acceptedBy:"actions",name:"HTTP Call",id:"ActionHTTPCall",icon:"Language",title:"Make a HTTP get request",helpDialog:"You can use %s in the URL to use current trigger value or %id to use the triggered object ID"}}getData(){return qv.getStaticData()}}class Kv extends ln{constructor(n){super(n,Kv.getStaticData())}static compile(n,s){return`// Log ${n.text}
		const subActionVar${n._id} = "${(n.text||"").replace(/"/g,'\\"')}"${ln.getReplacesInText(s)};
		_sendToFrontEnd(${n._id}, {text: subActionVar${n._id}});
		console.log(subActionVar${n._id});`}renderDebug(n){return I.I18n.t("Log: %s",n.data.text)}onTagChange(){this.setState({inputs:[{nameRender:"renderModalInput",attr:"text",defaultValue:"My device triggered",nameBlock:"Log text"}]},()=>super.onTagChange())}static getStaticData(){return{acceptedBy:"actions",name:"Log text",id:"ActionPrintText",icon:"Subject",title:"Print some text in log",helpDialog:"You can use %s in the text to display current trigger value or %id to display the triggered object ID"}}getData(){return Kv.getStaticData()}}class Jv extends ln{constructor(n){super(n,Jv.getStaticData())}static compile(n){const s=n.unit==="ms"?1:n.unit==="s"?1e3:n.unit==="m"?6e4:36e5;return`// pause for ${s}ms
		_sendToFrontEnd(${n._id}, {paused: true});

		await wait(${n.pause} * ${s});

		_sendToFrontEnd(${n._id}, {paused: false});`}renderDebug(n){return I.I18n.t("Paused: %s",n.data.paused)}_getOptions(n){return n=n===void 0?this.state.settings.pause:n,n===1||n==="1"?[{value:"ms",title:"millisecond"},{value:"s",title:"second"},{value:"m",title:"minute"},{value:"h",title:"hour"}]:[{value:"ms",title:"milliseconds"},{value:"s",title:"seconds"},{value:"m",title:"minutes"},{value:"h",title:"hours"}]}_setInputs(n){this.setState({inputs:[{nameRender:"renderNumber",attr:"pause",defaultValue:100,noHelperText:!0},{nameRender:"renderSelect",attr:"unit",defaultValue:"ms",options:this._getOptions(n)}]},()=>super.onTagChange())}onValueChanged(n,s){s==="pause"&&this._setInputs(n)}onTagChange(){this._setInputs()}static getStaticData(){return{acceptedBy:"actions",name:"Pause",id:"ActionPause",icon:"Pause",title:"Make a pause between actions"}}getData(){return Jv.getStaticData()}}class Yv extends ln{constructor(n){super(n,Yv.getStaticData())}static compile(n){const s=(n.func||"").split(`
`).map(i=>`        ${i}`);return s.unshift(`		_sendToFrontEnd(${n._id}, {func: 'executed'});`),s.unshift("// user function"),s.join(`
`)}renderDebug(){return I.I18n.t("Function: executed")}onTagChange(n){this.setState({inputs:[{nameRender:"renderModalInput",attr:"func",noTextEdit:!0,defaultValue:'console.log("Test")',nameBlock:"Function"}]},()=>super.onTagChange(n))}static getStaticData(){return{acceptedBy:"actions",name:"User function",id:"ActionFunction",icon:"Functions",title:"Write your own code",helpDialog:"This is advances option. You can write your own code here and it will be executed on trigger"}}getData(){return Yv.getStaticData()}}class Xv extends ln{constructor(n){super(n,Xv.getStaticData())}isAllTriggersOnState(){var n,s,i,a;return!!((s=(n=this.props.userRules)==null?void 0:n.triggers)!=null&&s.find(c=>c.id==="TriggerState"))&&!((a=(i=this.props.userRules)==null?void 0:i.triggers)!=null&&a.find(c=>c.id!=="TriggerState"))}static compile(n,s){let i=n.value;n.useTrigger?i=n.toggle?"!obj.state.val":"obj.state.val":(i==null&&(i=""),typeof n.value=="string"&&parseFloat(n.value).toString()!==n.value&&n.value!=="true"&&n.value!=="false"&&(i=`"${i.replace(/"/g,'\\"')}"${ln.getReplacesInText(s)}`));let a;return n.toggle&&!n.useTrigger?a=`const subActionVar${n._id} = !(await getStateAsync("${n.oid}")).val`:a=`const subActionVar${n._id} = ${i}`,`// set delayed state ${n.oid} to ${n.toggle&&!n.useTrigger?"toggle":i} with delay of ${n.delay}ms
		${a};
		_sendToFrontEnd(${n._id}, {val: subActionVar${n._id}, ack: ${n.tagCard==="update"}});
		setStateDelayed("${n.oid}", subActionVar${n._id}, ${n.tagCard==="update"}, ${parseInt(n.delay,10)}, ${n.clearRunning?"true":"false"});`}renderDebug(n){var s,i;return f.jsxs("span",{children:[I.I18n.t("Set:")," ",f.jsx("span",{className:n.data.ack?(s=this.props.classes)==null?void 0:s.valueAck:(i=this.props.classes)==null?void 0:i.valueNotAck,children:Yh(n.data.val)})]})}_setInputs(n,s){const i=this.isAllTriggersOnState();s=s===void 0?this.state.settings.toggle:s,n=n===void 0?this.state.settings.useTrigger:n;let a="",c;const{oidType:h,oidUnit:g,oidStates:b,oidMax:$,oidMin:y,oidRole:w,oidWrite:C,oidStep:S}=this.state.settings;let k;h&&(h==="number"?(a="number",$!==void 0&&y!==void 0&&(a="slider")):h==="boolean"?(a="boolean",w&&w.includes("button")&&C&&(a="button")):(a="",w&&w.includes("color")&&(a="color")),b&&(c=Object.keys(b).map(R=>({value:R,title:b[R]})),a="select"));let E;if(i&&n)E=[{backText:"use trigger value",nameRender:"renderCheckbox",attr:"useTrigger",defaultValue:!1}],a==="boolean"&&E.push({backText:"toggle value",attr:"toggle",nameRender:"renderCheckbox",defaultValue:!1});else{switch(a){case"number":E=[{backText:g||"",frontText:"with",nameRender:"renderNumber",defaultValue:$===void 0?0:$,attr:"value"}],this.state.settings.value!==void 0&&isNaN(parseFloat(this.state.settings.value))&&(k={value:$===void 0?0:$});break;case"slider":{E=[{nameRender:"renderSlider",defaultValue:$,min:y,max:$,unit:g,step:S,attr:"value"}];const R=parseFloat(this.state.settings.value);this.state.settings.value!==void 0&&(isNaN(R)||R<y||R>$)&&(k={value:$});break}case"select":E=[{nameRender:"renderSelect",frontText:"with",options:c,defaultValue:(c==null?void 0:c[0].value)||"",attr:"value"}],this.state.settings.value!==void 0&&!(c!=null&&c.find(R=>R.value===this.state.settings.value))&&(k={value:(c==null?void 0:c[0].value)||""});break;case"boolean":E=[{backText:"toggle value",attr:"toggle",nameRender:"renderCheckbox",defaultValue:!1}],s||E.push({backText:"true",frontText:"false",nameRender:"renderSwitch",defaultValue:!1,attr:"value"}),this.state.settings.value!==void 0&&this.state.settings.value!==!1&&this.state.settings.value!==!0&&(k={value:!1});break;case"button":E=[{nameRender:"renderButton",defaultValue:!0,attr:"value"}],this.state.settings.value!==void 0&&this.state.settings.value!==!0&&(k={value:!0});break;case"color":E=[{nameRender:"renderColor",frontText:"with",defaultValue:"#FFFFFF",attr:"value"}],this.state.settings.value!==void 0&&(typeof this.state.settings.value!="string"||!this.state.settings.value.startsWith("#")&&!this.state.settings.value.startsWith("rgb"))&&(k={value:"#FFFFFF"});break;default:E=[{backText:g||"",frontText:"with",nameRender:"renderText",defaultValue:"",attr:"value"}];break}i&&E.unshift({backText:"use trigger value",nameRender:"renderCheckbox",attr:"useTrigger"})}return E.push({backText:"ms",frontText:"Delay",nameRender:"renderNumber",defaultValue:1e3,noHelperText:!0,attr:"delay"}),E.push({backText:"clear running",nameRender:"renderCheckbox",defaultValue:!0,attr:"clearRunning"}),{inputs:E,newSettings:k}}onTagChange(n,s,i,a,c){c=c===void 0?this.state.settings.useTrigger:c;const{inputs:h,newSettings:g}=this._setInputs(c,a);h.unshift({nameRender:"renderObjectID",attr:"oid",defaultValue:"",checkReadOnly:!0}),this.setState({inputs:h},()=>super.onTagChange(null,()=>{if(g){const b=JSON.parse(JSON.stringify(this.state.settings));Object.assign(b,g),this.setState(b),this.props.onChange(b)}}))}onValueChanged(n,s){this.onTagChange(void 0,void 0,void 0,s==="toggle"?n:void 0,s==="useTrigger"?n:void 0)}onUpdate(){this.onTagChange()}static getStaticData(){return{acceptedBy:"actions",name:"Set with delay",id:"ActionSetStateDelayed",icon:"PlayForWork",tagCardArray:["control","update"],title:"Control or update some state with delay",helpDialog:"You can use %s in the value to use the current trigger value or %id to display the triggered object ID"}}getData(){return Xv.getStaticData()}}class Zv extends ln{constructor(n){super(n,Zv.getStaticData())}isAllTriggersOnState(){var n,s,i,a;return!!((s=(n=this.props.userRules)==null?void 0:n.triggers)!=null&&s.find(c=>c.id==="TriggerState"))&&!((a=(i=this.props.userRules)==null?void 0:i.triggers)!=null&&a.find(c=>c.id!=="TriggerState"))}static compile(n){const s=`const val2_${n._id} = (await getStateAsync("${n.oid1}")).val;`,i=`const val1_${n._id} = (await getStateAsync("${n.oid2}")).val;`;return`// ${n.oid1} ${n.operation} ${n.oid2} => ${n.oidResult}
		 ${s}
		 ${i}
		_sendToFrontEnd(${n._id}, {val: val1_${n._id} ${n.operation} val2_${n._id}, ack: ${n.tagCard==="update"}});
		await setStateAsync("${n.oidResult}", val1_${n._id} ${n.operation} val2_${n._id}, ${n.tagCard==="update"});`}renderDebug(n){var s,i;return f.jsxs("span",{children:[I.I18n.t("Set:")," ",f.jsx("span",{className:n.data.ack?(s=this.props.classes)==null?void 0:s.valueAck:(i=this.props.classes)==null?void 0:i.valueNotAck,children:Yh(n.data.val)})]})}onTagChange(){const n=[];n.push({nameRender:"renderObjectID",title:"ID1",attr:"oid1",defaultValue:"",checkReadOnly:!1}),n.push({nameRender:"renderSelect",options:[{value:"+",title:"+"},{value:"-",title:"-"},{value:"*",title:"*"},{value:"/",title:"/"}],doNotTranslate:!0,defaultValue:"+",attr:"operation"}),n.push({nameRender:"renderObjectID",title:"ID2",attr:"oid2",defaultValue:"",checkReadOnly:!1}),n.push({nameRender:"renderNameText",defaultValue:"store in",attr:"textEqual"}),n.push({nameRender:"renderObjectID",attr:"oidResult",defaultValue:"",checkReadOnly:!0}),this.setState({inputs:n},()=>super.onTagChange(null,()=>{const s=JSON.parse(JSON.stringify(this.state.settings));this.props.onChange(s)}))}onValueChanged(n,s){this.onTagChange()}onUpdate(){this.onTagChange()}static getStaticData(){return{acceptedBy:"actions",name:"Operate two states",id:"ActionOperateStates",icon:"AddBox",tagCardArray:["control","update"],title:"Operations with two states"}}getData(){return Zv.getStaticData()}}const NB=[xu,Hv,Wv,tm,nm,dc,Vv,Gv,qv,Kv,Jv,Yv,Xv,Zv],ev={email:Fv,sayit:Pv,pushover:jv,"whatsapp-cmb":zv,pushsafer:Uv},Tm=ve.createContext({blocks:null,socket:null,onUpdate:!1,setOnUpdate:o=>{},setOnDebugMessage:o=>{},onDebugMessage:[],enableSimulation:!1,setEnableSimulation:o=>{}}),MB=({children:o,socket:n})=>{const[s,i]=ve.useState(null),[a,c]=ve.useState(!1),[h,g]=ve.useState([]),[b,$]=ve.useState(!1);return ve.useEffect(()=>{a&&c(!1)},[a]),ve.useEffect(()=>{(async()=>{const y=await n.getAdapterInstances(),w=Object.keys(ev).filter(R=>y.find(F=>{var M;return((M=F==null?void 0:F.common)==null?void 0:M.name)===R})),C=[],S=y.filter(R=>R.common.javascriptRules),k=[];for(const R in S){const F=S[R];if(k.includes(F.common.name))continue;let M;if(F.common.javascriptRules.url.startsWith("http:")||F.common.javascriptRules.url.startsWith("https:")?M=F.common.javascriptRules.url:F.common.javascriptRules.url.startsWith("./")?M=`${window.location.protocol}//${window.location.host}${F.common.javascriptRules.url.replace(/^\./,"")}`:M=`${window.location.protocol}//${window.location.host}/adapter/${F.common.name}/${F.common.javascriptRules.url}`,F.common.javascriptRules.i18n===!0){const L=M.lastIndexOf("/");let T;L!==-1?T=M.substring(0,L):T=M;const V=I.I18n.getLanguage(),K=`${T}/i18n/${V}.json`;await fetch(K).then(Y=>Y.json()).then(Y=>I.I18n.extendTranslations(Y,V)).catch(Y=>{if(V!=="en")return fetch(`${T}/i18n/en.json`).then(te=>te.json()).then(te=>I.I18n.extendTranslations(te,V)).catch(te=>console.error(`Cannot load i18n "${K}": ${te}`));console.log(`Cannot load i18n "${K}": ${Y}`)})}else if(F.common.javascriptRules.i18n&&typeof F.common.javascriptRules.i18n=="object")try{I.I18n.extendTranslations(F.common.javascriptRules.i18n)}catch(L){console.error(`Cannot import i18n for "${F.common.javascriptRules.name}": ${L}`)}try{G_.registerRemotes([{name:F.common.javascriptRules.name,entry:M,type:F.common.javascriptRules.type}]);const L=(await G_.loadRemote(F.common.javascriptRules.name+"/"+F.common.javascriptRules.name)).default;L&&(C.push(L),k.push(F.common.name),ev[F.common.name]=null)}catch(L){console.error(`Cannot load component "${F.common.javascriptRules.name}": ${L}`)}}const E=w.filter(R=>ev[R]).map(R=>ev[R]);i([...NB,...E,...C])})()},[]),f.jsx(Tm.Provider,{value:{blocks:s,socket:n,onUpdate:a,setOnUpdate:c,onDebugMessage:h,setOnDebugMessage:g,enableSimulation:b,setEnableSimulation:$},children:o})};function LB(o,n,s){const{_id:i,acceptedBy:a}=o;let c;if(!a||!n[a])return console.warn(`Cannot find ${a}`),n;switch(a){case"actions":if(c=n.actions[s].find(h=>h._id===i),!c)console.warn(`Cannot find ${i}`);else{const h=n.actions[s].indexOf(c);n.actions[s][h]=o}return n;case"conditions":if(c=n.conditions[s].find(h=>h._id===i),!c)console.warn(`Cannot find ${i}`);else{const h=n.conditions[s].indexOf(c);n.conditions[s][h]=o}return n;default:if(c=n.triggers.find(h=>h._id===i),!c)console.warn(`Cannot find ${i}`);else{const h=n.triggers.indexOf(c);n.triggers[h]=o}return n}}const Hk=ve.memo(o=>{var ne;const{setUserRules:n,userRules:s,_id:i,id:a,blockValue:c,active:h,acceptedBy:g,isTourOpen:b,setTourStep:$,tourStep:y}=o,[w,C]=ve.useState(null),{blocks:S,socket:k,onUpdate:E,setOnUpdate:R,onDebugMessage:F,enableSimulation:M}=ve.useContext(Tm),L=ve.useCallback(Q=>S==null?void 0:S.find(he=>he.getStaticData().id===Q),[S]),T=ve.useCallback(Q=>{const he=LB(Q,s,c);he&&n(he)},[s]),V=Q=>{Q.currentTarget!==w&&C(Q.currentTarget)},K=()=>C(null),Y=ve.useMemo(()=>{const Q=L(a)||ln;return f.jsx(Q,{...o,notFound:!L(a),isTourOpen:b,setTourStep:$,tourStep:y,onUpdate:E,setOnUpdate:R,enableSimulation:M,onDebugMessage:F,onChange:T,className:void 0,socket:k})},[s,E,F,M]),[te,J]=ve.useState(!1);return f.jsxs("div",{onMouseMove:V,onMouseEnter:V,onMouseLeave:K,onMouseDown:Q=>{if(Q.ctrlKey){let he;const q=ap(g,s,c);g==="conditions"?(he=q.conditions[c].find(re=>re._id===i),he&&q.conditions[c].splice(q.conditions[c].indexOf(he),0,{...he,_id:Date.now()})):g==="actions"?(he=q.actions[c].find(re=>re._id===i),he&&q.actions[c].splice(q.actions[c].indexOf(he),0,{...he,_id:Date.now()})):(he=q.triggers.find(re=>re._id===i),he&&q.triggers.splice(q[g].indexOf(he),0,{...he,_id:Date.now()})),n(q)}},id:"height",style:h?{width:(((ne=document.getElementById("width"))==null?void 0:ne.clientWidth)||0)-70}:void 0,className:`${Nh.cardStyle} ${h?Nh.cardStyleActive:null} ${te?Nh.isDelete:null}`,children:[f.jsx("div",{className:Nh.drag_mobile}),Y,n&&f.jsx("div",{className:Nh.controlMenu,style:w?{opacity:1}:{opacity:0},children:f.jsx("div",{onClick:()=>{let Q=ap(g,s,c);Q=Iu(g,Q,c,i),J(!0),setTimeout(()=>{g==="triggers"&&R(!0),n(Q)},300)},className:Nh.closeBtn})})]})}),BB={position:"fixed",pointerEvents:"none",zIndex:100,left:0,top:0,width:"100%",height:"100%"},PB=(o,n,s)=>{if(!o||!n)return{display:"none"};let{x:i,y:a}=n;const c=`translate(${i}px, ${a}px)`;return{transform:c,WebkitTransform:c}},FB=o=>{const{itemType:n,isDragging:s,item:i,initialOffset:a,currentOffset:c,targetIds:h}=kO(b=>({item:b.getItem(),itemType:b.getItemType(),initialOffset:b.getInitialSourceClientOffset(),currentOffset:b.getSourceClientOffset(),isDragging:b.isDragging(),targetIds:b.getTargetIds()})),g=()=>{switch(n){case"box":return h.length?f.jsx(Hk,{active:!0,...i,allBlocks:o.allBlocks}):f.jsx(Lk,{active:!0,...i,socket:o.socket});default:return null}};return s?f.jsx("div",{style:BB,children:f.jsx("div",{style:PB(a,c),children:g()})}):null},jB="_border_wrpm3_1",zB="_emptyBlockStyle_wrpm3_6",UB="_emptyBlock_wrpm3_6",HB="_marginTop_wrpm3_1",WB="_selectOnChange_wrpm3_22",VB="_selectOnChangeHelp_wrpm3_28",GB="_selectOnChangeHelpIcon_wrpm3_34",qB="_emptyBlockNone_wrpm3_49",KB="_mainBlockItemRules_wrpm3_55",JB="_nameBlockItems_wrpm3_63",YB="_contentBlockItem_wrpm3_73",XB="_wrapperMargin_wrpm3_81",ZB="_contentHeightOn_wrpm3_87",QB="_heightBlock_wrpm3_1",eP="_contentHeightOff_wrpm3_99",tP="_cardAdd_wrpm3_105",nP="_blockCardAdd_wrpm3_125",sP="_addClassOverflow_wrpm3_136",rP="_addClassHeight_wrpm3_140",bs={border:jB,emptyBlockStyle:zB,emptyBlock:UB,marginTop:HB,selectOnChange:WB,selectOnChangeHelp:VB,selectOnChangeHelpIcon:GB,emptyBlockNone:qB,mainBlockItemRules:KB,nameBlockItems:JB,contentBlockItem:YB,wrapperMargin:XB,contentHeightOn:ZB,heightBlock:QB,contentHeightOff:eP,cardAdd:tP,blockCardAdd:nP,addClassOverflow:sP,addClassHeight:rP};function Ew(o,n){const[s,i]=ve.useState(window.localStorage.getItem(n)?JSON.parse(window.localStorage.getItem(n)||""):o);return[s,c=>{window.localStorage.setItem(n,JSON.stringify(c)),i(c)},!!window.localStorage.getItem(n)]}var Qv={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */Qv.exports;(function(o,n){(function(){var s,i="4.17.21",a=200,c="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",h="Expected a function",g="Invalid `variable` option passed into `_.template`",b="__lodash_hash_undefined__",$=500,y="__lodash_placeholder__",w=1,C=2,S=4,k=1,E=2,R=1,F=2,M=4,L=8,T=16,V=32,K=64,Y=128,te=256,J=512,ne=30,Q="...",he=800,q=16,re=1,De=2,ee=3,Fe=1/0,Ce=9007199254740991,Ze=17976931348623157e292,pe=NaN,Te=4294967295,ke=Te-1,Xe=Te>>>1,Ke=[["ary",Y],["bind",R],["bindKey",F],["curry",L],["curryRight",T],["flip",J],["partial",V],["partialRight",K],["rearg",te]],at="[object Arguments]",Ue="[object Array]",ut="[object AsyncFunction]",rt="[object Boolean]",tt="[object Date]",It="[object DOMException]",Yt="[object Error]",Ut="[object Function]",Fn="[object GeneratorFunction]",Xt="[object Map]",en="[object Number]",Ot="[object Null]",Lt="[object Object]",vn="[object Promise]",Ln="[object Proxy]",He="[object RegExp]",Ft="[object Set]",St="[object String]",Tn="[object Symbol]",os="[object Undefined]",Ee="[object WeakMap]",fe="[object WeakSet]",ue="[object ArrayBuffer]",we="[object DataView]",je="[object Float32Array]",ie="[object Float64Array]",Pe="[object Int8Array]",vt="[object Int16Array]",it="[object Int32Array]",En="[object Uint8Array]",lt="[object Uint8ClampedArray]",yn="[object Uint16Array]",gn="[object Uint32Array]",Wn=/\b__p \+= '';/g,Xn=/\b(__p \+=) '' \+/g,Xs=/(__e\(.*?\)|\b__t\)) \+\n'';/g,as=/&(?:amp|lt|gt|quot|#39);/g,An=/[&<>"']/g,Bt=RegExp(as.source),jn=RegExp(An.source),gs=/<%-([\s\S]+?)%>/g,Zs=/<%([\s\S]+?)%>/g,zn=/<%=([\s\S]+?)%>/g,Vn=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Fs=/^\w*$/,fi=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Or=/[\\^$.*+?()[\]{}|]/g,mc=RegExp(Or.source),Rr=/^\s+/,al=/\s/,bc=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,$c=/\{\n\/\* \[wrapped with (.+)\] \*/,Uu=/,? & /,ua=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,U=/[()=,{}\[\]\/\s]/,H=/\\(\\)?/g,A=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,j=/\w*$/,z=/^[-+]0x[0-9a-f]+$/i,de=/^0b[01]+$/i,ye=/^\[object .+?Constructor\]$/,$e=/^0o[0-7]+$/i,le=/^(?:0|[1-9]\d*)$/,Be=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Qe=/($^)/,xt=/['\n\r\u2028\u2029\\]/g,jt="\\ud800-\\udfff",tn="\\u0300-\\u036f",Ct="\\ufe20-\\ufe2f",nn="\\u20d0-\\u20ff",bn=tn+Ct+nn,mt="\\u2700-\\u27bf",kn="a-z\\xdf-\\xf6\\xf8-\\xff",ls="\\xac\\xb1\\xd7\\xf7",Qs="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",da="\\u2000-\\u206f",Ar=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",To="A-Z\\xc0-\\xd6\\xd8-\\xde",xs="\\ufe0e\\ufe0f",qt=ls+Qs+da+Ar,er="['’]",Fi="["+jt+"]",cs="["+qt+"]",js="["+bn+"]",Eo="\\d+",ha="["+mt+"]",ji="["+kn+"]",ko="[^"+jt+qt+Eo+mt+kn+To+"]",Io="\\ud83c[\\udffb-\\udfff]",mi="(?:"+js+"|"+Io+")",zi="[^"+jt+"]",Hu="(?:\\ud83c[\\udde6-\\uddff]){2}",ll="[\\ud800-\\udbff][\\udc00-\\udfff]",pa="["+To+"]",gp="\\u200d",vc="(?:"+ji+"|"+ko+")",Om="(?:"+pa+"|"+ko+")",ga="(?:"+er+"(?:d|ll|m|re|s|t|ve))?",fp="(?:"+er+"(?:D|LL|M|RE|S|T|VE))?",Wu=mi+"?",yc="["+xs+"]?",mp="(?:"+gp+"(?:"+[zi,Hu,ll].join("|")+")"+yc+Wu+")*",bp="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Rm="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",_c=yc+Wu+mp,cl="(?:"+[ha,Hu,ll].join("|")+")"+_c,Vu="(?:"+[zi+js+"?",js,Hu,ll,Fi].join("|")+")",Am=RegExp(er,"g"),$p=RegExp(js,"g"),wc=RegExp(Io+"(?="+Io+")|"+Vu+_c,"g"),Nm=RegExp([pa+"?"+ji+"+"+ga+"(?="+[cs,pa,"$"].join("|")+")",Om+"+"+fp+"(?="+[cs,pa+vc,"$"].join("|")+")",pa+"?"+vc+"+"+ga,pa+"+"+fp,Rm,bp,Eo,cl].join("|"),"g"),Mm=RegExp("["+gp+jt+bn+xs+"]"),fa=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Lm=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Sc=-1,Vt={};Vt[je]=Vt[ie]=Vt[Pe]=Vt[vt]=Vt[it]=Vt[En]=Vt[lt]=Vt[yn]=Vt[gn]=!0,Vt[at]=Vt[Ue]=Vt[ue]=Vt[rt]=Vt[we]=Vt[tt]=Vt[Yt]=Vt[Ut]=Vt[Xt]=Vt[en]=Vt[Lt]=Vt[He]=Vt[Ft]=Vt[St]=Vt[Ee]=!1;var _n={};_n[at]=_n[Ue]=_n[ue]=_n[we]=_n[rt]=_n[tt]=_n[je]=_n[ie]=_n[Pe]=_n[vt]=_n[it]=_n[Xt]=_n[en]=_n[Lt]=_n[He]=_n[Ft]=_n[St]=_n[Tn]=_n[En]=_n[lt]=_n[yn]=_n[gn]=!0,_n[Yt]=_n[Ut]=_n[Ee]=!1;var Bm={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},Pm={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Fm={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},jm={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},zm=parseFloat,Um=parseInt,Gu=typeof ei=="object"&&ei&&ei.Object===Object&&ei,Ui=typeof self=="object"&&self&&self.Object===Object&&self,Gn=Gu||Ui||Function("return this")(),Cc=n&&!n.nodeType&&n,xo=Cc&&!0&&o&&!o.nodeType&&o,vp=xo&&xo.exports===Cc,qu=vp&&Gu.process,vr=function(){try{var oe=xo&&xo.require&&xo.require("util").types;return oe||qu&&qu.binding&&qu.binding("util")}catch{}}(),yp=vr&&vr.isArrayBuffer,_p=vr&&vr.isDate,wp=vr&&vr.isMap,Sp=vr&&vr.isRegExp,Cp=vr&&vr.isSet,Ku=vr&&vr.isTypedArray;function tr(oe,Se,me){switch(me.length){case 0:return oe.call(Se);case 1:return oe.call(Se,me[0]);case 2:return oe.call(Se,me[0],me[1]);case 3:return oe.call(Se,me[0],me[1],me[2])}return oe.apply(Se,me)}function ul(oe,Se,me,Je){for(var yt=-1,Zt=oe==null?0:oe.length;++yt<Zt;){var Zn=oe[yt];Se(Je,Zn,me(Zn),oe)}return Je}function zs(oe,Se){for(var me=-1,Je=oe==null?0:oe.length;++me<Je&&Se(oe[me],me,oe)!==!1;);return oe}function Hm(oe,Se){for(var me=oe==null?0:oe.length;me--&&Se(oe[me],me,oe)!==!1;);return oe}function ma(oe,Se){for(var me=-1,Je=oe==null?0:oe.length;++me<Je;)if(!Se(oe[me],me,oe))return!1;return!0}function bi(oe,Se){for(var me=-1,Je=oe==null?0:oe.length,yt=0,Zt=[];++me<Je;){var Zn=oe[me];Se(Zn,me,oe)&&(Zt[yt++]=Zn)}return Zt}function dl(oe,Se){var me=oe==null?0:oe.length;return!!me&&Do(oe,Se,0)>-1}function Tc(oe,Se,me){for(var Je=-1,yt=oe==null?0:oe.length;++Je<yt;)if(me(Se,oe[Je]))return!0;return!1}function wn(oe,Se){for(var me=-1,Je=oe==null?0:oe.length,yt=Array(Je);++me<Je;)yt[me]=Se(oe[me],me,oe);return yt}function si(oe,Se){for(var me=-1,Je=Se.length,yt=oe.length;++me<Je;)oe[yt+me]=Se[me];return oe}function Ec(oe,Se,me,Je){var yt=-1,Zt=oe==null?0:oe.length;for(Je&&Zt&&(me=oe[++yt]);++yt<Zt;)me=Se(me,oe[yt],yt,oe);return me}function Wm(oe,Se,me,Je){var yt=oe==null?0:oe.length;for(Je&&yt&&(me=oe[--yt]);yt--;)me=Se(me,oe[yt],yt,oe);return me}function kc(oe,Se){for(var me=-1,Je=oe==null?0:oe.length;++me<Je;)if(Se(oe[me],me,oe))return!0;return!1}var Tp=gl("length");function Ep(oe){return oe.split("")}function kp(oe){return oe.match(ua)||[]}function Ju(oe,Se,me){var Je;return me(oe,function(yt,Zt,Zn){if(Se(yt,Zt,Zn))return Je=Zt,!1}),Je}function hl(oe,Se,me,Je){for(var yt=oe.length,Zt=me+(Je?1:-1);Je?Zt--:++Zt<yt;)if(Se(oe[Zt],Zt,oe))return Zt;return-1}function Do(oe,Se,me){return Se===Se?Np(oe,Se,me):hl(oe,pl,me)}function Vm(oe,Se,me,Je){for(var yt=me-1,Zt=oe.length;++yt<Zt;)if(Je(oe[yt],Se))return yt;return-1}function pl(oe){return oe!==oe}function Yu(oe,Se){var me=oe==null?0:oe.length;return me?Ic(oe,Se)/me:pe}function gl(oe){return function(Se){return Se==null?s:Se[oe]}}function fl(oe){return function(Se){return oe==null?s:oe[Se]}}function ri(oe,Se,me,Je,yt){return yt(oe,function(Zt,Zn,bt){me=Je?(Je=!1,Zt):Se(me,Zt,Zn,bt)}),me}function Ip(oe,Se){var me=oe.length;for(oe.sort(Se);me--;)oe[me]=oe[me].value;return oe}function Ic(oe,Se){for(var me,Je=-1,yt=oe.length;++Je<yt;){var Zt=Se(oe[Je]);Zt!==s&&(me=me===s?Zt:me+Zt)}return me}function ba(oe,Se){for(var me=-1,Je=Array(oe);++me<oe;)Je[me]=Se(me);return Je}function xp(oe,Se){return wn(Se,function(me){return[me,oe[me]]})}function Xu(oe){return oe&&oe.slice(0,Lp(oe)+1).replace(Rr,"")}function nr(oe){return function(Se){return oe(Se)}}function ml(oe,Se){return wn(Se,function(me){return oe[me]})}function $a(oe,Se){return oe.has(Se)}function Dp(oe,Se){for(var me=-1,Je=oe.length;++me<Je&&Do(Se,oe[me],0)>-1;);return me}function Op(oe,Se){for(var me=oe.length;me--&&Do(Se,oe[me],0)>-1;);return me}function Gm(oe,Se){for(var me=oe.length,Je=0;me--;)oe[me]===Se&&++Je;return Je}var qm=fl(Bm),Km=fl(Pm);function bl(oe){return"\\"+jm[oe]}function Rp(oe,Se){return oe==null?s:oe[Se]}function Oo(oe){return Mm.test(oe)}function $l(oe){return fa.test(oe)}function Zu(oe){for(var Se,me=[];!(Se=oe.next()).done;)me.push(Se.value);return me}function Qu(oe){var Se=-1,me=Array(oe.size);return oe.forEach(function(Je,yt){me[++Se]=[yt,Je]}),me}function Ap(oe,Se){return function(me){return oe(Se(me))}}function $i(oe,Se){for(var me=-1,Je=oe.length,yt=0,Zt=[];++me<Je;){var Zn=oe[me];(Zn===Se||Zn===y)&&(oe[me]=y,Zt[yt++]=me)}return Zt}function vl(oe){var Se=-1,me=Array(oe.size);return oe.forEach(function(Je){me[++Se]=Je}),me}function Hi(oe){var Se=-1,me=Array(oe.size);return oe.forEach(function(Je){me[++Se]=[Je,Je]}),me}function Np(oe,Se,me){for(var Je=me-1,yt=oe.length;++Je<yt;)if(oe[Je]===Se)return Je;return-1}function Mp(oe,Se,me){for(var Je=me+1;Je--;)if(oe[Je]===Se)return Je;return Je}function va(oe){return Oo(oe)?Bp(oe):Tp(oe)}function Nr(oe){return Oo(oe)?Ym(oe):Ep(oe)}function Lp(oe){for(var Se=oe.length;Se--&&al.test(oe.charAt(Se)););return Se}var Jm=fl(Fm);function Bp(oe){for(var Se=wc.lastIndex=0;wc.test(oe);)++Se;return Se}function Ym(oe){return oe.match(wc)||[]}function Pp(oe){return oe.match(Nm)||[]}var Xm=function oe(Se){Se=Se==null?Gn:Mr.defaults(Gn.Object(),Se,Mr.pick(Gn,Lm));var me=Se.Array,Je=Se.Date,yt=Se.Error,Zt=Se.Function,Zn=Se.Math,bt=Se.Object,ed=Se.RegExp,yl=Se.String,vs=Se.TypeError,xc=me.prototype,Fp=Zt.prototype,Wi=bt.prototype,Vi=Se["__core-js_shared__"],_l=Fp.toString,Kt=Wi.hasOwnProperty,Dc=0,td=function(){var u=/[^.]+$/.exec(Vi&&Vi.keys&&Vi.keys.IE_PROTO||"");return u?"Symbol(src)_1."+u:""}(),wl=Wi.toString,Zm=_l.call(bt),Qm=Gn._,eb=ed("^"+_l.call(Kt).replace(Or,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Sl=vp?Se.Buffer:s,Gi=Se.Symbol,Cl=Se.Uint8Array,Tl=Sl?Sl.allocUnsafe:s,Oc=Ap(bt.getPrototypeOf,bt),jp=bt.create,zp=Wi.propertyIsEnumerable,Rc=xc.splice,El=Gi?Gi.isConcatSpreadable:s,ya=Gi?Gi.iterator:s,qi=Gi?Gi.toStringTag:s,_a=function(){try{var u=un(bt,"defineProperty");return u({},"",{}),u}catch{}}(),nd=Se.clearTimeout!==Gn.clearTimeout&&Se.clearTimeout,tb=Je&&Je.now!==Gn.Date.now&&Je.now,Ac=Se.setTimeout!==Gn.setTimeout&&Se.setTimeout,kl=Zn.ceil,Ro=Zn.floor,sd=bt.getOwnPropertySymbols,nb=Sl?Sl.isBuffer:s,Ki=Se.isFinite,Up=xc.join,vi=Ap(bt.keys,bt),ts=Zn.max,ys=Zn.min,Hp=Je.now,sb=Se.parseInt,Ao=Zn.random,Wp=xc.reverse,rd=un(Se,"DataView"),Il=un(Se,"Map"),id=un(Se,"Promise"),wa=un(Se,"Set"),xl=un(Se,"WeakMap"),Sa=un(bt,"create"),Nc=xl&&new xl,Ca={},od=wr(rd),rb=wr(Il),ib=wr(id),Vp=wr(wa),ad=wr(xl),Dl=Gi?Gi.prototype:s,No=Dl?Dl.valueOf:s,ld=Dl?Dl.toString:s;function N(u){if(Sn(u)&&!Et(u)&&!(u instanceof _t)){if(u instanceof ns)return u;if(Kt.call(u,"__wrapped__"))return Fg(u)}return new ns(u)}var ii=function(){function u(){}return function(d){if(!Dn(d))return{};if(jp)return jp(d);u.prototype=d;var m=new u;return u.prototype=s,m}}();function yi(){}function ns(u,d){this.__wrapped__=u,this.__actions__=[],this.__chain__=!!d,this.__index__=0,this.__values__=s}N.templateSettings={escape:gs,evaluate:Zs,interpolate:zn,variable:"",imports:{_:N}},N.prototype=yi.prototype,N.prototype.constructor=N,ns.prototype=ii(yi.prototype),ns.prototype.constructor=ns;function _t(u){this.__wrapped__=u,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Te,this.__views__=[]}function ob(){var u=new _t(this.__wrapped__);return u.__actions__=Kn(this.__actions__),u.__dir__=this.__dir__,u.__filtered__=this.__filtered__,u.__iteratees__=Kn(this.__iteratees__),u.__takeCount__=this.__takeCount__,u.__views__=Kn(this.__views__),u}function ab(){if(this.__filtered__){var u=new _t(this);u.__dir__=-1,u.__filtered__=!0}else u=this.clone(),u.__dir__*=-1;return u}function lb(){var u=this.__wrapped__.value(),d=this.__dir__,m=Et(u),_=d<0,x=m?u.length:0,B=Xc(0,x,this.__views__),W=B.start,Z=B.end,ce=Z-W,Oe=_?Z:W-1,Re=this.__iteratees__,Me=Re.length,We=0,st=ys(ce,this.__takeCount__);if(!m||!_&&x==ce&&st==ce)return Qi(u,this.__actions__);var ht=[];e:for(;ce--&&We<st;){Oe+=d;for(var Dt=-1,pt=u[Oe];++Dt<Me;){var zt=Re[Dt],Gt=zt.iteratee,Gs=zt.type,Ls=Gt(pt);if(Gs==De)pt=Ls;else if(!Ls){if(Gs==re)continue e;break e}}ht[We++]=pt}return ht}_t.prototype=ii(yi.prototype),_t.prototype.constructor=_t;function Ji(u){var d=-1,m=u==null?0:u.length;for(this.clear();++d<m;){var _=u[d];this.set(_[0],_[1])}}function cd(){this.__data__=Sa?Sa(null):{},this.size=0}function cb(u){var d=this.has(u)&&delete this.__data__[u];return this.size-=d?1:0,d}function ub(u){var d=this.__data__;if(Sa){var m=d[u];return m===b?s:m}return Kt.call(d,u)?d[u]:s}function db(u){var d=this.__data__;return Sa?d[u]!==s:Kt.call(d,u)}function Gp(u,d){var m=this.__data__;return this.size+=this.has(u)?0:1,m[u]=Sa&&d===s?b:d,this}Ji.prototype.clear=cd,Ji.prototype.delete=cb,Ji.prototype.get=ub,Ji.prototype.has=db,Ji.prototype.set=Gp;function Lr(u){var d=-1,m=u==null?0:u.length;for(this.clear();++d<m;){var _=u[d];this.set(_[0],_[1])}}function qp(){this.__data__=[],this.size=0}function ud(u){var d=this.__data__,m=Rl(d,u);if(m<0)return!1;var _=d.length-1;return m==_?d.pop():Rc.call(d,m,1),--this.size,!0}function hb(u){var d=this.__data__,m=Rl(d,u);return m<0?s:d[m][1]}function pb(u){return Rl(this.__data__,u)>-1}function gb(u,d){var m=this.__data__,_=Rl(m,u);return _<0?(++this.size,m.push([u,d])):m[_][1]=d,this}Lr.prototype.clear=qp,Lr.prototype.delete=ud,Lr.prototype.get=hb,Lr.prototype.has=pb,Lr.prototype.set=gb;function _i(u){var d=-1,m=u==null?0:u.length;for(this.clear();++d<m;){var _=u[d];this.set(_[0],_[1])}}function nt(){this.size=0,this.__data__={hash:new Ji,map:new(Il||Lr),string:new Ji}}function sr(u){var d=Jc(this,u).delete(u);return this.size-=d?1:0,d}function us(u){return Jc(this,u).get(u)}function In(u){return Jc(this,u).has(u)}function wi(u,d){var m=Jc(this,u),_=m.size;return m.set(u,d),this.size+=m.size==_?0:1,this}_i.prototype.clear=nt,_i.prototype.delete=sr,_i.prototype.get=us,_i.prototype.has=In,_i.prototype.set=wi;function Br(u){var d=-1,m=u==null?0:u.length;for(this.__data__=new _i;++d<m;)this.add(u[d])}function Ye(u){return this.__data__.set(u,b),this}function qn(u){return this.__data__.has(u)}Br.prototype.add=Br.prototype.push=Ye,Br.prototype.has=qn;function yr(u){var d=this.__data__=new Lr(u);this.size=d.size}function fb(){this.__data__=new Lr,this.size=0}function Mo(u){var d=this.__data__,m=d.delete(u);return this.size=d.size,m}function dd(u){return this.__data__.get(u)}function hd(u){return this.__data__.has(u)}function Kp(u,d){var m=this.__data__;if(m instanceof Lr){var _=m.__data__;if(!Il||_.length<a-1)return _.push([u,d]),this.size=++m.size,this;m=this.__data__=new _i(_)}return m.set(u,d),this.size=m.size,this}yr.prototype.clear=fb,yr.prototype.delete=Mo,yr.prototype.get=dd,yr.prototype.has=hd,yr.prototype.set=Kp;function Jp(u,d){var m=Et(u),_=!m&&ao(u),x=!m&&!_&&ui(u),B=!m&&!_&&!x&&Vo(u),W=m||_||x||B,Z=W?ba(u.length,yl):[],ce=Z.length;for(var Oe in u)(d||Kt.call(u,Oe))&&!(W&&(Oe=="length"||x&&(Oe=="offset"||Oe=="parent")||B&&(Oe=="buffer"||Oe=="byteLength"||Oe=="byteOffset")||ae(Oe,ce)))&&Z.push(Oe);return Z}function pd(u){var d=u.length;return d?u[xd(0,d-1)]:s}function gd(u,d){return jr(Kn(u),Lo(d,0,u.length))}function Yp(u){return jr(Kn(u))}function Mc(u,d,m){(m!==s&&!ci(u[d],m)||m===s&&!(d in u))&&Si(u,d,m)}function Ol(u,d,m){var _=u[d];(!(Kt.call(u,d)&&ci(_,m))||m===s&&!(d in u))&&Si(u,d,m)}function Rl(u,d){for(var m=u.length;m--;)if(ci(u[m][0],d))return m;return-1}function mb(u,d,m,_){return Xi(u,function(x,B,W){d(_,x,m(x),W)}),_}function Lc(u,d){return u&&ai(d,ps(d),u)}function bb(u,d){return u&&ai(d,ms(d),u)}function Si(u,d,m){d=="__proto__"&&_a?_a(u,d,{configurable:!0,enumerable:!0,value:m,writable:!0}):u[d]=m}function fd(u,d){for(var m=-1,_=d.length,x=me(_),B=u==null;++m<_;)x[m]=B?s:Ql(u,d[m]);return x}function Lo(u,d,m){return u===u&&(m!==s&&(u=u<=m?u:m),d!==s&&(u=u>=d?u:d)),u}function _r(u,d,m,_,x,B){var W,Z=d&w,ce=d&C,Oe=d&S;if(m&&(W=x?m(u,_,x,B):m(u)),W!==s)return W;if(!Dn(u))return u;var Re=Et(u);if(Re){if(W=to(u),!Z)return Kn(u,W)}else{var Me=Ae(u),We=Me==Ut||Me==Fn;if(ui(u))return wg(u,Z);if(Me==Lt||Me==at||We&&!x){if(W=ce||We?{}:Fr(u),!Z)return ce?Eb(u,bb(W,u)):Wc(u,Lc(W,u))}else{if(!_n[Me])return x?u:{};W=Mg(u,Me,Z)}}B||(B=new yr);var st=B.get(u);if(st)return st;B.set(u,W),gf(u)?u.forEach(function(pt){W.add(_r(pt,d,m,pt,u,B))}):h$(u)&&u.forEach(function(pt,zt){W.set(zt,_r(pt,d,m,zt,u,B))});var ht=Oe?ce?Fd:qc:ce?ms:ps,Dt=Re?s:ht(u);return zs(Dt||u,function(pt,zt){Dt&&(zt=pt,pt=u[zt]),Ol(W,zt,_r(pt,d,m,zt,u,B))}),W}function Xp(u){var d=ps(u);return function(m){return Zp(m,u,d)}}function Zp(u,d,m){var _=m.length;if(u==null)return!_;for(u=bt(u);_--;){var x=m[_],B=d[x],W=u[x];if(W===s&&!(x in u)||!B(W))return!1}return!0}function Al(u,d,m){if(typeof u!="function")throw new vs(h);return zl(function(){u.apply(s,m)},d)}function Yi(u,d,m,_){var x=-1,B=dl,W=!0,Z=u.length,ce=[],Oe=d.length;if(!Z)return ce;m&&(d=wn(d,nr(m))),_?(B=Tc,W=!1):d.length>=a&&(B=$a,W=!1,d=new Br(d));e:for(;++x<Z;){var Re=u[x],Me=m==null?Re:m(Re);if(Re=_||Re!==0?Re:0,W&&Me===Me){for(var We=Oe;We--;)if(d[We]===Me)continue e;ce.push(Re)}else B(d,Me,_)||ce.push(Re)}return ce}var Xi=Bl(oi),md=Bl(Bo,!0);function Qp(u,d){var m=!0;return Xi(u,function(_,x,B){return m=!!d(_,x,B),m}),m}function Nl(u,d,m){for(var _=-1,x=u.length;++_<x;){var B=u[_],W=d(B);if(W!=null&&(Z===s?W===W&&!ur(W):m(W,Z)))var Z=W,ce=B}return ce}function eg(u,d,m,_){var x=u.length;for(m=ft(m),m<0&&(m=-m>x?0:x+m),_=_===s||_>x?x:ft(_),_<0&&(_+=x),_=m>_?0:Xl(_);m<_;)u[m++]=d;return u}function Bc(u,d){var m=[];return Xi(u,function(_,x,B){d(_,x,B)&&m.push(_)}),m}function ds(u,d,m,_,x){var B=-1,W=u.length;for(m||(m=fs),x||(x=[]);++B<W;){var Z=u[B];d>0&&m(Z)?d>1?ds(Z,d-1,m,_,x):si(x,Z):_||(x[x.length]=Z)}return x}var bd=Cg(),tg=Cg(!0);function oi(u,d){return u&&bd(u,d,ps)}function Bo(u,d){return u&&tg(u,d,ps)}function Ml(u,d){return bi(d,function(m){return Ss(u[m])})}function Po(u,d){d=Ds(d,u);for(var m=0,_=d.length;u!=null&&m<_;)u=u[ws(d[m++])];return m&&m==_?u:s}function Pc(u,d,m){var _=d(u);return Et(u)?_:si(_,m(u))}function xn(u){return u==null?u===s?os:Ot:qi&&qi in bt(u)?Ng(u):Qc(u)}function $d(u,d){return u>d}function Fo(u,d){return u!=null&&Kt.call(u,d)}function ng(u,d){return u!=null&&d in bt(u)}function $b(u,d,m){return u>=ys(d,m)&&u<ts(d,m)}function Ta(u,d,m){for(var _=m?Tc:dl,x=u[0].length,B=u.length,W=B,Z=me(B),ce=1/0,Oe=[];W--;){var Re=u[W];W&&d&&(Re=wn(Re,nr(d))),ce=ys(Re.length,ce),Z[W]=!m&&(d||x>=120&&Re.length>=120)?new Br(W&&Re):s}Re=u[0];var Me=-1,We=Z[0];e:for(;++Me<x&&Oe.length<ce;){var st=Re[Me],ht=d?d(st):st;if(st=m||st!==0?st:0,!(We?$a(We,ht):_(Oe,ht,m))){for(W=B;--W;){var Dt=Z[W];if(!(Dt?$a(Dt,ht):_(u[W],ht,m)))continue e}We&&We.push(ht),Oe.push(st)}}return Oe}function sg(u,d,m,_){return oi(u,function(x,B,W){d(_,m(x),B,W)}),_}function Ea(u,d,m){d=Ds(d,u),u=Bg(u,d);var _=u==null?u:u[ws(lr(d))];return _==null?s:tr(_,u,m)}function vd(u){return Sn(u)&&xn(u)==at}function rg(u){return Sn(u)&&xn(u)==ue}function ig(u){return Sn(u)&&xn(u)==tt}function ka(u,d,m,_,x){return u===d?!0:u==null||d==null||!Sn(u)&&!Sn(d)?u!==u&&d!==d:og(u,d,m,_,ka,x)}function og(u,d,m,_,x,B){var W=Et(u),Z=Et(d),ce=W?Ue:Ae(u),Oe=Z?Ue:Ae(d);ce=ce==at?Lt:ce,Oe=Oe==at?Lt:Oe;var Re=ce==Lt,Me=Oe==Lt,We=ce==Oe;if(We&&ui(u)){if(!ui(d))return!1;W=!0,Re=!1}if(We&&!Re)return B||(B=new yr),W||Vo(u)?Og(u,d,m,_,x,B):Rg(u,d,ce,m,_,x,B);if(!(m&k)){var st=Re&&Kt.call(u,"__wrapped__"),ht=Me&&Kt.call(d,"__wrapped__");if(st||ht){var Dt=st?u.value():u,pt=ht?d.value():d;return B||(B=new yr),x(Dt,pt,m,_,B)}}return We?(B||(B=new yr),Pd(u,d,m,_,x,B)):!1}function ag(u){return Sn(u)&&Ae(u)==Xt}function Fc(u,d,m,_){var x=m.length,B=x,W=!_;if(u==null)return!B;for(u=bt(u);x--;){var Z=m[x];if(W&&Z[2]?Z[1]!==u[Z[0]]:!(Z[0]in u))return!1}for(;++x<B;){Z=m[x];var ce=Z[0],Oe=u[ce],Re=Z[1];if(W&&Z[2]){if(Oe===s&&!(ce in u))return!1}else{var Me=new yr;if(_)var We=_(Oe,Re,ce,u,d,Me);if(!(We===s?ka(Re,Oe,k|E,_,Me):We))return!1}}return!0}function yd(u){if(!Dn(u)||Rb(u))return!1;var d=Ss(u)?eb:ye;return d.test(wr(u))}function vb(u){return Sn(u)&&xn(u)==He}function yb(u){return Sn(u)&&Ae(u)==Ft}function _b(u){return Sn(u)&&Ja(u.length)&&!!Vt[xn(u)]}function lg(u){return typeof u=="function"?u:u==null?Ms:typeof u=="object"?Et(u)?Sd(u[0],u[1]):ug(u):vh(u)}function _d(u){if(!Zc(u))return vi(u);var d=[];for(var m in bt(u))Kt.call(u,m)&&m!="constructor"&&d.push(m);return d}function wb(u){if(!Dn(u))return Hd(u);var d=Zc(u),m=[];for(var _ in u)_=="constructor"&&(d||!Kt.call(u,_))||m.push(_);return m}function wd(u,d){return u<d}function cg(u,d){var m=-1,_=is(u)?me(u.length):[];return Xi(u,function(x,B,W){_[++m]=d(x,B,W)}),_}function ug(u){var d=li(u);return d.length==1&&d[0][2]?Un(d[0][0],d[0][1]):function(m){return m===u||Fc(m,u,d)}}function Sd(u,d){return Pt(u)&&zo(d)?Un(ws(u),d):function(m){var _=Ql(m,u);return _===s&&_===d?Ko(m,u):ka(d,_,k|E)}}function Ll(u,d,m,_,x){u!==d&&bd(d,function(B,W){if(x||(x=new yr),Dn(B))dg(u,d,W,m,Ll,_,x);else{var Z=_?_(Uo(u,W),B,W+"",u,d,x):s;Z===s&&(Z=B),Mc(u,W,Z)}},ms)}function dg(u,d,m,_,x,B,W){var Z=Uo(u,m),ce=Uo(d,m),Oe=W.get(ce);if(Oe){Mc(u,m,Oe);return}var Re=B?B(Z,ce,m+"",u,d,W):s,Me=Re===s;if(Me){var We=Et(ce),st=!We&&ui(ce),ht=!We&&!st&&Vo(ce);Re=ce,We||st||ht?Et(Z)?Re=Z:Qn(Z)?Re=Kn(Z):st?(Me=!1,Re=wg(ce,!0)):ht?(Me=!1,Re=Md(ce,!0)):Re=[]:Yl(ce)||ao(ce)?(Re=Z,ao(Z)?Re=xi(Z):(!Dn(Z)||Ss(Z))&&(Re=Fr(ce))):Me=!1}Me&&(W.set(ce,Re),x(Re,ce,_,B,W),W.delete(ce)),Mc(u,m,Re)}function Cd(u,d){var m=u.length;if(m)return d+=d<0?m:0,ae(d,m)?u[d]:s}function Td(u,d,m){d.length?d=wn(d,function(B){return Et(B)?function(W){return Po(W,B.length===1?B[0]:B)}:B}):d=[Ms];var _=-1;d=wn(d,nr(ot()));var x=cg(u,function(B,W,Z){var ce=wn(d,function(Oe){return Oe(B)});return{criteria:ce,index:++_,value:B}});return Ip(x,function(B,W){return Hc(B,W,m)})}function hg(u,d){return Ed(u,d,function(m,_){return Ko(u,_)})}function Ed(u,d,m){for(var _=-1,x=d.length,B={};++_<x;){var W=d[_],Z=Po(u,W);m(Z,W)&&xa(B,Ds(W,u),Z)}return B}function kd(u){return function(d){return Po(d,u)}}function Ia(u,d,m,_){var x=_?Vm:Do,B=-1,W=d.length,Z=u;for(u===d&&(d=Kn(d)),m&&(Z=wn(u,nr(m)));++B<W;)for(var ce=0,Oe=d[B],Re=m?m(Oe):Oe;(ce=x(Z,Re,ce,_))>-1;)Z!==u&&Rc.call(Z,ce,1),Rc.call(u,ce,1);return u}function Id(u,d){for(var m=u?d.length:0,_=m-1;m--;){var x=d[m];if(m==_||x!==B){var B=x;ae(x)?Rc.call(u,x,1):Ad(u,x)}}return u}function xd(u,d){return u+Ro(Ao()*(d-u+1))}function pg(u,d,m,_){for(var x=-1,B=ts(kl((d-u)/(m||1)),0),W=me(B);B--;)W[_?B:++x]=u,u+=m;return W}function jc(u,d){var m="";if(!u||d<1||d>Ce)return m;do d%2&&(m+=u),d=Ro(d/2),d&&(u+=u);while(d);return m}function Rt(u,d){return wt(jl(u,d,Ms),u+"")}function gg(u){return pd(Xa(u))}function fg(u,d){var m=Xa(u);return jr(m,Lo(d,0,m.length))}function xa(u,d,m,_){if(!Dn(u))return u;d=Ds(d,u);for(var x=-1,B=d.length,W=B-1,Z=u;Z!=null&&++x<B;){var ce=ws(d[x]),Oe=m;if(ce==="__proto__"||ce==="constructor"||ce==="prototype")return u;if(x!=W){var Re=Z[ce];Oe=_?_(Re,ce,Z):s,Oe===s&&(Oe=Dn(Re)?Re:ae(d[x+1])?[]:{})}Ol(Z,ce,Oe),Z=Z[ce]}return u}var Dd=Nc?function(u,d){return Nc.set(u,d),u}:Ms,mg=_a?function(u,d){return _a(u,"toString",{configurable:!0,enumerable:!1,value:bh(d),writable:!0})}:Ms;function bg(u){return jr(Xa(u))}function rr(u,d,m){var _=-1,x=u.length;d<0&&(d=-d>x?0:x+d),m=m>x?x:m,m<0&&(m+=x),x=d>m?0:m-d>>>0,d>>>=0;for(var B=me(x);++_<x;)B[_]=u[_+d];return B}function Sb(u,d){var m;return Xi(u,function(_,x,B){return m=d(_,x,B),!m}),!!m}function zc(u,d,m){var _=0,x=u==null?_:u.length;if(typeof d=="number"&&d===d&&x<=Xe){for(;_<x;){var B=_+x>>>1,W=u[B];W!==null&&!ur(W)&&(m?W<=d:W<d)?_=B+1:x=B}return x}return Od(u,d,Ms,m)}function Od(u,d,m,_){var x=0,B=u==null?0:u.length;if(B===0)return 0;d=m(d);for(var W=d!==d,Z=d===null,ce=ur(d),Oe=d===s;x<B;){var Re=Ro((x+B)/2),Me=m(u[Re]),We=Me!==s,st=Me===null,ht=Me===Me,Dt=ur(Me);if(W)var pt=_||ht;else Oe?pt=ht&&(_||We):Z?pt=ht&&We&&(_||!st):ce?pt=ht&&We&&!st&&(_||!Dt):st||Dt?pt=!1:pt=_?Me<=d:Me<d;pt?x=Re+1:B=Re}return ys(B,ke)}function Rd(u,d){for(var m=-1,_=u.length,x=0,B=[];++m<_;){var W=u[m],Z=d?d(W):W;if(!m||!ci(Z,ce)){var ce=Z;B[x++]=W===0?0:W}}return B}function $g(u){return typeof u=="number"?u:ur(u)?pe:+u}function ir(u){if(typeof u=="string")return u;if(Et(u))return wn(u,ir)+"";if(ur(u))return ld?ld.call(u):"";var d=u+"";return d=="0"&&1/u==-Fe?"-0":d}function Zi(u,d,m){var _=-1,x=dl,B=u.length,W=!0,Z=[],ce=Z;if(m)W=!1,x=Tc;else if(B>=a){var Oe=d?null:Ig(u);if(Oe)return vl(Oe);W=!1,x=$a,ce=new Br}else ce=d?[]:Z;e:for(;++_<B;){var Re=u[_],Me=d?d(Re):Re;if(Re=m||Re!==0?Re:0,W&&Me===Me){for(var We=ce.length;We--;)if(ce[We]===Me)continue e;d&&ce.push(Me),Z.push(Re)}else x(ce,Me,m)||(ce!==Z&&ce.push(Me),Z.push(Re))}return Z}function Ad(u,d){return d=Ds(d,u),u=Bg(u,d),u==null||delete u[ws(lr(d))]}function vg(u,d,m,_){return xa(u,d,m(Po(u,d)),_)}function xe(u,d,m,_){for(var x=u.length,B=_?x:-1;(_?B--:++B<x)&&d(u[B],B,u););return m?rr(u,_?0:B,_?B+1:x):rr(u,_?B+1:0,_?x:B)}function Qi(u,d){var m=u;return m instanceof _t&&(m=m.value()),Ec(d,function(_,x){return x.func.apply(x.thisArg,si([_],x.args))},m)}function yg(u,d,m){var _=u.length;if(_<2)return _?Zi(u[0]):[];for(var x=-1,B=me(_);++x<_;)for(var W=u[x],Z=-1;++Z<_;)Z!=x&&(B[x]=Yi(B[x]||W,u[Z],d,m));return Zi(ds(B,1),d,m)}function Uc(u,d,m){for(var _=-1,x=u.length,B=d.length,W={};++_<x;){var Z=_<B?d[_]:s;m(W,u[_],Z)}return W}function Pr(u){return Qn(u)?u:[]}function Ne(u){return typeof u=="function"?u:Ms}function Ds(u,d){return Et(u)?u:Pt(u,d)?[u]:La(rn(u))}var or=Rt;function ge(u,d,m){var _=u.length;return m=m===s?_:m,!d&&m>=_?u:rr(u,d,m)}var _g=nd||function(u){return Gn.clearTimeout(u)};function wg(u,d){if(d)return u.slice();var m=u.length,_=Tl?Tl(m):new u.constructor(m);return u.copy(_),_}function Nd(u){var d=new u.constructor(u.byteLength);return new Cl(d).set(new Cl(u)),d}function Cb(u,d){var m=d?Nd(u.buffer):u.buffer;return new u.constructor(m,u.byteOffset,u.byteLength)}function Tb(u){var d=new u.constructor(u.source,j.exec(u));return d.lastIndex=u.lastIndex,d}function Dy(u){return No?bt(No.call(u)):{}}function Md(u,d){var m=d?Nd(u.buffer):u.buffer;return new u.constructor(m,u.byteOffset,u.length)}function Sg(u,d){if(u!==d){var m=u!==s,_=u===null,x=u===u,B=ur(u),W=d!==s,Z=d===null,ce=d===d,Oe=ur(d);if(!Z&&!Oe&&!B&&u>d||B&&W&&ce&&!Z&&!Oe||_&&W&&ce||!m&&ce||!x)return 1;if(!_&&!B&&!Oe&&u<d||Oe&&m&&x&&!_&&!B||Z&&m&&x||!W&&x||!ce)return-1}return 0}function Hc(u,d,m){for(var _=-1,x=u.criteria,B=d.criteria,W=x.length,Z=m.length;++_<W;){var ce=Sg(x[_],B[_]);if(ce){if(_>=Z)return ce;var Oe=m[_];return ce*(Oe=="desc"?-1:1)}}return u.index-d.index}function Ld(u,d,m,_){for(var x=-1,B=u.length,W=m.length,Z=-1,ce=d.length,Oe=ts(B-W,0),Re=me(ce+Oe),Me=!_;++Z<ce;)Re[Z]=d[Z];for(;++x<W;)(Me||x<B)&&(Re[m[x]]=u[x]);for(;Oe--;)Re[Z++]=u[x++];return Re}function Bd(u,d,m,_){for(var x=-1,B=u.length,W=-1,Z=m.length,ce=-1,Oe=d.length,Re=ts(B-Z,0),Me=me(Re+Oe),We=!_;++x<Re;)Me[x]=u[x];for(var st=x;++ce<Oe;)Me[st+ce]=d[ce];for(;++W<Z;)(We||x<B)&&(Me[st+m[W]]=u[x++]);return Me}function Kn(u,d){var m=-1,_=u.length;for(d||(d=me(_));++m<_;)d[m]=u[m];return d}function ai(u,d,m,_){var x=!m;m||(m={});for(var B=-1,W=d.length;++B<W;){var Z=d[B],ce=_?_(m[Z],u[Z],Z,m,u):s;ce===s&&(ce=u[Z]),x?Si(m,Z,ce):Ol(m,Z,ce)}return m}function Wc(u,d){return ai(u,Yc(u),d)}function Eb(u,d){return ai(u,jd(u),d)}function Ci(u,d){return function(m,_){var x=Et(m)?ul:mb,B=d?d():{};return x(m,u,ot(_,2),B)}}function Da(u){return Rt(function(d,m){var _=-1,x=m.length,B=x>1?m[x-1]:s,W=x>2?m[2]:s;for(B=u.length>3&&typeof B=="function"?(x--,B):s,W&&Tt(m[0],m[1],W)&&(B=x<3?s:B,x=1),d=bt(d);++_<x;){var Z=m[_];Z&&u(d,Z,_,B)}return d})}function Bl(u,d){return function(m,_){if(m==null)return m;if(!is(m))return u(m,_);for(var x=m.length,B=d?x:-1,W=bt(m);(d?B--:++B<x)&&_(W[B],B,W)!==!1;);return m}}function Cg(u){return function(d,m,_){for(var x=-1,B=bt(d),W=_(d),Z=W.length;Z--;){var ce=W[u?Z:++x];if(m(B[ce],ce,B)===!1)break}return d}}function _s(u,d,m){var _=d&R,x=Ra(u);function B(){var W=this&&this!==Gn&&this instanceof B?x:u;return W.apply(_?m:this,arguments)}return B}function Oa(u){return function(d){d=rn(d);var m=Oo(d)?Nr(d):s,_=m?m[0]:d.charAt(0),x=m?ge(m,1).join(""):d.slice(1);return _[u]()+x}}function Os(u){return function(d){return Ec(fh(dh(d).replace(Am,"")),u,"")}}function Ra(u){return function(){var d=arguments;switch(d.length){case 0:return new u;case 1:return new u(d[0]);case 2:return new u(d[0],d[1]);case 3:return new u(d[0],d[1],d[2]);case 4:return new u(d[0],d[1],d[2],d[3]);case 5:return new u(d[0],d[1],d[2],d[3],d[4]);case 6:return new u(d[0],d[1],d[2],d[3],d[4],d[5]);case 7:return new u(d[0],d[1],d[2],d[3],d[4],d[5],d[6])}var m=ii(u.prototype),_=u.apply(m,d);return Dn(_)?_:m}}function Tg(u,d,m){var _=Ra(u);function x(){for(var B=arguments.length,W=me(B),Z=B,ce=Ma(x);Z--;)W[Z]=arguments[Z];var Oe=B<3&&W[0]!==ce&&W[B-1]!==ce?[]:$i(W,ce);if(B-=Oe.length,B<m)return Gc(u,d,Aa,x.placeholder,s,W,Oe,s,s,m-B);var Re=this&&this!==Gn&&this instanceof x?_:u;return tr(Re,this,W)}return x}function kb(u){return function(d,m,_){var x=bt(d);if(!is(d)){var B=ot(m,3);d=ps(d),m=function(Z){return B(x[Z],Z,x)}}var W=u(d,m,_);return W>-1?x[B?d[W]:W]:s}}function Eg(u){return Ei(function(d){var m=d.length,_=m,x=ns.prototype.thru;for(u&&d.reverse();_--;){var B=d[_];if(typeof B!="function")throw new vs(h);if(x&&!W&&Kc(B)=="wrapper")var W=new ns([],!0)}for(_=W?_:m;++_<m;){B=d[_];var Z=Kc(B),ce=Z=="wrapper"?Ag(B):s;ce&&Ii(ce[0])&&ce[1]==(Y|L|V|te)&&!ce[4].length&&ce[9]==1?W=W[Kc(ce[0])].apply(W,ce[3]):W=B.length==1&&Ii(B)?W[Z]():W.thru(B)}return function(){var Oe=arguments,Re=Oe[0];if(W&&Oe.length==1&&Et(Re))return W.plant(Re).value();for(var Me=0,We=m?d[Me].apply(this,Oe):Re;++Me<m;)We=d[Me].call(this,We);return We}})}function Aa(u,d,m,_,x,B,W,Z,ce,Oe){var Re=d&Y,Me=d&R,We=d&F,st=d&(L|T),ht=d&J,Dt=We?s:Ra(u);function pt(){for(var zt=arguments.length,Gt=me(zt),Gs=zt;Gs--;)Gt[Gs]=arguments[Gs];if(st)var Ls=Ma(pt),pr=Gm(Gt,Ls);if(_&&(Gt=Ld(Gt,_,x,st)),B&&(Gt=Bd(Gt,B,W,st)),zt-=pr,st&&zt<Oe){var Yn=$i(Gt,Ls);return Gc(u,d,Aa,pt.placeholder,m,Gt,Yn,Z,ce,Oe-zt)}var Jr=Me?m:this,Ai=We?Jr[u]:u;return zt=Gt.length,Z?Gt=Oy(Gt,Z):ht&&zt>1&&Gt.reverse(),Re&&ce<zt&&(Gt.length=ce),this&&this!==Gn&&this instanceof pt&&(Ai=Dt||Ra(Ai)),Ai.apply(Jr,Gt)}return pt}function jo(u,d){return function(m,_){return sg(m,u,d(_),{})}}function Na(u,d){return function(m,_){var x;if(m===s&&_===s)return d;if(m!==s&&(x=m),_!==s){if(x===s)return _;typeof m=="string"||typeof _=="string"?(m=ir(m),_=ir(_)):(m=$g(m),_=$g(_)),x=u(m,_)}return x}}function eo(u){return Ei(function(d){return d=wn(d,nr(ot())),Rt(function(m){var _=this;return u(d,function(x){return tr(x,_,m)})})})}function Pl(u,d){d=d===s?" ":ir(d);var m=d.length;if(m<2)return m?jc(d,u):d;var _=jc(d,kl(u/va(d)));return Oo(d)?ge(Nr(_),0,u).join(""):_.slice(0,u)}function Ib(u,d,m,_){var x=d&R,B=Ra(u);function W(){for(var Z=-1,ce=arguments.length,Oe=-1,Re=_.length,Me=me(Re+ce),We=this&&this!==Gn&&this instanceof W?B:u;++Oe<Re;)Me[Oe]=_[Oe];for(;ce--;)Me[Oe++]=arguments[++Z];return tr(We,x?m:this,Me)}return W}function kg(u){return function(d,m,_){return _&&typeof _!="number"&&Tt(d,m,_)&&(m=_=s),d=X(d),m===s?(m=d,d=0):m=X(m),_=_===s?d<m?1:-1:X(_),pg(d,m,_,u)}}function Vc(u){return function(d,m){return typeof d=="string"&&typeof m=="string"||(d=dr(d),m=dr(m)),u(d,m)}}function Gc(u,d,m,_,x,B,W,Z,ce,Oe){var Re=d&L,Me=Re?W:s,We=Re?s:W,st=Re?B:s,ht=Re?s:B;d|=Re?V:K,d&=~(Re?K:V),d&M||(d&=~(R|F));var Dt=[u,d,x,st,Me,ht,We,Z,ce,Oe],pt=m.apply(s,Dt);return Ii(u)&&Wd(pt,Dt),pt.placeholder=_,Pg(pt,u,d)}function Fl(u){var d=Zn[u];return function(m,_){if(m=dr(m),_=_==null?0:ys(ft(_),292),_&&Ki(m)){var x=(rn(m)+"e").split("e"),B=d(x[0]+"e"+(+x[1]+_));return x=(rn(B)+"e").split("e"),+(x[0]+"e"+(+x[1]-_))}return d(m)}}var Ig=wa&&1/vl(new wa([,-0]))[1]==Fe?function(u){return new wa(u)}:Kr;function xg(u){return function(d){var m=Ae(d);return m==Xt?Qu(d):m==Ft?Hi(d):xp(d,u(d))}}function Ti(u,d,m,_,x,B,W,Z){var ce=d&F;if(!ce&&typeof u!="function")throw new vs(h);var Oe=_?_.length:0;if(Oe||(d&=~(V|K),_=x=s),W=W===s?W:ts(ft(W),0),Z=Z===s?Z:ft(Z),Oe-=x?x.length:0,d&K){var Re=_,Me=x;_=x=s}var We=ce?s:Ag(u),st=[u,d,m,_,x,Re,Me,B,W,Z];if(We&&Lg(st,We),u=st[0],d=st[1],m=st[2],_=st[3],x=st[4],Z=st[9]=st[9]===s?ce?0:u.length:ts(st[9]-Oe,0),!Z&&d&(L|T)&&(d&=~(L|T)),!d||d==R)var ht=_s(u,d,m);else d==L||d==T?ht=Tg(u,d,Z):(d==V||d==(R|V))&&!x.length?ht=Ib(u,d,m,_):ht=Aa.apply(s,st);var Dt=We?Dd:Wd;return Pg(Dt(ht,st),u,d)}function Dg(u,d,m,_){return u===s||ci(u,Wi[m])&&!Kt.call(_,m)?d:u}function xb(u,d,m,_,x,B){return Dn(u)&&Dn(d)&&(B.set(d,u),Ll(u,d,s,xb,B),B.delete(d)),u}function Db(u){return Yl(u)?s:u}function Og(u,d,m,_,x,B){var W=m&k,Z=u.length,ce=d.length;if(Z!=ce&&!(W&&ce>Z))return!1;var Oe=B.get(u),Re=B.get(d);if(Oe&&Re)return Oe==d&&Re==u;var Me=-1,We=!0,st=m&E?new Br:s;for(B.set(u,d),B.set(d,u);++Me<Z;){var ht=u[Me],Dt=d[Me];if(_)var pt=W?_(Dt,ht,Me,d,u,B):_(ht,Dt,Me,u,d,B);if(pt!==s){if(pt)continue;We=!1;break}if(st){if(!kc(d,function(zt,Gt){if(!$a(st,Gt)&&(ht===zt||x(ht,zt,m,_,B)))return st.push(Gt)})){We=!1;break}}else if(!(ht===Dt||x(ht,Dt,m,_,B))){We=!1;break}}return B.delete(u),B.delete(d),We}function Rg(u,d,m,_,x,B,W){switch(m){case we:if(u.byteLength!=d.byteLength||u.byteOffset!=d.byteOffset)return!1;u=u.buffer,d=d.buffer;case ue:return!(u.byteLength!=d.byteLength||!B(new Cl(u),new Cl(d)));case rt:case tt:case en:return ci(+u,+d);case Yt:return u.name==d.name&&u.message==d.message;case He:case St:return u==d+"";case Xt:var Z=Qu;case Ft:var ce=_&k;if(Z||(Z=vl),u.size!=d.size&&!ce)return!1;var Oe=W.get(u);if(Oe)return Oe==d;_|=E,W.set(u,d);var Re=Og(Z(u),Z(d),_,x,B,W);return W.delete(u),Re;case Tn:if(No)return No.call(u)==No.call(d)}return!1}function Pd(u,d,m,_,x,B){var W=m&k,Z=qc(u),ce=Z.length,Oe=qc(d),Re=Oe.length;if(ce!=Re&&!W)return!1;for(var Me=ce;Me--;){var We=Z[Me];if(!(W?We in d:Kt.call(d,We)))return!1}var st=B.get(u),ht=B.get(d);if(st&&ht)return st==d&&ht==u;var Dt=!0;B.set(u,d),B.set(d,u);for(var pt=W;++Me<ce;){We=Z[Me];var zt=u[We],Gt=d[We];if(_)var Gs=W?_(Gt,zt,We,d,u,B):_(zt,Gt,We,u,d,B);if(!(Gs===s?zt===Gt||x(zt,Gt,m,_,B):Gs)){Dt=!1;break}pt||(pt=We=="constructor")}if(Dt&&!pt){var Ls=u.constructor,pr=d.constructor;Ls!=pr&&"constructor"in u&&"constructor"in d&&!(typeof Ls=="function"&&Ls instanceof Ls&&typeof pr=="function"&&pr instanceof pr)&&(Dt=!1)}return B.delete(u),B.delete(d),Dt}function Ei(u){return wt(jl(u,s,zr),u+"")}function qc(u){return Pc(u,ps,Yc)}function Fd(u){return Pc(u,ms,jd)}var Ag=Nc?function(u){return Nc.get(u)}:Kr;function Kc(u){for(var d=u.name+"",m=Ca[d],_=Kt.call(Ca,d)?m.length:0;_--;){var x=m[_],B=x.func;if(B==null||B==u)return x.name}return d}function Ma(u){var d=Kt.call(N,"placeholder")?N:u;return d.placeholder}function ot(){var u=N.iteratee||Eu;return u=u===Eu?lg:u,arguments.length?u(arguments[0],arguments[1]):u}function Jc(u,d){var m=u.__data__;return Ob(d)?m[typeof d=="string"?"string":"hash"]:m.map}function li(u){for(var d=ps(u),m=d.length;m--;){var _=d[m],x=u[_];d[m]=[_,x,zo(x)]}return d}function un(u,d){var m=Rp(u,d);return yd(m)?m:s}function Ng(u){var d=Kt.call(u,qi),m=u[qi];try{u[qi]=s;var _=!0}catch{}var x=wl.call(u);return _&&(d?u[qi]=m:delete u[qi]),x}var Yc=sd?function(u){return u==null?[]:(u=bt(u),bi(sd(u),function(d){return zp.call(u,d)}))}:yh,jd=sd?function(u){for(var d=[];u;)si(d,Yc(u)),u=Oc(u);return d}:yh,Ae=xn;(rd&&Ae(new rd(new ArrayBuffer(1)))!=we||Il&&Ae(new Il)!=Xt||id&&Ae(id.resolve())!=vn||wa&&Ae(new wa)!=Ft||xl&&Ae(new xl)!=Ee)&&(Ae=function(u){var d=xn(u),m=d==Lt?u.constructor:s,_=m?wr(m):"";if(_)switch(_){case od:return we;case rb:return Xt;case ib:return vn;case Vp:return Ft;case ad:return Ee}return d});function Xc(u,d,m){for(var _=-1,x=m.length;++_<x;){var B=m[_],W=B.size;switch(B.type){case"drop":u+=W;break;case"dropRight":d-=W;break;case"take":d=ys(d,u+W);break;case"takeRight":u=ts(u,d-W);break}}return{start:u,end:d}}function ki(u){var d=u.match($c);return d?d[1].split(Uu):[]}function ar(u,d,m){d=Ds(d,u);for(var _=-1,x=d.length,B=!1;++_<x;){var W=ws(d[_]);if(!(B=u!=null&&m(u,W)))break;u=u[W]}return B||++_!=x?B:(x=u==null?0:u.length,!!x&&Ja(x)&&ae(W,x)&&(Et(u)||ao(u)))}function to(u){var d=u.length,m=new u.constructor(d);return d&&typeof u[0]=="string"&&Kt.call(u,"index")&&(m.index=u.index,m.input=u.input),m}function Fr(u){return typeof u.constructor=="function"&&!Zc(u)?ii(Oc(u)):{}}function Mg(u,d,m){var _=u.constructor;switch(d){case ue:return Nd(u);case rt:case tt:return new _(+u);case we:return Cb(u,m);case je:case ie:case Pe:case vt:case it:case En:case lt:case yn:case gn:return Md(u,m);case Xt:return new _;case en:case St:return new _(u);case He:return Tb(u);case Ft:return new _;case Tn:return Dy(u)}}function zd(u,d){var m=d.length;if(!m)return u;var _=m-1;return d[_]=(m>1?"& ":"")+d[_],d=d.join(m>2?", ":" "),u.replace(bc,`{
/* [wrapped with `+d+`] */
`)}function fs(u){return Et(u)||ao(u)||!!(El&&u&&u[El])}function ae(u,d){var m=typeof u;return d=d??Ce,!!d&&(m=="number"||m!="symbol"&&le.test(u))&&u>-1&&u%1==0&&u<d}function Tt(u,d,m){if(!Dn(m))return!1;var _=typeof d;return(_=="number"?is(m)&&ae(d,m.length):_=="string"&&d in m)?ci(m[d],u):!1}function Pt(u,d){if(Et(u))return!1;var m=typeof u;return m=="number"||m=="symbol"||m=="boolean"||u==null||ur(u)?!0:Fs.test(u)||!Vn.test(u)||d!=null&&u in bt(d)}function Ob(u){var d=typeof u;return d=="string"||d=="number"||d=="symbol"||d=="boolean"?u!=="__proto__":u===null}function Ii(u){var d=Kc(u),m=N[d];if(typeof m!="function"||!(d in _t.prototype))return!1;if(u===m)return!0;var _=Ag(m);return!!_&&u===_[0]}function Rb(u){return!!td&&td in u}var Ab=Vi?Ss:_h;function Zc(u){var d=u&&u.constructor,m=typeof d=="function"&&d.prototype||Wi;return u===m}function zo(u){return u===u&&!Dn(u)}function Un(u,d){return function(m){return m==null?!1:m[u]===d&&(d!==s||u in bt(m))}}function Ud(u){var d=Ka(u,function(_){return m.size===$&&m.clear(),_}),m=d.cache;return d}function Lg(u,d){var m=u[1],_=d[1],x=m|_,B=x<(R|F|Y),W=_==Y&&m==L||_==Y&&m==te&&u[7].length<=d[8]||_==(Y|te)&&d[7].length<=d[8]&&m==L;if(!(B||W))return u;_&R&&(u[2]=d[2],x|=m&R?0:M);var Z=d[3];if(Z){var ce=u[3];u[3]=ce?Ld(ce,Z,d[4]):Z,u[4]=ce?$i(u[3],y):d[4]}return Z=d[5],Z&&(ce=u[5],u[5]=ce?Bd(ce,Z,d[6]):Z,u[6]=ce?$i(u[5],y):d[6]),Z=d[7],Z&&(u[7]=Z),_&Y&&(u[8]=u[8]==null?d[8]:ys(u[8],d[8])),u[9]==null&&(u[9]=d[9]),u[0]=d[0],u[1]=x,u}function Hd(u){var d=[];if(u!=null)for(var m in bt(u))d.push(m);return d}function Qc(u){return wl.call(u)}function jl(u,d,m){return d=ts(d===s?u.length-1:d,0),function(){for(var _=arguments,x=-1,B=ts(_.length-d,0),W=me(B);++x<B;)W[x]=_[d+x];x=-1;for(var Z=me(d+1);++x<d;)Z[x]=_[x];return Z[d]=m(W),tr(u,this,Z)}}function Bg(u,d){return d.length<2?u:Po(u,rr(d,0,-1))}function Oy(u,d){for(var m=u.length,_=ys(d.length,m),x=Kn(u);_--;){var B=d[_];u[_]=ae(B,m)?x[B]:s}return u}function Uo(u,d){if(!(d==="constructor"&&typeof u[d]=="function")&&d!="__proto__")return u[d]}var Wd=no(Dd),zl=Ac||function(u,d){return Gn.setTimeout(u,d)},wt=no(mg);function Pg(u,d,m){var _=d+"";return wt(u,zd(_,Us(ki(_),m)))}function no(u){var d=0,m=0;return function(){var _=Hp(),x=q-(_-m);if(m=_,x>0){if(++d>=he)return arguments[0]}else d=0;return u.apply(s,arguments)}}function jr(u,d){var m=-1,_=u.length,x=_-1;for(d=d===s?_:d;++m<d;){var B=xd(m,x),W=u[B];u[B]=u[m],u[m]=W}return u.length=d,u}var La=Ud(function(u){var d=[];return u.charCodeAt(0)===46&&d.push(""),u.replace(fi,function(m,_,x,B){d.push(x?B.replace(H,"$1"):_||m)}),d});function ws(u){if(typeof u=="string"||ur(u))return u;var d=u+"";return d=="0"&&1/u==-Fe?"-0":d}function wr(u){if(u!=null){try{return _l.call(u)}catch{}try{return u+""}catch{}}return""}function Us(u,d){return zs(Ke,function(m){var _="_."+m[0];d&m[1]&&!dl(u,_)&&u.push(_)}),u.sort()}function Fg(u){if(u instanceof _t)return u.clone();var d=new ns(u.__wrapped__,u.__chain__);return d.__actions__=Kn(u.__actions__),d.__index__=u.__index__,d.__values__=u.__values__,d}function Nb(u,d,m){(m?Tt(u,d,m):d===s)?d=1:d=ts(ft(d),0);var _=u==null?0:u.length;if(!_||d<1)return[];for(var x=0,B=0,W=me(kl(_/d));x<_;)W[B++]=rr(u,x,x+=d);return W}function Mb(u){for(var d=-1,m=u==null?0:u.length,_=0,x=[];++d<m;){var B=u[d];B&&(x[_++]=B)}return x}function Lb(){var u=arguments.length;if(!u)return[];for(var d=me(u-1),m=arguments[0],_=u;_--;)d[_-1]=arguments[_];return si(Et(m)?Kn(m):[m],ds(d,1))}var Bb=Rt(function(u,d){return Qn(u)?Yi(u,ds(d,1,Qn,!0)):[]}),Ry=Rt(function(u,d){var m=lr(d);return Qn(m)&&(m=s),Qn(u)?Yi(u,ds(d,1,Qn,!0),ot(m,2)):[]}),jg=Rt(function(u,d){var m=lr(d);return Qn(m)&&(m=s),Qn(u)?Yi(u,ds(d,1,Qn,!0),s,m):[]});function Pb(u,d,m){var _=u==null?0:u.length;return _?(d=m||d===s?1:ft(d),rr(u,d<0?0:d,_)):[]}function Vd(u,d,m){var _=u==null?0:u.length;return _?(d=m||d===s?1:ft(d),d=_-d,rr(u,0,d<0?0:d)):[]}function zg(u,d){return u&&u.length?xe(u,ot(d,3),!0,!0):[]}function Gd(u,d){return u&&u.length?xe(u,ot(d,3),!0):[]}function Ug(u,d,m,_){var x=u==null?0:u.length;return x?(m&&typeof m!="number"&&Tt(u,d,m)&&(m=0,_=x),eg(u,d,m,_)):[]}function Fb(u,d,m){var _=u==null?0:u.length;if(!_)return-1;var x=m==null?0:ft(m);return x<0&&(x=ts(_+x,0)),hl(u,ot(d,3),x)}function jb(u,d,m){var _=u==null?0:u.length;if(!_)return-1;var x=_-1;return m!==s&&(x=ft(m),x=m<0?ts(_+x,0):ys(x,_-1)),hl(u,ot(d,3),x,!0)}function zr(u){var d=u==null?0:u.length;return d?ds(u,1):[]}function hs(u){var d=u==null?0:u.length;return d?ds(u,Fe):[]}function eu(u,d){var m=u==null?0:u.length;return m?(d=d===s?1:ft(d),ds(u,d)):[]}function Hg(u){for(var d=-1,m=u==null?0:u.length,_={};++d<m;){var x=u[d];_[x[0]]=x[1]}return _}function qd(u){return u&&u.length?u[0]:s}function tu(u,d,m){var _=u==null?0:u.length;if(!_)return-1;var x=m==null?0:ft(m);return x<0&&(x=ts(_+x,0)),Do(u,d,x)}function Kd(u){var d=u==null?0:u.length;return d?rr(u,0,-1):[]}var Hs=Rt(function(u){var d=wn(u,Pr);return d.length&&d[0]===u[0]?Ta(d):[]}),Ay=Rt(function(u){var d=lr(u),m=wn(u,Pr);return d===lr(m)?d=s:m.pop(),m.length&&m[0]===u[0]?Ta(m,ot(d,2)):[]}),Jd=Rt(function(u){var d=lr(u),m=wn(u,Pr);return d=typeof d=="function"?d:s,d&&m.pop(),m.length&&m[0]===u[0]?Ta(m,s,d):[]});function Wg(u,d){return u==null?"":Up.call(u,d)}function lr(u){var d=u==null?0:u.length;return d?u[d-1]:s}function Ul(u,d,m){var _=u==null?0:u.length;if(!_)return-1;var x=_;return m!==s&&(x=ft(m),x=x<0?ts(_+x,0):ys(x,_-1)),d===d?Mp(u,d,x):hl(u,pl,x,!0)}function Vg(u,d){return u&&u.length?Cd(u,ft(d)):s}var zb=Rt(nu);function nu(u,d){return u&&u.length&&d&&d.length?Ia(u,d):u}function Ub(u,d,m){return u&&u.length&&d&&d.length?Ia(u,d,ot(m,2)):u}function Hb(u,d,m){return u&&u.length&&d&&d.length?Ia(u,d,s,m):u}var Wb=Ei(function(u,d){var m=u==null?0:u.length,_=fd(u,d);return Id(u,wn(d,function(x){return ae(x,m)?+x:x}).sort(Sg)),_});function Vb(u,d){var m=[];if(!(u&&u.length))return m;var _=-1,x=[],B=u.length;for(d=ot(d,3);++_<B;){var W=u[_];d(W,_,u)&&(m.push(W),x.push(_))}return Id(u,x),m}function so(u){return u==null?u:Wp.call(u)}function Gg(u,d,m){var _=u==null?0:u.length;return _?(m&&typeof m!="number"&&Tt(u,d,m)?(d=0,m=_):(d=d==null?0:ft(d),m=m===s?_:ft(m)),rr(u,d,m)):[]}function Gb(u,d){return zc(u,d)}function su(u,d,m){return Od(u,d,ot(m,2))}function qg(u,d){var m=u==null?0:u.length;if(m){var _=zc(u,d);if(_<m&&ci(u[_],d))return _}return-1}function ru(u,d){return zc(u,d,!0)}function Kg(u,d,m){return Od(u,d,ot(m,2),!0)}function Jg(u,d){var m=u==null?0:u.length;if(m){var _=zc(u,d,!0)-1;if(ci(u[_],d))return _}return-1}function qb(u){return u&&u.length?Rd(u):[]}function Rs(u,d){return u&&u.length?Rd(u,ot(d,2)):[]}function Hl(u){var d=u==null?0:u.length;return d?rr(u,1,d):[]}function Kb(u,d,m){return u&&u.length?(d=m||d===s?1:ft(d),rr(u,0,d<0?0:d)):[]}function iu(u,d,m){var _=u==null?0:u.length;return _?(d=m||d===s?1:ft(d),d=_-d,rr(u,d<0?0:d,_)):[]}function Jb(u,d){return u&&u.length?xe(u,ot(d,3),!1,!0):[]}function Yb(u,d){return u&&u.length?xe(u,ot(d,3)):[]}var Xb=Rt(function(u){return Zi(ds(u,1,Qn,!0))}),Ba=Rt(function(u){var d=lr(u);return Qn(d)&&(d=s),Zi(ds(u,1,Qn,!0),ot(d,2))}),Zb=Rt(function(u){var d=lr(u);return d=typeof d=="function"?d:s,Zi(ds(u,1,Qn,!0),s,d)});function ou(u){return u&&u.length?Zi(u):[]}function ss(u,d){return u&&u.length?Zi(u,ot(d,2)):[]}function Pa(u,d){return d=typeof d=="function"?d:s,u&&u.length?Zi(u,s,d):[]}function ro(u){if(!(u&&u.length))return[];var d=0;return u=bi(u,function(m){if(Qn(m))return d=ts(m.length,d),!0}),ba(d,function(m){return wn(u,gl(m))})}function au(u,d){if(!(u&&u.length))return[];var m=ro(u);return d==null?m:wn(m,function(_){return tr(d,s,_)})}var lu=Rt(function(u,d){return Qn(u)?Yi(u,d):[]}),Yg=Rt(function(u){return yg(bi(u,Qn))}),Qb=Rt(function(u){var d=lr(u);return Qn(d)&&(d=s),yg(bi(u,Qn),ot(d,2))}),Xg=Rt(function(u){var d=lr(u);return d=typeof d=="function"?d:s,yg(bi(u,Qn),s,d)}),Yd=Rt(ro);function Zg(u,d){return Uc(u||[],d||[],Ol)}function Fa(u,d){return Uc(u||[],d||[],xa)}var Wl=Rt(function(u){var d=u.length,m=d>1?u[d-1]:s;return m=typeof m=="function"?(u.pop(),m):s,au(u,m)});function ja(u){var d=N(u);return d.__chain__=!0,d}function sn(u,d){return d(u),u}function io(u,d){return d(u)}var za=Ei(function(u){var d=u.length,m=d?u[0]:0,_=this.__wrapped__,x=function(B){return fd(B,u)};return d>1||this.__actions__.length||!(_ instanceof _t)||!ae(m)?this.thru(x):(_=_.slice(m,+m+(d?1:0)),_.__actions__.push({func:io,args:[x],thisArg:s}),new ns(_,this.__chain__).thru(function(B){return d&&!B.length&&B.push(s),B}))});function Qg(){return ja(this)}function Ho(){return new ns(this.value(),this.__chain__)}function e$(){this.__values__===s&&(this.__values__=f$(this.value()));var u=this.__index__>=this.__values__.length,d=u?s:this.__values__[this.__index__++];return{done:u,value:d}}function ef(){return this}function As(u){for(var d,m=this;m instanceof yi;){var _=Fg(m);_.__index__=0,_.__values__=s,d?x.__wrapped__=_:d=_;var x=_;m=m.__wrapped__}return x.__wrapped__=u,d}function cu(){var u=this.__wrapped__;if(u instanceof _t){var d=u;return this.__actions__.length&&(d=new _t(this)),d=d.reverse(),d.__actions__.push({func:io,args:[so],thisArg:s}),new ns(d,this.__chain__)}return this.thru(so)}function Vl(){return Qi(this.__wrapped__,this.__actions__)}var Xd=Ci(function(u,d,m){Kt.call(u,m)?++u[m]:Si(u,m,1)});function uu(u,d,m){var _=Et(u)?ma:Qp;return m&&Tt(u,d,m)&&(d=s),_(u,ot(d,3))}function Gl(u,d){var m=Et(u)?bi:Bc;return m(u,ot(d,3))}var t$=kb(Fb),n$=kb(jb);function Ua(u,d){return ds(Ha(u,d),1)}function tf(u,d){return ds(Ha(u,d),Fe)}function nf(u,d,m){return m=m===s?1:ft(m),ds(Ha(u,d),m)}function Sr(u,d){var m=Et(u)?zs:Xi;return m(u,ot(d,3))}function ql(u,d){var m=Et(u)?Hm:md;return m(u,ot(d,3))}var sf=Ci(function(u,d,m){Kt.call(u,m)?u[m].push(d):Si(u,m,[d])});function rf(u,d,m,_){u=is(u)?u:Xa(u),m=m&&!_?ft(m):0;var x=u.length;return m<0&&(m=ts(x+m,0)),$u(u)?m<=x&&u.indexOf(d,m)>-1:!!x&&Do(u,d,m)>-1}var s$=Rt(function(u,d,m){var _=-1,x=typeof d=="function",B=is(u)?me(u.length):[];return Xi(u,function(W){B[++_]=x?tr(d,W,m):Ea(W,d,m)}),B}),r$=Ci(function(u,d,m){Si(u,m,d)});function Ha(u,d){var m=Et(u)?wn:cg;return m(u,ot(d,3))}function rs(u,d,m,_){return u==null?[]:(Et(d)||(d=d==null?[]:[d]),m=_?s:m,Et(m)||(m=m==null?[]:[m]),Td(u,d,m))}var Cr=Ci(function(u,d,m){u[m?0:1].push(d)},function(){return[[],[]]});function of(u,d,m){var _=Et(u)?Ec:ri,x=arguments.length<3;return _(u,ot(d,4),m,x,Xi)}function af(u,d,m){var _=Et(u)?Wm:ri,x=arguments.length<3;return _(u,ot(d,4),m,x,md)}function i$(u,d){var m=Et(u)?bi:Bc;return m(u,Qd(ot(d,3)))}function Ur(u){var d=Et(u)?pd:gg;return d(u)}function du(u,d,m){(m?Tt(u,d,m):d===s)?d=1:d=ft(d);var _=Et(u)?gd:fg;return _(u,d)}function fn(u){var d=Et(u)?Yp:bg;return d(u)}function Jn(u){if(u==null)return 0;if(is(u))return $u(u)?va(u):u.length;var d=Ae(u);return d==Xt||d==Ft?u.size:_d(u).length}function Kl(u,d,m){var _=Et(u)?kc:Sb;return m&&Tt(u,d,m)&&(d=s),_(u,ot(d,3))}var lf=Rt(function(u,d){if(u==null)return[];var m=d.length;return m>1&&Tt(u,d[0],d[1])?d=[]:m>2&&Tt(d[0],d[1],d[2])&&(d=[d[0]]),Td(u,ds(d,1),[])}),Wa=tb||function(){return Gn.Date.now()};function Zd(u,d){if(typeof d!="function")throw new vs(h);return u=ft(u),function(){if(--u<1)return d.apply(this,arguments)}}function Va(u,d,m){return d=m?s:d,d=u&&d==null?u.length:d,Ti(u,Y,s,s,s,s,d)}function Ga(u,d){var m;if(typeof d!="function")throw new vs(h);return u=ft(u),function(){return--u>0&&(m=d.apply(this,arguments)),u<=1&&(d=s),m}}var Tr=Rt(function(u,d,m){var _=R;if(m.length){var x=$i(m,Ma(Tr));_|=V}return Ti(u,_,d,m,x)}),Hr=Rt(function(u,d,m){var _=R|F;if(m.length){var x=$i(m,Ma(Hr));_|=V}return Ti(d,_,u,m,x)});function hu(u,d,m){d=m?s:d;var _=Ti(u,L,s,s,s,s,s,d);return _.placeholder=hu.placeholder,_}function cf(u,d,m){d=m?s:d;var _=Ti(u,T,s,s,s,s,s,d);return _.placeholder=cf.placeholder,_}function pu(u,d,m){var _,x,B,W,Z,ce,Oe=0,Re=!1,Me=!1,We=!0;if(typeof u!="function")throw new vs(h);d=dr(d)||0,Dn(m)&&(Re=!!m.leading,Me="maxWait"in m,B=Me?ts(dr(m.maxWait)||0,d):B,We="trailing"in m?!!m.trailing:We);function st(Yn){var Jr=_,Ai=x;return _=x=s,Oe=Yn,W=u.apply(Ai,Jr),W}function ht(Yn){return Oe=Yn,Z=zl(zt,d),Re?st(Yn):W}function Dt(Yn){var Jr=Yn-ce,Ai=Yn-Oe,Af=d-Jr;return Me?ys(Af,B-Ai):Af}function pt(Yn){var Jr=Yn-ce,Ai=Yn-Oe;return ce===s||Jr>=d||Jr<0||Me&&Ai>=B}function zt(){var Yn=Wa();if(pt(Yn))return Gt(Yn);Z=zl(zt,Dt(Yn))}function Gt(Yn){return Z=s,We&&_?st(Yn):(_=x=s,W)}function Gs(){Z!==s&&_g(Z),Oe=0,_=ce=x=Z=s}function Ls(){return Z===s?W:Gt(Wa())}function pr(){var Yn=Wa(),Jr=pt(Yn);if(_=arguments,x=this,ce=Yn,Jr){if(Z===s)return ht(ce);if(Me)return _g(Z),Z=zl(zt,d),st(ce)}return Z===s&&(Z=zl(zt,d)),W}return pr.cancel=Gs,pr.flush=Ls,pr}var qa=Rt(function(u,d){return Al(u,1,d)}),At=Rt(function(u,d,m){return Al(u,dr(d)||0,m)});function Wo(u){return Ti(u,J)}function Ka(u,d){if(typeof u!="function"||d!=null&&typeof d!="function")throw new vs(h);var m=function(){var _=arguments,x=d?d.apply(this,_):_[0],B=m.cache;if(B.has(x))return B.get(x);var W=u.apply(this,_);return m.cache=B.set(x,W)||B,W};return m.cache=new(Ka.Cache||_i),m}Ka.Cache=_i;function Qd(u){if(typeof u!="function")throw new vs(h);return function(){var d=arguments;switch(d.length){case 0:return!u.call(this);case 1:return!u.call(this,d[0]);case 2:return!u.call(this,d[0],d[1]);case 3:return!u.call(this,d[0],d[1],d[2])}return!u.apply(this,d)}}function o$(u){return Ga(2,u)}var a$=or(function(u,d){d=d.length==1&&Et(d[0])?wn(d[0],nr(ot())):wn(ds(d,1),nr(ot()));var m=d.length;return Rt(function(_){for(var x=-1,B=ys(_.length,m);++x<B;)_[x]=d[x].call(this,_[x]);return tr(u,this,_)})}),eh=Rt(function(u,d){var m=$i(d,Ma(eh));return Ti(u,V,s,d,m)}),gu=Rt(function(u,d){var m=$i(d,Ma(gu));return Ti(u,K,s,d,m)}),th=Ei(function(u,d){return Ti(u,te,s,s,s,d)});function Ns(u,d){if(typeof u!="function")throw new vs(h);return d=d===s?d:ft(d),Rt(u,d)}function uf(u,d){if(typeof u!="function")throw new vs(h);return d=d==null?0:ts(ft(d),0),Rt(function(m){var _=m[d],x=ge(m,0,d);return _&&si(x,_),tr(u,this,x)})}function Ny(u,d,m){var _=!0,x=!0;if(typeof u!="function")throw new vs(h);return Dn(m)&&(_="leading"in m?!!m.leading:_,x="trailing"in m?!!m.trailing:x),pu(u,d,{leading:_,maxWait:d,trailing:x})}function df(u){return Va(u,1)}function hf(u,d){return eh(Ne(d),u)}function Ge(){if(!arguments.length)return[];var u=arguments[0];return Et(u)?u:[u]}function Jl(u){return _r(u,S)}function nh(u,d){return d=typeof d=="function"?d:s,_r(u,S,d)}function fu(u){return _r(u,w|S)}function mu(u,d){return d=typeof d=="function"?d:s,_r(u,w|S,d)}function l$(u,d){return d==null||Zp(u,d,ps(d))}function ci(u,d){return u===d||u!==u&&d!==d}var My=Vc($d),oo=Vc(function(u,d){return u>=d}),ao=vd(function(){return arguments}())?vd:function(u){return Sn(u)&&Kt.call(u,"callee")&&!zp.call(u,"callee")},Et=me.isArray,c$=yp?nr(yp):rg;function is(u){return u!=null&&Ja(u.length)&&!Ss(u)}function Qn(u){return Sn(u)&&is(u)}function Ly(u){return u===!0||u===!1||Sn(u)&&xn(u)==rt}var ui=nb||_h,Wr=_p?nr(_p):ig;function u$(u){return Sn(u)&&u.nodeType===1&&!Yl(u)}function sh(u){if(u==null)return!0;if(is(u)&&(Et(u)||typeof u=="string"||typeof u.splice=="function"||ui(u)||Vo(u)||ao(u)))return!u.length;var d=Ae(u);if(d==Xt||d==Ft)return!u.size;if(Zc(u))return!_d(u).length;for(var m in u)if(Kt.call(u,m))return!1;return!0}function cr(u,d){return ka(u,d)}function d$(u,d,m){m=typeof m=="function"?m:s;var _=m?m(u,d):s;return _===s?ka(u,d,s,m):!!_}function Ws(u){if(!Sn(u))return!1;var d=xn(u);return d==Yt||d==It||typeof u.message=="string"&&typeof u.name=="string"&&!Yl(u)}function dn(u){return typeof u=="number"&&Ki(u)}function Ss(u){if(!Dn(u))return!1;var d=xn(u);return d==Ut||d==Fn||d==ut||d==Ln}function bu(u){return typeof u=="number"&&u==ft(u)}function Ja(u){return typeof u=="number"&&u>-1&&u%1==0&&u<=Ce}function Dn(u){var d=typeof u;return u!=null&&(d=="object"||d=="function")}function Sn(u){return u!=null&&typeof u=="object"}var h$=wp?nr(wp):ag;function di(u,d){return u===d||Fc(u,d,li(d))}function Nt(u,d,m){return m=typeof m=="function"?m:s,Fc(u,d,li(d),m)}function lo(u){return rh(u)&&u!=+u}function Bn(u){if(Ab(u))throw new yt(c);return yd(u)}function p$(u){return u===null}function pf(u){return u==null}function rh(u){return typeof u=="number"||Sn(u)&&xn(u)==en}function Yl(u){if(!Sn(u)||xn(u)!=Lt)return!1;var d=Oc(u);if(d===null)return!0;var m=Kt.call(d,"constructor")&&d.constructor;return typeof m=="function"&&m instanceof m&&_l.call(m)==Zm}var ih=Sp?nr(Sp):vb;function co(u){return bu(u)&&u>=-Ce&&u<=Ce}var gf=Cp?nr(Cp):yb;function $u(u){return typeof u=="string"||!Et(u)&&Sn(u)&&xn(u)==St}function ur(u){return typeof u=="symbol"||Sn(u)&&xn(u)==Tn}var Vo=Ku?nr(Ku):_b;function uo(u){return u===s}function Go(u){return Sn(u)&&Ae(u)==Ee}function g$(u){return Sn(u)&&xn(u)==fe}var oh=Vc(wd),Vs=Vc(function(u,d){return u<=d});function f$(u){if(!u)return[];if(is(u))return $u(u)?Nr(u):Kn(u);if(ya&&u[ya])return Zu(u[ya]());var d=Ae(u),m=d==Xt?Qu:d==Ft?vl:Xa;return m(u)}function X(u){if(!u)return u===0?u:0;if(u=dr(u),u===Fe||u===-Fe){var d=u<0?-1:1;return d*Ze}return u===u?u:0}function ft(u){var d=X(u),m=d%1;return d===d?m?d-m:d:0}function Xl(u){return u?Lo(ft(u),0,Te):0}function dr(u){if(typeof u=="number")return u;if(ur(u))return pe;if(Dn(u)){var d=typeof u.valueOf=="function"?u.valueOf():u;u=Dn(d)?d+"":d}if(typeof u!="string")return u===0?u:+u;u=Xu(u);var m=de.test(u);return m||$e.test(u)?Um(u.slice(2),m?2:8):z.test(u)?pe:+u}function xi(u){return ai(u,ms(u))}function qo(u){return u?Lo(ft(u),-Ce,Ce):u===0?u:0}function rn(u){return u==null?"":ir(u)}var Zl=Da(function(u,d){if(Zc(d)||is(d)){ai(d,ps(d),u);return}for(var m in d)Kt.call(d,m)&&Ol(u,m,d[m])}),ah=Da(function(u,d){ai(d,ms(d),u)}),vu=Da(function(u,d,m,_){ai(d,ms(d),u,_)}),Er=Da(function(u,d,m,_){ai(d,ps(d),u,_)}),ff=Ei(fd);function yu(u,d){var m=ii(u);return d==null?m:Lc(m,d)}var mf=Rt(function(u,d){u=bt(u);var m=-1,_=d.length,x=_>2?d[2]:s;for(x&&Tt(d[0],d[1],x)&&(_=1);++m<_;)for(var B=d[m],W=ms(B),Z=-1,ce=W.length;++Z<ce;){var Oe=W[Z],Re=u[Oe];(Re===s||ci(Re,Wi[Oe])&&!Kt.call(u,Oe))&&(u[Oe]=B[Oe])}return u}),m$=Rt(function(u){return u.push(s,xb),tr(Ir,s,u)});function b$(u,d){return Ju(u,ot(d,3),oi)}function $$(u,d){return Ju(u,ot(d,3),Bo)}function v$(u,d){return u==null?u:bd(u,ot(d,3),ms)}function _u(u,d){return u==null?u:tg(u,ot(d,3),ms)}function bf(u,d){return u&&oi(u,ot(d,3))}function wu(u,d){return u&&Bo(u,ot(d,3))}function $f(u){return u==null?[]:Ml(u,ps(u))}function lh(u){return u==null?[]:Ml(u,ms(u))}function Ql(u,d,m){var _=u==null?s:Po(u,d);return _===s?m:_}function Ya(u,d){return u!=null&&ar(u,d,Fo)}function Ko(u,d){return u!=null&&ar(u,d,ng)}var Di=jo(function(u,d,m){d!=null&&typeof d.toString!="function"&&(d=wl.call(d)),u[d]=m},bh(Ms)),ho=jo(function(u,d,m){d!=null&&typeof d.toString!="function"&&(d=wl.call(d)),Kt.call(u,d)?u[d].push(m):u[d]=[m]},ot),kr=Rt(Ea);function ps(u){return is(u)?Jp(u):_d(u)}function ms(u){return is(u)?Jp(u,!0):wb(u)}function vf(u,d){var m={};return d=ot(d,3),oi(u,function(_,x,B){Si(m,d(_,x,B),_)}),m}function Jt(u,d){var m={};return d=ot(d,3),oi(u,function(_,x,B){Si(m,x,d(_,x,B))}),m}var Jo=Da(function(u,d,m){Ll(u,d,m)}),Ir=Da(function(u,d,m,_){Ll(u,d,m,_)}),Ie=Ei(function(u,d){var m={};if(u==null)return m;var _=!1;d=wn(d,function(B){return B=Ds(B,u),_||(_=B.length>1),B}),ai(u,Fd(u),m),_&&(m=_r(m,w|C|S,Db));for(var x=d.length;x--;)Ad(m,d[x]);return m});function yf(u,d){return y$(u,Qd(ot(d)))}var By=Ei(function(u,d){return u==null?{}:hg(u,d)});function y$(u,d){if(u==null)return{};var m=wn(Fd(u),function(_){return[_]});return d=ot(d),Ed(u,m,function(_,x){return d(_,x[0])})}function Py(u,d,m){d=Ds(d,u);var _=-1,x=d.length;for(x||(x=1,u=s);++_<x;){var B=u==null?s:u[ws(d[_])];B===s&&(_=x,B=m),u=Ss(B)?B.call(u):B}return u}function _f(u,d,m){return u==null?u:xa(u,d,m)}function ch(u,d,m,_){return _=typeof _=="function"?_:s,u==null?u:xa(u,d,m,_)}var Vr=xg(ps),Su=xg(ms);function on(u,d,m){var _=Et(u),x=_||ui(u)||Vo(u);if(d=ot(d,4),m==null){var B=u&&u.constructor;x?m=_?new B:[]:Dn(u)?m=Ss(B)?ii(Oc(u)):{}:m={}}return(x?zs:oi)(u,function(W,Z,ce){return d(m,W,Z,ce)}),m}function _$(u,d){return u==null?!0:Ad(u,d)}function wf(u,d,m){return u==null?u:vg(u,d,Ne(m))}function ec(u,d,m,_){return _=typeof _=="function"?_:s,u==null?u:vg(u,d,Ne(m),_)}function Xa(u){return u==null?[]:ml(u,ps(u))}function Za(u){return u==null?[]:ml(u,ms(u))}function Sf(u,d,m){return m===s&&(m=d,d=s),m!==s&&(m=dr(m),m=m===m?m:0),d!==s&&(d=dr(d),d=d===d?d:0),Lo(dr(u),d,m)}function Cf(u,d,m){return d=X(d),m===s?(m=d,d=0):m=X(m),u=dr(u),$b(u,d,m)}function w$(u,d,m){if(m&&typeof m!="boolean"&&Tt(u,d,m)&&(d=m=s),m===s&&(typeof d=="boolean"?(m=d,d=s):typeof u=="boolean"&&(m=u,u=s)),u===s&&d===s?(u=0,d=1):(u=X(u),d===s?(d=u,u=0):d=X(d)),u>d){var _=u;u=d,d=_}if(m||u%1||d%1){var x=Ao();return ys(u+x*(d-u+zm("1e-"+((x+"").length-1))),d)}return xd(u,d)}var Tf=Os(function(u,d,m){return d=d.toLowerCase(),u+(m?uh(d):d)});function uh(u){return rc(rn(u).toLowerCase())}function dh(u){return u=rn(u),u&&u.replace(Be,qm).replace($p,"")}function tc(u,d,m){u=rn(u),d=ir(d);var _=u.length;m=m===s?_:Lo(ft(m),0,_);var x=m;return m-=d.length,m>=0&&u.slice(m,x)==d}function Fy(u){return u=rn(u),u&&jn.test(u)?u.replace(An,Km):u}function S$(u){return u=rn(u),u&&mc.test(u)?u.replace(Or,"\\$&"):u}var jy=Os(function(u,d,m){return u+(m?"-":"")+d.toLowerCase()}),Gr=Os(function(u,d,m){return u+(m?" ":"")+d.toLowerCase()}),Ef=Oa("toLowerCase");function Cu(u,d,m){u=rn(u),d=ft(d);var _=d?va(u):0;if(!d||_>=d)return u;var x=(d-_)/2;return Pl(Ro(x),m)+u+Pl(kl(x),m)}function hh(u,d,m){u=rn(u),d=ft(d);var _=d?va(u):0;return d&&_<d?u+Pl(d-_,m):u}function C$(u,d,m){u=rn(u),d=ft(d);var _=d?va(u):0;return d&&_<d?Pl(d-_,m)+u:u}function T$(u,d,m){return m||d==null?d=0:d&&(d=+d),sb(rn(u).replace(Rr,""),d||0)}function kf(u,d,m){return(m?Tt(u,d,m):d===s)?d=1:d=ft(d),jc(rn(u),d)}function Tu(){var u=arguments,d=rn(u[0]);return u.length<3?d:d.replace(u[1],u[2])}var E$=Os(function(u,d,m){return u+(m?"_":"")+d.toLowerCase()});function k$(u,d,m){return m&&typeof m!="number"&&Tt(u,d,m)&&(d=m=s),m=m===s?Te:m>>>0,m?(u=rn(u),u&&(typeof d=="string"||d!=null&&!ih(d))&&(d=ir(d),!d&&Oo(u))?ge(Nr(u),0,m):u.split(d,m)):[]}var hr=Os(function(u,d,m){return u+(m?" ":"")+rc(d)});function qr(u,d,m){return u=rn(u),m=m==null?0:Lo(ft(m),0,u.length),d=ir(d),u.slice(m,m+d.length)==d}function I$(u,d,m){var _=N.templateSettings;m&&Tt(u,d,m)&&(d=s),u=rn(u),d=vu({},d,_,Dg);var x=vu({},d.imports,_.imports,Dg),B=ps(x),W=ml(x,B),Z,ce,Oe=0,Re=d.interpolate||Qe,Me="__p += '",We=ed((d.escape||Qe).source+"|"+Re.source+"|"+(Re===zn?A:Qe).source+"|"+(d.evaluate||Qe).source+"|$","g"),st="//# sourceURL="+(Kt.call(d,"sourceURL")?(d.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Sc+"]")+`
`;u.replace(We,function(pt,zt,Gt,Gs,Ls,pr){return Gt||(Gt=Gs),Me+=u.slice(Oe,pr).replace(xt,bl),zt&&(Z=!0,Me+=`' +
__e(`+zt+`) +
'`),Ls&&(ce=!0,Me+=`';
`+Ls+`;
__p += '`),Gt&&(Me+=`' +
((__t = (`+Gt+`)) == null ? '' : __t) +
'`),Oe=pr+pt.length,pt}),Me+=`';
`;var ht=Kt.call(d,"variable")&&d.variable;if(!ht)Me=`with (obj) {
`+Me+`
}
`;else if(U.test(ht))throw new yt(g);Me=(ce?Me.replace(Wn,""):Me).replace(Xn,"$1").replace(Xs,"$1;"),Me="function("+(ht||"obj")+`) {
`+(ht?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(Z?", __e = _.escape":"")+(ce?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+Me+`return __p
}`;var Dt=mh(function(){return Zt(B,st+"return "+Me).apply(s,W)});if(Dt.source=Me,Ws(Dt))throw Dt;return Dt}function ph(u){return rn(u).toLowerCase()}function If(u){return rn(u).toUpperCase()}function x$(u,d,m){if(u=rn(u),u&&(m||d===s))return Xu(u);if(!u||!(d=ir(d)))return u;var _=Nr(u),x=Nr(d),B=Dp(_,x),W=Op(_,x)+1;return ge(_,B,W).join("")}function nc(u,d,m){if(u=rn(u),u&&(m||d===s))return u.slice(0,Lp(u)+1);if(!u||!(d=ir(d)))return u;var _=Nr(u),x=Op(_,Nr(d))+1;return ge(_,0,x).join("")}function gh(u,d,m){if(u=rn(u),u&&(m||d===s))return u.replace(Rr,"");if(!u||!(d=ir(d)))return u;var _=Nr(u),x=Dp(_,Nr(d));return ge(_,x).join("")}function sc(u,d){var m=ne,_=Q;if(Dn(d)){var x="separator"in d?d.separator:x;m="length"in d?ft(d.length):m,_="omission"in d?ir(d.omission):_}u=rn(u);var B=u.length;if(Oo(u)){var W=Nr(u);B=W.length}if(m>=B)return u;var Z=m-va(_);if(Z<1)return _;var ce=W?ge(W,0,Z).join(""):u.slice(0,Z);if(x===s)return ce+_;if(W&&(Z+=ce.length-Z),ih(x)){if(u.slice(Z).search(x)){var Oe,Re=ce;for(x.global||(x=ed(x.source,rn(j.exec(x))+"g")),x.lastIndex=0;Oe=x.exec(Re);)var Me=Oe.index;ce=ce.slice(0,Me===s?Z:Me)}}else if(u.indexOf(ir(x),Z)!=Z){var We=ce.lastIndexOf(x);We>-1&&(ce=ce.slice(0,We))}return ce+_}function D$(u){return u=rn(u),u&&Bt.test(u)?u.replace(as,Jm):u}var zy=Os(function(u,d,m){return u+(m?" ":"")+d.toUpperCase()}),rc=Oa("toUpperCase");function fh(u,d,m){return u=rn(u),d=m?s:d,d===s?$l(u)?Pp(u):kp(u):u.match(d)||[]}var mh=Rt(function(u,d){try{return tr(u,s,d)}catch(m){return Ws(m)?m:new yt(m)}}),Uy=Ei(function(u,d){return zs(d,function(m){m=ws(m),Si(u,m,Tr(u[m],u))}),u});function Hy(u){var d=u==null?0:u.length,m=ot();return u=d?wn(u,function(_){if(typeof _[1]!="function")throw new vs(h);return[m(_[0]),_[1]]}):[],Rt(function(_){for(var x=-1;++x<d;){var B=u[x];if(tr(B[0],this,_))return tr(B[1],this,_)}})}function Wy(u){return Xp(_r(u,w))}function bh(u){return function(){return u}}function Vy(u,d){return u==null||u!==u?d:u}var O$=Eg(),an=Eg(!0);function Ms(u){return u}function Eu(u){return lg(typeof u=="function"?u:_r(u,w))}function Gy(u){return ug(_r(u,w))}function ku(u,d){return Sd(u,_r(d,w))}var Oi=Rt(function(u,d){return function(m){return Ea(m,u,d)}}),Yo=Rt(function(u,d){return function(m){return Ea(u,m,d)}});function Ri(u,d,m){var _=ps(d),x=Ml(d,_);m==null&&!(Dn(d)&&(x.length||!_.length))&&(m=d,d=u,u=this,x=Ml(d,ps(d)));var B=!(Dn(m)&&"chain"in m)||!!m.chain,W=Ss(u);return zs(x,function(Z){var ce=d[Z];u[Z]=ce,W&&(u.prototype[Z]=function(){var Oe=this.__chain__;if(B||Oe){var Re=u(this.__wrapped__),Me=Re.__actions__=Kn(this.__actions__);return Me.push({func:ce,args:arguments,thisArg:u}),Re.__chain__=Oe,Re}return ce.apply(u,si([this.value()],arguments))})}),u}function ic(){return Gn._===this&&(Gn._=Qm),this}function Kr(){}function qy(u){return u=ft(u),Rt(function(d){return Cd(d,u)})}var $h=eo(wn),R$=eo(ma),A$=eo(kc);function vh(u){return Pt(u)?gl(ws(u)):kd(u)}function Ky(u){return function(d){return u==null?s:Po(u,d)}}var xf=kg(),Df=kg(!0);function yh(){return[]}function _h(){return!1}function Qa(){return{}}function wh(){return""}function Sh(){return!0}function N$(u,d){if(u=ft(u),u<1||u>Ce)return[];var m=Te,_=ys(u,Te);d=ot(d),u-=Te;for(var x=ba(_,d);++m<u;)d(m);return x}function Ch(u){return Et(u)?wn(u,ws):ur(u)?[u]:Kn(La(rn(u)))}function M$(u){var d=++Dc;return rn(u)+d}var L$=Na(function(u,d){return u+d},0),B$=Fl("ceil"),P$=Na(function(u,d){return u/d},1),F$=Fl("floor");function Of(u){return u&&u.length?Nl(u,Ms,$d):s}function j$(u,d){return u&&u.length?Nl(u,ot(d,2),$d):s}function Xo(u){return Yu(u,Ms)}function z$(u,d){return Yu(u,ot(d,2))}function U$(u){return u&&u.length?Nl(u,Ms,wd):s}function H$(u,d){return u&&u.length?Nl(u,ot(d,2),wd):s}var oc=Na(function(u,d){return u*d},1),Jy=Fl("round"),Th=Na(function(u,d){return u-d},0);function Rf(u){return u&&u.length?Ic(u,Ms):0}function W$(u,d){return u&&u.length?Ic(u,ot(d,2)):0}return N.after=Zd,N.ary=Va,N.assign=Zl,N.assignIn=ah,N.assignInWith=vu,N.assignWith=Er,N.at=ff,N.before=Ga,N.bind=Tr,N.bindAll=Uy,N.bindKey=Hr,N.castArray=Ge,N.chain=ja,N.chunk=Nb,N.compact=Mb,N.concat=Lb,N.cond=Hy,N.conforms=Wy,N.constant=bh,N.countBy=Xd,N.create=yu,N.curry=hu,N.curryRight=cf,N.debounce=pu,N.defaults=mf,N.defaultsDeep=m$,N.defer=qa,N.delay=At,N.difference=Bb,N.differenceBy=Ry,N.differenceWith=jg,N.drop=Pb,N.dropRight=Vd,N.dropRightWhile=zg,N.dropWhile=Gd,N.fill=Ug,N.filter=Gl,N.flatMap=Ua,N.flatMapDeep=tf,N.flatMapDepth=nf,N.flatten=zr,N.flattenDeep=hs,N.flattenDepth=eu,N.flip=Wo,N.flow=O$,N.flowRight=an,N.fromPairs=Hg,N.functions=$f,N.functionsIn=lh,N.groupBy=sf,N.initial=Kd,N.intersection=Hs,N.intersectionBy=Ay,N.intersectionWith=Jd,N.invert=Di,N.invertBy=ho,N.invokeMap=s$,N.iteratee=Eu,N.keyBy=r$,N.keys=ps,N.keysIn=ms,N.map=Ha,N.mapKeys=vf,N.mapValues=Jt,N.matches=Gy,N.matchesProperty=ku,N.memoize=Ka,N.merge=Jo,N.mergeWith=Ir,N.method=Oi,N.methodOf=Yo,N.mixin=Ri,N.negate=Qd,N.nthArg=qy,N.omit=Ie,N.omitBy=yf,N.once=o$,N.orderBy=rs,N.over=$h,N.overArgs=a$,N.overEvery=R$,N.overSome=A$,N.partial=eh,N.partialRight=gu,N.partition=Cr,N.pick=By,N.pickBy=y$,N.property=vh,N.propertyOf=Ky,N.pull=zb,N.pullAll=nu,N.pullAllBy=Ub,N.pullAllWith=Hb,N.pullAt=Wb,N.range=xf,N.rangeRight=Df,N.rearg=th,N.reject=i$,N.remove=Vb,N.rest=Ns,N.reverse=so,N.sampleSize=du,N.set=_f,N.setWith=ch,N.shuffle=fn,N.slice=Gg,N.sortBy=lf,N.sortedUniq=qb,N.sortedUniqBy=Rs,N.split=k$,N.spread=uf,N.tail=Hl,N.take=Kb,N.takeRight=iu,N.takeRightWhile=Jb,N.takeWhile=Yb,N.tap=sn,N.throttle=Ny,N.thru=io,N.toArray=f$,N.toPairs=Vr,N.toPairsIn=Su,N.toPath=Ch,N.toPlainObject=xi,N.transform=on,N.unary=df,N.union=Xb,N.unionBy=Ba,N.unionWith=Zb,N.uniq=ou,N.uniqBy=ss,N.uniqWith=Pa,N.unset=_$,N.unzip=ro,N.unzipWith=au,N.update=wf,N.updateWith=ec,N.values=Xa,N.valuesIn=Za,N.without=lu,N.words=fh,N.wrap=hf,N.xor=Yg,N.xorBy=Qb,N.xorWith=Xg,N.zip=Yd,N.zipObject=Zg,N.zipObjectDeep=Fa,N.zipWith=Wl,N.entries=Vr,N.entriesIn=Su,N.extend=ah,N.extendWith=vu,Ri(N,N),N.add=L$,N.attempt=mh,N.camelCase=Tf,N.capitalize=uh,N.ceil=B$,N.clamp=Sf,N.clone=Jl,N.cloneDeep=fu,N.cloneDeepWith=mu,N.cloneWith=nh,N.conformsTo=l$,N.deburr=dh,N.defaultTo=Vy,N.divide=P$,N.endsWith=tc,N.eq=ci,N.escape=Fy,N.escapeRegExp=S$,N.every=uu,N.find=t$,N.findIndex=Fb,N.findKey=b$,N.findLast=n$,N.findLastIndex=jb,N.findLastKey=$$,N.floor=F$,N.forEach=Sr,N.forEachRight=ql,N.forIn=v$,N.forInRight=_u,N.forOwn=bf,N.forOwnRight=wu,N.get=Ql,N.gt=My,N.gte=oo,N.has=Ya,N.hasIn=Ko,N.head=qd,N.identity=Ms,N.includes=rf,N.indexOf=tu,N.inRange=Cf,N.invoke=kr,N.isArguments=ao,N.isArray=Et,N.isArrayBuffer=c$,N.isArrayLike=is,N.isArrayLikeObject=Qn,N.isBoolean=Ly,N.isBuffer=ui,N.isDate=Wr,N.isElement=u$,N.isEmpty=sh,N.isEqual=cr,N.isEqualWith=d$,N.isError=Ws,N.isFinite=dn,N.isFunction=Ss,N.isInteger=bu,N.isLength=Ja,N.isMap=h$,N.isMatch=di,N.isMatchWith=Nt,N.isNaN=lo,N.isNative=Bn,N.isNil=pf,N.isNull=p$,N.isNumber=rh,N.isObject=Dn,N.isObjectLike=Sn,N.isPlainObject=Yl,N.isRegExp=ih,N.isSafeInteger=co,N.isSet=gf,N.isString=$u,N.isSymbol=ur,N.isTypedArray=Vo,N.isUndefined=uo,N.isWeakMap=Go,N.isWeakSet=g$,N.join=Wg,N.kebabCase=jy,N.last=lr,N.lastIndexOf=Ul,N.lowerCase=Gr,N.lowerFirst=Ef,N.lt=oh,N.lte=Vs,N.max=Of,N.maxBy=j$,N.mean=Xo,N.meanBy=z$,N.min=U$,N.minBy=H$,N.stubArray=yh,N.stubFalse=_h,N.stubObject=Qa,N.stubString=wh,N.stubTrue=Sh,N.multiply=oc,N.nth=Vg,N.noConflict=ic,N.noop=Kr,N.now=Wa,N.pad=Cu,N.padEnd=hh,N.padStart=C$,N.parseInt=T$,N.random=w$,N.reduce=of,N.reduceRight=af,N.repeat=kf,N.replace=Tu,N.result=Py,N.round=Jy,N.runInContext=oe,N.sample=Ur,N.size=Jn,N.snakeCase=E$,N.some=Kl,N.sortedIndex=Gb,N.sortedIndexBy=su,N.sortedIndexOf=qg,N.sortedLastIndex=ru,N.sortedLastIndexBy=Kg,N.sortedLastIndexOf=Jg,N.startCase=hr,N.startsWith=qr,N.subtract=Th,N.sum=Rf,N.sumBy=W$,N.template=I$,N.times=N$,N.toFinite=X,N.toInteger=ft,N.toLength=Xl,N.toLower=ph,N.toNumber=dr,N.toSafeInteger=qo,N.toString=rn,N.toUpper=If,N.trim=x$,N.trimEnd=nc,N.trimStart=gh,N.truncate=sc,N.unescape=D$,N.uniqueId=M$,N.upperCase=zy,N.upperFirst=rc,N.each=Sr,N.eachRight=ql,N.first=qd,Ri(N,function(){var u={};return oi(N,function(d,m){Kt.call(N.prototype,m)||(u[m]=d)}),u}(),{chain:!1}),N.VERSION=i,zs(["bind","bindKey","curry","curryRight","partial","partialRight"],function(u){N[u].placeholder=N}),zs(["drop","take"],function(u,d){_t.prototype[u]=function(m){m=m===s?1:ts(ft(m),0);var _=this.__filtered__&&!d?new _t(this):this.clone();return _.__filtered__?_.__takeCount__=ys(m,_.__takeCount__):_.__views__.push({size:ys(m,Te),type:u+(_.__dir__<0?"Right":"")}),_},_t.prototype[u+"Right"]=function(m){return this.reverse()[u](m).reverse()}}),zs(["filter","map","takeWhile"],function(u,d){var m=d+1,_=m==re||m==ee;_t.prototype[u]=function(x){var B=this.clone();return B.__iteratees__.push({iteratee:ot(x,3),type:m}),B.__filtered__=B.__filtered__||_,B}}),zs(["head","last"],function(u,d){var m="take"+(d?"Right":"");_t.prototype[u]=function(){return this[m](1).value()[0]}}),zs(["initial","tail"],function(u,d){var m="drop"+(d?"":"Right");_t.prototype[u]=function(){return this.__filtered__?new _t(this):this[m](1)}}),_t.prototype.compact=function(){return this.filter(Ms)},_t.prototype.find=function(u){return this.filter(u).head()},_t.prototype.findLast=function(u){return this.reverse().find(u)},_t.prototype.invokeMap=Rt(function(u,d){return typeof u=="function"?new _t(this):this.map(function(m){return Ea(m,u,d)})}),_t.prototype.reject=function(u){return this.filter(Qd(ot(u)))},_t.prototype.slice=function(u,d){u=ft(u);var m=this;return m.__filtered__&&(u>0||d<0)?new _t(m):(u<0?m=m.takeRight(-u):u&&(m=m.drop(u)),d!==s&&(d=ft(d),m=d<0?m.dropRight(-d):m.take(d-u)),m)},_t.prototype.takeRightWhile=function(u){return this.reverse().takeWhile(u).reverse()},_t.prototype.toArray=function(){return this.take(Te)},oi(_t.prototype,function(u,d){var m=/^(?:filter|find|map|reject)|While$/.test(d),_=/^(?:head|last)$/.test(d),x=N[_?"take"+(d=="last"?"Right":""):d],B=_||/^find/.test(d);x&&(N.prototype[d]=function(){var W=this.__wrapped__,Z=_?[1]:arguments,ce=W instanceof _t,Oe=Z[0],Re=ce||Et(W),Me=function(zt){var Gt=x.apply(N,si([zt],Z));return _&&We?Gt[0]:Gt};Re&&m&&typeof Oe=="function"&&Oe.length!=1&&(ce=Re=!1);var We=this.__chain__,st=!!this.__actions__.length,ht=B&&!We,Dt=ce&&!st;if(!B&&Re){W=Dt?W:new _t(this);var pt=u.apply(W,Z);return pt.__actions__.push({func:io,args:[Me],thisArg:s}),new ns(pt,We)}return ht&&Dt?u.apply(this,Z):(pt=this.thru(Me),ht?_?pt.value()[0]:pt.value():pt)})}),zs(["pop","push","shift","sort","splice","unshift"],function(u){var d=xc[u],m=/^(?:push|sort|unshift)$/.test(u)?"tap":"thru",_=/^(?:pop|shift)$/.test(u);N.prototype[u]=function(){var x=arguments;if(_&&!this.__chain__){var B=this.value();return d.apply(Et(B)?B:[],x)}return this[m](function(W){return d.apply(Et(W)?W:[],x)})}}),oi(_t.prototype,function(u,d){var m=N[d];if(m){var _=m.name+"";Kt.call(Ca,_)||(Ca[_]=[]),Ca[_].push({name:d,func:m})}}),Ca[Aa(s,F).name]=[{name:"wrapper",func:s}],_t.prototype.clone=ob,_t.prototype.reverse=ab,_t.prototype.value=lb,N.prototype.at=za,N.prototype.chain=Qg,N.prototype.commit=Ho,N.prototype.next=e$,N.prototype.plant=As,N.prototype.reverse=cu,N.prototype.toJSON=N.prototype.valueOf=N.prototype.value=Vl,N.prototype.first=N.prototype.head,ya&&(N.prototype[ya]=ef),N},Mr=Xm();xo?((xo.exports=Mr)._=Mr,Cc._=Mr):Gn._=Mr}).call(ei)})(Qv,Qv.exports);var iP=Qv.exports;const kw=aa(iP),D_=kw.throttle((o,n)=>o(n),0);function bv(o,n){const s=n.find(i=>i._id===o);return{card:s,index:s?n.indexOf(s):-1}}function O_(o,n,s,i,a,c,h,g,b){const{card:$,index:y}=bv(o,s);if(!(y<n&&g<b)&&!(y>n&&g>b)&&$&&y!==n){const w=kw.clone(s);w.splice(y,1),w.splice(n,0,$);const C=kw.clone(a);switch(c){case"actions":C.actions[h]=w,D_(i,C);return;case"conditions":C.conditions[h]=w,D_(i,C);return;default:C.triggers=w,D_(i,C);return}}}const oP="_drag_7xfhc_1",aP="_root_7xfhc_11",JC={drag:oP,root:aP},Wk=({typeBlock:o,allProperties:n,id:s,isActive:i,setUserRules:a,userRules:c,children:h,_id:g,blockValue:b})=>{const{setOnUpdate:$}=ve.useContext(Tm),[{opacity:y},w,C]=rE({type:"box",item:()=>({...n,id:s,isActive:i,_id:g}),end:(R,F)=>{const{acceptedBy:M}=R,L=F.getDropResult();let T;if(!L)return typeof g=="number"&&!F.getTargetIds().length&&(T=ap(M,c,b),T=Iu(M,T,b,g),a(T)),null;if(L.blockValue!==b){const V=typeof g=="number"?g:Date.now();T=ap(M,c,L.blockValue);const K={id:R.id,acceptedBy:R.acceptedBy};switch(M){case"actions":return b&&(T=Iu("actions",T,b,V)),T=Iu("actions",T,L.blockValue,V),T.actions[L.blockValue].push({...K,_id:V}),a(T);case"conditions":return typeof b=="number"&&(T=Iu("conditions",T,b,V)),T=Iu("conditions",T,L.blockValue,V),T.conditions[L.blockValue].push({...K,_id:V}),a(T);default:return $(!0),T=Iu("triggers",T,L.blockValue,V),T.triggers.push({...K,_id:V}),a(T)}}},collect:R=>({opacity:R.isDragging()?.4:1,isDragging:R.isDragging()})}),S=ve.useRef(null),[,k]=Kw({accept:"box",canDrop:()=>!1,hover({_id:R,acceptedBy:F},M){var Y;if(!S.current||o!==F)return;const L=(Y=S.current)==null?void 0:Y.getBoundingClientRect(),T=(L.bottom-L.top)/2,V=M.getClientOffset(),K=((V==null?void 0:V.y)||0)-L.top;if(g&&R!==g)switch(F){case"actions":if(b==="then"||b==="else"){const{index:te}=bv(g,c.actions[b]);te!==R&&O_(R,te,c[F][b],a,c,F,b,K,T)}return;case"conditions":if(typeof b=="number"){const{index:te}=bv(g,c[F][b]);te!==R&&O_(R,te,c[F][b],a,c,F,b,K,T)}return;default:{const{index:te}=bv(g,c[F]);te!==R&&O_(R,te,c[F],a,c,F,void 0,K,T);return}}}});ve.useEffect(()=>{C(KO(),{captureDraggingState:!0})},[]),w(k(S));const E=window.innerWidth<600;return f.jsxs("div",{ref:E&&g?null:S,className:JC.root,style:{opacity:y},children:[f.jsx("div",{className:g?JC.drag:null,ref:g&&E?S:null}),h]})},lP=({onClose:o,open:n})=>f.jsxs(D.Dialog,{open:n,onClose:o,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[f.jsx(D.DialogContent,{children:f.jsxs("div",{style:{fontSize:"1rem",fontFamily:'"Roboto", "Helvetica", "Arial", sans-serif',fontWeight:400,lineHeight:1.5,letterSpacing:"0.00938em"},children:[f.jsx("h3",{children:I.I18n.t("On condition change")}),f.jsx("div",{children:I.I18n.t("help_on_change")}),f.jsx("h3",{children:I.I18n.t("Just check")}),f.jsx("div",{children:I.I18n.t("help_just_check")})]})}),f.jsx(D.DialogActions,{children:f.jsx(D.Button,{onClick:o,color:"primary",autoFocus:!0,startIcon:f.jsx(ol,{}),children:I.I18n.t("OK")})})]}),cP=({onClose:o,open:n})=>f.jsxs(D.Dialog,{open:n,onClose:o,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[f.jsx(D.DialogContent,{children:f.jsxs(D.DialogContentText,{id:"alert-dialog-description",children:[f.jsx("h3",{children:I.I18n.t("On condition change")}),f.jsx("div",{children:I.I18n.t("help_on_change")}),f.jsx("h3",{children:I.I18n.t("Just check")}),f.jsx("div",{children:I.I18n.t("help_just_check")})]})}),f.jsx(D.DialogActions,{children:f.jsx(D.Button,{onClick:o,color:"primary",autoFocus:!0,children:I.I18n.t("OK")})})]}),YC=({size:o,blockValue:n,boolean:s,typeBlock:i,userRules:a,setUserRules:c,animation:h,setTourStep:g,tourStep:b,isTourOpen:$,theme:y,themeType:w,themeName:C})=>{var De;const[S,k]=ve.useState(!1),[E,R]=ve.useState(!1),[F,M]=ve.useState(!1),[L,T]=ve.useState("");s===void 0&&(s=!0);const V=Kw({accept:"box",drop:()=>({blockValue:n}),hover:({acceptedBy:ee,_id:Fe},Ce)=>{k(ee===i),M(!!Fe),T(Ce.getHandlerId()||"")},canDrop:({acceptedBy:ee})=>(R(ee===i),ee===i),collect:ee=>{var Fe;return{isOver:ee.isOver(),canDrop:((Fe=ee.getItem())==null?void 0:Fe.acceptedBy)===i,offset:ee.getClientOffset(),targetId:ee.getHandlerId()}}}),K=V[0],{canDrop:Y,isOver:te,offset:J,targetId:ne}=K,Q=V[1];ve.useEffect(()=>{T("")},[J]);const he=Y&&te;let q="";he?q=S?"#00fb003d":"#fb00002e":Y?q=E?"#00fb003d":"#fb00002e":J&&(q=ne===L?"#fb00002e":"");let re;return i==="actions"?re=a.actions[n]:i==="conditions"?re=a.conditions[n]:re=a.triggers,f.jsx("div",{ref:Q,style:{backgroundColor:q},className:`${I.Utils.clsx(bs.contentBlockItem,o&&bs.addClassHeight)} ${s?h?bs.contentHeightOn:null:bs.contentHeightOff}`,children:f.jsxs("div",{className:bs.wrapperMargin,children:[re.map(ee=>f.jsx(Wk,{typeBlock:i,...ee,blockValue:n,allProperties:ee,userRules:a,setUserRules:c,children:f.jsx(Hk,{...ee,isTourOpen:$,setTourStep:g,tourStep:b,settings:ee,blockValue:n,userRules:a,setUserRules:c,theme:y,themeType:w,themeName:C})},ee._id)),f.jsx("div",{style:he&&S&&!F?{height:((De=document.getElementById("height"))==null?void 0:De.clientHeight)||200}:void 0,className:`${bs.emptyBlockStyle} ${he&&S&&!F?bs.emptyBlock:bs.emptyBlockNone}`})]})})},R_=({size:o,typeBlock:n,name:s,nameAdditionally:i,additionally:a,border:c,userRules:h,setUserRules:g,iconName:b,adapter:$,socket:y,setTourStep:w,tourStep:C,isTourOpen:S,theme:k,themeType:E,themeName:R})=>{const[F,M,L]=Ew(n==="actions"?!1:[],`additionallyClickItems_${n}`),[T,V]=ve.useState(!1),[K,Y]=ve.useState(!1);ve.useEffect(()=>{if(n==="conditions"&&(F==null?void 0:F.length)!==h.conditions.length-1){const ne=[];h.conditions.forEach((Q,he)=>{he>0&&ne.push({_id:Date.now(),open:!0})}),M([...F,...ne])}n==="actions"&&!L&&h.actions.else.length&&M(!0)},[]);const[te,J]=ve.useState(!1);return f.jsxs("div",{className:`${I.Utils.clsx(bs.mainBlockItemRules,o&&bs.addClassOverflow)} ${c&&!o?bs.border:null}`,children:[f.jsxs("span",{id:"width",className:bs.nameBlockItems,children:[f.jsx(Mu,{iconName:b,className:bs.iconThemCard,adapter:$,socket:y}),s]}),n==="conditions"?f.jsxs("div",{style:{width:"100%"},children:[f.jsxs(D.Select,{variant:"standard",className:bs.selectOnChange,value:h.justCheck||!1,onChange:ne=>{const Q=ap("conditions",h);Q.justCheck=ne.target.value==="true",g(Q)},children:[f.jsx(D.MenuItem,{value:"false",children:I.I18n.t("on condition change")}),f.jsx(D.MenuItem,{value:"true",children:I.I18n.t("just check")})]}),f.jsx(D.IconButton,{size:"small",title:I.I18n.t("Explanation"),className:bs.selectOnChangeHelp,onClick:()=>V(!0),children:f.jsx(Jw,{className:bs.selectOnChangeHelpIcon})})]}):null,f.jsx(YC,{setTourStep:w,tourStep:C,isTourOpen:S,blockValue:n==="actions"?"then":n==="conditions"?0:n,typeBlock:n,setUserRules:g,userRules:h,theme:k,themeName:R,themeType:E,size:o}),a&&[...Array(n==="actions"?1:h.conditions.length-1)].map((ne,Q)=>{const he=(q=Q)=>n==="actions"?!!F:!!F.find((re,De)=>De===q&&re.open);return f.jsxs(ve.Fragment,{children:[f.jsxs("div",{onClick:()=>{if(n==="actions")return M(!F),null;let q=JSON.parse(JSON.stringify(F));if(h.conditions[Q+1].length)return q[Q].open=!q[Q].open,M(q),null;q=q.filter((re,De)=>De!==Q),M(q),J(Q),setTimeout(()=>{J(!1),g({...h,conditions:[...h.conditions.filter((re,De)=>De!==Q+1)]})},250)},className:bs.blockCardAdd,children:[he()?"-":"+",f.jsx("div",{className:bs.cardAdd,children:i})]},Q),f.jsx(YC,{blockValue:n==="actions"?"else":n==="conditions"?Q+1:n,typeBlock:n,setUserRules:g,userRules:h,boolean:he(),animation:te===Q,size:o,theme:k,themeName:R,themeType:E})]},`${Q}_block_${n}`)}),a&&n==="conditions"&&f.jsxs("div",{onClick:()=>{M([...F,{_id:Date.now(),open:!0}]),g({...h,conditions:[...h.conditions,[]]}),J(h.conditions.length-1),setTimeout(()=>J(!1),1e3)},className:bs.blockCardAdd,children:["+",f.jsx("div",{className:bs.cardAdd,children:i})]}),f.jsx(lP,{open:T,onClose:()=>V(!1)}),f.jsx(cP,{open:K,onClose:()=>Y(!1)})]})},uP="_menuRules_1qqcb_1",dP="_switchesRenderWrapper_1qqcb_13",hP="_menuOff_1qqcb_22",pP="_menuTitle_1qqcb_28",gP="_marginAuto_1qqcb_42",fP="_inputWidth_1qqcb_47",mP="_menuWrapper_1qqcb_52",bP="_hamburgerWrapper_1qqcb_57",$P="_hamburgerOff_1qqcb_74",vP="_nothingFound_1qqcb_82",yP="_resetSearch_1qqcb_89",_P="_controlPanel_1qqcb_101",wP="_controlPanelAppBar_1qqcb_112",SP="_addClassMenu_1qqcb_126",CP="_addClassBackground_1qqcb_132",TP="_addClassPosition_1qqcb_136",mr={menuRules:uP,switchesRenderWrapper:dP,menuOff:hP,menuTitle:pP,marginAuto:gP,inputWidth:fP,menuWrapper:mP,hamburgerWrapper:bP,hamburgerOff:$P,nothingFound:vP,resetSearch:yP,controlPanel:_P,controlPanelAppBar:wP,addClassMenu:SP,addClassBackground:CP,addClassPosition:TP},EP=o=>{const{allProperties:n,allProperties:{acceptedBy:s,id:i},setUserRules:a,userRules:c,setTourStep:h,tourStep:g,isTourOpen:b,onTouchMove:$,isActive:y}=o;return f.jsx(Wk,{allProperties:n,id:n.id,isActive:y,setUserRules:a,userRules:c,children:f.jsx(Lk,{onDoubleClick:()=>{b&&g===Is.addScheduleByDoubleClick&&i==="TriggerScheduleBlock"&&h(Is.openTagsMenu),b&&g===Is.addActionPrintText&&i==="ActionPrintText"&&h(Is.showJavascript);const w=Date.now();let C;switch(s){case"actions":C="then";break;case"conditions":C=c[s].length-1;break}const S=ap(s,c,C),k={id:i,_id:w,acceptedBy:s};C!==void 0?s==="actions"?S.actions[C].push({...k}):s==="conditions"&&S.conditions[C].push({...k}):S.triggers.push({...k}),a(S)},...o,...n,onTouchMove:$})})},kP="_menu_wrapper_hqnsm_1",IP="_hamburgerMenu_hqnsm_8",xP="_animate_hqnsm_21",DP="_menu_conatiner_wrapper_hqnsm_55",XC={menu_wrapper:kP,hamburgerMenu:IP,animate:xP,menu_conatiner_wrapper:DP};function OP({bool:o}){return f.jsx("div",{className:`${XC.hamburgerMenu} ${o?XC.animate:""}`})}const RP=({addClass:o,setAllBlocks:n,allBlocks:s,userRules:i,onChangeBlocks:a,setTourStep:c,tourStep:h,isTourOpen:g})=>{const{blocks:b,socket:$}=ve.useContext(Tm),[y,w]=Ew(!1,"hamburgerOnOff"),[C,S]=Ew({text:"",type:"triggers",index:0},"filterControlPanel"),k=(F=C.text,M=C.type)=>{if(!b)return;let L=[...b];L=L.filter(T=>{if(!F)return!0;const{name:V}=T.getStaticData();return V&&I.I18n.t(V).toLowerCase().includes(F.toLowerCase())}),L=L.filter(T=>M===T.getStaticData().acceptedBy),n(L)},E=(F,M)=>{g&&M===0&&h===Is.selectTriggers&&c(Is.addScheduleByDoubleClick),g&&M===2&&h===Is.selectActions&&c(Is.addActionPrintText),S({...C,index:M,type:["triggers","conditions","actions"][M]}),k(C.text,["triggers","conditions","actions"][M])},R=F=>({id:`scrollable-force-tab-${F}`,"aria-controls":`scrollable-force-tabpanel-${F}`});return ve.useEffect(()=>{k()},[b]),f.jsx(D.ClickAwayListener,{mouseEvent:!1,touchEvent:"onTouchStart",onClickAway:()=>w(!0),children:f.jsxs("div",{className:I.Utils.clsx(mr.menuWrapper,o[1035]&&mr.addClassMenu),children:[f.jsx("div",{className:`${mr.hamburgerWrapper} ${y?mr.hamburgerOff:null}`,onClick:()=>w(!y),children:f.jsx(OP,{bool:!y})}),f.jsxs("div",{className:`${I.Utils.clsx(mr.menuRules,o[1035]&&mr.addClassBackground,o[835]&&mr.addClassPosition)} ${y?mr.menuOff:null}`,children:[f.jsx("div",{className:mr.controlPanel,children:f.jsx(D.AppBar,{className:mr.controlPanelAppBar,position:"static",children:f.jsxs(D.Tabs,{value:C.index,onChange:E,children:[f.jsx(D.Tab,{className:"blocks-triggers",title:I.I18n.t("Triggers"),icon:f.jsx(Mu,{iconName:"FlashOn"}),...R(0)}),f.jsx(D.Tab,{title:I.I18n.t("Conditions"),className:"blocks-conditions",icon:f.jsx(Mu,{iconName:"Help"}),...R(1)}),f.jsx(D.Tab,{title:I.I18n.t("Actions"),className:"blocks-actions",icon:f.jsx(Mu,{iconName:"PlayForWork"}),...R(2)})]})})}),f.jsx("div",{className:mr.switchesRenderWrapper,children:f.jsxs("span",{children:[s.map(F=>{const{name:M,id:L,icon:T,adapter:V}=F.getStaticData();return f.jsx(ve.Fragment,{children:f.jsx(EP,{adapter:V,allProperties:F.getStaticData(),icon:T,id:L,isActive:!1,isTourOpen:g,name:M,onTouchMove:()=>w(!0),setTourStep:c,setUserRules:a,socket:$,tourStep:h,userRules:i})},L)}),!s.length&&f.jsxs("div",{className:mr.nothingFound,children:[I.I18n.t("Nothing found"),"...",f.jsx("div",{className:mr.resetSearch,onClick:()=>{S({...C,text:""}),k("")},children:I.I18n.t("reset search")})]})]})}),f.jsx("div",{className:I.Utils.clsx(mr.menuTitle,mr.marginAuto)}),f.jsx(hc,{className:mr.inputWidth,fullWidth:!0,customValue:!0,value:C.text,size:"small",autoComplete:"off",label:I.I18n.t("search"),variant:"outlined",onChange:F=>{S({...C,text:F}),k(F)}})]})]})})};let A_=[];const AP=({code:o,onChange:n,themeName:s,themeType:i,theme:a,setTourStep:c,tourStep:h,isTourOpen:g,command:b,scriptId:$,changed:y,running:w})=>{var q;const{blocks:C,socket:S,setOnUpdate:k,setOnDebugMessage:E,setEnableSimulation:R}=ve.useContext(Tm),[F,M]=ve.useState([]),[L,T]=ve.useState(VC(o)),[V,K]=ve.useState(""),[Y,te]=ve.useState(!1);ve.useEffect(()=>{let re,De;const ee=(Ze,pe)=>{Ze===`${re}.alive`&&De!==(pe==null?void 0:pe.val)&&(De=!!(pe!=null&&pe.val),De&&re&&(S==null||S.sendTo(re.replace(/^system\.adapter\./,""),"rulesOn",$)))},Fe=(Ze,pe)=>{var Te,ke;S&&re!==((Te=pe==null?void 0:pe.common)==null?void 0:Te.engine)&&(re&&(S.unsubscribeState(`${re}.alive`,ee),De&&S.sendTo(re.replace(/^system\.adapter\./,""),"rulesOn",$)),re=(ke=pe==null?void 0:pe.common)==null?void 0:ke.engine,re&&re&&S.subscribeState(`${re}.alive`,ee))},Ce=(Ze,pe)=>{if(pe)try{const Te=JSON.parse(pe.val),ke=Date.now();if(Te.ruleId===$&&ke-Te.ts<1e3){const Xe=[...A_,{blockId:Te.blockId,data:Te.data,ts:Te.ts}];Xe.length>200&&Xe.splice(0,200-Xe.length);for(let Ke=Xe.length-1;Ke>=0;Ke--)if(Xe[Ke].ts<ke-5e3){Xe.splice(0,Ke);break}console.log(`Debug1: ${JSON.stringify(A_)}`),console.log(`Debug2: ${JSON.stringify(Xe)}`),A_=Xe,E(Xe)}}catch{console.error(`Cannot parse: ${pe.val}`)}};return S==null||S.getObject($).then(Ze=>{var pe;re=(pe=Ze==null?void 0:Ze.common)==null?void 0:pe.engine,S.subscribeObject($,Fe),re&&(S.subscribeState(`${re}.alive`,ee),S.subscribeState(`${re.replace(/^system\.adapter\./,"")}.debug.rules`,Ce))}),function(){S==null||S.unsubscribeState($,ee),re&&(S==null||S.unsubscribeObject(`${re}.alive`,Fe),De&&(S==null||S.sendTo(re.replace(/^system\.adapter\./,""),"rulesOff",$)),S==null||S.unsubscribeState(`${re.replace(/^system\.adapter\./,"")}.debug.rules`,Ce))}},[]),ve.useEffect(()=>{R(!y&&w)},[y,w,R]),ve.useEffect(()=>{b&&(K(b),Y||te(!0))},[b]),ve.useEffect(()=>{const re=VC(o);JSON.stringify(re)!==JSON.stringify(L)&&(T(re),k(!0))},[o]),ve.useEffect(()=>{document.getElementsByTagName("HTML")[0].className=s||"blue"},[s]);const J=ve.useCallback(re=>{T(re),C&&n(DB(re,C))},[C,n]),ne=ve.useRef(null),[Q,he]=ve.useState({835:!1,1035:!1});return ve.useEffect(()=>{ne.current&&(ne.current.clientWidth<=1035&&he({835:!1,1035:!0}),ne.current.clientWidth<=835&&he({1035:!0,835:!0}),ne.current.clientWidth>1035&&he({835:!1,1035:!1}))},[((q=ne.current)==null?void 0:q.clientWidth)||0]),!C||!S?null:f.jsxs("div",{className:S_.wrapperRules,ref:ne,children:[f.jsx(FB,{allBlocks:F,socket:S}),Y?V==="export"?f.jsx(xk,{scriptId:$,themeType:i,onClose:()=>te(!1),text:JSON.stringify(L,null,2)}):f.jsx(Sy,{onClose:re=>{te(!1),re&&J(JSON.parse(re))}}):null,f.jsxs("div",{className:I.Utils.clsx(S_.rootWrapper,Q[835]&&S_.addClass),children:[f.jsx(RP,{setAllBlocks:M,allBlocks:F,userRules:L,onChangeBlocks:J,setTourStep:c,tourStep:h,addClass:Q,isTourOpen:g}),f.jsx(R_,{socket:S,setUserRules:J,userRules:L,isTourOpen:g,setTourStep:c,tourStep:h,name:`${I.I18n.t("when")}...`,typeBlock:"triggers",iconName:"FlashOn",size:Q[835],themeType:i,themeName:s,theme:a}),f.jsx(R_,{socket:S,setUserRules:J,isTourOpen:g,setTourStep:c,tourStep:h,userRules:L,name:`...${I.I18n.t("and")}...`,typeBlock:"conditions",iconName:"Help",nameAdditionally:I.I18n.t("or"),additionally:!0,border:!0,size:Q[835],themeType:i,themeName:s,theme:a}),f.jsx(R_,{socket:S,setUserRules:J,isTourOpen:g,setTourStep:c,tourStep:h,userRules:L,name:`...${I.I18n.t("then")}`,typeBlock:"actions",iconName:"PlayForWork",nameAdditionally:I.I18n.t("else"),additionally:!0,size:Q[835],themeType:i,themeName:s,theme:a})]})]},"rulesEditor")},NP={editorDiv:{height:"100%",width:"100%",overflow:"hidden",position:"relative"}};let MP=class extends Le.Component{constructor(n){super(n),this.state={lines:(this.props.script||"").split(/\r\n|\n/)}}render(){return f.jsx("div",{style:NP.editorDiv,children:f.jsx(wy,{name:this.props.scriptName,adapterName:this.props.adapterName,readOnly:!0,code:this.props.script||"",isDark:this.props.themeType==="dark",socket:this.props.socket,runningInstances:this.props.runningInstances,language:"javascript",breakpoints:this.props.breakpoints,location:this.props.paused?this.props.location:null,onToggleBreakpoint:n=>this.props.onToggleBreakpoint(n)},"scriptEditor2")},"scriptEditorDiv2")}};const ZC=34,fo={logBox:{width:"100%",height:"100%",position:"relative",overflow:"hidden"},logBoxInner:o=>({display:"inline-block",color:o.palette.mode==="dark"?"white":"black",width:`calc(100% - ${ZC}px)`,height:"100%",overflow:"auto",position:"relative",verticalAlign:"top"}),info:o=>({background:o.palette.mode==="dark"?"darkgrey":"lightgrey",color:(o.palette.mode==="dark","black")}),error:o=>({background:"#FF0000",color:o.palette.mode==="dark"?"black":"white"}),warn:o=>({background:"#FF8000",color:o.palette.mode==="dark"?"black":"white"}),debug:o=>({background:"gray",opacity:.8,color:o.palette.mode==="dark"?"black":"white"}),silly:o=>({background:"gray",opacity:.6,color:o.palette.mode==="dark"?"black":"white"}),table:{fontFamily:"monospace",width:"100%"},toolbox:{width:ZC,height:"100%",boxShadow:"2px 0px 4px -1px rgba(0, 0, 0, 0.2), 4px 0px 5px 0px rgba(0, 0, 0, 0.14), 1px 0px 10px 0px rgba(0, 0, 0, 0.12)",display:"inline-block",verticalAlign:"top",overflow:"hidden"},trTime:{width:90},trSeverity:{width:40,fontWeight:"bold"},iconButtons:{width:32,height:32,padding:4}};function LP(o){let n,s=o.getHours();return s<10&&(s=`0${s.toString()}`),n=`${s}:`,s=o.getMinutes(),s<10&&(s=`0${s.toString()}`),n+=`${s}:`,s=o.getSeconds(),s<10&&(s=`0${s.toString()}`),n+=`${s}.`,s=o.getMilliseconds(),s<10?s=`00${s.toString()}`:s<100&&(s=`0${s.toString()}`),n+=s,n}let BP=class Vk extends Le.Component{messagesEnd;constructor(n){super(n),this.state={goBottom:!0},this.messagesEnd=Le.createRef()}static generateLine(n){return f.jsxs(D.Box,{component:"tr",sx:fo[n.severity],children:[f.jsx("td",{style:fo.trTime,children:LP(new Date(n.ts))}),f.jsx("td",{style:fo.trSeverity,children:n.severity}),f.jsx("td",{children:n.text})]},`tr_${n.ts}_${n.text.substring(n.text.length-10,n.text.length)}`)}renderLogList(n){return n!=null&&n.length?f.jsxs(D.Box,{sx:fo.logBoxInner,children:[f.jsx("table",{style:fo.table,children:f.jsx("tbody",{children:n.map(s=>Vk.generateLine(s))})},"logTable"),f.jsx("div",{ref:this.messagesEnd,style:{float:"left",clear:"both"}},"logScrollPoint")]},"logList"):f.jsx(D.Box,{sx:fo.logBoxInner,style:{paddingLeft:10},children:I.I18n.t("Log outputs")},"logList")}onCopy(){I.Utils.copyToClipboard(this.props.console.join(`
`))}scrollToBottom(){var n,s;(s=(n=this.messagesEnd)==null?void 0:n.current)==null||s.scrollIntoView({behavior:"smooth"})}componentDidUpdate(){this.state.goBottom&&this.scrollToBottom()}render(){const n=this.props.console;return f.jsxs("div",{style:fo.logBox,children:[f.jsxs("div",{style:fo.toolbox,children:[f.jsx(D.IconButton,{style:fo.iconButtons,onClick:()=>this.setState({goBottom:!this.state.goBottom}),color:this.state.goBottom?"secondary":void 0,size:"medium",children:f.jsx(UT,{})}),n!=null&&n.length?f.jsx(D.IconButton,{style:fo.iconButtons,onClick:()=>this.props.onClearAllLogs(),size:"medium",children:f.jsx(jT,{})}):null,n!=null&&n.length?f.jsx(D.IconButton,{style:fo.iconButtons,onClick:()=>this.onCopy(),size:"medium",children:f.jsx(zw,{})}):null]},"toolbox"),this.renderLogList(n)]})}};var Gk={exports:{}};(function(o,n){(function(s,i){o.exports=i(Dx)})(ei,function(s){return function(i){var a={};function c(h){if(a[h])return a[h].exports;var g=a[h]={i:h,l:!1,exports:{}};return i[h].call(g.exports,g,g.exports,c),g.l=!0,g.exports}return c.m=i,c.c=a,c.d=function(h,g,b){c.o(h,g)||Object.defineProperty(h,g,{enumerable:!0,get:b})},c.r=function(h){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(h,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(h,"__esModule",{value:!0})},c.t=function(h,g){if(1&g&&(h=c(h)),8&g||4&g&&typeof h=="object"&&h&&h.__esModule)return h;var b=Object.create(null);if(c.r(b),Object.defineProperty(b,"default",{enumerable:!0,value:h}),2&g&&typeof h!="string")for(var $ in h)c.d(b,$,function(y){return h[y]}.bind(null,$));return b},c.n=function(h){var g=h&&h.__esModule?function(){return h.default}:function(){return h};return c.d(g,"a",g),g},c.o=function(h,g){return Object.prototype.hasOwnProperty.call(h,g)},c.p="",c(c.s=48)}([function(i,a){i.exports=s},function(i,a){var c=i.exports={version:"2.6.12"};typeof __e=="number"&&(__e=c)},function(i,a,c){var h=c(26)("wks"),g=c(17),b=c(3).Symbol,$=typeof b=="function";(i.exports=function(y){return h[y]||(h[y]=$&&b[y]||($?b:g)("Symbol."+y))}).store=h},function(i,a){var c=i.exports=typeof window<"u"&&window.Math==Math?window:typeof self<"u"&&self.Math==Math?self:Function("return this")();typeof __g=="number"&&(__g=c)},function(i,a,c){i.exports=!c(8)(function(){return Object.defineProperty({},"a",{get:function(){return 7}}).a!=7})},function(i,a){var c={}.hasOwnProperty;i.exports=function(h,g){return c.call(h,g)}},function(i,a,c){var h=c(7),g=c(16);i.exports=c(4)?function(b,$,y){return h.f(b,$,g(1,y))}:function(b,$,y){return b[$]=y,b}},function(i,a,c){var h=c(10),g=c(35),b=c(23),$=Object.defineProperty;a.f=c(4)?Object.defineProperty:function(y,w,C){if(h(y),w=b(w,!0),h(C),g)try{return $(y,w,C)}catch{}if("get"in C||"set"in C)throw TypeError("Accessors not supported!");return"value"in C&&(y[w]=C.value),y}},function(i,a){i.exports=function(c){try{return!!c()}catch{return!0}}},function(i,a,c){var h=c(40),g=c(22);i.exports=function(b){return h(g(b))}},function(i,a,c){var h=c(11);i.exports=function(g){if(!h(g))throw TypeError(g+" is not an object!");return g}},function(i,a){i.exports=function(c){return typeof c=="object"?c!==null:typeof c=="function"}},function(i,a){i.exports={}},function(i,a,c){var h=c(39),g=c(27);i.exports=Object.keys||function(b){return h(b,g)}},function(i,a){i.exports=!0},function(i,a,c){var h=c(3),g=c(1),b=c(53),$=c(6),y=c(5),w=function(C,S,k){var E,R,F,M=C&w.F,L=C&w.G,T=C&w.S,V=C&w.P,K=C&w.B,Y=C&w.W,te=L?g:g[S]||(g[S]={}),J=te.prototype,ne=L?h:T?h[S]:(h[S]||{}).prototype;for(E in L&&(k=S),k)(R=!M&&ne&&ne[E]!==void 0)&&y(te,E)||(F=R?ne[E]:k[E],te[E]=L&&typeof ne[E]!="function"?k[E]:K&&R?b(F,h):Y&&ne[E]==F?function(Q){var he=function(q,re,De){if(this instanceof Q){switch(arguments.length){case 0:return new Q;case 1:return new Q(q);case 2:return new Q(q,re)}return new Q(q,re,De)}return Q.apply(this,arguments)};return he.prototype=Q.prototype,he}(F):V&&typeof F=="function"?b(Function.call,F):F,V&&((te.virtual||(te.virtual={}))[E]=F,C&w.R&&J&&!J[E]&&$(J,E,F)))};w.F=1,w.G=2,w.S=4,w.P=8,w.B=16,w.W=32,w.U=64,w.R=128,i.exports=w},function(i,a){i.exports=function(c,h){return{enumerable:!(1&c),configurable:!(2&c),writable:!(4&c),value:h}}},function(i,a){var c=0,h=Math.random();i.exports=function(g){return"Symbol(".concat(g===void 0?"":g,")_",(++c+h).toString(36))}},function(i,a,c){var h=c(22);i.exports=function(g){return Object(h(g))}},function(i,a){a.f={}.propertyIsEnumerable},function(i,a,c){var h=c(52)(!0);c(34)(String,"String",function(g){this._t=String(g),this._i=0},function(){var g,b=this._t,$=this._i;return $>=b.length?{value:void 0,done:!0}:(g=h(b,$),this._i+=g.length,{value:g,done:!1})})},function(i,a){var c=Math.ceil,h=Math.floor;i.exports=function(g){return isNaN(g=+g)?0:(g>0?h:c)(g)}},function(i,a){i.exports=function(c){if(c==null)throw TypeError("Can't call method on  "+c);return c}},function(i,a,c){var h=c(11);i.exports=function(g,b){if(!h(g))return g;var $,y;if(b&&typeof($=g.toString)=="function"&&!h(y=$.call(g))||typeof($=g.valueOf)=="function"&&!h(y=$.call(g))||!b&&typeof($=g.toString)=="function"&&!h(y=$.call(g)))return y;throw TypeError("Can't convert object to primitive value")}},function(i,a){var c={}.toString;i.exports=function(h){return c.call(h).slice(8,-1)}},function(i,a,c){var h=c(26)("keys"),g=c(17);i.exports=function(b){return h[b]||(h[b]=g(b))}},function(i,a,c){var h=c(1),g=c(3),b=g["__core-js_shared__"]||(g["__core-js_shared__"]={});(i.exports=function($,y){return b[$]||(b[$]=y!==void 0?y:{})})("versions",[]).push({version:h.version,mode:c(14)?"pure":"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})},function(i,a){i.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(i,a,c){var h=c(7).f,g=c(5),b=c(2)("toStringTag");i.exports=function($,y,w){$&&!g($=w?$:$.prototype,b)&&h($,b,{configurable:!0,value:y})}},function(i,a,c){c(62);for(var h=c(3),g=c(6),b=c(12),$=c(2)("toStringTag"),y="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),w=0;w<y.length;w++){var C=y[w],S=h[C],k=S&&S.prototype;k&&!k[$]&&g(k,$,C),b[C]=b.Array}},function(i,a,c){a.f=c(2)},function(i,a,c){var h=c(3),g=c(1),b=c(14),$=c(30),y=c(7).f;i.exports=function(w){var C=g.Symbol||(g.Symbol=b?{}:h.Symbol||{});w.charAt(0)=="_"||w in C||y(C,w,{value:$.f(w)})}},function(i,a){a.f=Object.getOwnPropertySymbols},function(i,a){i.exports=function(c,h,g){return Math.min(Math.max(c,h),g)}},function(i,a,c){var h=c(14),g=c(15),b=c(37),$=c(6),y=c(12),w=c(55),C=c(28),S=c(61),k=c(2)("iterator"),E=!([].keys&&"next"in[].keys()),R=function(){return this};i.exports=function(F,M,L,T,V,K,Y){w(L,M,T);var te,J,ne,Q=function(pe){if(!E&&pe in De)return De[pe];switch(pe){case"keys":case"values":return function(){return new L(this,pe)}}return function(){return new L(this,pe)}},he=M+" Iterator",q=V=="values",re=!1,De=F.prototype,ee=De[k]||De["@@iterator"]||V&&De[V],Fe=ee||Q(V),Ce=V?q?Q("entries"):Fe:void 0,Ze=M=="Array"&&De.entries||ee;if(Ze&&(ne=S(Ze.call(new F)))!==Object.prototype&&ne.next&&(C(ne,he,!0),h||typeof ne[k]=="function"||$(ne,k,R)),q&&ee&&ee.name!=="values"&&(re=!0,Fe=function(){return ee.call(this)}),h&&!Y||!E&&!re&&De[k]||$(De,k,Fe),y[M]=Fe,y[he]=R,V)if(te={values:q?Fe:Q("values"),keys:K?Fe:Q("keys"),entries:Ce},Y)for(J in te)J in De||b(De,J,te[J]);else g(g.P+g.F*(E||re),M,te);return te}},function(i,a,c){i.exports=!c(4)&&!c(8)(function(){return Object.defineProperty(c(36)("div"),"a",{get:function(){return 7}}).a!=7})},function(i,a,c){var h=c(11),g=c(3).document,b=h(g)&&h(g.createElement);i.exports=function($){return b?g.createElement($):{}}},function(i,a,c){i.exports=c(6)},function(i,a,c){var h=c(10),g=c(56),b=c(27),$=c(25)("IE_PROTO"),y=function(){},w=function(){var C,S=c(36)("iframe"),k=b.length;for(S.style.display="none",c(60).appendChild(S),S.src="javascript:",(C=S.contentWindow.document).open(),C.write("<script>document.F=Object<\/script>"),C.close(),w=C.F;k--;)delete w.prototype[b[k]];return w()};i.exports=Object.create||function(C,S){var k;return C!==null?(y.prototype=h(C),k=new y,y.prototype=null,k[$]=C):k=w(),S===void 0?k:g(k,S)}},function(i,a,c){var h=c(5),g=c(9),b=c(57)(!1),$=c(25)("IE_PROTO");i.exports=function(y,w){var C,S=g(y),k=0,E=[];for(C in S)C!=$&&h(S,C)&&E.push(C);for(;w.length>k;)h(S,C=w[k++])&&(~b(E,C)||E.push(C));return E}},function(i,a,c){var h=c(24);i.exports=Object("z").propertyIsEnumerable(0)?Object:function(g){return h(g)=="String"?g.split(""):Object(g)}},function(i,a,c){var h=c(39),g=c(27).concat("length","prototype");a.f=Object.getOwnPropertyNames||function(b){return h(b,g)}},function(i,a,c){var h=c(24),g=c(2)("toStringTag"),b=h(function(){return arguments}())=="Arguments";i.exports=function($){var y,w,C;return $===void 0?"Undefined":$===null?"Null":typeof(w=function(S,k){try{return S[k]}catch{}}(y=Object($),g))=="string"?w:b?h(y):(C=h(y))=="Object"&&typeof y.callee=="function"?"Arguments":C}},function(i,a){var c;c=function(){return this}();try{c=c||new Function("return this")()}catch{typeof window=="object"&&(c=window)}i.exports=c},function(i,a){var c=/-?\d+(\.\d+)?%?/g;i.exports=function(h){return h.match(c)}},function(i,a,c){Object.defineProperty(a,"__esModule",{value:!0}),a.getBase16Theme=a.createStyling=a.invertTheme=void 0;var h=R(c(49)),g=R(c(76)),b=R(c(81)),$=R(c(89)),y=R(c(93)),w=function(J){if(J&&J.__esModule)return J;var ne={};if(J!=null)for(var Q in J)Object.prototype.hasOwnProperty.call(J,Q)&&(ne[Q]=J[Q]);return ne.default=J,ne}(c(94)),C=R(c(132)),S=R(c(133)),k=R(c(138)),E=c(139);function R(J){return J&&J.__esModule?J:{default:J}}var F=w.default,M=(0,$.default)(F),L=(0,k.default)(S.default,E.rgb2yuv,function(J){var ne,Q=(0,b.default)(J,3),he=Q[0],q=Q[1],re=Q[2];return[(ne=he,ne<.25?1:ne<.5?.9-ne:1.1-ne),q,re]},E.yuv2rgb,C.default),T=function(J){return function(ne){return{className:[ne.className,J.className].filter(Boolean).join(" "),style:(0,g.default)({},ne.style||{},J.style||{})}}},V=function(J,ne){var Q=(0,$.default)(ne);for(var he in J)Q.indexOf(he)===-1&&Q.push(he);return Q.reduce(function(q,re){return q[re]=function(De,ee){if(De===void 0)return ee;if(ee===void 0)return De;var Fe=De===void 0?"undefined":(0,h.default)(De),Ce=ee===void 0?"undefined":(0,h.default)(ee);switch(Fe){case"string":switch(Ce){case"string":return[ee,De].filter(Boolean).join(" ");case"object":return T({className:De,style:ee});case"function":return function(Ze){for(var pe=arguments.length,Te=Array(pe>1?pe-1:0),ke=1;ke<pe;ke++)Te[ke-1]=arguments[ke];return T({className:De})(ee.apply(void 0,[Ze].concat(Te)))}}case"object":switch(Ce){case"string":return T({className:ee,style:De});case"object":return(0,g.default)({},ee,De);case"function":return function(Ze){for(var pe=arguments.length,Te=Array(pe>1?pe-1:0),ke=1;ke<pe;ke++)Te[ke-1]=arguments[ke];return T({style:De})(ee.apply(void 0,[Ze].concat(Te)))}}case"function":switch(Ce){case"string":return function(Ze){for(var pe=arguments.length,Te=Array(pe>1?pe-1:0),ke=1;ke<pe;ke++)Te[ke-1]=arguments[ke];return De.apply(void 0,[T(Ze)({className:ee})].concat(Te))};case"object":return function(Ze){for(var pe=arguments.length,Te=Array(pe>1?pe-1:0),ke=1;ke<pe;ke++)Te[ke-1]=arguments[ke];return De.apply(void 0,[T(Ze)({style:ee})].concat(Te))};case"function":return function(Ze){for(var pe=arguments.length,Te=Array(pe>1?pe-1:0),ke=1;ke<pe;ke++)Te[ke-1]=arguments[ke];return De.apply(void 0,[ee.apply(void 0,[Ze].concat(Te))].concat(Te))}}}}(J[re],ne[re]),q},{})},K=function(J,ne){for(var Q=arguments.length,he=Array(Q>2?Q-2:0),q=2;q<Q;q++)he[q-2]=arguments[q];if(ne===null)return J;Array.isArray(ne)||(ne=[ne]);var re=ne.map(function(ee){return J[ee]}).filter(Boolean),De=re.reduce(function(ee,Fe){return typeof Fe=="string"?ee.className=[ee.className,Fe].filter(Boolean).join(" "):(Fe===void 0?"undefined":(0,h.default)(Fe))==="object"?ee.style=(0,g.default)({},ee.style,Fe):typeof Fe=="function"&&(ee=(0,g.default)({},ee,Fe.apply(void 0,[ee].concat(he)))),ee},{className:"",style:{}});return De.className||delete De.className,(0,$.default)(De.style).length===0&&delete De.style,De},Y=a.invertTheme=function(J){return(0,$.default)(J).reduce(function(ne,Q){return ne[Q]=/^base/.test(Q)?L(J[Q]):Q==="scheme"?J[Q]+":inverted":J[Q],ne},{})},te=(a.createStyling=(0,y.default)(function(J){for(var ne=arguments.length,Q=Array(ne>3?ne-3:0),he=3;he<ne;he++)Q[he-3]=arguments[he];var q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},re=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},De=q.defaultBase16,ee=De===void 0?F:De,Fe=q.base16Themes,Ce=Fe===void 0?null:Fe,Ze=te(re,Ce);Ze&&(re=(0,g.default)({},Ze,re));var pe=M.reduce(function(Ke,at){return Ke[at]=re[at]||ee[at],Ke},{}),Te=(0,$.default)(re).reduce(function(Ke,at){return M.indexOf(at)===-1&&(Ke[at]=re[at]),Ke},{}),ke=J(pe),Xe=V(Te,ke);return(0,y.default)(K,2).apply(void 0,[Xe].concat(Q))},3),a.getBase16Theme=function(J,ne){if(J&&J.extend&&(J=J.extend),typeof J=="string"){var Q=J.split(":"),he=(0,b.default)(Q,2),q=he[0],re=he[1];J=(ne||{})[q]||w[q],re==="inverted"&&(J=Y(J))}return J&&J.hasOwnProperty("base00")?J:void 0})},function(i,a,c){var h,g=typeof Reflect=="object"?Reflect:null,b=g&&typeof g.apply=="function"?g.apply:function(T,V,K){return Function.prototype.apply.call(T,V,K)};h=g&&typeof g.ownKeys=="function"?g.ownKeys:Object.getOwnPropertySymbols?function(T){return Object.getOwnPropertyNames(T).concat(Object.getOwnPropertySymbols(T))}:function(T){return Object.getOwnPropertyNames(T)};var $=Number.isNaN||function(T){return T!=T};function y(){y.init.call(this)}i.exports=y,i.exports.once=function(T,V){return new Promise(function(K,Y){function te(){J!==void 0&&T.removeListener("error",J),K([].slice.call(arguments))}var J;V!=="error"&&(J=function(ne){T.removeListener(V,te),Y(ne)},T.once("error",J)),T.once(V,te)})},y.EventEmitter=y,y.prototype._events=void 0,y.prototype._eventsCount=0,y.prototype._maxListeners=void 0;var w=10;function C(T){if(typeof T!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof T)}function S(T){return T._maxListeners===void 0?y.defaultMaxListeners:T._maxListeners}function k(T,V,K,Y){var te,J,ne,Q;if(C(K),(J=T._events)===void 0?(J=T._events=Object.create(null),T._eventsCount=0):(J.newListener!==void 0&&(T.emit("newListener",V,K.listener?K.listener:K),J=T._events),ne=J[V]),ne===void 0)ne=J[V]=K,++T._eventsCount;else if(typeof ne=="function"?ne=J[V]=Y?[K,ne]:[ne,K]:Y?ne.unshift(K):ne.push(K),(te=S(T))>0&&ne.length>te&&!ne.warned){ne.warned=!0;var he=new Error("Possible EventEmitter memory leak detected. "+ne.length+" "+String(V)+" listeners added. Use emitter.setMaxListeners() to increase limit");he.name="MaxListenersExceededWarning",he.emitter=T,he.type=V,he.count=ne.length,Q=he,console&&console.warn&&console.warn(Q)}return T}function E(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function R(T,V,K){var Y={fired:!1,wrapFn:void 0,target:T,type:V,listener:K},te=E.bind(Y);return te.listener=K,Y.wrapFn=te,te}function F(T,V,K){var Y=T._events;if(Y===void 0)return[];var te=Y[V];return te===void 0?[]:typeof te=="function"?K?[te.listener||te]:[te]:K?function(J){for(var ne=new Array(J.length),Q=0;Q<ne.length;++Q)ne[Q]=J[Q].listener||J[Q];return ne}(te):L(te,te.length)}function M(T){var V=this._events;if(V!==void 0){var K=V[T];if(typeof K=="function")return 1;if(K!==void 0)return K.length}return 0}function L(T,V){for(var K=new Array(V),Y=0;Y<V;++Y)K[Y]=T[Y];return K}Object.defineProperty(y,"defaultMaxListeners",{enumerable:!0,get:function(){return w},set:function(T){if(typeof T!="number"||T<0||$(T))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+T+".");w=T}}),y.init=function(){this._events!==void 0&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},y.prototype.setMaxListeners=function(T){if(typeof T!="number"||T<0||$(T))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+T+".");return this._maxListeners=T,this},y.prototype.getMaxListeners=function(){return S(this)},y.prototype.emit=function(T){for(var V=[],K=1;K<arguments.length;K++)V.push(arguments[K]);var Y=T==="error",te=this._events;if(te!==void 0)Y=Y&&te.error===void 0;else if(!Y)return!1;if(Y){var J;if(V.length>0&&(J=V[0]),J instanceof Error)throw J;var ne=new Error("Unhandled error."+(J?" ("+J.message+")":""));throw ne.context=J,ne}var Q=te[T];if(Q===void 0)return!1;if(typeof Q=="function")b(Q,this,V);else{var he=Q.length,q=L(Q,he);for(K=0;K<he;++K)b(q[K],this,V)}return!0},y.prototype.addListener=function(T,V){return k(this,T,V,!1)},y.prototype.on=y.prototype.addListener,y.prototype.prependListener=function(T,V){return k(this,T,V,!0)},y.prototype.once=function(T,V){return C(V),this.on(T,R(this,T,V)),this},y.prototype.prependOnceListener=function(T,V){return C(V),this.prependListener(T,R(this,T,V)),this},y.prototype.removeListener=function(T,V){var K,Y,te,J,ne;if(C(V),(Y=this._events)===void 0)return this;if((K=Y[T])===void 0)return this;if(K===V||K.listener===V)--this._eventsCount==0?this._events=Object.create(null):(delete Y[T],Y.removeListener&&this.emit("removeListener",T,K.listener||V));else if(typeof K!="function"){for(te=-1,J=K.length-1;J>=0;J--)if(K[J]===V||K[J].listener===V){ne=K[J].listener,te=J;break}if(te<0)return this;te===0?K.shift():function(Q,he){for(;he+1<Q.length;he++)Q[he]=Q[he+1];Q.pop()}(K,te),K.length===1&&(Y[T]=K[0]),Y.removeListener!==void 0&&this.emit("removeListener",T,ne||V)}return this},y.prototype.off=y.prototype.removeListener,y.prototype.removeAllListeners=function(T){var V,K,Y;if((K=this._events)===void 0)return this;if(K.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):K[T]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete K[T]),this;if(arguments.length===0){var te,J=Object.keys(K);for(Y=0;Y<J.length;++Y)(te=J[Y])!=="removeListener"&&this.removeAllListeners(te);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(typeof(V=K[T])=="function")this.removeListener(T,V);else if(V!==void 0)for(Y=V.length-1;Y>=0;Y--)this.removeListener(T,V[Y]);return this},y.prototype.listeners=function(T){return F(this,T,!0)},y.prototype.rawListeners=function(T){return F(this,T,!1)},y.listenerCount=function(T,V){return typeof T.listenerCount=="function"?T.listenerCount(V):M.call(T,V)},y.prototype.listenerCount=M,y.prototype.eventNames=function(){return this._eventsCount>0?h(this._events):[]}},function(i,a,c){i.exports.Dispatcher=c(140)},function(i,a,c){i.exports=c(142)},function(i,a,c){a.__esModule=!0;var h=$(c(50)),g=$(c(65)),b=typeof g.default=="function"&&typeof h.default=="symbol"?function(y){return typeof y}:function(y){return y&&typeof g.default=="function"&&y.constructor===g.default&&y!==g.default.prototype?"symbol":typeof y};function $(y){return y&&y.__esModule?y:{default:y}}a.default=typeof g.default=="function"&&b(h.default)==="symbol"?function(y){return y===void 0?"undefined":b(y)}:function(y){return y&&typeof g.default=="function"&&y.constructor===g.default&&y!==g.default.prototype?"symbol":y===void 0?"undefined":b(y)}},function(i,a,c){i.exports={default:c(51),__esModule:!0}},function(i,a,c){c(20),c(29),i.exports=c(30).f("iterator")},function(i,a,c){var h=c(21),g=c(22);i.exports=function(b){return function($,y){var w,C,S=String(g($)),k=h(y),E=S.length;return k<0||k>=E?b?"":void 0:(w=S.charCodeAt(k))<55296||w>56319||k+1===E||(C=S.charCodeAt(k+1))<56320||C>57343?b?S.charAt(k):w:b?S.slice(k,k+2):C-56320+(w-55296<<10)+65536}}},function(i,a,c){var h=c(54);i.exports=function(g,b,$){if(h(g),b===void 0)return g;switch($){case 1:return function(y){return g.call(b,y)};case 2:return function(y,w){return g.call(b,y,w)};case 3:return function(y,w,C){return g.call(b,y,w,C)}}return function(){return g.apply(b,arguments)}}},function(i,a){i.exports=function(c){if(typeof c!="function")throw TypeError(c+" is not a function!");return c}},function(i,a,c){var h=c(38),g=c(16),b=c(28),$={};c(6)($,c(2)("iterator"),function(){return this}),i.exports=function(y,w,C){y.prototype=h($,{next:g(1,C)}),b(y,w+" Iterator")}},function(i,a,c){var h=c(7),g=c(10),b=c(13);i.exports=c(4)?Object.defineProperties:function($,y){g($);for(var w,C=b(y),S=C.length,k=0;S>k;)h.f($,w=C[k++],y[w]);return $}},function(i,a,c){var h=c(9),g=c(58),b=c(59);i.exports=function($){return function(y,w,C){var S,k=h(y),E=g(k.length),R=b(C,E);if($&&w!=w){for(;E>R;)if((S=k[R++])!=S)return!0}else for(;E>R;R++)if(($||R in k)&&k[R]===w)return $||R||0;return!$&&-1}}},function(i,a,c){var h=c(21),g=Math.min;i.exports=function(b){return b>0?g(h(b),9007199254740991):0}},function(i,a,c){var h=c(21),g=Math.max,b=Math.min;i.exports=function($,y){return($=h($))<0?g($+y,0):b($,y)}},function(i,a,c){var h=c(3).document;i.exports=h&&h.documentElement},function(i,a,c){var h=c(5),g=c(18),b=c(25)("IE_PROTO"),$=Object.prototype;i.exports=Object.getPrototypeOf||function(y){return y=g(y),h(y,b)?y[b]:typeof y.constructor=="function"&&y instanceof y.constructor?y.constructor.prototype:y instanceof Object?$:null}},function(i,a,c){var h=c(63),g=c(64),b=c(12),$=c(9);i.exports=c(34)(Array,"Array",function(y,w){this._t=$(y),this._i=0,this._k=w},function(){var y=this._t,w=this._k,C=this._i++;return!y||C>=y.length?(this._t=void 0,g(1)):g(0,w=="keys"?C:w=="values"?y[C]:[C,y[C]])},"values"),b.Arguments=b.Array,h("keys"),h("values"),h("entries")},function(i,a){i.exports=function(){}},function(i,a){i.exports=function(c,h){return{value:h,done:!!c}}},function(i,a,c){i.exports={default:c(66),__esModule:!0}},function(i,a,c){c(67),c(73),c(74),c(75),i.exports=c(1).Symbol},function(i,a,c){var h=c(3),g=c(5),b=c(4),$=c(15),y=c(37),w=c(68).KEY,C=c(8),S=c(26),k=c(28),E=c(17),R=c(2),F=c(30),M=c(31),L=c(69),T=c(70),V=c(10),K=c(11),Y=c(18),te=c(9),J=c(23),ne=c(16),Q=c(38),he=c(71),q=c(72),re=c(32),De=c(7),ee=c(13),Fe=q.f,Ce=De.f,Ze=he.f,pe=h.Symbol,Te=h.JSON,ke=Te&&Te.stringify,Xe=R("_hidden"),Ke=R("toPrimitive"),at={}.propertyIsEnumerable,Ue=S("symbol-registry"),ut=S("symbols"),rt=S("op-symbols"),tt=Object.prototype,It=typeof pe=="function"&&!!re.f,Yt=h.QObject,Ut=!Yt||!Yt.prototype||!Yt.prototype.findChild,Fn=b&&C(function(){return Q(Ce({},"a",{get:function(){return Ce(this,"a",{value:7}).a}})).a!=7})?function(ue,we,je){var ie=Fe(tt,we);ie&&delete tt[we],Ce(ue,we,je),ie&&ue!==tt&&Ce(tt,we,ie)}:Ce,Xt=function(ue){var we=ut[ue]=Q(pe.prototype);return we._k=ue,we},en=It&&typeof pe.iterator=="symbol"?function(ue){return typeof ue=="symbol"}:function(ue){return ue instanceof pe},Ot=function(ue,we,je){return ue===tt&&Ot(rt,we,je),V(ue),we=J(we,!0),V(je),g(ut,we)?(je.enumerable?(g(ue,Xe)&&ue[Xe][we]&&(ue[Xe][we]=!1),je=Q(je,{enumerable:ne(0,!1)})):(g(ue,Xe)||Ce(ue,Xe,ne(1,{})),ue[Xe][we]=!0),Fn(ue,we,je)):Ce(ue,we,je)},Lt=function(ue,we){V(ue);for(var je,ie=L(we=te(we)),Pe=0,vt=ie.length;vt>Pe;)Ot(ue,je=ie[Pe++],we[je]);return ue},vn=function(ue){var we=at.call(this,ue=J(ue,!0));return!(this===tt&&g(ut,ue)&&!g(rt,ue))&&(!(we||!g(this,ue)||!g(ut,ue)||g(this,Xe)&&this[Xe][ue])||we)},Ln=function(ue,we){if(ue=te(ue),we=J(we,!0),ue!==tt||!g(ut,we)||g(rt,we)){var je=Fe(ue,we);return!je||!g(ut,we)||g(ue,Xe)&&ue[Xe][we]||(je.enumerable=!0),je}},He=function(ue){for(var we,je=Ze(te(ue)),ie=[],Pe=0;je.length>Pe;)g(ut,we=je[Pe++])||we==Xe||we==w||ie.push(we);return ie},Ft=function(ue){for(var we,je=ue===tt,ie=Ze(je?rt:te(ue)),Pe=[],vt=0;ie.length>vt;)!g(ut,we=ie[vt++])||je&&!g(tt,we)||Pe.push(ut[we]);return Pe};It||(y((pe=function(){if(this instanceof pe)throw TypeError("Symbol is not a constructor!");var ue=E(arguments.length>0?arguments[0]:void 0),we=function(je){this===tt&&we.call(rt,je),g(this,Xe)&&g(this[Xe],ue)&&(this[Xe][ue]=!1),Fn(this,ue,ne(1,je))};return b&&Ut&&Fn(tt,ue,{configurable:!0,set:we}),Xt(ue)}).prototype,"toString",function(){return this._k}),q.f=Ln,De.f=Ot,c(41).f=he.f=He,c(19).f=vn,re.f=Ft,b&&!c(14)&&y(tt,"propertyIsEnumerable",vn,!0),F.f=function(ue){return Xt(R(ue))}),$($.G+$.W+$.F*!It,{Symbol:pe});for(var St="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),Tn=0;St.length>Tn;)R(St[Tn++]);for(var os=ee(R.store),Ee=0;os.length>Ee;)M(os[Ee++]);$($.S+$.F*!It,"Symbol",{for:function(ue){return g(Ue,ue+="")?Ue[ue]:Ue[ue]=pe(ue)},keyFor:function(ue){if(!en(ue))throw TypeError(ue+" is not a symbol!");for(var we in Ue)if(Ue[we]===ue)return we},useSetter:function(){Ut=!0},useSimple:function(){Ut=!1}}),$($.S+$.F*!It,"Object",{create:function(ue,we){return we===void 0?Q(ue):Lt(Q(ue),we)},defineProperty:Ot,defineProperties:Lt,getOwnPropertyDescriptor:Ln,getOwnPropertyNames:He,getOwnPropertySymbols:Ft});var fe=C(function(){re.f(1)});$($.S+$.F*fe,"Object",{getOwnPropertySymbols:function(ue){return re.f(Y(ue))}}),Te&&$($.S+$.F*(!It||C(function(){var ue=pe();return ke([ue])!="[null]"||ke({a:ue})!="{}"||ke(Object(ue))!="{}"})),"JSON",{stringify:function(ue){for(var we,je,ie=[ue],Pe=1;arguments.length>Pe;)ie.push(arguments[Pe++]);if(je=we=ie[1],(K(we)||ue!==void 0)&&!en(ue))return T(we)||(we=function(vt,it){if(typeof je=="function"&&(it=je.call(this,vt,it)),!en(it))return it}),ie[1]=we,ke.apply(Te,ie)}}),pe.prototype[Ke]||c(6)(pe.prototype,Ke,pe.prototype.valueOf),k(pe,"Symbol"),k(Math,"Math",!0),k(h.JSON,"JSON",!0)},function(i,a,c){var h=c(17)("meta"),g=c(11),b=c(5),$=c(7).f,y=0,w=Object.isExtensible||function(){return!0},C=!c(8)(function(){return w(Object.preventExtensions({}))}),S=function(E){$(E,h,{value:{i:"O"+ ++y,w:{}}})},k=i.exports={KEY:h,NEED:!1,fastKey:function(E,R){if(!g(E))return typeof E=="symbol"?E:(typeof E=="string"?"S":"P")+E;if(!b(E,h)){if(!w(E))return"F";if(!R)return"E";S(E)}return E[h].i},getWeak:function(E,R){if(!b(E,h)){if(!w(E))return!0;if(!R)return!1;S(E)}return E[h].w},onFreeze:function(E){return C&&k.NEED&&w(E)&&!b(E,h)&&S(E),E}}},function(i,a,c){var h=c(13),g=c(32),b=c(19);i.exports=function($){var y=h($),w=g.f;if(w)for(var C,S=w($),k=b.f,E=0;S.length>E;)k.call($,C=S[E++])&&y.push(C);return y}},function(i,a,c){var h=c(24);i.exports=Array.isArray||function(g){return h(g)=="Array"}},function(i,a,c){var h=c(9),g=c(41).f,b={}.toString,$=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];i.exports.f=function(y){return $&&b.call(y)=="[object Window]"?function(w){try{return g(w)}catch{return $.slice()}}(y):g(h(y))}},function(i,a,c){var h=c(19),g=c(16),b=c(9),$=c(23),y=c(5),w=c(35),C=Object.getOwnPropertyDescriptor;a.f=c(4)?C:function(S,k){if(S=b(S),k=$(k,!0),w)try{return C(S,k)}catch{}if(y(S,k))return g(!h.f.call(S,k),S[k])}},function(i,a){},function(i,a,c){c(31)("asyncIterator")},function(i,a,c){c(31)("observable")},function(i,a,c){a.__esModule=!0;var h,g=c(77),b=(h=g)&&h.__esModule?h:{default:h};a.default=b.default||function($){for(var y=1;y<arguments.length;y++){var w=arguments[y];for(var C in w)Object.prototype.hasOwnProperty.call(w,C)&&($[C]=w[C])}return $}},function(i,a,c){i.exports={default:c(78),__esModule:!0}},function(i,a,c){c(79),i.exports=c(1).Object.assign},function(i,a,c){var h=c(15);h(h.S+h.F,"Object",{assign:c(80)})},function(i,a,c){var h=c(4),g=c(13),b=c(32),$=c(19),y=c(18),w=c(40),C=Object.assign;i.exports=!C||c(8)(function(){var S={},k={},E=Symbol(),R="abcdefghijklmnopqrst";return S[E]=7,R.split("").forEach(function(F){k[F]=F}),C({},S)[E]!=7||Object.keys(C({},k)).join("")!=R})?function(S,k){for(var E=y(S),R=arguments.length,F=1,M=b.f,L=$.f;R>F;)for(var T,V=w(arguments[F++]),K=M?g(V).concat(M(V)):g(V),Y=K.length,te=0;Y>te;)T=K[te++],h&&!L.call(V,T)||(E[T]=V[T]);return E}:C},function(i,a,c){a.__esModule=!0;var h=b(c(82)),g=b(c(85));function b($){return $&&$.__esModule?$:{default:$}}a.default=function($,y){if(Array.isArray($))return $;if((0,h.default)(Object($)))return function(w,C){var S=[],k=!0,E=!1,R=void 0;try{for(var F,M=(0,g.default)(w);!(k=(F=M.next()).done)&&(S.push(F.value),!C||S.length!==C);k=!0);}catch(L){E=!0,R=L}finally{try{!k&&M.return&&M.return()}finally{if(E)throw R}}return S}($,y);throw new TypeError("Invalid attempt to destructure non-iterable instance")}},function(i,a,c){i.exports={default:c(83),__esModule:!0}},function(i,a,c){c(29),c(20),i.exports=c(84)},function(i,a,c){var h=c(42),g=c(2)("iterator"),b=c(12);i.exports=c(1).isIterable=function($){var y=Object($);return y[g]!==void 0||"@@iterator"in y||b.hasOwnProperty(h(y))}},function(i,a,c){i.exports={default:c(86),__esModule:!0}},function(i,a,c){c(29),c(20),i.exports=c(87)},function(i,a,c){var h=c(10),g=c(88);i.exports=c(1).getIterator=function(b){var $=g(b);if(typeof $!="function")throw TypeError(b+" is not iterable!");return h($.call(b))}},function(i,a,c){var h=c(42),g=c(2)("iterator"),b=c(12);i.exports=c(1).getIteratorMethod=function($){if($!=null)return $[g]||$["@@iterator"]||b[h($)]}},function(i,a,c){i.exports={default:c(90),__esModule:!0}},function(i,a,c){c(91),i.exports=c(1).Object.keys},function(i,a,c){var h=c(18),g=c(13);c(92)("keys",function(){return function(b){return g(h(b))}})},function(i,a,c){var h=c(15),g=c(1),b=c(8);i.exports=function($,y){var w=(g.Object||{})[$]||Object[$],C={};C[$]=y(w),h(h.S+h.F*b(function(){w(1)}),"Object",C)}},function(i,a,c){(function(h){var g=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]],b=/^\s+|\s+$/g,$=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,y=/\{\n\/\* \[wrapped with (.+)\] \*/,w=/,? & /,C=/^[-+]0x[0-9a-f]+$/i,S=/^0b[01]+$/i,k=/^\[object .+?Constructor\]$/,E=/^0o[0-7]+$/i,R=/^(?:0|[1-9]\d*)$/,F=parseInt,M=typeof h=="object"&&h&&h.Object===Object&&h,L=typeof self=="object"&&self&&self.Object===Object&&self,T=M||L||Function("return this")();function V(Ee,fe,ue){switch(ue.length){case 0:return Ee.call(fe);case 1:return Ee.call(fe,ue[0]);case 2:return Ee.call(fe,ue[0],ue[1]);case 3:return Ee.call(fe,ue[0],ue[1],ue[2])}return Ee.apply(fe,ue)}function K(Ee,fe){return!!(Ee&&Ee.length)&&function(ue,we,je){if(we!=we)return function(vt,it,En,lt){for(var yn=vt.length,gn=En+-1;++gn<yn;)if(it(vt[gn],gn,vt))return gn;return-1}(ue,Y,je);for(var ie=je-1,Pe=ue.length;++ie<Pe;)if(ue[ie]===we)return ie;return-1}(Ee,fe,0)>-1}function Y(Ee){return Ee!=Ee}function te(Ee,fe){for(var ue=Ee.length,we=0;ue--;)Ee[ue]===fe&&we++;return we}function J(Ee,fe){for(var ue=-1,we=Ee.length,je=0,ie=[];++ue<we;){var Pe=Ee[ue];Pe!==fe&&Pe!=="__lodash_placeholder__"||(Ee[ue]="__lodash_placeholder__",ie[je++]=ue)}return ie}var ne,Q,he,q=Function.prototype,re=Object.prototype,De=T["__core-js_shared__"],ee=(ne=/[^.]+$/.exec(De&&De.keys&&De.keys.IE_PROTO||""))?"Symbol(src)_1."+ne:"",Fe=q.toString,Ce=re.hasOwnProperty,Ze=re.toString,pe=RegExp("^"+Fe.call(Ce).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Te=Object.create,ke=Math.max,Xe=Math.min,Ke=(Q=Xt(Object,"defineProperty"),(he=Xt.name)&&he.length>2?Q:void 0);function at(Ee){return St(Ee)?Te(Ee):{}}function Ue(Ee){return!(!St(Ee)||function(fe){return!!ee&&ee in fe}(Ee))&&(function(fe){var ue=St(fe)?Ze.call(fe):"";return ue=="[object Function]"||ue=="[object GeneratorFunction]"}(Ee)||function(fe){var ue=!1;if(fe!=null&&typeof fe.toString!="function")try{ue=!!(fe+"")}catch{}return ue}(Ee)?pe:k).test(function(fe){if(fe!=null){try{return Fe.call(fe)}catch{}try{return fe+""}catch{}}return""}(Ee))}function ut(Ee,fe,ue,we){for(var je=-1,ie=Ee.length,Pe=ue.length,vt=-1,it=fe.length,En=ke(ie-Pe,0),lt=Array(it+En),yn=!we;++vt<it;)lt[vt]=fe[vt];for(;++je<Pe;)(yn||je<ie)&&(lt[ue[je]]=Ee[je]);for(;En--;)lt[vt++]=Ee[je++];return lt}function rt(Ee,fe,ue,we){for(var je=-1,ie=Ee.length,Pe=-1,vt=ue.length,it=-1,En=fe.length,lt=ke(ie-vt,0),yn=Array(lt+En),gn=!we;++je<lt;)yn[je]=Ee[je];for(var Wn=je;++it<En;)yn[Wn+it]=fe[it];for(;++Pe<vt;)(gn||je<ie)&&(yn[Wn+ue[Pe]]=Ee[je++]);return yn}function tt(Ee){return function(){var fe=arguments;switch(fe.length){case 0:return new Ee;case 1:return new Ee(fe[0]);case 2:return new Ee(fe[0],fe[1]);case 3:return new Ee(fe[0],fe[1],fe[2]);case 4:return new Ee(fe[0],fe[1],fe[2],fe[3]);case 5:return new Ee(fe[0],fe[1],fe[2],fe[3],fe[4]);case 6:return new Ee(fe[0],fe[1],fe[2],fe[3],fe[4],fe[5]);case 7:return new Ee(fe[0],fe[1],fe[2],fe[3],fe[4],fe[5],fe[6])}var ue=at(Ee.prototype),we=Ee.apply(ue,fe);return St(we)?we:ue}}function It(Ee,fe,ue,we,je,ie,Pe,vt,it,En){var lt=128&fe,yn=1&fe,gn=2&fe,Wn=24&fe,Xn=512&fe,Xs=gn?void 0:tt(Ee);return function as(){for(var An=arguments.length,Bt=Array(An),jn=An;jn--;)Bt[jn]=arguments[jn];if(Wn)var gs=Fn(as),Zs=te(Bt,gs);if(we&&(Bt=ut(Bt,we,je,Wn)),ie&&(Bt=rt(Bt,ie,Pe,Wn)),An-=Zs,Wn&&An<En){var zn=J(Bt,gs);return Yt(Ee,fe,It,as.placeholder,ue,Bt,zn,vt,it,En-An)}var Vn=yn?ue:this,Fs=gn?Vn[Ee]:Ee;return An=Bt.length,vt?Bt=vn(Bt,vt):Xn&&An>1&&Bt.reverse(),lt&&it<An&&(Bt.length=it),this&&this!==T&&this instanceof as&&(Fs=Xs||tt(Fs)),Fs.apply(Vn,Bt)}}function Yt(Ee,fe,ue,we,je,ie,Pe,vt,it,En){var lt=8&fe;fe|=lt?32:64,4&(fe&=~(lt?64:32))||(fe&=-4);var yn=ue(Ee,fe,je,lt?ie:void 0,lt?Pe:void 0,lt?void 0:ie,lt?void 0:Pe,vt,it,En);return yn.placeholder=we,Ln(yn,Ee,fe)}function Ut(Ee,fe,ue,we,je,ie,Pe,vt){var it=2&fe;if(!it&&typeof Ee!="function")throw new TypeError("Expected a function");var En=we?we.length:0;if(En||(fe&=-97,we=je=void 0),Pe=Pe===void 0?Pe:ke(os(Pe),0),vt=vt===void 0?vt:os(vt),En-=je?je.length:0,64&fe){var lt=we,yn=je;we=je=void 0}var gn=[Ee,fe,ue,we,je,lt,yn,ie,Pe,vt];if(Ee=gn[0],fe=gn[1],ue=gn[2],we=gn[3],je=gn[4],!(vt=gn[9]=gn[9]==null?it?0:Ee.length:ke(gn[9]-En,0))&&24&fe&&(fe&=-25),fe&&fe!=1)Wn=fe==8||fe==16?function(Xn,Xs,as){var An=tt(Xn);return function Bt(){for(var jn=arguments.length,gs=Array(jn),Zs=jn,zn=Fn(Bt);Zs--;)gs[Zs]=arguments[Zs];var Vn=jn<3&&gs[0]!==zn&&gs[jn-1]!==zn?[]:J(gs,zn);if((jn-=Vn.length)<as)return Yt(Xn,Xs,It,Bt.placeholder,void 0,gs,Vn,void 0,void 0,as-jn);var Fs=this&&this!==T&&this instanceof Bt?An:Xn;return V(Fs,this,gs)}}(Ee,fe,vt):fe!=32&&fe!=33||je.length?It.apply(void 0,gn):function(Xn,Xs,as,An){var Bt=1&Xs,jn=tt(Xn);return function gs(){for(var Zs=-1,zn=arguments.length,Vn=-1,Fs=An.length,fi=Array(Fs+zn),Or=this&&this!==T&&this instanceof gs?jn:Xn;++Vn<Fs;)fi[Vn]=An[Vn];for(;zn--;)fi[Vn++]=arguments[++Zs];return V(Or,Bt?as:this,fi)}}(Ee,fe,ue,we);else var Wn=function(Xn,Xs,as){var An=1&Xs,Bt=tt(Xn);return function jn(){var gs=this&&this!==T&&this instanceof jn?Bt:Xn;return gs.apply(An?as:this,arguments)}}(Ee,fe,ue);return Ln(Wn,Ee,fe)}function Fn(Ee){return Ee.placeholder}function Xt(Ee,fe){var ue=function(we,je){return we==null?void 0:we[je]}(Ee,fe);return Ue(ue)?ue:void 0}function en(Ee){var fe=Ee.match(y);return fe?fe[1].split(w):[]}function Ot(Ee,fe){var ue=fe.length,we=ue-1;return fe[we]=(ue>1?"& ":"")+fe[we],fe=fe.join(ue>2?", ":" "),Ee.replace($,`{
/* [wrapped with `+fe+`] */
`)}function Lt(Ee,fe){return!!(fe=fe??9007199254740991)&&(typeof Ee=="number"||R.test(Ee))&&Ee>-1&&Ee%1==0&&Ee<fe}function vn(Ee,fe){for(var ue=Ee.length,we=Xe(fe.length,ue),je=function(Pe,vt){var it=-1,En=Pe.length;for(vt||(vt=Array(En));++it<En;)vt[it]=Pe[it];return vt}(Ee);we--;){var ie=fe[we];Ee[we]=Lt(ie,ue)?je[ie]:void 0}return Ee}var Ln=Ke?function(Ee,fe,ue){var we,je=fe+"";return Ke(Ee,"toString",{configurable:!0,enumerable:!1,value:(we=Ot(je,He(en(je),ue)),function(){return we})})}:function(Ee){return Ee};function He(Ee,fe){return function(ue,we){for(var je=-1,ie=ue.length;++je<ie&&we(ue[je],je,ue)!==!1;);}(g,function(ue){var we="_."+ue[0];fe&ue[1]&&!K(Ee,we)&&Ee.push(we)}),Ee.sort()}function Ft(Ee,fe,ue){var we=Ut(Ee,8,void 0,void 0,void 0,void 0,void 0,fe=ue?void 0:fe);return we.placeholder=Ft.placeholder,we}function St(Ee){var fe=typeof Ee;return!!Ee&&(fe=="object"||fe=="function")}function Tn(Ee){return Ee?(Ee=function(fe){if(typeof fe=="number")return fe;if(function(je){return typeof je=="symbol"||function(ie){return!!ie&&typeof ie=="object"}(je)&&Ze.call(je)=="[object Symbol]"}(fe))return NaN;if(St(fe)){var ue=typeof fe.valueOf=="function"?fe.valueOf():fe;fe=St(ue)?ue+"":ue}if(typeof fe!="string")return fe===0?fe:+fe;fe=fe.replace(b,"");var we=S.test(fe);return we||E.test(fe)?F(fe.slice(2),we?2:8):C.test(fe)?NaN:+fe}(Ee))===1/0||Ee===-1/0?17976931348623157e292*(Ee<0?-1:1):Ee==Ee?Ee:0:Ee===0?Ee:0}function os(Ee){var fe=Tn(Ee),ue=fe%1;return fe==fe?ue?fe-ue:fe:0}Ft.placeholder={},i.exports=Ft}).call(this,c(43))},function(i,a,c){function h(rt){return rt&&rt.__esModule?rt.default:rt}a.__esModule=!0;var g=c(95);a.threezerotwofour=h(g);var b=c(96);a.apathy=h(b);var $=c(97);a.ashes=h($);var y=c(98);a.atelierDune=h(y);var w=c(99);a.atelierForest=h(w);var C=c(100);a.atelierHeath=h(C);var S=c(101);a.atelierLakeside=h(S);var k=c(102);a.atelierSeaside=h(k);var E=c(103);a.bespin=h(E);var R=c(104);a.brewer=h(R);var F=c(105);a.bright=h(F);var M=c(106);a.chalk=h(M);var L=c(107);a.codeschool=h(L);var T=c(108);a.colors=h(T);var V=c(109);a.default=h(V);var K=c(110);a.eighties=h(K);var Y=c(111);a.embers=h(Y);var te=c(112);a.flat=h(te);var J=c(113);a.google=h(J);var ne=c(114);a.grayscale=h(ne);var Q=c(115);a.greenscreen=h(Q);var he=c(116);a.harmonic=h(he);var q=c(117);a.hopscotch=h(q);var re=c(118);a.isotope=h(re);var De=c(119);a.marrakesh=h(De);var ee=c(120);a.mocha=h(ee);var Fe=c(121);a.monokai=h(Fe);var Ce=c(122);a.ocean=h(Ce);var Ze=c(123);a.paraiso=h(Ze);var pe=c(124);a.pop=h(pe);var Te=c(125);a.railscasts=h(Te);var ke=c(126);a.shapeshifter=h(ke);var Xe=c(127);a.solarized=h(Xe);var Ke=c(128);a.summerfruit=h(Ke);var at=c(129);a.tomorrow=h(at);var Ue=c(130);a.tube=h(Ue);var ut=c(131);a.twilight=h(ut)},function(i,a,c){a.__esModule=!0,a.default={scheme:"threezerotwofour",author:"jan t. sott (http://github.com/idleberg)",base00:"#090300",base01:"#3a3432",base02:"#4a4543",base03:"#5c5855",base04:"#807d7c",base05:"#a5a2a2",base06:"#d6d5d4",base07:"#f7f7f7",base08:"#db2d20",base09:"#e8bbd0",base0A:"#fded02",base0B:"#01a252",base0C:"#b5e4f4",base0D:"#01a0e4",base0E:"#a16a94",base0F:"#cdab53"},i.exports=a.default},function(i,a,c){a.__esModule=!0,a.default={scheme:"apathy",author:"jannik siebert (https://github.com/janniks)",base00:"#031A16",base01:"#0B342D",base02:"#184E45",base03:"#2B685E",base04:"#5F9C92",base05:"#81B5AC",base06:"#A7CEC8",base07:"#D2E7E4",base08:"#3E9688",base09:"#3E7996",base0A:"#3E4C96",base0B:"#883E96",base0C:"#963E4C",base0D:"#96883E",base0E:"#4C963E",base0F:"#3E965B"},i.exports=a.default},function(i,a,c){a.__esModule=!0,a.default={scheme:"ashes",author:"jannik siebert (https://github.com/janniks)",base00:"#1C2023",base01:"#393F45",base02:"#565E65",base03:"#747C84",base04:"#ADB3BA",base05:"#C7CCD1",base06:"#DFE2E5",base07:"#F3F4F5",base08:"#C7AE95",base09:"#C7C795",base0A:"#AEC795",base0B:"#95C7AE",base0C:"#95AEC7",base0D:"#AE95C7",base0E:"#C795AE",base0F:"#C79595"},i.exports=a.default},function(i,a,c){a.__esModule=!0,a.default={scheme:"atelier dune",author:"bram de haan (http://atelierbram.github.io/syntax-highlighting/atelier-schemes/dune)",base00:"#20201d",base01:"#292824",base02:"#6e6b5e",base03:"#7d7a68",base04:"#999580",base05:"#a6a28c",base06:"#e8e4cf",base07:"#fefbec",base08:"#d73737",base09:"#b65611",base0A:"#cfb017",base0B:"#60ac39",base0C:"#1fad83",base0D:"#6684e1",base0E:"#b854d4",base0F:"#d43552"},i.exports=a.default},function(i,a,c){a.__esModule=!0,a.default={scheme:"atelier forest",author:"bram de haan (http://atelierbram.github.io/syntax-highlighting/atelier-schemes/forest)",base00:"#1b1918",base01:"#2c2421",base02:"#68615e",base03:"#766e6b",base04:"#9c9491",base05:"#a8a19f",base06:"#e6e2e0",base07:"#f1efee",base08:"#f22c40",base09:"#df5320",base0A:"#d5911a",base0B:"#5ab738",base0C:"#00ad9c",base0D:"#407ee7",base0E:"#6666ea",base0F:"#c33ff3"},i.exports=a.default},function(i,a,c){a.__esModule=!0,a.default={scheme:"atelier heath",author:"bram de haan (http://atelierbram.github.io/syntax-highlighting/atelier-schemes/heath)",base00:"#1b181b",base01:"#292329",base02:"#695d69",base03:"#776977",base04:"#9e8f9e",base05:"#ab9bab",base06:"#d8cad8",base07:"#f7f3f7",base08:"#ca402b",base09:"#a65926",base0A:"#bb8a35",base0B:"#379a37",base0C:"#159393",base0D:"#516aec",base0E:"#7b59c0",base0F:"#cc33cc"},i.exports=a.default},function(i,a,c){a.__esModule=!0,a.default={scheme:"atelier lakeside",author:"bram de haan (http://atelierbram.github.io/syntax-highlighting/atelier-schemes/lakeside/)",base00:"#161b1d",base01:"#1f292e",base02:"#516d7b",base03:"#5a7b8c",base04:"#7195a8",base05:"#7ea2b4",base06:"#c1e4f6",base07:"#ebf8ff",base08:"#d22d72",base09:"#935c25",base0A:"#8a8a0f",base0B:"#568c3b",base0C:"#2d8f6f",base0D:"#257fad",base0E:"#5d5db1",base0F:"#b72dd2"},i.exports=a.default},function(i,a,c){a.__esModule=!0,a.default={scheme:"atelier seaside",author:"bram de haan (http://atelierbram.github.io/syntax-highlighting/atelier-schemes/seaside/)",base00:"#131513",base01:"#242924",base02:"#5e6e5e",base03:"#687d68",base04:"#809980",base05:"#8ca68c",base06:"#cfe8cf",base07:"#f0fff0",base08:"#e6193c",base09:"#87711d",base0A:"#c3c322",base0B:"#29a329",base0C:"#1999b3",base0D:"#3d62f5",base0E:"#ad2bee",base0F:"#e619c3"},i.exports=a.default},function(i,a,c){a.__esModule=!0,a.default={scheme:"bespin",author:"jan t. sott",base00:"#28211c",base01:"#36312e",base02:"#5e5d5c",base03:"#666666",base04:"#797977",base05:"#8a8986",base06:"#9d9b97",base07:"#baae9e",base08:"#cf6a4c",base09:"#cf7d34",base0A:"#f9ee98",base0B:"#54be0d",base0C:"#afc4db",base0D:"#5ea6ea",base0E:"#9b859d",base0F:"#937121"},i.exports=a.default},function(i,a,c){a.__esModule=!0,a.default={scheme:"brewer",author:"timothée poisot (http://github.com/tpoisot)",base00:"#0c0d0e",base01:"#2e2f30",base02:"#515253",base03:"#737475",base04:"#959697",base05:"#b7b8b9",base06:"#dadbdc",base07:"#fcfdfe",base08:"#e31a1c",base09:"#e6550d",base0A:"#dca060",base0B:"#31a354",base0C:"#80b1d3",base0D:"#3182bd",base0E:"#756bb1",base0F:"#b15928"},i.exports=a.default},function(i,a,c){a.__esModule=!0,a.default={scheme:"bright",author:"chris kempson (http://chriskempson.com)",base00:"#000000",base01:"#303030",base02:"#505050",base03:"#b0b0b0",base04:"#d0d0d0",base05:"#e0e0e0",base06:"#f5f5f5",base07:"#ffffff",base08:"#fb0120",base09:"#fc6d24",base0A:"#fda331",base0B:"#a1c659",base0C:"#76c7b7",base0D:"#6fb3d2",base0E:"#d381c3",base0F:"#be643c"},i.exports=a.default},function(i,a,c){a.__esModule=!0,a.default={scheme:"chalk",author:"chris kempson (http://chriskempson.com)",base00:"#151515",base01:"#202020",base02:"#303030",base03:"#505050",base04:"#b0b0b0",base05:"#d0d0d0",base06:"#e0e0e0",base07:"#f5f5f5",base08:"#fb9fb1",base09:"#eda987",base0A:"#ddb26f",base0B:"#acc267",base0C:"#12cfc0",base0D:"#6fc2ef",base0E:"#e1a3ee",base0F:"#deaf8f"},i.exports=a.default},function(i,a,c){a.__esModule=!0,a.default={scheme:"codeschool",author:"brettof86",base00:"#232c31",base01:"#1c3657",base02:"#2a343a",base03:"#3f4944",base04:"#84898c",base05:"#9ea7a6",base06:"#a7cfa3",base07:"#b5d8f6",base08:"#2a5491",base09:"#43820d",base0A:"#a03b1e",base0B:"#237986",base0C:"#b02f30",base0D:"#484d79",base0E:"#c59820",base0F:"#c98344"},i.exports=a.default},function(i,a,c){a.__esModule=!0,a.default={scheme:"colors",author:"mrmrs (http://clrs.cc)",base00:"#111111",base01:"#333333",base02:"#555555",base03:"#777777",base04:"#999999",base05:"#bbbbbb",base06:"#dddddd",base07:"#ffffff",base08:"#ff4136",base09:"#ff851b",base0A:"#ffdc00",base0B:"#2ecc40",base0C:"#7fdbff",base0D:"#0074d9",base0E:"#b10dc9",base0F:"#85144b"},i.exports=a.default},function(i,a,c){a.__esModule=!0,a.default={scheme:"default",author:"chris kempson (http://chriskempson.com)",base00:"#181818",base01:"#282828",base02:"#383838",base03:"#585858",base04:"#b8b8b8",base05:"#d8d8d8",base06:"#e8e8e8",base07:"#f8f8f8",base08:"#ab4642",base09:"#dc9656",base0A:"#f7ca88",base0B:"#a1b56c",base0C:"#86c1b9",base0D:"#7cafc2",base0E:"#ba8baf",base0F:"#a16946"},i.exports=a.default},function(i,a,c){a.__esModule=!0,a.default={scheme:"eighties",author:"chris kempson (http://chriskempson.com)",base00:"#2d2d2d",base01:"#393939",base02:"#515151",base03:"#747369",base04:"#a09f93",base05:"#d3d0c8",base06:"#e8e6df",base07:"#f2f0ec",base08:"#f2777a",base09:"#f99157",base0A:"#ffcc66",base0B:"#99cc99",base0C:"#66cccc",base0D:"#6699cc",base0E:"#cc99cc",base0F:"#d27b53"},i.exports=a.default},function(i,a,c){a.__esModule=!0,a.default={scheme:"embers",author:"jannik siebert (https://github.com/janniks)",base00:"#16130F",base01:"#2C2620",base02:"#433B32",base03:"#5A5047",base04:"#8A8075",base05:"#A39A90",base06:"#BEB6AE",base07:"#DBD6D1",base08:"#826D57",base09:"#828257",base0A:"#6D8257",base0B:"#57826D",base0C:"#576D82",base0D:"#6D5782",base0E:"#82576D",base0F:"#825757"},i.exports=a.default},function(i,a,c){a.__esModule=!0,a.default={scheme:"flat",author:"chris kempson (http://chriskempson.com)",base00:"#2C3E50",base01:"#34495E",base02:"#7F8C8D",base03:"#95A5A6",base04:"#BDC3C7",base05:"#e0e0e0",base06:"#f5f5f5",base07:"#ECF0F1",base08:"#E74C3C",base09:"#E67E22",base0A:"#F1C40F",base0B:"#2ECC71",base0C:"#1ABC9C",base0D:"#3498DB",base0E:"#9B59B6",base0F:"#be643c"},i.exports=a.default},function(i,a,c){a.__esModule=!0,a.default={scheme:"google",author:"seth wright (http://sethawright.com)",base00:"#1d1f21",base01:"#282a2e",base02:"#373b41",base03:"#969896",base04:"#b4b7b4",base05:"#c5c8c6",base06:"#e0e0e0",base07:"#ffffff",base08:"#CC342B",base09:"#F96A38",base0A:"#FBA922",base0B:"#198844",base0C:"#3971ED",base0D:"#3971ED",base0E:"#A36AC7",base0F:"#3971ED"},i.exports=a.default},function(i,a,c){a.__esModule=!0,a.default={scheme:"grayscale",author:"alexandre gavioli (https://github.com/alexx2/)",base00:"#101010",base01:"#252525",base02:"#464646",base03:"#525252",base04:"#ababab",base05:"#b9b9b9",base06:"#e3e3e3",base07:"#f7f7f7",base08:"#7c7c7c",base09:"#999999",base0A:"#a0a0a0",base0B:"#8e8e8e",base0C:"#868686",base0D:"#686868",base0E:"#747474",base0F:"#5e5e5e"},i.exports=a.default},function(i,a,c){a.__esModule=!0,a.default={scheme:"green screen",author:"chris kempson (http://chriskempson.com)",base00:"#001100",base01:"#003300",base02:"#005500",base03:"#007700",base04:"#009900",base05:"#00bb00",base06:"#00dd00",base07:"#00ff00",base08:"#007700",base09:"#009900",base0A:"#007700",base0B:"#00bb00",base0C:"#005500",base0D:"#009900",base0E:"#00bb00",base0F:"#005500"},i.exports=a.default},function(i,a,c){a.__esModule=!0,a.default={scheme:"harmonic16",author:"jannik siebert (https://github.com/janniks)",base00:"#0b1c2c",base01:"#223b54",base02:"#405c79",base03:"#627e99",base04:"#aabcce",base05:"#cbd6e2",base06:"#e5ebf1",base07:"#f7f9fb",base08:"#bf8b56",base09:"#bfbf56",base0A:"#8bbf56",base0B:"#56bf8b",base0C:"#568bbf",base0D:"#8b56bf",base0E:"#bf568b",base0F:"#bf5656"},i.exports=a.default},function(i,a,c){a.__esModule=!0,a.default={scheme:"hopscotch",author:"jan t. sott",base00:"#322931",base01:"#433b42",base02:"#5c545b",base03:"#797379",base04:"#989498",base05:"#b9b5b8",base06:"#d5d3d5",base07:"#ffffff",base08:"#dd464c",base09:"#fd8b19",base0A:"#fdcc59",base0B:"#8fc13e",base0C:"#149b93",base0D:"#1290bf",base0E:"#c85e7c",base0F:"#b33508"},i.exports=a.default},function(i,a,c){a.__esModule=!0,a.default={scheme:"isotope",author:"jan t. sott",base00:"#000000",base01:"#404040",base02:"#606060",base03:"#808080",base04:"#c0c0c0",base05:"#d0d0d0",base06:"#e0e0e0",base07:"#ffffff",base08:"#ff0000",base09:"#ff9900",base0A:"#ff0099",base0B:"#33ff00",base0C:"#00ffff",base0D:"#0066ff",base0E:"#cc00ff",base0F:"#3300ff"},i.exports=a.default},function(i,a,c){a.__esModule=!0,a.default={scheme:"marrakesh",author:"alexandre gavioli (http://github.com/alexx2/)",base00:"#201602",base01:"#302e00",base02:"#5f5b17",base03:"#6c6823",base04:"#86813b",base05:"#948e48",base06:"#ccc37a",base07:"#faf0a5",base08:"#c35359",base09:"#b36144",base0A:"#a88339",base0B:"#18974e",base0C:"#75a738",base0D:"#477ca1",base0E:"#8868b3",base0F:"#b3588e"},i.exports=a.default},function(i,a,c){a.__esModule=!0,a.default={scheme:"mocha",author:"chris kempson (http://chriskempson.com)",base00:"#3B3228",base01:"#534636",base02:"#645240",base03:"#7e705a",base04:"#b8afad",base05:"#d0c8c6",base06:"#e9e1dd",base07:"#f5eeeb",base08:"#cb6077",base09:"#d28b71",base0A:"#f4bc87",base0B:"#beb55b",base0C:"#7bbda4",base0D:"#8ab3b5",base0E:"#a89bb9",base0F:"#bb9584"},i.exports=a.default},function(i,a,c){a.__esModule=!0,a.default={scheme:"monokai",author:"wimer hazenberg (http://www.monokai.nl)",base00:"#272822",base01:"#383830",base02:"#49483e",base03:"#75715e",base04:"#a59f85",base05:"#f8f8f2",base06:"#f5f4f1",base07:"#f9f8f5",base08:"#f92672",base09:"#fd971f",base0A:"#f4bf75",base0B:"#a6e22e",base0C:"#a1efe4",base0D:"#66d9ef",base0E:"#ae81ff",base0F:"#cc6633"},i.exports=a.default},function(i,a,c){a.__esModule=!0,a.default={scheme:"ocean",author:"chris kempson (http://chriskempson.com)",base00:"#2b303b",base01:"#343d46",base02:"#4f5b66",base03:"#65737e",base04:"#a7adba",base05:"#c0c5ce",base06:"#dfe1e8",base07:"#eff1f5",base08:"#bf616a",base09:"#d08770",base0A:"#ebcb8b",base0B:"#a3be8c",base0C:"#96b5b4",base0D:"#8fa1b3",base0E:"#b48ead",base0F:"#ab7967"},i.exports=a.default},function(i,a,c){a.__esModule=!0,a.default={scheme:"paraiso",author:"jan t. sott",base00:"#2f1e2e",base01:"#41323f",base02:"#4f424c",base03:"#776e71",base04:"#8d8687",base05:"#a39e9b",base06:"#b9b6b0",base07:"#e7e9db",base08:"#ef6155",base09:"#f99b15",base0A:"#fec418",base0B:"#48b685",base0C:"#5bc4bf",base0D:"#06b6ef",base0E:"#815ba4",base0F:"#e96ba8"},i.exports=a.default},function(i,a,c){a.__esModule=!0,a.default={scheme:"pop",author:"chris kempson (http://chriskempson.com)",base00:"#000000",base01:"#202020",base02:"#303030",base03:"#505050",base04:"#b0b0b0",base05:"#d0d0d0",base06:"#e0e0e0",base07:"#ffffff",base08:"#eb008a",base09:"#f29333",base0A:"#f8ca12",base0B:"#37b349",base0C:"#00aabb",base0D:"#0e5a94",base0E:"#b31e8d",base0F:"#7a2d00"},i.exports=a.default},function(i,a,c){a.__esModule=!0,a.default={scheme:"railscasts",author:"ryan bates (http://railscasts.com)",base00:"#2b2b2b",base01:"#272935",base02:"#3a4055",base03:"#5a647e",base04:"#d4cfc9",base05:"#e6e1dc",base06:"#f4f1ed",base07:"#f9f7f3",base08:"#da4939",base09:"#cc7833",base0A:"#ffc66d",base0B:"#a5c261",base0C:"#519f50",base0D:"#6d9cbe",base0E:"#b6b3eb",base0F:"#bc9458"},i.exports=a.default},function(i,a,c){a.__esModule=!0,a.default={scheme:"shapeshifter",author:"tyler benziger (http://tybenz.com)",base00:"#000000",base01:"#040404",base02:"#102015",base03:"#343434",base04:"#555555",base05:"#ababab",base06:"#e0e0e0",base07:"#f9f9f9",base08:"#e92f2f",base09:"#e09448",base0A:"#dddd13",base0B:"#0ed839",base0C:"#23edda",base0D:"#3b48e3",base0E:"#f996e2",base0F:"#69542d"},i.exports=a.default},function(i,a,c){a.__esModule=!0,a.default={scheme:"solarized",author:"ethan schoonover (http://ethanschoonover.com/solarized)",base00:"#002b36",base01:"#073642",base02:"#586e75",base03:"#657b83",base04:"#839496",base05:"#93a1a1",base06:"#eee8d5",base07:"#fdf6e3",base08:"#dc322f",base09:"#cb4b16",base0A:"#b58900",base0B:"#859900",base0C:"#2aa198",base0D:"#268bd2",base0E:"#6c71c4",base0F:"#d33682"},i.exports=a.default},function(i,a,c){a.__esModule=!0,a.default={scheme:"summerfruit",author:"christopher corley (http://cscorley.github.io/)",base00:"#151515",base01:"#202020",base02:"#303030",base03:"#505050",base04:"#B0B0B0",base05:"#D0D0D0",base06:"#E0E0E0",base07:"#FFFFFF",base08:"#FF0086",base09:"#FD8900",base0A:"#ABA800",base0B:"#00C918",base0C:"#1faaaa",base0D:"#3777E6",base0E:"#AD00A1",base0F:"#cc6633"},i.exports=a.default},function(i,a,c){a.__esModule=!0,a.default={scheme:"tomorrow",author:"chris kempson (http://chriskempson.com)",base00:"#1d1f21",base01:"#282a2e",base02:"#373b41",base03:"#969896",base04:"#b4b7b4",base05:"#c5c8c6",base06:"#e0e0e0",base07:"#ffffff",base08:"#cc6666",base09:"#de935f",base0A:"#f0c674",base0B:"#b5bd68",base0C:"#8abeb7",base0D:"#81a2be",base0E:"#b294bb",base0F:"#a3685a"},i.exports=a.default},function(i,a,c){a.__esModule=!0,a.default={scheme:"london tube",author:"jan t. sott",base00:"#231f20",base01:"#1c3f95",base02:"#5a5758",base03:"#737171",base04:"#959ca1",base05:"#d9d8d8",base06:"#e7e7e8",base07:"#ffffff",base08:"#ee2e24",base09:"#f386a1",base0A:"#ffd204",base0B:"#00853e",base0C:"#85cebc",base0D:"#009ddc",base0E:"#98005d",base0F:"#b06110"},i.exports=a.default},function(i,a,c){a.__esModule=!0,a.default={scheme:"twilight",author:"david hart (http://hart-dev.com)",base00:"#1e1e1e",base01:"#323537",base02:"#464b50",base03:"#5f5a60",base04:"#838184",base05:"#a7a7a7",base06:"#c3c3c3",base07:"#ffffff",base08:"#cf6a4c",base09:"#cda869",base0A:"#f9ee98",base0B:"#8f9d6a",base0C:"#afc4db",base0D:"#7587a6",base0E:"#9b859d",base0F:"#9b703f"},i.exports=a.default},function(i,a,c){var h=c(33);function g(b){var $=Math.round(h(b,0,255)).toString(16);return $.length==1?"0"+$:$}i.exports=function(b){var $=b.length===4?g(255*b[3]):"";return"#"+g(b[0])+g(b[1])+g(b[2])+$}},function(i,a,c){var h=c(134),g=c(135),b=c(136),$=c(137),y={"#":g,hsl:function(C){var S=h(C),k=$(S);return S.length===4&&k.push(S[3]),k},rgb:b};function w(C){for(var S in y)if(C.indexOf(S)===0)return y[S](C)}w.rgb=b,w.hsl=h,w.hex=g,i.exports=w},function(i,a,c){var h=c(44),g=c(33);function b($,y){switch($=parseFloat($),y){case 0:return g($,0,360);case 1:case 2:return g($,0,100);case 3:return g($,0,1)}}i.exports=function($){return h($).map(b)}},function(i,a){i.exports=function(c){c.length!==4&&c.length!==5||(c=function(b){for(var $="#",y=1;y<b.length;y++){var w=b.charAt(y);$+=w+w}return $}(c));var h=[parseInt(c.substring(1,3),16),parseInt(c.substring(3,5),16),parseInt(c.substring(5,7),16)];if(c.length===9){var g=parseFloat((parseInt(c.substring(7,9),16)/255).toFixed(2));h.push(g)}return h}},function(i,a,c){var h=c(44),g=c(33);function b($,y){return y<3?$.indexOf("%")!=-1?Math.round(255*g(parseInt($,10),0,100)/100):g(parseInt($,10),0,255):g(parseFloat($),0,1)}i.exports=function($){return h($).map(b)}},function(i,a){i.exports=function(c){var h,g,b,$,y,w=c[0]/360,C=c[1]/100,S=c[2]/100;if(C==0)return[y=255*S,y,y];h=2*S-(g=S<.5?S*(1+C):S+C-S*C),$=[0,0,0];for(var k=0;k<3;k++)(b=w+1/3*-(k-1))<0&&b++,b>1&&b--,y=6*b<1?h+6*(g-h)*b:2*b<1?g:3*b<2?h+(g-h)*(2/3-b)*6:h,$[k]=255*y;return $}},function(i,a,c){(function(h){var g=typeof h=="object"&&h&&h.Object===Object&&h,b=typeof self=="object"&&self&&self.Object===Object&&self,$=g||b||Function("return this")();function y(J,ne,Q){switch(Q.length){case 0:return J.call(ne);case 1:return J.call(ne,Q[0]);case 2:return J.call(ne,Q[0],Q[1]);case 3:return J.call(ne,Q[0],Q[1],Q[2])}return J.apply(ne,Q)}function w(J,ne){for(var Q=-1,he=ne.length,q=J.length;++Q<he;)J[q+Q]=ne[Q];return J}var C=Object.prototype,S=C.hasOwnProperty,k=C.toString,E=$.Symbol,R=C.propertyIsEnumerable,F=E?E.isConcatSpreadable:void 0,M=Math.max;function L(J){return T(J)||function(ne){return function(Q){return function(he){return!!he&&typeof he=="object"}(Q)&&function(he){return he!=null&&function(q){return typeof q=="number"&&q>-1&&q%1==0&&q<=9007199254740991}(he.length)&&!function(q){var re=function(De){var ee=typeof De;return!!De&&(ee=="object"||ee=="function")}(q)?k.call(q):"";return re=="[object Function]"||re=="[object GeneratorFunction]"}(he)}(Q)}(ne)&&S.call(ne,"callee")&&(!R.call(ne,"callee")||k.call(ne)=="[object Arguments]")}(J)||!!(F&&J&&J[F])}var T=Array.isArray,V,K,Y,te=(K=function(J){var ne=(J=function(q,re,De,ee,Fe){var Ce=-1,Ze=q.length;for(De||(De=L),Fe||(Fe=[]);++Ce<Ze;){var pe=q[Ce];De(pe)?w(Fe,pe):Fe[Fe.length]=pe}return Fe}(J)).length,Q=ne;for(V;Q--;)if(typeof J[Q]!="function")throw new TypeError("Expected a function");return function(){for(var he=0,q=ne?J[he].apply(this,arguments):arguments[0];++he<ne;)q=J[he].call(this,q);return q}},Y=M(Y===void 0?K.length-1:Y,0),function(){for(var J=arguments,ne=-1,Q=M(J.length-Y,0),he=Array(Q);++ne<Q;)he[ne]=J[Y+ne];ne=-1;for(var q=Array(Y+1);++ne<Y;)q[ne]=J[ne];return q[Y]=he,y(K,this,q)});i.exports=te}).call(this,c(43))},function(i,a,c){Object.defineProperty(a,"__esModule",{value:!0}),a.yuv2rgb=function(h){var g,b,$,y=h[0],w=h[1],C=h[2];return g=1*y+0*w+1.13983*C,b=1*y+-.39465*w+-.5806*C,$=1*y+2.02311*w+0*C,g=Math.min(Math.max(0,g),1),b=Math.min(Math.max(0,b),1),$=Math.min(Math.max(0,$),1),[255*g,255*b,255*$]},a.rgb2yuv=function(h){var g=h[0]/255,b=h[1]/255,$=h[2]/255;return[.299*g+.587*b+.114*$,-.14713*g+-.28886*b+.436*$,.615*g+-.51499*b+-.10001*$]}},function(i,a,c){function h($,y,w){return y in $?Object.defineProperty($,y,{value:w,enumerable:!0,configurable:!0,writable:!0}):$[y]=w,$}var g=c(141),b=function(){function $(){h(this,"_callbacks",void 0),h(this,"_isDispatching",void 0),h(this,"_isHandled",void 0),h(this,"_isPending",void 0),h(this,"_lastID",void 0),h(this,"_pendingPayload",void 0),this._callbacks={},this._isDispatching=!1,this._isHandled={},this._isPending={},this._lastID=1}var y=$.prototype;return y.register=function(w){var C="ID_"+this._lastID++;return this._callbacks[C]=w,C},y.unregister=function(w){this._callbacks[w]||g(!1),delete this._callbacks[w]},y.waitFor=function(w){this._isDispatching||g(!1);for(var C=0;C<w.length;C++){var S=w[C];this._isPending[S]?this._isHandled[S]||g(!1):(this._callbacks[S]||g(!1),this._invokeCallback(S))}},y.dispatch=function(w){this._isDispatching&&g(!1),this._startDispatching(w);try{for(var C in this._callbacks)this._isPending[C]||this._invokeCallback(C)}finally{this._stopDispatching()}},y.isDispatching=function(){return this._isDispatching},y._invokeCallback=function(w){this._isPending[w]=!0,this._callbacks[w](this._pendingPayload),this._isHandled[w]=!0},y._startDispatching=function(w){for(var C in this._callbacks)this._isPending[C]=!1,this._isHandled[C]=!1;this._pendingPayload=w,this._isDispatching=!0},y._stopDispatching=function(){delete this._pendingPayload,this._isDispatching=!1},$}();i.exports=b},function(i,a,c){i.exports=function(h,g){for(var b=arguments.length,$=new Array(b>2?b-2:0),y=2;y<b;y++)$[y-2]=arguments[y];if(!h){var w;if(g===void 0)w=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var C=0;(w=new Error(g.replace(/%s/g,function(){return String($[C++])}))).name="Invariant Violation"}throw w.framesToPop=1,w}}},function(i,a,c){function h(U,H,A){return H in U?Object.defineProperty(U,H,{value:A,enumerable:!0,configurable:!0,writable:!0}):U[H]=A,U}function g(U,H){var A=Object.keys(U);if(Object.getOwnPropertySymbols){var j=Object.getOwnPropertySymbols(U);H&&(j=j.filter(function(z){return Object.getOwnPropertyDescriptor(U,z).enumerable})),A.push.apply(A,j)}return A}function b(U){for(var H=1;H<arguments.length;H++){var A=arguments[H]!=null?arguments[H]:{};H%2?g(Object(A),!0).forEach(function(j){h(U,j,A[j])}):Object.getOwnPropertyDescriptors?Object.defineProperties(U,Object.getOwnPropertyDescriptors(A)):g(Object(A)).forEach(function(j){Object.defineProperty(U,j,Object.getOwnPropertyDescriptor(A,j))})}return U}function $(U,H){if(!(U instanceof H))throw new TypeError("Cannot call a class as a function")}function y(U,H){for(var A=0;A<H.length;A++){var j=H[A];j.enumerable=j.enumerable||!1,j.configurable=!0,"value"in j&&(j.writable=!0),Object.defineProperty(U,j.key,j)}}function w(U,H,A){return H&&y(U.prototype,H),A&&y(U,A),U}function C(U,H){return(C=Object.setPrototypeOf||function(A,j){return A.__proto__=j,A})(U,H)}function S(U,H){if(typeof H!="function"&&H!==null)throw new TypeError("Super expression must either be null or a function");U.prototype=Object.create(H&&H.prototype,{constructor:{value:U,writable:!0,configurable:!0}}),H&&C(U,H)}function k(U){return(k=Object.setPrototypeOf?Object.getPrototypeOf:function(H){return H.__proto__||Object.getPrototypeOf(H)})(U)}function E(U){return(E=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(H){return typeof H}:function(H){return H&&typeof Symbol=="function"&&H.constructor===Symbol&&H!==Symbol.prototype?"symbol":typeof H})(U)}function R(U){if(U===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return U}function F(U,H){return!H||E(H)!=="object"&&typeof H!="function"?R(U):H}function M(U){var H=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var A,j=k(U);if(H){var z=k(this).constructor;A=Reflect.construct(j,arguments,z)}else A=j.apply(this,arguments);return F(this,A)}}c.r(a);var L=c(0),T=c.n(L);function V(){var U=this.constructor.getDerivedStateFromProps(this.props,this.state);U!=null&&this.setState(U)}function K(U){this.setState(function(H){var A=this.constructor.getDerivedStateFromProps(U,H);return A??null}.bind(this))}function Y(U,H){try{var A=this.props,j=this.state;this.props=U,this.state=H,this.__reactInternalSnapshotFlag=!0,this.__reactInternalSnapshot=this.getSnapshotBeforeUpdate(A,j)}finally{this.props=A,this.state=j}}function te(U){var H=U.prototype;if(!H||!H.isReactComponent)throw new Error("Can only polyfill class components");if(typeof U.getDerivedStateFromProps!="function"&&typeof H.getSnapshotBeforeUpdate!="function")return U;var A=null,j=null,z=null;if(typeof H.componentWillMount=="function"?A="componentWillMount":typeof H.UNSAFE_componentWillMount=="function"&&(A="UNSAFE_componentWillMount"),typeof H.componentWillReceiveProps=="function"?j="componentWillReceiveProps":typeof H.UNSAFE_componentWillReceiveProps=="function"&&(j="UNSAFE_componentWillReceiveProps"),typeof H.componentWillUpdate=="function"?z="componentWillUpdate":typeof H.UNSAFE_componentWillUpdate=="function"&&(z="UNSAFE_componentWillUpdate"),A!==null||j!==null||z!==null){var de=U.displayName||U.name,ye=typeof U.getDerivedStateFromProps=="function"?"getDerivedStateFromProps()":"getSnapshotBeforeUpdate()";throw Error(`Unsafe legacy lifecycles will not be called for components using new component APIs.

`+de+" uses "+ye+" but also contains the following legacy lifecycles:"+(A!==null?`
  `+A:"")+(j!==null?`
  `+j:"")+(z!==null?`
  `+z:"")+`

The above lifecycles should be removed. Learn more about this warning here:
https://fb.me/react-async-component-lifecycle-hooks`)}if(typeof U.getDerivedStateFromProps=="function"&&(H.componentWillMount=V,H.componentWillReceiveProps=K),typeof H.getSnapshotBeforeUpdate=="function"){if(typeof H.componentDidUpdate!="function")throw new Error("Cannot polyfill getSnapshotBeforeUpdate() for components that do not define componentDidUpdate() on the prototype");H.componentWillUpdate=Y;var $e=H.componentDidUpdate;H.componentDidUpdate=function(le,Be,Qe){var xt=this.__reactInternalSnapshotFlag?this.__reactInternalSnapshot:Qe;$e.call(this,le,Be,xt)}}return U}function J(U,H){if(U==null)return{};var A,j,z=function(ye,$e){if(ye==null)return{};var le,Be,Qe={},xt=Object.keys(ye);for(Be=0;Be<xt.length;Be++)le=xt[Be],$e.indexOf(le)>=0||(Qe[le]=ye[le]);return Qe}(U,H);if(Object.getOwnPropertySymbols){var de=Object.getOwnPropertySymbols(U);for(j=0;j<de.length;j++)A=de[j],H.indexOf(A)>=0||Object.prototype.propertyIsEnumerable.call(U,A)&&(z[A]=U[A])}return z}function ne(U){var H=function(A){return{}.toString.call(A).match(/\s([a-zA-Z]+)/)[1].toLowerCase()}(U);return H==="number"&&(H=isNaN(U)?"nan":(0|U)!=U?"float":"integer"),H}V.__suppressDeprecationWarning=!0,K.__suppressDeprecationWarning=!0,Y.__suppressDeprecationWarning=!0;var Q={scheme:"rjv-default",author:"mac gainor",base00:"rgba(0, 0, 0, 0)",base01:"rgb(245, 245, 245)",base02:"rgb(235, 235, 235)",base03:"#93a1a1",base04:"rgba(0, 0, 0, 0.3)",base05:"#586e75",base06:"#073642",base07:"#002b36",base08:"#d33682",base09:"#cb4b16",base0A:"#dc322f",base0B:"#859900",base0C:"#6c71c4",base0D:"#586e75",base0E:"#2aa198",base0F:"#268bd2"},he={scheme:"rjv-grey",author:"mac gainor",base00:"rgba(1, 1, 1, 0)",base01:"rgba(1, 1, 1, 0.1)",base02:"rgba(0, 0, 0, 0.2)",base03:"rgba(1, 1, 1, 0.3)",base04:"rgba(0, 0, 0, 0.4)",base05:"rgba(1, 1, 1, 0.5)",base06:"rgba(1, 1, 1, 0.6)",base07:"rgba(1, 1, 1, 0.7)",base08:"rgba(1, 1, 1, 0.8)",base09:"rgba(1, 1, 1, 0.8)",base0A:"rgba(1, 1, 1, 0.8)",base0B:"rgba(1, 1, 1, 0.8)",base0C:"rgba(1, 1, 1, 0.8)",base0D:"rgba(1, 1, 1, 0.8)",base0E:"rgba(1, 1, 1, 0.8)",base0F:"rgba(1, 1, 1, 0.8)"},q={white:"#fff",black:"#000",transparent:"rgba(1, 1, 1, 0)",globalFontFamily:"monospace",globalCursor:"default",indentBlockWidth:"5px",braceFontWeight:"bold",braceCursor:"pointer",ellipsisFontSize:"18px",ellipsisLineHeight:"10px",ellipsisCursor:"pointer",keyMargin:"0px 5px",keyLetterSpacing:"0.5px",keyFontStyle:"none",keyBorderRadius:"3px",keyColonWeight:"bold",keyVerticalAlign:"top",keyOpacity:"0.85",keyOpacityHover:"1",keyValPaddingTop:"3px",keyValPaddingBottom:"3px",keyValPaddingRight:"5px",keyValBorderLeft:"1px solid",keyValBorderHover:"2px solid",keyValPaddingHover:"3px 5px 3px 4px",pushedContentMarginLeft:"6px",variableValuePaddingRight:"6px",nullFontSize:"11px",nullFontWeight:"bold",nullPadding:"1px 2px",nullBorderRadius:"3px",nanFontSize:"11px",nanFontWeight:"bold",nanPadding:"1px 2px",nanBorderRadius:"3px",undefinedFontSize:"11px",undefinedFontWeight:"bold",undefinedPadding:"1px 2px",undefinedBorderRadius:"3px",dataTypeFontSize:"11px",dataTypeMarginRight:"4px",datatypeOpacity:"0.8",objectSizeBorderRadius:"3px",objectSizeFontStyle:"italic",objectSizeMargin:"0px 6px 0px 0px",clipboardCursor:"pointer",clipboardCheckMarginLeft:"-12px",metaDataPadding:"0px 0px 0px 10px",arrayGroupMetaPadding:"0px 0px 0px 4px",iconContainerWidth:"17px",tooltipPadding:"4px",editInputMinWidth:"130px",editInputBorderRadius:"2px",editInputPadding:"5px",editInputMarginRight:"4px",editInputFontFamily:"monospace",iconCursor:"pointer",iconFontSize:"15px",iconPaddingRight:"1px",dateValueMarginLeft:"2px",iconMarginRight:"3px",detectedRowPaddingTop:"3px",addKeyCoverBackground:"rgba(255, 255, 255, 0.3)",addKeyCoverPosition:"absolute",addKeyCoverPositionPx:"0px",addKeyModalWidth:"200px",addKeyModalMargin:"auto",addKeyModalPadding:"10px",addKeyModalRadius:"3px"},re=c(45),De=function(U){var H=function(A){return{backgroundColor:A.base00,ellipsisColor:A.base09,braceColor:A.base07,expandedIcon:A.base0D,collapsedIcon:A.base0E,keyColor:A.base07,arrayKeyColor:A.base0C,objectSize:A.base04,copyToClipboard:A.base0F,copyToClipboardCheck:A.base0D,objectBorder:A.base02,dataTypes:{boolean:A.base0E,date:A.base0D,float:A.base0B,function:A.base0D,integer:A.base0F,string:A.base09,nan:A.base08,null:A.base0A,undefined:A.base05,regexp:A.base0A,background:A.base02},editVariable:{editIcon:A.base0E,cancelIcon:A.base09,removeIcon:A.base09,addIcon:A.base0E,checkIcon:A.base0E,background:A.base01,color:A.base0A,border:A.base07},addKeyModal:{background:A.base05,border:A.base04,color:A.base0A,labelColor:A.base01},validationFailure:{background:A.base09,iconColor:A.base01,fontColor:A.base01}}}(U);return{"app-container":{fontFamily:q.globalFontFamily,cursor:q.globalCursor,backgroundColor:H.backgroundColor,position:"relative"},ellipsis:{display:"inline-block",color:H.ellipsisColor,fontSize:q.ellipsisFontSize,lineHeight:q.ellipsisLineHeight,cursor:q.ellipsisCursor},"brace-row":{display:"inline-block",cursor:"pointer"},brace:{display:"inline-block",cursor:q.braceCursor,fontWeight:q.braceFontWeight,color:H.braceColor},"expanded-icon":{color:H.expandedIcon},"collapsed-icon":{color:H.collapsedIcon},colon:{display:"inline-block",margin:q.keyMargin,color:H.keyColor,verticalAlign:"top"},objectKeyVal:function(A,j){return{style:b({paddingTop:q.keyValPaddingTop,paddingRight:q.keyValPaddingRight,paddingBottom:q.keyValPaddingBottom,borderLeft:q.keyValBorderLeft+" "+H.objectBorder,":hover":{paddingLeft:j.paddingLeft-1+"px",borderLeft:q.keyValBorderHover+" "+H.objectBorder}},j)}},"object-key-val-no-border":{padding:q.keyValPadding},"pushed-content":{marginLeft:q.pushedContentMarginLeft},variableValue:function(A,j){return{style:b({display:"inline-block",paddingRight:q.variableValuePaddingRight,position:"relative"},j)}},"object-name":{display:"inline-block",color:H.keyColor,letterSpacing:q.keyLetterSpacing,fontStyle:q.keyFontStyle,verticalAlign:q.keyVerticalAlign,opacity:q.keyOpacity,":hover":{opacity:q.keyOpacityHover}},"array-key":{display:"inline-block",color:H.arrayKeyColor,letterSpacing:q.keyLetterSpacing,fontStyle:q.keyFontStyle,verticalAlign:q.keyVerticalAlign,opacity:q.keyOpacity,":hover":{opacity:q.keyOpacityHover}},"object-size":{color:H.objectSize,borderRadius:q.objectSizeBorderRadius,fontStyle:q.objectSizeFontStyle,margin:q.objectSizeMargin,cursor:"default"},"data-type-label":{fontSize:q.dataTypeFontSize,marginRight:q.dataTypeMarginRight,opacity:q.datatypeOpacity},boolean:{display:"inline-block",color:H.dataTypes.boolean},date:{display:"inline-block",color:H.dataTypes.date},"date-value":{marginLeft:q.dateValueMarginLeft},float:{display:"inline-block",color:H.dataTypes.float},function:{display:"inline-block",color:H.dataTypes.function,cursor:"pointer",whiteSpace:"pre-line"},"function-value":{fontStyle:"italic"},integer:{display:"inline-block",color:H.dataTypes.integer},string:{display:"inline-block",color:H.dataTypes.string},nan:{display:"inline-block",color:H.dataTypes.nan,fontSize:q.nanFontSize,fontWeight:q.nanFontWeight,backgroundColor:H.dataTypes.background,padding:q.nanPadding,borderRadius:q.nanBorderRadius},null:{display:"inline-block",color:H.dataTypes.null,fontSize:q.nullFontSize,fontWeight:q.nullFontWeight,backgroundColor:H.dataTypes.background,padding:q.nullPadding,borderRadius:q.nullBorderRadius},undefined:{display:"inline-block",color:H.dataTypes.undefined,fontSize:q.undefinedFontSize,padding:q.undefinedPadding,borderRadius:q.undefinedBorderRadius,backgroundColor:H.dataTypes.background},regexp:{display:"inline-block",color:H.dataTypes.regexp},"copy-to-clipboard":{cursor:q.clipboardCursor},"copy-icon":{color:H.copyToClipboard,fontSize:q.iconFontSize,marginRight:q.iconMarginRight,verticalAlign:"top"},"copy-icon-copied":{color:H.copyToClipboardCheck,marginLeft:q.clipboardCheckMarginLeft},"array-group-meta-data":{display:"inline-block",padding:q.arrayGroupMetaPadding},"object-meta-data":{display:"inline-block",padding:q.metaDataPadding},"icon-container":{display:"inline-block",width:q.iconContainerWidth},tooltip:{padding:q.tooltipPadding},removeVarIcon:{verticalAlign:"top",display:"inline-block",color:H.editVariable.removeIcon,cursor:q.iconCursor,fontSize:q.iconFontSize,marginRight:q.iconMarginRight},addVarIcon:{verticalAlign:"top",display:"inline-block",color:H.editVariable.addIcon,cursor:q.iconCursor,fontSize:q.iconFontSize,marginRight:q.iconMarginRight},editVarIcon:{verticalAlign:"top",display:"inline-block",color:H.editVariable.editIcon,cursor:q.iconCursor,fontSize:q.iconFontSize,marginRight:q.iconMarginRight},"edit-icon-container":{display:"inline-block",verticalAlign:"top"},"check-icon":{display:"inline-block",cursor:q.iconCursor,color:H.editVariable.checkIcon,fontSize:q.iconFontSize,paddingRight:q.iconPaddingRight},"cancel-icon":{display:"inline-block",cursor:q.iconCursor,color:H.editVariable.cancelIcon,fontSize:q.iconFontSize,paddingRight:q.iconPaddingRight},"edit-input":{display:"inline-block",minWidth:q.editInputMinWidth,borderRadius:q.editInputBorderRadius,backgroundColor:H.editVariable.background,color:H.editVariable.color,padding:q.editInputPadding,marginRight:q.editInputMarginRight,fontFamily:q.editInputFontFamily},"detected-row":{paddingTop:q.detectedRowPaddingTop},"key-modal-request":{position:q.addKeyCoverPosition,top:q.addKeyCoverPositionPx,left:q.addKeyCoverPositionPx,right:q.addKeyCoverPositionPx,bottom:q.addKeyCoverPositionPx,backgroundColor:q.addKeyCoverBackground},"key-modal":{width:q.addKeyModalWidth,backgroundColor:H.addKeyModal.background,marginLeft:q.addKeyModalMargin,marginRight:q.addKeyModalMargin,padding:q.addKeyModalPadding,borderRadius:q.addKeyModalRadius,marginTop:"15px",position:"relative"},"key-modal-label":{color:H.addKeyModal.labelColor,marginLeft:"2px",marginBottom:"5px",fontSize:"11px"},"key-modal-input-container":{overflow:"hidden"},"key-modal-input":{width:"100%",padding:"3px 6px",fontFamily:"monospace",color:H.addKeyModal.color,border:"none",boxSizing:"border-box",borderRadius:"2px"},"key-modal-cancel":{backgroundColor:H.editVariable.removeIcon,position:"absolute",top:"0px",right:"0px",borderRadius:"0px 3px 0px 3px",cursor:"pointer"},"key-modal-cancel-icon":{color:H.addKeyModal.labelColor,fontSize:q.iconFontSize,transform:"rotate(45deg)"},"key-modal-submit":{color:H.editVariable.addIcon,fontSize:q.iconFontSize,position:"absolute",right:"2px",top:"3px",cursor:"pointer"},"function-ellipsis":{display:"inline-block",color:H.ellipsisColor,fontSize:q.ellipsisFontSize,lineHeight:q.ellipsisLineHeight,cursor:q.ellipsisCursor},"validation-failure":{float:"right",padding:"3px 6px",borderRadius:"2px",cursor:"pointer",color:H.validationFailure.fontColor,backgroundColor:H.validationFailure.background},"validation-failure-label":{marginRight:"6px"},"validation-failure-clear":{position:"relative",verticalAlign:"top",cursor:"pointer",color:H.validationFailure.iconColor,fontSize:q.iconFontSize,transform:"rotate(45deg)"}}};function ee(U,H,A){return U||console.error("theme has not been set"),function(j){var z=Q;return j!==!1&&j!=="none"||(z=he),Object(re.createStyling)(De,{defaultBase16:z})(j)}(U)(H,A)}var Fe=function(U){S(A,U);var H=M(A);function A(){return $(this,A),H.apply(this,arguments)}return w(A,[{key:"render",value:function(){var j=this.props,z=(j.rjvId,j.type_name),de=j.displayDataTypes,ye=j.theme;return de?T.a.createElement("span",Object.assign({className:"data-type-label"},ee(ye,"data-type-label")),z):null}}]),A}(T.a.PureComponent),Ce=function(U){S(A,U);var H=M(A);function A(){return $(this,A),H.apply(this,arguments)}return w(A,[{key:"render",value:function(){var j=this.props;return T.a.createElement("div",ee(j.theme,"boolean"),T.a.createElement(Fe,Object.assign({type_name:"bool"},j)),j.value?"true":"false")}}]),A}(T.a.PureComponent),Ze=function(U){S(A,U);var H=M(A);function A(){return $(this,A),H.apply(this,arguments)}return w(A,[{key:"render",value:function(){var j=this.props;return T.a.createElement("div",ee(j.theme,"date"),T.a.createElement(Fe,Object.assign({type_name:"date"},j)),T.a.createElement("span",Object.assign({className:"date-value"},ee(j.theme,"date-value")),j.value.toLocaleTimeString("en-us",{weekday:"short",year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})))}}]),A}(T.a.PureComponent),pe=function(U){S(A,U);var H=M(A);function A(){return $(this,A),H.apply(this,arguments)}return w(A,[{key:"render",value:function(){var j=this.props;return T.a.createElement("div",ee(j.theme,"float"),T.a.createElement(Fe,Object.assign({type_name:"float"},j)),this.props.value)}}]),A}(T.a.PureComponent);function Te(U,H){(H==null||H>U.length)&&(H=U.length);for(var A=0,j=new Array(H);A<H;A++)j[A]=U[A];return j}function ke(U,H){if(U){if(typeof U=="string")return Te(U,H);var A=Object.prototype.toString.call(U).slice(8,-1);return A==="Object"&&U.constructor&&(A=U.constructor.name),A==="Map"||A==="Set"?Array.from(U):A==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(A)?Te(U,H):void 0}}function Xe(U,H){var A;if(typeof Symbol>"u"||U[Symbol.iterator]==null){if(Array.isArray(U)||(A=ke(U))||H){A&&(U=A);var j=0,z=function(){};return{s:z,n:function(){return j>=U.length?{done:!0}:{done:!1,value:U[j++]}},e:function(le){throw le},f:z}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var de,ye=!0,$e=!1;return{s:function(){A=U[Symbol.iterator]()},n:function(){var le=A.next();return ye=le.done,le},e:function(le){$e=!0,de=le},f:function(){try{ye||A.return==null||A.return()}finally{if($e)throw de}}}}function Ke(U){return function(H){if(Array.isArray(H))return Te(H)}(U)||function(H){if(typeof Symbol<"u"&&Symbol.iterator in Object(H))return Array.from(H)}(U)||ke(U)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}var at=c(46),Ue=new(c(47)).Dispatcher,ut=new(function(U){S(A,U);var H=M(A);function A(){var j;$(this,A);for(var z=arguments.length,de=new Array(z),ye=0;ye<z;ye++)de[ye]=arguments[ye];return(j=H.call.apply(H,[this].concat(de))).objects={},j.set=function($e,le,Be,Qe){j.objects[$e]===void 0&&(j.objects[$e]={}),j.objects[$e][le]===void 0&&(j.objects[$e][le]={}),j.objects[$e][le][Be]=Qe},j.get=function($e,le,Be,Qe){return j.objects[$e]===void 0||j.objects[$e][le]===void 0||j.objects[$e][le][Be]==null?Qe:j.objects[$e][le][Be]},j.handleAction=function($e){var le=$e.rjvId,Be=$e.data;switch($e.name){case"RESET":j.emit("reset-"+le);break;case"VARIABLE_UPDATED":$e.data.updated_src=j.updateSrc(le,Be),j.set(le,"action","variable-update",b(b({},Be),{},{type:"variable-edited"})),j.emit("variable-update-"+le);break;case"VARIABLE_REMOVED":$e.data.updated_src=j.updateSrc(le,Be),j.set(le,"action","variable-update",b(b({},Be),{},{type:"variable-removed"})),j.emit("variable-update-"+le);break;case"VARIABLE_ADDED":$e.data.updated_src=j.updateSrc(le,Be),j.set(le,"action","variable-update",b(b({},Be),{},{type:"variable-added"})),j.emit("variable-update-"+le);break;case"ADD_VARIABLE_KEY_REQUEST":j.set(le,"action","new-key-request",Be),j.emit("add-key-request-"+le)}},j.updateSrc=function($e,le){var Be=le.name,Qe=le.namespace,xt=le.new_value,jt=(le.existing_value,le.variable_removed);Qe.shift();var tn,Ct=j.get($e,"global","src"),nn=j.deepCopy(Ct,Ke(Qe)),bn=nn,mt=Xe(Qe);try{for(mt.s();!(tn=mt.n()).done;)bn=bn[tn.value]}catch(kn){mt.e(kn)}finally{mt.f()}return jt?ne(bn)=="array"?bn.splice(Be,1):delete bn[Be]:Be!==null?bn[Be]=xt:nn=xt,j.set($e,"global","src",nn),nn},j.deepCopy=function($e,le){var Be,Qe=ne($e),xt=le.shift();return Qe=="array"?Be=Ke($e):Qe=="object"&&(Be=b({},$e)),xt!==void 0&&(Be[xt]=j.deepCopy($e[xt],le)),Be},j}return A}(at.EventEmitter));Ue.register(ut.handleAction.bind(ut));var rt=ut,tt=function(U){S(A,U);var H=M(A);function A(j){var z;return $(this,A),(z=H.call(this,j)).toggleCollapsed=function(){z.setState({collapsed:!z.state.collapsed},function(){rt.set(z.props.rjvId,z.props.namespace,"collapsed",z.state.collapsed)})},z.getFunctionDisplay=function(de){var ye=R(z).props;return de?T.a.createElement("span",null,z.props.value.toString().slice(9,-1).replace(/\{[\s\S]+/,""),T.a.createElement("span",{className:"function-collapsed",style:{fontWeight:"bold"}},T.a.createElement("span",null,"{"),T.a.createElement("span",ee(ye.theme,"ellipsis"),"..."),T.a.createElement("span",null,"}"))):z.props.value.toString().slice(9,-1)},z.state={collapsed:rt.get(j.rjvId,j.namespace,"collapsed",!0)},z}return w(A,[{key:"render",value:function(){var j=this.props,z=this.state.collapsed;return T.a.createElement("div",ee(j.theme,"function"),T.a.createElement(Fe,Object.assign({type_name:"function"},j)),T.a.createElement("span",Object.assign({},ee(j.theme,"function-value"),{className:"rjv-function-container",onClick:this.toggleCollapsed}),this.getFunctionDisplay(z)))}}]),A}(T.a.PureComponent),It=function(U){S(A,U);var H=M(A);function A(){return $(this,A),H.apply(this,arguments)}return w(A,[{key:"render",value:function(){return T.a.createElement("div",ee(this.props.theme,"nan"),"NaN")}}]),A}(T.a.PureComponent),Yt=function(U){S(A,U);var H=M(A);function A(){return $(this,A),H.apply(this,arguments)}return w(A,[{key:"render",value:function(){return T.a.createElement("div",ee(this.props.theme,"null"),"NULL")}}]),A}(T.a.PureComponent),Ut=function(U){S(A,U);var H=M(A);function A(){return $(this,A),H.apply(this,arguments)}return w(A,[{key:"render",value:function(){var j=this.props;return T.a.createElement("div",ee(j.theme,"integer"),T.a.createElement(Fe,Object.assign({type_name:"int"},j)),this.props.value)}}]),A}(T.a.PureComponent),Fn=function(U){S(A,U);var H=M(A);function A(){return $(this,A),H.apply(this,arguments)}return w(A,[{key:"render",value:function(){var j=this.props;return T.a.createElement("div",ee(j.theme,"regexp"),T.a.createElement(Fe,Object.assign({type_name:"regexp"},j)),this.props.value.toString())}}]),A}(T.a.PureComponent),Xt=function(U){S(A,U);var H=M(A);function A(j){var z;return $(this,A),(z=H.call(this,j)).toggleCollapsed=function(){z.setState({collapsed:!z.state.collapsed},function(){rt.set(z.props.rjvId,z.props.namespace,"collapsed",z.state.collapsed)})},z.state={collapsed:rt.get(j.rjvId,j.namespace,"collapsed",!0)},z}return w(A,[{key:"render",value:function(){this.state.collapsed;var j=this.props,z=j.collapseStringsAfterLength,de=j.theme,ye=j.value,$e={style:{cursor:"default"}};return ne(z)==="integer"&&ye.length>z&&($e.style.cursor="pointer",this.state.collapsed&&(ye=T.a.createElement("span",null,ye.substring(0,z),T.a.createElement("span",ee(de,"ellipsis")," ...")))),T.a.createElement("div",ee(de,"string"),T.a.createElement(Fe,Object.assign({type_name:"string"},j)),T.a.createElement("span",Object.assign({className:"string-value"},$e,{onClick:this.toggleCollapsed}),'"',ye,'"'))}}]),A}(T.a.PureComponent),en=function(U){S(A,U);var H=M(A);function A(){return $(this,A),H.apply(this,arguments)}return w(A,[{key:"render",value:function(){return T.a.createElement("div",ee(this.props.theme,"undefined"),"undefined")}}]),A}(T.a.PureComponent);function Ot(){return(Ot=Object.assign||function(U){for(var H=1;H<arguments.length;H++){var A=arguments[H];for(var j in A)Object.prototype.hasOwnProperty.call(A,j)&&(U[j]=A[j])}return U}).apply(this,arguments)}var Lt=L.useLayoutEffect,vn=function(U){var H=Object(L.useRef)(U);return Lt(function(){H.current=U}),H},Ln=function(U,H){typeof U!="function"?U.current=H:U(H)},He=function(U,H){var A=Object(L.useRef)();return Object(L.useCallback)(function(j){U.current=j,A.current&&Ln(A.current,null),A.current=H,H&&Ln(H,j)},[H])},Ft={"min-height":"0","max-height":"none",height:"0",visibility:"hidden",overflow:"hidden",position:"absolute","z-index":"-1000",top:"0",right:"0"},St=function(U){Object.keys(Ft).forEach(function(H){U.style.setProperty(H,Ft[H],"important")})},Tn=null,os=function(){},Ee=["borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopWidth","boxSizing","fontFamily","fontSize","fontStyle","fontWeight","letterSpacing","lineHeight","paddingBottom","paddingLeft","paddingRight","paddingTop","tabSize","textIndent","textRendering","textTransform","width"],fe=!!document.documentElement.currentStyle,ue=function(U,H){var A=U.cacheMeasurements,j=U.maxRows,z=U.minRows,de=U.onChange,ye=de===void 0?os:de,$e=U.onHeightChange,le=$e===void 0?os:$e,Be=function(mt,kn){if(mt==null)return{};var ls,Qs,da={},Ar=Object.keys(mt);for(Qs=0;Qs<Ar.length;Qs++)ls=Ar[Qs],kn.indexOf(ls)>=0||(da[ls]=mt[ls]);return da}(U,["cacheMeasurements","maxRows","minRows","onChange","onHeightChange"]),Qe,xt=Be.value!==void 0,jt=Object(L.useRef)(null),tn=He(jt,H),Ct=Object(L.useRef)(0),nn=Object(L.useRef)(),bn=function(){var mt=jt.current,kn=A&&nn.current?nn.current:function(Ar){var To=window.getComputedStyle(Ar);if(To===null)return null;var xs,qt=(xs=To,Ee.reduce(function(Fi,cs){return Fi[cs]=xs[cs],Fi},{})),er=qt.boxSizing;return er===""?null:(fe&&er==="border-box"&&(qt.width=parseFloat(qt.width)+parseFloat(qt.borderRightWidth)+parseFloat(qt.borderLeftWidth)+parseFloat(qt.paddingRight)+parseFloat(qt.paddingLeft)+"px"),{sizingStyle:qt,paddingSize:parseFloat(qt.paddingBottom)+parseFloat(qt.paddingTop),borderSize:parseFloat(qt.borderBottomWidth)+parseFloat(qt.borderTopWidth)})}(mt);if(kn){nn.current=kn;var ls=function(Ar,To,xs,qt){xs===void 0&&(xs=1),qt===void 0&&(qt=1/0),Tn||((Tn=document.createElement("textarea")).setAttribute("tab-index","-1"),Tn.setAttribute("aria-hidden","true"),St(Tn)),Tn.parentNode===null&&document.body.appendChild(Tn);var er=Ar.paddingSize,Fi=Ar.borderSize,cs=Ar.sizingStyle,js=cs.boxSizing;Object.keys(cs).forEach(function(Io){var mi=Io;Tn.style[mi]=cs[mi]}),St(Tn),Tn.value=To;var Eo=function(Io,mi){var zi=Io.scrollHeight;return mi.sizingStyle.boxSizing==="border-box"?zi+mi.borderSize:zi-mi.paddingSize}(Tn,Ar);Tn.value="x";var ha=Tn.scrollHeight-er,ji=ha*xs;js==="border-box"&&(ji=ji+er+Fi),Eo=Math.max(ji,Eo);var ko=ha*qt;return js==="border-box"&&(ko=ko+er+Fi),[Eo=Math.min(ko,Eo),ha]}(kn,mt.value||mt.placeholder||"x",z,j),Qs=ls[0],da=ls[1];Ct.current!==Qs&&(Ct.current=Qs,mt.style.setProperty("height",Qs+"px","important"),le(Qs,{rowHeight:da}))}};return Object(L.useLayoutEffect)(bn),Qe=vn(bn),Object(L.useLayoutEffect)(function(){var mt=function(kn){Qe.current(kn)};return window.addEventListener("resize",mt),function(){window.removeEventListener("resize",mt)}},[]),Object(L.createElement)("textarea",Ot({},Be,{onChange:function(mt){xt||bn(),ye(mt)},ref:tn}))},we=Object(L.forwardRef)(ue);function je(U){U=U.trim();try{if((U=JSON.stringify(JSON.parse(U)))[0]==="[")return ie("array",JSON.parse(U));if(U[0]==="{")return ie("object",JSON.parse(U));if(U.match(/\-?\d+\.\d+/)&&U.match(/\-?\d+\.\d+/)[0]===U)return ie("float",parseFloat(U));if(U.match(/\-?\d+e-\d+/)&&U.match(/\-?\d+e-\d+/)[0]===U)return ie("float",Number(U));if(U.match(/\-?\d+/)&&U.match(/\-?\d+/)[0]===U)return ie("integer",parseInt(U));if(U.match(/\-?\d+e\+\d+/)&&U.match(/\-?\d+e\+\d+/)[0]===U)return ie("integer",Number(U))}catch{}switch(U=U.toLowerCase()){case"undefined":return ie("undefined",void 0);case"nan":return ie("nan",NaN);case"null":return ie("null",null);case"true":return ie("boolean",!0);case"false":return ie("boolean",!1);default:if(U=Date.parse(U))return ie("date",new Date(U))}return ie(!1,null)}function ie(U,H){return{type:U,value:H}}var Pe=function(U){S(A,U);var H=M(A);function A(){return $(this,A),H.apply(this,arguments)}return w(A,[{key:"render",value:function(){var j=this.props,z=j.style,de=J(j,["style"]);return T.a.createElement("span",de,T.a.createElement("svg",Object.assign({},Bt(z),{viewBox:"0 0 24 24",fill:"currentColor",preserveAspectRatio:"xMidYMid meet"}),T.a.createElement("path",{d:"M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M7,13H17V11H7"})))}}]),A}(T.a.PureComponent),vt=function(U){S(A,U);var H=M(A);function A(){return $(this,A),H.apply(this,arguments)}return w(A,[{key:"render",value:function(){var j=this.props,z=j.style,de=J(j,["style"]);return T.a.createElement("span",de,T.a.createElement("svg",Object.assign({},Bt(z),{viewBox:"0 0 24 24",fill:"currentColor",preserveAspectRatio:"xMidYMid meet"}),T.a.createElement("path",{d:"M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M13,7H11V11H7V13H11V17H13V13H17V11H13V7Z"})))}}]),A}(T.a.PureComponent),it=function(U){S(A,U);var H=M(A);function A(){return $(this,A),H.apply(this,arguments)}return w(A,[{key:"render",value:function(){var j=this.props,z=j.style,de=J(j,["style"]),ye=Bt(z).style;return T.a.createElement("span",de,T.a.createElement("svg",{fill:ye.color,width:ye.height,height:ye.width,style:ye,viewBox:"0 0 1792 1792"},T.a.createElement("path",{d:"M1344 800v64q0 14-9 23t-23 9h-832q-14 0-23-9t-9-23v-64q0-14 9-23t23-9h832q14 0 23 9t9 23zm128 448v-832q0-66-47-113t-113-47h-832q-66 0-113 47t-47 113v832q0 66 47 113t113 47h832q66 0 113-47t47-113zm128-832v832q0 119-84.5 203.5t-203.5 84.5h-832q-119 0-203.5-84.5t-84.5-203.5v-832q0-119 84.5-203.5t203.5-84.5h832q119 0 203.5 84.5t84.5 203.5z"})))}}]),A}(T.a.PureComponent),En=function(U){S(A,U);var H=M(A);function A(){return $(this,A),H.apply(this,arguments)}return w(A,[{key:"render",value:function(){var j=this.props,z=j.style,de=J(j,["style"]),ye=Bt(z).style;return T.a.createElement("span",de,T.a.createElement("svg",{fill:ye.color,width:ye.height,height:ye.width,style:ye,viewBox:"0 0 1792 1792"},T.a.createElement("path",{d:"M1344 800v64q0 14-9 23t-23 9h-352v352q0 14-9 23t-23 9h-64q-14 0-23-9t-9-23v-352h-352q-14 0-23-9t-9-23v-64q0-14 9-23t23-9h352v-352q0-14 9-23t23-9h64q14 0 23 9t9 23v352h352q14 0 23 9t9 23zm128 448v-832q0-66-47-113t-113-47h-832q-66 0-113 47t-47 113v832q0 66 47 113t113 47h832q66 0 113-47t47-113zm128-832v832q0 119-84.5 203.5t-203.5 84.5h-832q-119 0-203.5-84.5t-84.5-203.5v-832q0-119 84.5-203.5t203.5-84.5h832q119 0 203.5 84.5t84.5 203.5z"})))}}]),A}(T.a.PureComponent),lt=function(U){S(A,U);var H=M(A);function A(){return $(this,A),H.apply(this,arguments)}return w(A,[{key:"render",value:function(){var j=this.props,z=j.style,de=J(j,["style"]);return T.a.createElement("span",de,T.a.createElement("svg",{style:b(b({},Bt(z).style),{},{paddingLeft:"2px",verticalAlign:"top"}),viewBox:"0 0 15 15",fill:"currentColor"},T.a.createElement("path",{d:"M0 14l6-6-6-6z"})))}}]),A}(T.a.PureComponent),yn=function(U){S(A,U);var H=M(A);function A(){return $(this,A),H.apply(this,arguments)}return w(A,[{key:"render",value:function(){var j=this.props,z=j.style,de=J(j,["style"]);return T.a.createElement("span",de,T.a.createElement("svg",{style:b(b({},Bt(z).style),{},{paddingLeft:"2px",verticalAlign:"top"}),viewBox:"0 0 15 15",fill:"currentColor"},T.a.createElement("path",{d:"M0 5l6 6 6-6z"})))}}]),A}(T.a.PureComponent),gn=function(U){S(A,U);var H=M(A);function A(){return $(this,A),H.apply(this,arguments)}return w(A,[{key:"render",value:function(){var j=this.props,z=j.style,de=J(j,["style"]);return T.a.createElement("span",de,T.a.createElement("svg",Object.assign({},Bt(z),{viewBox:"0 0 40 40",fill:"currentColor",preserveAspectRatio:"xMidYMid meet"}),T.a.createElement("g",null,T.a.createElement("path",{d:"m30 35h-25v-22.5h25v7.5h2.5v-12.5c0-1.4-1.1-2.5-2.5-2.5h-7.5c0-2.8-2.2-5-5-5s-5 2.2-5 5h-7.5c-1.4 0-2.5 1.1-2.5 2.5v27.5c0 1.4 1.1 2.5 2.5 2.5h25c1.4 0 2.5-1.1 2.5-2.5v-5h-2.5v5z m-20-27.5h2.5s2.5-1.1 2.5-2.5 1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5 1.3 2.5 2.5 2.5h2.5s2.5 1.1 2.5 2.5h-20c0-1.5 1.1-2.5 2.5-2.5z m-2.5 20h5v-2.5h-5v2.5z m17.5-5v-5l-10 7.5 10 7.5v-5h12.5v-5h-12.5z m-17.5 10h7.5v-2.5h-7.5v2.5z m12.5-17.5h-12.5v2.5h12.5v-2.5z m-7.5 5h-5v2.5h5v-2.5z"}))))}}]),A}(T.a.PureComponent),Wn=function(U){S(A,U);var H=M(A);function A(){return $(this,A),H.apply(this,arguments)}return w(A,[{key:"render",value:function(){var j=this.props,z=j.style,de=J(j,["style"]);return T.a.createElement("span",de,T.a.createElement("svg",Object.assign({},Bt(z),{viewBox:"0 0 40 40",fill:"currentColor",preserveAspectRatio:"xMidYMid meet"}),T.a.createElement("g",null,T.a.createElement("path",{d:"m28.6 25q0-0.5-0.4-1l-4-4 4-4q0.4-0.5 0.4-1 0-0.6-0.4-1.1l-2-2q-0.4-0.4-1-0.4-0.6 0-1 0.4l-4.1 4.1-4-4.1q-0.4-0.4-1-0.4-0.6 0-1 0.4l-2 2q-0.5 0.5-0.5 1.1 0 0.5 0.5 1l4 4-4 4q-0.5 0.5-0.5 1 0 0.7 0.5 1.1l2 2q0.4 0.4 1 0.4 0.6 0 1-0.4l4-4.1 4.1 4.1q0.4 0.4 1 0.4 0.6 0 1-0.4l2-2q0.4-0.4 0.4-1z m8.7-5q0 4.7-2.3 8.6t-6.3 6.2-8.6 2.3-8.6-2.3-6.2-6.2-2.3-8.6 2.3-8.6 6.2-6.2 8.6-2.3 8.6 2.3 6.3 6.2 2.3 8.6z"}))))}}]),A}(T.a.PureComponent),Xn=function(U){S(A,U);var H=M(A);function A(){return $(this,A),H.apply(this,arguments)}return w(A,[{key:"render",value:function(){var j=this.props,z=j.style,de=J(j,["style"]);return T.a.createElement("span",de,T.a.createElement("svg",Object.assign({},Bt(z),{viewBox:"0 0 40 40",fill:"currentColor",preserveAspectRatio:"xMidYMid meet"}),T.a.createElement("g",null,T.a.createElement("path",{d:"m30.1 21.4v-2.8q0-0.6-0.4-1t-1-0.5h-5.7v-5.7q0-0.6-0.4-1t-1-0.4h-2.9q-0.6 0-1 0.4t-0.4 1v5.7h-5.7q-0.6 0-1 0.5t-0.5 1v2.8q0 0.6 0.5 1t1 0.5h5.7v5.7q0 0.5 0.4 1t1 0.4h2.9q0.6 0 1-0.4t0.4-1v-5.7h5.7q0.6 0 1-0.5t0.4-1z m7.2-1.4q0 4.7-2.3 8.6t-6.3 6.2-8.6 2.3-8.6-2.3-6.2-6.2-2.3-8.6 2.3-8.6 6.2-6.2 8.6-2.3 8.6 2.3 6.3 6.2 2.3 8.6z"}))))}}]),A}(T.a.PureComponent),Xs=function(U){S(A,U);var H=M(A);function A(){return $(this,A),H.apply(this,arguments)}return w(A,[{key:"render",value:function(){var j=this.props,z=j.style,de=J(j,["style"]);return T.a.createElement("span",de,T.a.createElement("svg",Object.assign({},Bt(z),{viewBox:"0 0 40 40",fill:"currentColor",preserveAspectRatio:"xMidYMid meet"}),T.a.createElement("g",null,T.a.createElement("path",{d:"m31.6 21.6h-10v10h-3.2v-10h-10v-3.2h10v-10h3.2v10h10v3.2z"}))))}}]),A}(T.a.PureComponent),as=function(U){S(A,U);var H=M(A);function A(){return $(this,A),H.apply(this,arguments)}return w(A,[{key:"render",value:function(){var j=this.props,z=j.style,de=J(j,["style"]);return T.a.createElement("span",de,T.a.createElement("svg",Object.assign({},Bt(z),{viewBox:"0 0 40 40",fill:"currentColor",preserveAspectRatio:"xMidYMid meet"}),T.a.createElement("g",null,T.a.createElement("path",{d:"m19.8 26.4l2.6-2.6-3.4-3.4-2.6 2.6v1.3h2.2v2.1h1.2z m9.8-16q-0.3-0.4-0.7 0l-7.8 7.8q-0.4 0.4 0 0.7t0.7 0l7.8-7.8q0.4-0.4 0-0.7z m1.8 13.2v4.3q0 2.6-1.9 4.5t-4.5 1.9h-18.6q-2.6 0-4.5-1.9t-1.9-4.5v-18.6q0-2.7 1.9-4.6t4.5-1.8h18.6q1.4 0 2.6 0.5 0.3 0.2 0.4 0.5 0.1 0.4-0.2 0.7l-1.1 1.1q-0.3 0.3-0.7 0.1-0.5-0.1-1-0.1h-18.6q-1.4 0-2.5 1.1t-1 2.5v18.6q0 1.4 1 2.5t2.5 1h18.6q1.5 0 2.5-1t1.1-2.5v-2.9q0-0.2 0.2-0.4l1.4-1.5q0.3-0.3 0.8-0.1t0.4 0.6z m-2.1-16.5l6.4 6.5-15 15h-6.4v-6.5z m9.9 3l-2.1 2-6.4-6.4 2.1-2q0.6-0.7 1.5-0.7t1.5 0.7l3.4 3.4q0.6 0.6 0.6 1.5t-0.6 1.5z"}))))}}]),A}(T.a.PureComponent),An=function(U){S(A,U);var H=M(A);function A(){return $(this,A),H.apply(this,arguments)}return w(A,[{key:"render",value:function(){var j=this.props,z=j.style,de=J(j,["style"]);return T.a.createElement("span",de,T.a.createElement("svg",Object.assign({},Bt(z),{viewBox:"0 0 40 40",fill:"currentColor",preserveAspectRatio:"xMidYMid meet"}),T.a.createElement("g",null,T.a.createElement("path",{d:"m31.7 16.4q0-0.6-0.4-1l-2.1-2.1q-0.4-0.4-1-0.4t-1 0.4l-9.1 9.1-5-5q-0.5-0.4-1-0.4t-1 0.4l-2.1 2q-0.4 0.4-0.4 1 0 0.6 0.4 1l8.1 8.1q0.4 0.4 1 0.4 0.6 0 1-0.4l12.2-12.1q0.4-0.4 0.4-1z m5.6 3.6q0 4.7-2.3 8.6t-6.3 6.2-8.6 2.3-8.6-2.3-6.2-6.2-2.3-8.6 2.3-8.6 6.2-6.2 8.6-2.3 8.6 2.3 6.3 6.2 2.3 8.6z"}))))}}]),A}(T.a.PureComponent);function Bt(U){return U||(U={}),{style:b(b({verticalAlign:"middle"},U),{},{color:U.color?U.color:"#000000",height:"1em",width:"1em"})}}var jn=function(U){S(A,U);var H=M(A);function A(j){var z;return $(this,A),(z=H.call(this,j)).copiedTimer=null,z.handleCopy=function(){var de=document.createElement("textarea"),ye=z.props,$e=ye.clickCallback,le=ye.src,Be=ye.namespace;de.innerHTML=JSON.stringify(z.clipboardValue(le),null,"  "),document.body.appendChild(de),de.select(),document.execCommand("copy"),document.body.removeChild(de),z.copiedTimer=setTimeout(function(){z.setState({copied:!1})},5500),z.setState({copied:!0},function(){typeof $e=="function"&&$e({src:le,namespace:Be,name:Be[Be.length-1]})})},z.getClippyIcon=function(){var de=z.props.theme;return z.state.copied?T.a.createElement("span",null,T.a.createElement(gn,Object.assign({className:"copy-icon"},ee(de,"copy-icon"))),T.a.createElement("span",ee(de,"copy-icon-copied"),"✔")):T.a.createElement(gn,Object.assign({className:"copy-icon"},ee(de,"copy-icon")))},z.clipboardValue=function(de){switch(ne(de)){case"function":case"regexp":return de.toString();default:return de}},z.state={copied:!1},z}return w(A,[{key:"componentWillUnmount",value:function(){this.copiedTimer&&(clearTimeout(this.copiedTimer),this.copiedTimer=null)}},{key:"render",value:function(){var j=this.props,z=(j.src,j.theme),de=j.hidden,ye=j.rowHovered,$e=ee(z,"copy-to-clipboard").style,le="inline";return de&&(le="none"),T.a.createElement("span",{className:"copy-to-clipboard-container",title:"Copy to clipboard",style:{verticalAlign:"top",display:ye?"inline-block":"none"}},T.a.createElement("span",{style:b(b({},$e),{},{display:le}),onClick:this.handleCopy},this.getClippyIcon()))}}]),A}(T.a.PureComponent),gs=function(U){S(A,U);var H=M(A);function A(j){var z;return $(this,A),(z=H.call(this,j)).getEditIcon=function(){var de=z.props,ye=de.variable,$e=de.theme;return T.a.createElement("div",{className:"click-to-edit",style:{verticalAlign:"top",display:z.state.hovered?"inline-block":"none"}},T.a.createElement(as,Object.assign({className:"click-to-edit-icon"},ee($e,"editVarIcon"),{onClick:function(){z.prepopInput(ye)}})))},z.prepopInput=function(de){if(z.props.onEdit!==!1){var ye=function(le){var Be;switch(ne(le)){case"undefined":Be="undefined";break;case"nan":Be="NaN";break;case"string":Be=le;break;case"date":case"function":case"regexp":Be=le.toString();break;default:try{Be=JSON.stringify(le,null,"  ")}catch{Be=""}}return Be}(de.value),$e=je(ye);z.setState({editMode:!0,editValue:ye,parsedInput:{type:$e.type,value:$e.value}})}},z.getRemoveIcon=function(){var de=z.props,ye=de.variable,$e=de.namespace,le=de.theme,Be=de.rjvId;return T.a.createElement("div",{className:"click-to-remove",style:{verticalAlign:"top",display:z.state.hovered?"inline-block":"none"}},T.a.createElement(Wn,Object.assign({className:"click-to-remove-icon"},ee(le,"removeVarIcon"),{onClick:function(){Ue.dispatch({name:"VARIABLE_REMOVED",rjvId:Be,data:{name:ye.name,namespace:$e,existing_value:ye.value,variable_removed:!0}})}})))},z.getValue=function(de,ye){var $e=!ye&&de.type,le=R(z).props;switch($e){case!1:return z.getEditInput();case"string":return T.a.createElement(Xt,Object.assign({value:de.value},le));case"integer":return T.a.createElement(Ut,Object.assign({value:de.value},le));case"float":return T.a.createElement(pe,Object.assign({value:de.value},le));case"boolean":return T.a.createElement(Ce,Object.assign({value:de.value},le));case"function":return T.a.createElement(tt,Object.assign({value:de.value},le));case"null":return T.a.createElement(Yt,le);case"nan":return T.a.createElement(It,le);case"undefined":return T.a.createElement(en,le);case"date":return T.a.createElement(Ze,Object.assign({value:de.value},le));case"regexp":return T.a.createElement(Fn,Object.assign({value:de.value},le));default:return T.a.createElement("div",{className:"object-value"},JSON.stringify(de.value))}},z.getEditInput=function(){var de=z.props.theme,ye=z.state.editValue;return T.a.createElement("div",null,T.a.createElement(we,Object.assign({type:"text",inputRef:function($e){return $e&&$e.focus()},value:ye,className:"variable-editor",onChange:function($e){var le=$e.target.value,Be=je(le);z.setState({editValue:le,parsedInput:{type:Be.type,value:Be.value}})},onKeyDown:function($e){switch($e.key){case"Escape":z.setState({editMode:!1,editValue:""});break;case"Enter":($e.ctrlKey||$e.metaKey)&&z.submitEdit(!0)}$e.stopPropagation()},placeholder:"update this value",minRows:2},ee(de,"edit-input"))),T.a.createElement("div",ee(de,"edit-icon-container"),T.a.createElement(Wn,Object.assign({className:"edit-cancel"},ee(de,"cancel-icon"),{onClick:function(){z.setState({editMode:!1,editValue:""})}})),T.a.createElement(An,Object.assign({className:"edit-check string-value"},ee(de,"check-icon"),{onClick:function(){z.submitEdit()}})),T.a.createElement("div",null,z.showDetected())))},z.submitEdit=function(de){var ye=z.props,$e=ye.variable,le=ye.namespace,Be=ye.rjvId,Qe=z.state,xt=Qe.editValue,jt=Qe.parsedInput,tn=xt;de&&jt.type&&(tn=jt.value),z.setState({editMode:!1}),Ue.dispatch({name:"VARIABLE_UPDATED",rjvId:Be,data:{name:$e.name,namespace:le,existing_value:$e.value,new_value:tn,variable_removed:!1}})},z.showDetected=function(){var de=z.props,ye=de.theme,$e=(de.variable,de.namespace,de.rjvId,z.state.parsedInput),le=($e.type,$e.value,z.getDetectedInput());if(le)return T.a.createElement("div",null,T.a.createElement("div",ee(ye,"detected-row"),le,T.a.createElement(An,{className:"edit-check detected",style:b({verticalAlign:"top",paddingLeft:"3px"},ee(ye,"check-icon").style),onClick:function(){z.submitEdit(!0)}})))},z.getDetectedInput=function(){var de=z.state.parsedInput,ye=de.type,$e=de.value,le=R(z).props,Be=le.theme;if(ye!==!1)switch(ye.toLowerCase()){case"object":return T.a.createElement("span",null,T.a.createElement("span",{style:b(b({},ee(Be,"brace").style),{},{cursor:"default"})},"{"),T.a.createElement("span",{style:b(b({},ee(Be,"ellipsis").style),{},{cursor:"default"})},"..."),T.a.createElement("span",{style:b(b({},ee(Be,"brace").style),{},{cursor:"default"})},"}"));case"array":return T.a.createElement("span",null,T.a.createElement("span",{style:b(b({},ee(Be,"brace").style),{},{cursor:"default"})},"["),T.a.createElement("span",{style:b(b({},ee(Be,"ellipsis").style),{},{cursor:"default"})},"..."),T.a.createElement("span",{style:b(b({},ee(Be,"brace").style),{},{cursor:"default"})},"]"));case"string":return T.a.createElement(Xt,Object.assign({value:$e},le));case"integer":return T.a.createElement(Ut,Object.assign({value:$e},le));case"float":return T.a.createElement(pe,Object.assign({value:$e},le));case"boolean":return T.a.createElement(Ce,Object.assign({value:$e},le));case"function":return T.a.createElement(tt,Object.assign({value:$e},le));case"null":return T.a.createElement(Yt,le);case"nan":return T.a.createElement(It,le);case"undefined":return T.a.createElement(en,le);case"date":return T.a.createElement(Ze,Object.assign({value:new Date($e)},le))}},z.state={editMode:!1,editValue:"",hovered:!1,renameKey:!1,parsedInput:{type:!1,value:null}},z}return w(A,[{key:"render",value:function(){var j=this,z=this.props,de=z.variable,ye=z.singleIndent,$e=z.type,le=z.theme,Be=z.namespace,Qe=z.indentWidth,xt=z.enableClipboard,jt=z.onEdit,tn=z.onDelete,Ct=z.onSelect,nn=z.displayArrayKey,bn=z.quotesOnKeys,mt=this.state.editMode;return T.a.createElement("div",Object.assign({},ee(le,"objectKeyVal",{paddingLeft:Qe*ye}),{onMouseEnter:function(){return j.setState(b(b({},j.state),{},{hovered:!0}))},onMouseLeave:function(){return j.setState(b(b({},j.state),{},{hovered:!1}))},className:"variable-row",key:de.name}),$e=="array"?nn?T.a.createElement("span",Object.assign({},ee(le,"array-key"),{key:de.name+"_"+Be}),de.name,T.a.createElement("div",ee(le,"colon"),":")):null:T.a.createElement("span",null,T.a.createElement("span",Object.assign({},ee(le,"object-name"),{className:"object-key",key:de.name+"_"+Be}),!!bn&&T.a.createElement("span",{style:{verticalAlign:"top"}},'"'),T.a.createElement("span",{style:{display:"inline-block"}},de.name),!!bn&&T.a.createElement("span",{style:{verticalAlign:"top"}},'"')),T.a.createElement("span",ee(le,"colon"),":")),T.a.createElement("div",Object.assign({className:"variable-value",onClick:Ct===!1&&jt===!1?null:function(kn){var ls=Ke(Be);(kn.ctrlKey||kn.metaKey)&&jt!==!1?j.prepopInput(de):Ct!==!1&&(ls.shift(),Ct(b(b({},de),{},{namespace:ls})))}},ee(le,"variableValue",{cursor:Ct===!1?"default":"pointer"})),this.getValue(de,mt)),xt?T.a.createElement(jn,{rowHovered:this.state.hovered,hidden:mt,src:de.value,clickCallback:xt,theme:le,namespace:[].concat(Ke(Be),[de.name])}):null,jt!==!1&&mt==0?this.getEditIcon():null,tn!==!1&&mt==0?this.getRemoveIcon():null)}}]),A}(T.a.PureComponent),Zs=function(U){S(A,U);var H=M(A);function A(){var j;$(this,A);for(var z=arguments.length,de=new Array(z),ye=0;ye<z;ye++)de[ye]=arguments[ye];return(j=H.call.apply(H,[this].concat(de))).getObjectSize=function(){var $e=j.props,le=$e.size,Be=$e.theme;if($e.displayObjectSize)return T.a.createElement("span",Object.assign({className:"object-size"},ee(Be,"object-size")),le," item",le===1?"":"s")},j.getAddAttribute=function($e){var le=j.props,Be=le.theme,Qe=le.namespace,xt=le.name,jt=le.src,tn=le.rjvId,Ct=le.depth;return T.a.createElement("span",{className:"click-to-add",style:{verticalAlign:"top",display:$e?"inline-block":"none"}},T.a.createElement(Xn,Object.assign({className:"click-to-add-icon"},ee(Be,"addVarIcon"),{onClick:function(){var nn={name:Ct>0?xt:null,namespace:Qe.splice(0,Qe.length-1),existing_value:jt,variable_removed:!1,key_name:null};ne(jt)==="object"?Ue.dispatch({name:"ADD_VARIABLE_KEY_REQUEST",rjvId:tn,data:nn}):Ue.dispatch({name:"VARIABLE_ADDED",rjvId:tn,data:b(b({},nn),{},{new_value:[].concat(Ke(jt),[null])})})}})))},j.getRemoveObject=function($e){var le=j.props,Be=le.theme,Qe=(le.hover,le.namespace),xt=le.name,jt=le.src,tn=le.rjvId;if(Qe.length!==1)return T.a.createElement("span",{className:"click-to-remove",style:{display:$e?"inline-block":"none"}},T.a.createElement(Wn,Object.assign({className:"click-to-remove-icon"},ee(Be,"removeVarIcon"),{onClick:function(){Ue.dispatch({name:"VARIABLE_REMOVED",rjvId:tn,data:{name:xt,namespace:Qe.splice(0,Qe.length-1),existing_value:jt,variable_removed:!0}})}})))},j.render=function(){var $e=j.props,le=$e.theme,Be=$e.onDelete,Qe=$e.onAdd,xt=$e.enableClipboard,jt=$e.src,tn=$e.namespace,Ct=$e.rowHovered;return T.a.createElement("div",Object.assign({},ee(le,"object-meta-data"),{className:"object-meta-data",onClick:function(nn){nn.stopPropagation()}}),j.getObjectSize(),xt?T.a.createElement(jn,{rowHovered:Ct,clickCallback:xt,src:jt,theme:le,namespace:tn}):null,Qe!==!1?j.getAddAttribute(Ct):null,Be!==!1?j.getRemoveObject(Ct):null)},j}return A}(T.a.PureComponent);function zn(U){var H=U.parent_type,A=U.namespace,j=U.quotesOnKeys,z=U.theme,de=U.jsvRoot,ye=U.name,$e=U.displayArrayKey,le=U.name?U.name:"";return!de||ye!==!1&&ye!==null?H=="array"?$e?T.a.createElement("span",Object.assign({},ee(z,"array-key"),{key:A}),T.a.createElement("span",{className:"array-key"},le),T.a.createElement("span",ee(z,"colon"),":")):T.a.createElement("span",null):T.a.createElement("span",Object.assign({},ee(z,"object-name"),{key:A}),T.a.createElement("span",{className:"object-key"},j&&T.a.createElement("span",{style:{verticalAlign:"top"}},'"'),T.a.createElement("span",null,le),j&&T.a.createElement("span",{style:{verticalAlign:"top"}},'"')),T.a.createElement("span",ee(z,"colon"),":")):T.a.createElement("span",null)}function Vn(U){var H=U.theme;switch(U.iconStyle){case"triangle":return T.a.createElement(yn,Object.assign({},ee(H,"expanded-icon"),{className:"expanded-icon"}));case"square":return T.a.createElement(it,Object.assign({},ee(H,"expanded-icon"),{className:"expanded-icon"}));default:return T.a.createElement(Pe,Object.assign({},ee(H,"expanded-icon"),{className:"expanded-icon"}))}}function Fs(U){var H=U.theme;switch(U.iconStyle){case"triangle":return T.a.createElement(lt,Object.assign({},ee(H,"collapsed-icon"),{className:"collapsed-icon"}));case"square":return T.a.createElement(En,Object.assign({},ee(H,"collapsed-icon"),{className:"collapsed-icon"}));default:return T.a.createElement(vt,Object.assign({},ee(H,"collapsed-icon"),{className:"collapsed-icon"}))}}var fi=function(U){S(A,U);var H=M(A);function A(j){var z;return $(this,A),(z=H.call(this,j)).toggleCollapsed=function(de){var ye=[];for(var $e in z.state.expanded)ye.push(z.state.expanded[$e]);ye[de]=!ye[de],z.setState({expanded:ye})},z.state={expanded:[]},z}return w(A,[{key:"getExpandedIcon",value:function(j){var z=this.props,de=z.theme,ye=z.iconStyle;return this.state.expanded[j]?T.a.createElement(Vn,{theme:de,iconStyle:ye}):T.a.createElement(Fs,{theme:de,iconStyle:ye})}},{key:"render",value:function(){var j=this,z=this.props,de=z.src,ye=z.groupArraysAfterLength,$e=(z.depth,z.name),le=z.theme,Be=z.jsvRoot,Qe=z.namespace,xt=(z.parent_type,J(z,["src","groupArraysAfterLength","depth","name","theme","jsvRoot","namespace","parent_type"])),jt=0,tn=5*this.props.indentWidth;Be||(jt=5*this.props.indentWidth);var Ct=ye,nn=Math.ceil(de.length/Ct);return T.a.createElement("div",Object.assign({className:"object-key-val"},ee(le,Be?"jsv-root":"objectKeyVal",{paddingLeft:jt})),T.a.createElement(zn,this.props),T.a.createElement("span",null,T.a.createElement(Zs,Object.assign({size:de.length},this.props))),Ke(Array(nn)).map(function(bn,mt){return T.a.createElement("div",Object.assign({key:mt,className:"object-key-val array-group"},ee(le,"objectKeyVal",{marginLeft:6,paddingLeft:tn})),T.a.createElement("span",ee(le,"brace-row"),T.a.createElement("div",Object.assign({className:"icon-container"},ee(le,"icon-container"),{onClick:function(kn){j.toggleCollapsed(mt)}}),j.getExpandedIcon(mt)),j.state.expanded[mt]?T.a.createElement(Rr,Object.assign({key:$e+mt,depth:0,name:!1,collapsed:!1,groupArraysAfterLength:Ct,index_offset:mt*Ct,src:de.slice(mt*Ct,mt*Ct+Ct),namespace:Qe,type:"array",parent_type:"array_group",theme:le},xt)):T.a.createElement("span",Object.assign({},ee(le,"brace"),{onClick:function(kn){j.toggleCollapsed(mt)},className:"array-group-brace"}),"[",T.a.createElement("div",Object.assign({},ee(le,"array-group-meta-data"),{className:"array-group-meta-data"}),T.a.createElement("span",Object.assign({className:"object-size"},ee(le,"object-size")),mt*Ct," - ",mt*Ct+Ct>de.length?de.length:mt*Ct+Ct)),"]")))}))}}]),A}(T.a.PureComponent),Or=function(U){S(A,U);var H=M(A);function A(j){var z;$(this,A),(z=H.call(this,j)).toggleCollapsed=function(){z.setState({expanded:!z.state.expanded},function(){rt.set(z.props.rjvId,z.props.namespace,"expanded",z.state.expanded)})},z.getObjectContent=function(ye,$e,le){return T.a.createElement("div",{className:"pushed-content object-container"},T.a.createElement("div",Object.assign({className:"object-content"},ee(z.props.theme,"pushed-content")),z.renderObjectContents($e,le)))},z.getEllipsis=function(){return z.state.size===0?null:T.a.createElement("div",Object.assign({},ee(z.props.theme,"ellipsis"),{className:"node-ellipsis",onClick:z.toggleCollapsed}),"...")},z.getObjectMetaData=function(ye){var $e=z.props,le=($e.rjvId,$e.theme,z.state),Be=le.size,Qe=le.hovered;return T.a.createElement(Zs,Object.assign({rowHovered:Qe,size:Be},z.props))},z.renderObjectContents=function(ye,$e){var le,Be=z.props,Qe=Be.depth,xt=Be.parent_type,jt=Be.index_offset,tn=Be.groupArraysAfterLength,Ct=Be.namespace,nn=z.state.object_type,bn=[],mt=Object.keys(ye||{});return z.props.sortKeys&&nn!=="array"&&(mt=mt.sort()),mt.forEach(function(kn){if(le=new mc(kn,ye[kn]),xt==="array_group"&&jt&&(le.name=parseInt(le.name)+jt),ye.hasOwnProperty(kn))if(le.type==="object")bn.push(T.a.createElement(Rr,Object.assign({key:le.name,depth:Qe+1,name:le.name,src:le.value,namespace:Ct.concat(le.name),parent_type:nn},$e)));else if(le.type==="array"){var ls=Rr;tn&&le.value.length>tn&&(ls=fi),bn.push(T.a.createElement(ls,Object.assign({key:le.name,depth:Qe+1,name:le.name,src:le.value,namespace:Ct.concat(le.name),type:"array",parent_type:nn},$e)))}else bn.push(T.a.createElement(gs,Object.assign({key:le.name+"_"+Ct,variable:le,singleIndent:5,namespace:Ct,type:z.props.type},$e)))}),bn};var de=A.getState(j);return z.state=b(b({},de),{},{prevProps:{}}),z}return w(A,[{key:"getBraceStart",value:function(j,z){var de=this,ye=this.props,$e=ye.src,le=ye.theme,Be=ye.iconStyle;if(ye.parent_type==="array_group")return T.a.createElement("span",null,T.a.createElement("span",ee(le,"brace"),j==="array"?"[":"{"),z?this.getObjectMetaData($e):null);var Qe=z?Vn:Fs;return T.a.createElement("span",null,T.a.createElement("span",Object.assign({onClick:function(xt){de.toggleCollapsed()}},ee(le,"brace-row")),T.a.createElement("div",Object.assign({className:"icon-container"},ee(le,"icon-container")),T.a.createElement(Qe,{theme:le,iconStyle:Be})),T.a.createElement(zn,this.props),T.a.createElement("span",ee(le,"brace"),j==="array"?"[":"{")),z?this.getObjectMetaData($e):null)}},{key:"render",value:function(){var j=this,z=this.props,de=z.depth,ye=z.src,$e=(z.namespace,z.name,z.type,z.parent_type),le=z.theme,Be=z.jsvRoot,Qe=z.iconStyle,xt=J(z,["depth","src","namespace","name","type","parent_type","theme","jsvRoot","iconStyle"]),jt=this.state,tn=jt.object_type,Ct=jt.expanded,nn={};return Be||$e==="array_group"?$e==="array_group"&&(nn.borderLeft=0,nn.display="inline"):nn.paddingLeft=5*this.props.indentWidth,T.a.createElement("div",Object.assign({className:"object-key-val",onMouseEnter:function(){return j.setState(b(b({},j.state),{},{hovered:!0}))},onMouseLeave:function(){return j.setState(b(b({},j.state),{},{hovered:!1}))}},ee(le,Be?"jsv-root":"objectKeyVal",nn)),this.getBraceStart(tn,Ct),Ct?this.getObjectContent(de,ye,b({theme:le,iconStyle:Qe},xt)):this.getEllipsis(),T.a.createElement("span",{className:"brace-row"},T.a.createElement("span",{style:b(b({},ee(le,"brace").style),{},{paddingLeft:Ct?"3px":"0px"})},tn==="array"?"]":"}"),Ct?null:this.getObjectMetaData(ye)))}}],[{key:"getDerivedStateFromProps",value:function(j,z){var de=z.prevProps;return j.src!==de.src||j.collapsed!==de.collapsed||j.name!==de.name||j.namespace!==de.namespace||j.rjvId!==de.rjvId?b(b({},A.getState(j)),{},{prevProps:j}):null}}]),A}(T.a.PureComponent);Or.getState=function(U){var H=Object.keys(U.src).length,A=(U.collapsed===!1||U.collapsed!==!0&&U.collapsed>U.depth)&&(!U.shouldCollapse||U.shouldCollapse({name:U.name,src:U.src,type:ne(U.src),namespace:U.namespace})===!1)&&H!==0;return{expanded:rt.get(U.rjvId,U.namespace,"expanded",A),object_type:U.type==="array"?"array":"object",parent_type:U.type==="array"?"array":"object",size:H,hovered:!1}};var mc=function U(H,A){$(this,U),this.name=H,this.value=A,this.type=ne(A)};te(Or);var Rr=Or,al=function(U){S(A,U);var H=M(A);function A(){var j;$(this,A);for(var z=arguments.length,de=new Array(z),ye=0;ye<z;ye++)de[ye]=arguments[ye];return(j=H.call.apply(H,[this].concat(de))).render=function(){var $e=R(j).props,le=[$e.name],Be=Rr;return Array.isArray($e.src)&&$e.groupArraysAfterLength&&$e.src.length>$e.groupArraysAfterLength&&(Be=fi),T.a.createElement("div",{className:"pretty-json-container object-container"},T.a.createElement("div",{className:"object-content"},T.a.createElement(Be,Object.assign({namespace:le,depth:0,jsvRoot:!0},$e))))},j}return A}(T.a.PureComponent),bc=function(U){S(A,U);var H=M(A);function A(j){var z;return $(this,A),(z=H.call(this,j)).closeModal=function(){Ue.dispatch({rjvId:z.props.rjvId,name:"RESET"})},z.submit=function(){z.props.submit(z.state.input)},z.state={input:j.input?j.input:""},z}return w(A,[{key:"render",value:function(){var j=this,z=this.props,de=z.theme,ye=z.rjvId,$e=z.isValid,le=this.state.input,Be=$e(le);return T.a.createElement("div",Object.assign({className:"key-modal-request"},ee(de,"key-modal-request"),{onClick:this.closeModal}),T.a.createElement("div",Object.assign({},ee(de,"key-modal"),{onClick:function(Qe){Qe.stopPropagation()}}),T.a.createElement("div",ee(de,"key-modal-label"),"Key Name:"),T.a.createElement("div",{style:{position:"relative"}},T.a.createElement("input",Object.assign({},ee(de,"key-modal-input"),{className:"key-modal-input",ref:function(Qe){return Qe&&Qe.focus()},spellCheck:!1,value:le,placeholder:"...",onChange:function(Qe){j.setState({input:Qe.target.value})},onKeyPress:function(Qe){Be&&Qe.key==="Enter"?j.submit():Qe.key==="Escape"&&j.closeModal()}})),Be?T.a.createElement(An,Object.assign({},ee(de,"key-modal-submit"),{className:"key-modal-submit",onClick:function(Qe){return j.submit()}})):null),T.a.createElement("span",ee(de,"key-modal-cancel"),T.a.createElement(Xs,Object.assign({},ee(de,"key-modal-cancel-icon"),{className:"key-modal-cancel",onClick:function(){Ue.dispatch({rjvId:ye,name:"RESET"})}})))))}}]),A}(T.a.PureComponent),$c=function(U){S(A,U);var H=M(A);function A(){var j;$(this,A);for(var z=arguments.length,de=new Array(z),ye=0;ye<z;ye++)de[ye]=arguments[ye];return(j=H.call.apply(H,[this].concat(de))).isValid=function($e){var le=j.props.rjvId,Be=rt.get(le,"action","new-key-request");return $e!=""&&Object.keys(Be.existing_value).indexOf($e)===-1},j.submit=function($e){var le=j.props.rjvId,Be=rt.get(le,"action","new-key-request");Be.new_value=b({},Be.existing_value),Be.new_value[$e]=j.props.defaultValue,Ue.dispatch({name:"VARIABLE_ADDED",rjvId:le,data:Be})},j}return w(A,[{key:"render",value:function(){var j=this.props,z=j.active,de=j.theme,ye=j.rjvId;return z?T.a.createElement(bc,{rjvId:ye,theme:de,isValid:this.isValid,submit:this.submit}):null}}]),A}(T.a.PureComponent),Uu=function(U){S(A,U);var H=M(A);function A(){return $(this,A),H.apply(this,arguments)}return w(A,[{key:"render",value:function(){var j=this.props,z=j.message,de=j.active,ye=j.theme,$e=j.rjvId;return de?T.a.createElement("div",Object.assign({className:"validation-failure"},ee(ye,"validation-failure"),{onClick:function(){Ue.dispatch({rjvId:$e,name:"RESET"})}}),T.a.createElement("span",ee(ye,"validation-failure-label"),z),T.a.createElement(Xs,ee(ye,"validation-failure-clear"))):null}}]),A}(T.a.PureComponent),ua=function(U){S(A,U);var H=M(A);function A(j){var z;return $(this,A),(z=H.call(this,j)).rjvId=Date.now().toString(),z.getListeners=function(){return{reset:z.resetState,"variable-update":z.updateSrc,"add-key-request":z.addKeyRequest}},z.updateSrc=function(){var de,ye=rt.get(z.rjvId,"action","variable-update"),$e=ye.name,le=ye.namespace,Be=ye.new_value,Qe=ye.existing_value,xt=(ye.variable_removed,ye.updated_src),jt=ye.type,tn=z.props,Ct=tn.onEdit,nn=tn.onDelete,bn=tn.onAdd,mt={existing_src:z.state.src,new_value:Be,updated_src:xt,name:$e,namespace:le,existing_value:Qe};switch(jt){case"variable-added":de=bn(mt);break;case"variable-edited":de=Ct(mt);break;case"variable-removed":de=nn(mt)}de!==!1?(rt.set(z.rjvId,"global","src",xt),z.setState({src:xt})):z.setState({validationFailure:!0})},z.addKeyRequest=function(){z.setState({addKeyRequest:!0})},z.resetState=function(){z.setState({validationFailure:!1,addKeyRequest:!1})},z.state={addKeyRequest:!1,editKeyRequest:!1,validationFailure:!1,src:A.defaultProps.src,name:A.defaultProps.name,theme:A.defaultProps.theme,validationMessage:A.defaultProps.validationMessage,prevSrc:A.defaultProps.src,prevName:A.defaultProps.name,prevTheme:A.defaultProps.theme},z}return w(A,[{key:"componentDidMount",value:function(){rt.set(this.rjvId,"global","src",this.state.src);var j=this.getListeners();for(var z in j)rt.on(z+"-"+this.rjvId,j[z]);this.setState({addKeyRequest:!1,editKeyRequest:!1})}},{key:"componentDidUpdate",value:function(j,z){z.addKeyRequest!==!1&&this.setState({addKeyRequest:!1}),z.editKeyRequest!==!1&&this.setState({editKeyRequest:!1}),j.src!==this.state.src&&rt.set(this.rjvId,"global","src",this.state.src)}},{key:"componentWillUnmount",value:function(){var j=this.getListeners();for(var z in j)rt.removeListener(z+"-"+this.rjvId,j[z])}},{key:"render",value:function(){var j=this.state,z=j.validationFailure,de=j.validationMessage,ye=j.addKeyRequest,$e=j.theme,le=j.src,Be=j.name,Qe=this.props,xt=Qe.style,jt=Qe.defaultValue;return T.a.createElement("div",{className:"react-json-view",style:b(b({},ee($e,"app-container").style),xt)},T.a.createElement(Uu,{message:de,active:z,theme:$e,rjvId:this.rjvId}),T.a.createElement(al,Object.assign({},this.props,{src:le,name:Be,theme:$e,type:ne(le),rjvId:this.rjvId})),T.a.createElement($c,{active:ye,theme:$e,rjvId:this.rjvId,defaultValue:jt}))}}],[{key:"getDerivedStateFromProps",value:function(j,z){if(j.src!==z.prevSrc||j.name!==z.prevName||j.theme!==z.prevTheme){var de={src:j.src,name:j.name,theme:j.theme,validationMessage:j.validationMessage,prevSrc:j.src,prevName:j.name,prevTheme:j.theme};return A.validateState(de)}return null}}]),A}(T.a.PureComponent);ua.defaultProps={src:{},name:"root",theme:"rjv-default",collapsed:!1,collapseStringsAfterLength:!1,shouldCollapse:!1,sortKeys:!1,quotesOnKeys:!0,groupArraysAfterLength:100,indentWidth:4,enableClipboard:!0,displayObjectSize:!0,displayDataTypes:!0,onEdit:!1,onDelete:!1,onAdd:!1,onSelect:!1,iconStyle:"triangle",style:{},validationMessage:"Validation Error",defaultValue:null,displayArrayKey:!0},ua.validateState=function(U){var H={};return ne(U.theme)!=="object"||function(A){var j=["base00","base01","base02","base03","base04","base05","base06","base07","base08","base09","base0A","base0B","base0C","base0D","base0E","base0F"];if(ne(A)==="object"){for(var z=0;z<j.length;z++)if(!(j[z]in A))return!1;return!0}return!1}(U.theme)||(console.error("react-json-view error:","theme prop must be a theme name or valid base-16 theme object.",'defaulting to "rjv-default" theme'),H.theme="rjv-default"),ne(U.src)!=="object"&&ne(U.src)!=="array"&&(console.error("react-json-view error:","src property must be a valid json object"),H.name="ERROR",H.src={message:"src property must be a valid json object"}),b(b({},U),H)},te(ua),a.default=ua}])})})(Gk);var PP=Gk.exports;const FP=aa(PP),pn={frameRoot:{paddingTop:0,paddingBottom:0},frameTextRoot:{m:0},frameTextPrimary:o=>({color:o.palette.mode==="dark"?"#CCC":"#333"}),frameTextSecondary:{fontStyle:"italic",fontSize:12,opacity:.6,pl:1},listRoot:{padding:0,fontSize:"small"},scopeType:{verticalAlign:"top",textTransform:"uppercase",width:50},scopeType_local:{color:"#53a944"},scopeType_closure:{color:"#365b80"},scopeType_user:{color:"#a48a15"},scopeName:{color:"#bc5b5b",width:"calc(100% - 82px)",whiteSpace:"nowrap",textOverflow:"ellipsis"},scopeButton:{width:32},scopeValueEditable:{cursor:"pointer"},selectedFrame:{backgroundColor:"#777",color:"white"},splitter:{width:"100%",height:"calc(100% - 36px)",overflow:"hidden",fontSize:12},toolbarScopes:o=>({width:24,display:"inline-block",height:"100%",background:o.palette.mode==="dark"?"#222":"#EEE",verticalAlign:"top"}),scopesAfterToolbar:{width:"calc(100% - 24px)",display:"inline-block",height:"100%",verticalAlign:"top"},scopeNameName:{fontWeight:"bold",display:"inline-block",verticalAlign:"top"},scopeNameEqual:o=>({display:"inline-block",color:o.palette.mode==="dark"?"#EEE":"#222",verticalAlign:"top"}),scopeNameValue:{verticalAlign:"top",display:"inline-block",color:"#3b709f",whiteSpace:"nowrap"},scopeButtonDel:{padding:0,float:"right"},valueNull:{color:"#a44a24"},valueUndefined:{color:"#a44a24"},valueString:{color:"#1e8816"},valueNumber:{color:"#163c88"},valueBoolean:{color:"#a44a24"},valueObject:{color:"#721b70"},valueNone:{color:"#8a8a8a"},valueFunc:{color:"#ac4343"},error:o=>({color:o.palette.mode==="dark"?"#FF8080":"#FF0000",fontStyle:"italic"})};function jP(o){var s,i;const n={};return o.className==="ReferenceError"?o.description:((i=(s=o.preview)==null?void 0:s.properties)==null||i.forEach(a=>{(a==null?void 0:a.type)==="object"?a.subtype==="null"?n[a.name]=null:n[a.name]=`{ ${a.value==="Object"?"...":a.value} }`:a.type==="boolean"?n[a.name||a.description]=a.value==="true":a.type==="number"?n[a.name||a.description]=parseFloat(a.value):a.type==="function"?n[a.name||a.description]="function(){}":a.type==="undefined"?n[a.name||a.description]=void 0:n[a.name||a.description]=a.value}),n)}let zP=class extends Le.Component{editRef;scopeValue=null;constructor(n){super(n);const s=window.localStorage.getItem("JS.framesSizes");let i=[30,70];if(s)try{i=JSON.parse(s)}catch{}this.state={editValue:null,callFrames:this.props.callFrames,framesSizes:i},this.editRef=Le.createRef()}onExpressionNameUpdate(){this.state.editValue&&this.props.onExpressionNameUpdate(this.state.editValue.index,this.scopeValue,()=>{this.setState({editValue:null}),this.scopeValue=null})}renderExpression(n,s){const i=this.state.editValue&&this.state.editValue.type==="expression"&&this.state.editValue.index===s?f.jsx(D.Input,{inputRef:this.editRef,fullWidth:!0,margin:"dense",onBlur:()=>this.state.editValue&&this.setState({editValue:null}),defaultValue:n.name,onKeyUp:a=>{a.key==="Enter"?this.onExpressionNameUpdate():a.key==="Escape"&&this.setState({editValue:null})},onChange:a=>this.scopeValue=a.target.value,endAdornment:f.jsx(D.InputAdornment,{position:"end",children:f.jsx(D.IconButton,{onClick:()=>this.onExpressionNameUpdate(),size:"medium",children:f.jsx(X_,{})})})}):[f.jsx("div",{style:pn.scopeNameName,title:I.I18n.t("Double click to edit expression"),children:n.name},"name"),f.jsxs(D.Box,{sx:pn.scopeNameEqual,children:[" ","="," "]},"="),f.jsx("div",{style:pn.scopeNameValue,children:this.formatValue(n.value)},"val")];return f.jsxs("tr",{children:[f.jsx("td",{style:{...pn.scopeType,...pn.scopeType_user},children:"user"}),f.jsx("td",{style:pn.scopeName,onDoubleClick:()=>{this.scopeValue=n.name||"",this.setState({editValue:{type:"expression",valueType:"string",index:s,name:n.name,value:n.name||""}})},children:i}),f.jsx(D.IconButton,{style:pn.scopeButtonDel,size:"small",disabled:!!this.state.editValue,onClick:()=>this.props.onExpressionDelete(s),children:f.jsx(cv,{})})]},`user_${s}${n.name}`)}renderExpressions(){return this.props.expressions.map((n,s)=>this.renderExpression(n,s))}renderOneFrameTitle(n,s){if(this.props.mainScriptId===this.props.currentScriptId&&n.location.scriptId!==this.props.mainScriptId)return null;const i=(n.url.split("/").pop()||"").replace(/^script\.js\./,"");return f.jsx(D.ListItemButton,{onClick:()=>this.props.onChangeCurrentFrame(s),dense:!0,selected:this.props.currentFrame===s,style:pn.frameRoot,children:f.jsx(D.ListItemText,{sx:{...pn.frameTextRoot,"& .MuiListItemText-primary":pn.frameTextPrimary,"& .MuiListItemText-secondary":pn.frameTextSecondary},title:n.url,primary:n.functionName||"anonymous",secondary:`${i} (${n.location.lineNumber}:${n.location.columnNumber})`})},n.callFrameId)}formatValue(n,s){if(!n)return s?"none":f.jsx("span",{style:pn.valueNone,children:"none"});if(n.type==="undefined")return s?"undefined":f.jsx("span",{style:pn.valueUndefined,children:"undefined"});if(n.type==="null")return s?"null":f.jsx("span",{style:pn.valueNull,children:"null"});if(n.type==="function"){const i=n.description?n.description.length>100?`${n.description.substring(0,100)}...`:n.description:"function";return s?i:f.jsx("span",{style:pn.valueFunc,title:n.description,children:i})}if(n.type==="object"){const i=jP(n);return s?JSON.stringify(i):typeof i=="string"?f.jsx(D.Box,{component:"span",sx:pn.error,children:i}):f.jsx(FP,{name:!1,enableClipboard:!1,style:{backgroundColor:"inherit",marginTop:3},src:i,collapsed:!0,theme:this.props.themeType==="dark"?"brewer":"rjv-default",displayDataTypes:!1})}if(n.value===void 0)return s?"undefined":f.jsx("span",{style:pn.valueUndefined,children:"undefined"});if(n.value===null)return s?"null":f.jsx("span",{style:pn.valueNull,children:"null"});if(n.type==="string"){if(s)return n.value;const i=`"${n.value?n.value.length>100?`${n.value.substring(0,100)}...`:n.value:""}"`;return f.jsx("span",{style:pn.valueString,title:i,children:i})}return n.type==="boolean"?s?n.value.toString():f.jsx("span",{style:pn.valueBoolean,children:n.value.toString()}):n.value.toString()}onWriteScopeValue(){var n,s;this.scopeValue==="true"?this.scopeValue=!0:this.scopeValue==="false"?this.scopeValue=!1:this.scopeValue==="null"?this.scopeValue=null:this.scopeValue==="undefined"?this.scopeValue=void 0:parseFloat(this.scopeValue).toString()===this.scopeValue&&(this.scopeValue=parseFloat(this.scopeValue)),this.props.onWriteScopeValue({variableName:((n=this.state.editValue)==null?void 0:n.name)||"",scopeNumber:0,newValue:{value:this.scopeValue,valueType:typeof this.scopeValue},callFrameId:(s=this.props.callFrames)==null?void 0:s[this.props.currentFrame].callFrameId}),this.setState({editValue:null}),this.scopeValue=null}componentDidUpdate(){var n;(n=this.editRef.current)==null||n.focus()}renderScope(n,s,i){var h,g,b,$;const a=!this.props.currentFrame&&s.value&&(s.value.type==="undefined"||s.value.type==="string"||s.value.type==="number"||s.value.type==="boolean"||((h=s.value)==null?void 0:h.value)===null||((g=s.value)==null?void 0:g.value)===void 0&&s.value.type!=="object"),c=((b=this.state.editValue)==null?void 0:b.type)===i&&(($=this.state.editValue)==null?void 0:$.name)===s.name?[f.jsx("div",{style:pn.scopeNameName,children:s.name},"name"),f.jsxs(D.Box,{sx:pn.scopeNameEqual,children:[" ","="," "]},"="),f.jsx(D.Input,{inputRef:this.editRef,margin:"dense",onBlur:()=>this.state.editValue&&this.setState({editValue:null}),defaultValue:this.formatValue(s.value,!0),onKeyUp:y=>{y.key==="Enter"?this.onWriteScopeValue():y.key==="Escape"&&this.setState({editValue:null})},onChange:y=>this.scopeValue=y.target.value,endAdornment:f.jsx(D.InputAdornment,{position:"end",children:f.jsx(D.IconButton,{onClick:()=>this.onWriteScopeValue(),size:"medium",children:f.jsx(X_,{})})})},"input")]:[f.jsx("div",{style:pn.scopeNameName,title:I.I18n.t("Double click to write value"),children:s.name},"name"),f.jsxs(D.Box,{sx:pn.scopeNameEqual,children:[" ","="," "]},"="),f.jsxs("div",{style:pn.scopeNameValue,children:[this.formatValue(s.value)," (",s.value.type,")"]},"val")];return f.jsxs("tr",{children:[f.jsx("td",{style:{...pn.scopeType,...pn[`scopeType_${i}`]},children:i}),f.jsx("td",{style:{...pn.scopeName,...!this.props.currentFrame&&a?pn.scopeValueEditable:void 0},onDoubleClick:()=>{a&&(this.scopeValue=s.value.value,this.setState({editValue:{scopeId:n,type:i,index:0,valueType:s.value.type,name:s.name,value:s.value.value}}))},children:c})]},`${i}_${n}_${s.name}`)}renderScopes(n){var a,c,h,g,b,$;if(!n)return null;const s=this.renderExpressions();let i=(h=(c=(a=this.props.scopes)==null?void 0:a.local)==null?void 0:c.properties)==null?void 0:h.result.map(y=>this.props.scopes&&this.renderScope("",y,"local"));return i==null||i.forEach(y=>y&&s.push(y)),i=($=(b=(g=this.props.scopes)==null?void 0:g.closure)==null?void 0:b.properties)==null?void 0:$.result.map(y=>this.props.scopes&&this.renderScope("",y,"closure")),i==null||i.forEach(y=>y&&s.push(y)),f.jsx("table",{style:{width:"100%",fontSize:"small"},children:f.jsx("tbody",{children:s})})}render(){var n,s;return f.jsxs(Tv,{direction:Pn.Horizontal,initialSizes:this.state.framesSizes,minWidths:[100,200],onResizeFinished:(i,a)=>{this.setState({framesSizes:a}),window.localStorage.setItem("JS.framesSizes",JSON.stringify(a))},gutterClassName:this.props.themeType==="dark"?"Dark visGutter":"Light visGutter",children:[f.jsx("div",{style:{width:"100%",height:"100%",overflow:"auto"},children:f.jsx(D.List,{style:pn.listRoot,children:((n=this.props.callFrames)==null?void 0:n.map((i,a)=>this.renderOneFrameTitle(i,a)))||null})}),f.jsxs("div",{style:{width:"100%",height:"100%",overflow:"auto"},children:[f.jsx(D.Box,{sx:pn.toolbarScopes,children:f.jsx(D.IconButton,{size:"small",onClick:()=>this.props.onExpressionAdd((i,a)=>{this.scopeValue=a.name||"",this.setState({editValue:{type:"expression",valueType:"string",index:i,name:a.name,value:a.name||""}})}),children:f.jsx(cy,{})})}),f.jsx("div",{style:pn.scopesAfterToolbar,children:((s=this.props.callFrames)==null?void 0:s.length)&&this.renderScopes(this.props.callFrames[this.props.currentFrame])})]})]})}};const Ts={root:o=>({width:"100%",height:`calc(100% - ${parseInt(o.toolbar.height,10)+38+5}px)`,overflow:"hidden",position:"relative"}),toolbar:{minHeight:38,boxShadow:"0px 2px 4px -1px rgba(0, 0, 0, 0.2), 0px 4px 5px 0px rgba(0, 0, 0, 0.14), 0px 1px 10px 0px rgba(0, 0, 0, 0.12)"},buttonRun:{color:"green"},buttonPause:{color:"orange"},buttonRestart:{color:"darkgreen"},buttonStop:{color:"red"},buttonNext:{color:"blue"},buttonStep:{color:"blue"},buttonOut:{color:"blue"},buttonException:{},tabFile:o=>({textTransform:"inherit",color:o.palette.mode==="dark"?"#DDD":"inherit"}),tabText:{maxWidth:130,textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",display:"inline-block",verticalAlign:"middle"},closeButton:{position:"absolute",top:8,right:0,zIndex:10,padding:8,cursor:"pointer"},tabsRoot:o=>({minHeight:24,background:o.palette.mode==="dark"?"#333":"#e6e6e6",color:o.palette.mode==="dark"?"white":"inherit"}),tabRoot:{minHeight:24},bpListItem:{borderTop:"1px dashed #bfbfbf44"},monospace:{fontFamily:"Courier New, monospace",whiteSpace:"pre",fontSize:12},arrow:{color:"#fffa4f"},splitter:{height:"calc(100% - 52px)","& .layout-pane":{overflow:"hidden",height:"100%"}}};class ey extends Le.Component{console=null;scripts={};mainScriptId=null;constructor(n){super(n);const s=window.localStorage.getItem(`javascript.tools.bp.${this.props.src}`);let i;try{i=s?JSON.parse(s):[]}catch{i=[]}const a=window.localStorage.getItem(`javascript.tools.exps.${this.props.src}`);let c;try{c=(a?JSON.parse(a):[]).map($=>({name:$,value:{type:"undefined",description:"",value:"undefined",name:"name"}}))}catch{c=[]}const h=window.localStorage.getItem("JS.toolSizes");let g=[80,20];if(h)try{g=JSON.parse(h)}catch{}this.state={starting:!0,selected:null,tabs:{},script:"",breakpoints:i,expressions:c,running:!1,error:"",started:!1,paused:!0,location:null,toolsTab:window.localStorage.getItem("javascript.tools.tab")||"console",stopOnException:window.localStorage.getItem("javascript.tools.stopOnException")==="true",console:[],finished:!1,currentFrame:0,scopes:{},queryBreakpoints:null,logErrors:0,logWarnings:0,logs:0,toolSizes:g,instance:void 0,context:null}}async componentDidMount(){var s,i;let n;if(this.props.debugInstance)n=this.props.debugInstance.instance;else{const a=await this.props.socket.getObject(this.props.src);n=((i=(s=a==null?void 0:a.common)==null?void 0:s.engine)==null?void 0:i.replace("system.adapter.",""))||""}this.setState({instance:n},()=>{this.state.instance?(this.props.socket.setState(`${this.state.instance}.debug.from`,{val:'{"cmd": "subscribed"}',ack:!0}),setTimeout(()=>this.props.socket.subscribeState(`${this.state.instance}.debug.from`,this.fromInstance),200)):this.setState({error:"Unknown instance"})})}componentWillUnmount(){this.state.instance&&(this.props.socket.unsubscribeState(`${this.state.instance}.debug.from`,this.fromInstance),this.props.socket.sendTo(this.state.instance,"debugStop"))}sendToInstance(n){this.props.socket.setState(`${this.state.instance}.debug.to`,{val:JSON.stringify(n),ack:!1})}reinitBreakpoints(n){if(this.state.breakpoints.length){const i=JSON.parse(JSON.stringify(this.state.breakpoints)).map(a=>a.location);this.setState({breakpoints:[]},()=>{this.sendToInstance({breakpoints:i,cmd:"sb"}),this.state.stopOnException&&this.sendToInstance({cmd:"stopOnException",state:!0}),n&&n()})}else this.state.stopOnException&&this.sendToInstance({cmd:"stopOnException",state:!0}),n&&n()}static getLocation(n){return n.callFrames?n.callFrames[0].location:null}readCurrentScope(){var s;const n=((s=this.state.context)==null?void 0:s.callFrames)&&this.state.context.callFrames[this.state.currentFrame];if(n){const i=n.scopeChain.filter(a=>a.type!=="global");i.length?this.sendToInstance({cmd:"scope",scopes:i}):(this.state.scopes.global||this.state.scopes.local||this.state.scopes.closure)&&this.setState({scopes:{}})}}readExpressions(n){var s;this.state.expressions.length&&((s=this.state.context)!=null&&s.callFrames)&&this.state.context.callFrames[this.state.currentFrame]&&(n!==void 0?this.sendToInstance({cmd:"expressions",expressions:[this.state.expressions[n]],callFrameId:this.state.context.callFrames[this.state.currentFrame].callFrameId}):this.sendToInstance({cmd:"expressions",expressions:this.state.expressions,callFrameId:this.state.context.callFrames[this.state.currentFrame].callFrameId}))}fromInstance=(n,s)=>{var i,a,c,h,g,b,$,y,w,C;if(s!=null&&s.val&&this.state.instance!==void 0)try{const S=JSON.parse(s.val);if(S.cmd==="subscribed")this.props.socket.sendTo(this.state.instance,"debug",this.props.debugInstance||{scriptName:this.props.src});else if(S.cmd==="readyToDebug"){this.mainScriptId=S.scriptId,this.scripts[S.scriptId]=S.script,S.script.startsWith(`(async () => {debugger;
`)?this.scripts[S.scriptId]=`(async () => {
${S.script.substring(24)}`:S.script.startsWith("debugger;")&&(this.scripts[S.scriptId]=S.script.substring(9));const k=JSON.parse(JSON.stringify(this.state.tabs));k[S.scriptId]=this.props.debugInstance?S.url:this.props.src.replace("script.js.","");const E=`${Date.now()}.${Math.random()*1e4}`;(a=(i=S.context)==null?void 0:i.callFrames)==null||a.forEach((R,F)=>R.id=E+F),this.setState({starting:!1,finished:!1,selected:this.mainScriptId,script:this.scripts[S.scriptId],tabs:k,currentFrame:0,started:!0,paused:!0,location:ey.getLocation(S.context),context:S.context},()=>this.reinitBreakpoints(()=>{this.readCurrentScope(),this.readExpressions()}))}else if(S.cmd==="paused"){const k=`${Date.now()}.${Math.random()*1e4}`;(h=(c=S.context)==null?void 0:c.callFrames)==null||h.forEach((L,T)=>L.id=k+T);const E=ey.getLocation(S.context),R=JSON.parse(JSON.stringify(this.state.tabs)),F=S.context.callFrames[0].url.split("iobroker.javascript");E&&(R[E.scriptId]=(F[1]||F[0]).replace("script.js.",""));const M={tabs:R,paused:!0,location:E,currentFrame:0,context:S.context};M.script=!(E!=null&&E.scriptId)||this.scripts[E.scriptId]===void 0?I.I18n.t("loading..."):this.scripts[E.scriptId],M.selected=E==null?void 0:E.scriptId,this.setState(M,()=>{this.readCurrentScope(),this.readExpressions(),E!=null&&E.scriptId&&(this.scripts[E.scriptId]||this.sendToInstance({cmd:"source",scriptId:E.scriptId}))})}else if(S.cmd==="script")this.scripts[S.scriptId]=S.text,this.state.selected===S.scriptId&&this.setState({script:this.scripts[S.scriptId]});else if(S.cmd==="resumed")this.setState({paused:!1});else if(S.cmd==="log")if(this.state.toolsTab==="console"){this.console=null;const k=[...this.state.console];k.push({text:S.text,severity:S.severity,ts:S.ts}),this.setState({console:k})}else S.severity==="error"?this.setState({logErrors:this.state.logErrors+1}):S.severity==="warn"?this.setState({logWarnings:this.state.logWarnings+1}):this.setState({logs:this.state.logs+1}),this.console=this.console||[...this.state.console],this.console.push({text:S.text,severity:S.severity,ts:S.ts});else if(S.cmd==="error")this.setState({error:S.error});else if(S.cmd==="finished"||S.cmd==="debugStopped")this.setState({finished:!0,starting:!1,started:!0});else if(S.cmd==="sb"){const k=JSON.parse(JSON.stringify(this.state.breakpoints));let E=!1;S.breakpoints.filter(R=>R).forEach(R=>{k.find(M=>M.location.scriptId===R.location.scriptId&&M.location.lineNumber===R.location.lineNumber)||(E=!0,k.push(R))}),E&&window.localStorage.setItem(`javascript.tools.bp.${this.props.src}`,JSON.stringify(k)),E&&this.setState({breakpoints:k})}else if(S.cmd==="cb"){const k=JSON.parse(JSON.stringify(this.state.breakpoints));let E=!1;S.breakpoints.filter(R=>R!=null).forEach(R=>{const F=k.find(M=>M.id===R);if(F){const M=k.indexOf(F);k.splice(M,1),E=!0}}),E&&window.localStorage.setItem(`javascript.tools.bp.${this.props.src}`,JSON.stringify(k)),E&&this.setState({breakpoints:k})}else if(S.cmd==="scope"){const k=S.scopes.find(R=>R.type==="local")||void 0,E=S.scopes.find(R=>R.type==="closure")||void 0;console.log(JSON.stringify(E)),this.setState({scopes:{local:k,closure:E}})}else if(S.cmd==="setValue"){const k=JSON.parse(JSON.stringify(this.state.scopes));let E;S.scopeNumber===0?E=(b=(g=k==null?void 0:k.local)==null?void 0:g.properties)==null?void 0:b.result.find(R=>R.name===S.variableName):E=(y=($=k==null?void 0:k.closure)==null?void 0:$.properties)==null?void 0:y.result.find(R=>R.name===S.variableName),E&&(E.value.value=S.newValue.value,this.setState({scopes:k}))}else if(S.cmd==="expressions"){const k=JSON.parse(JSON.stringify(this.state.expressions));let E=!1;S.expressions.forEach(R=>{const F=k.find(M=>M.name===R.name);F&&(E=!0,F.value=R.result)}),E&&this.setState({expressions:k}),console.log(`expressions: ${JSON.stringify(S)}`)}else S.cmd==="getPossibleBreakpoints"?((w=S.breakpoints)==null?void 0:w.length)===1?this.sendToInstance({breakpoints:S.breakpoints,cmd:"sb"}):(C=S.breakpoints)!=null&&C.length?this.setState({queryBreakpoints:S.breakpoints}):window.alert("cannot set"):console.error(`Unknown command: ${JSON.stringify(S)}`)}catch{}};getTextAtLocation(n){let s=this.state.script.split(/\r\n|\n/)[n.lineNumber],i;return n.columnNumber!==void 0&&n.columnNumber>=10?(s=s.substring(n.columnNumber-10,n.columnNumber+20),i=`${"".padStart(10," ")}↑`):n.columnNumber!==void 0&&(s=s.substring(0,30-n.columnNumber),i=`${"".padStart(n.columnNumber," ")}↑`),[f.jsx("div",{style:Ts.monospace,children:s},"line"),f.jsx("div",{style:{...Ts.monospace,...Ts.arrow},children:i},"arrow")]}renderQueryBreakpoints(){return this.state.queryBreakpoints?f.jsxs(D.Dialog,{onClose:()=>this.setState({queryBreakpoints:null}),"aria-labelledby":"bp-dialog-title",open:!0,children:[f.jsx(D.DialogTitle,{id:"bp-dialog-title",children:I.I18n.t("Select breakpoint")}),f.jsx(D.List,{children:this.state.queryBreakpoints.map((n,s)=>f.jsx(D.ListItemButton,{style:Ts.bpListItem,dense:!0,onClick:()=>{this.sendToInstance({breakpoints:[n],cmd:"sb"}),this.setState({queryBreakpoints:null})},children:f.jsx(D.ListItemText,{primary:this.getTextAtLocation(n)})},s))})]}):null}renderError(){return this.state.error?f.jsx(Sm,{onClose:()=>this.setState({error:""}),text:this.state.error},"dialogError"):null}closeTab(n,s){s==null||s.stopPropagation();const i=JSON.parse(JSON.stringify(this.state.tabs));delete i[n];const a={tabs:i,script:this.mainScriptId?this.scripts[this.mainScriptId]:"...",selected:this.mainScriptId};this.state.location&&this.state.location.scriptId!==this.mainScriptId&&(a.location=null),this.setState(a)}renderTabs(){const n=!this.state.tabs||!this.state.started;return f.jsx(D.Tabs,{component:"div",indicatorColor:"primary",style:{position:"relative",width:"calc(100% - 300px)",display:"inline-block"},value:this.state.selected,onChange:(s,i)=>{this.scripts[i]?this.setState({selected:i,script:this.scripts[i]}):this.setState({selected:i,script:"loading..."},()=>this.sendToInstance({cmd:"source",scriptId:i}))},scrollButtons:"auto",children:Object.keys(this.state.tabs||[]).map(s=>{let i=s;const a=this.state.tabs[s]||"";this.state.tabs[s]&&(i=this.state.tabs[s].split("/").pop()||"");const c=[f.jsx("div",{style:Ts.tabText,children:i},"text"),s!==this.mainScriptId?f.jsx("span",{style:Ts.closeButton,children:f.jsx(Uh,{onClick:h=>this.closeTab(s,h),fontSize:"small"},"close")},"icon"):null];return f.jsx(D.Tab,{disabled:n,sx:Ts.tabFile,label:c,title:a,value:s},s)})})}onResume(){this.sendToInstance({cmd:"cont"})}onPause(){this.sendToInstance({cmd:"pause"})}onNext(){this.sendToInstance({cmd:"next"})}onStepIn(){this.sendToInstance({cmd:"step"})}onStepOut(){this.sendToInstance({cmd:"out"})}onRestart(){this.setState({started:!1,starting:!0},()=>this.state.instance!==void 0&&this.props.socket.sendTo(this.state.instance,"debug",this.props.debugInstance||{scriptName:this.props.src}))}onToggleException(){const n=!this.state.stopOnException;window.localStorage.setItem("javascript.tools.stopOnException",n?"true":"false"),this.setState({stopOnException:n},()=>this.sendToInstance({cmd:"stopOnException",state:n}))}renderToolbar(){const n=!this.state.started;return f.jsxs(D.Toolbar,{variant:"dense",style:Ts.toolbar,children:[f.jsx(D.IconButton,{style:Ts.buttonRestart,disabled:n,onClick:()=>this.onRestart(),title:I.I18n.t("Restart"),size:"medium",children:f.jsx(WT,{})}),!this.state.finished&&this.state.paused?f.jsx(D.IconButton,{style:Ts.buttonRun,disabled:n,onClick:()=>this.onResume(),title:I.I18n.t("Resume execution"),size:"medium",children:f.jsx(Iv,{})}):!this.state.finished&&f.jsx(D.IconButton,{disabled:n,style:Ts.buttonPause,onClick:()=>this.onPause(),title:I.I18n.t("Pause execution"),size:"medium",children:f.jsx(Xf,{})}),!this.state.finished&&f.jsx(D.IconButton,{style:Ts.buttonNext,disabled:n||!this.state.paused,onClick:()=>this.onNext(),title:I.I18n.t("Go to next line"),size:"medium",children:f.jsx(N1,{})}),!this.state.finished&&f.jsx(D.IconButton,{style:Ts.buttonStep,disabled:n||!this.state.paused,onClick:()=>this.onStepIn(),title:I.I18n.t("Step into function"),size:"medium",children:f.jsx(A1,{})}),!this.state.finished&&f.jsx(D.IconButton,{style:Ts.buttonOut,disabled:n||!this.state.paused,onClick:()=>this.onStepOut(),title:I.I18n.t("Step out from function"),size:"medium",children:f.jsx(M1,{})}),!this.state.finished&&f.jsx(D.IconButton,{style:Ts.buttonException,color:this.state.stopOnException?"primary":"default",disabled:n||!this.state.paused,onClick:()=>this.onToggleException(),title:I.I18n.t("Stop on exception"),size:"medium",children:f.jsx(C1,{})}),this.renderTabs()]},"toolbar1")}getPossibleBreakpoints(n){const s={...n,columnNumber:1e3};this.sendToInstance({cmd:"getPossibleBreakpoints",start:n,end:s})}toggleBreakpoint(n){const s=this.state.breakpoints.find(i=>i.location.scriptId===this.state.selected&&i.location.lineNumber===n);if(s){const i=JSON.parse(JSON.stringify(this.state.breakpoints));this.setState({breakpoints:i},()=>this.sendToInstance({breakpoints:[s.id],cmd:"cb"}))}else this.getPossibleBreakpoints({scriptId:this.state.selected,lineNumber:n,columnNumber:0})}renderCode(){if(this.state.script&&this.state.started){const n=this.state.breakpoints.filter(s=>s.location.scriptId===this.state.selected);return f.jsx(MP,{runningInstances:this.props.runningInstances,socket:this.props.socket,adapterName:this.props.adapterName,scriptName:this.state.selected?this.state.tabs[this.state.selected]:"",sourceId:this.state.selected,script:this.state.script,paused:this.state.paused,breakpoints:n,location:this.state.location,themeType:this.props.themeType,themeName:this.props.themeName,onToggleBreakpoint:s=>this.toggleBreakpoint(s)})}return null}renderFrames(){var n;return this.state.paused?f.jsx(zP,{currentScriptId:this.state.selected,scopes:this.state.scopes,expressions:this.state.expressions,themeType:this.props.themeType,callFrames:(n=this.state.context)==null?void 0:n.callFrames,currentFrame:this.state.currentFrame,onChangeCurrentFrame:s=>{this.setState({currentFrame:s,scopes:{}},()=>{this.readCurrentScope(),this.readExpressions()})},onWriteScopeValue:s=>{this.sendToInstance({cmd:"setValue",variableName:s.variableName,scopeNumber:s.scopeNumber,newValue:s.newValue,callFrameId:s.callFrameId})},onExpressionDelete:s=>{const i=JSON.parse(JSON.stringify(this.state.expressions));i.splice(s,1),this.setState({expressions:i}),window.localStorage.setItem(`javascript.tools.exps.${this.props.src}`,JSON.stringify(i.map(a=>a.name)))},onExpressionAdd:s=>{const i=JSON.parse(JSON.stringify(this.state.expressions));i.push({name:"",value:{value:""}}),this.setState({expressions:i},()=>s&&s(i.length-1,this.state.expressions[i.length-1]))},onExpressionNameUpdate:(s,i,a)=>{const c=JSON.parse(JSON.stringify(this.state.expressions));if(!i)c.splice(s,1);else{if(c.find(h=>h.name===i))return a&&a();c[s].name=i}this.setState({expressions:c},()=>{i&&this.readExpressions(s),a&&a()}),window.localStorage.setItem(`javascript.tools.exps.${this.props.src}`,JSON.stringify(c.map(h=>h.name)))}}):null}renderConsole(){return f.jsx(BP,{console:this.state.console,onClearAllLogs:()=>this.setState({console:[],logErrors:0,logWarnings:0,logs:0})})}renderTools(){const n=!this.state.tabs||!this.state.started;let s;return this.state.logErrors?s=f.jsx(D.Badge,{badgeContent:this.state.logErrors,color:"error",children:f.jsx("span",{children:I.I18n.t("Console")})}):this.state.logWarnings?s=f.jsx(D.Badge,{badgeContent:this.state.logWarnings,color:"secondary",children:f.jsx("span",{children:I.I18n.t("Console")})}):this.state.logs?s=f.jsx(D.Badge,{badgeContent:this.state.logs,color:"default",children:f.jsx("span",{children:I.I18n.t("Console")})}):s=I.I18n.t("Console"),f.jsxs("div",{style:{width:"100%",height:"100%",overflow:"hidden"},children:[f.jsxs(D.Tabs,{sx:Ts.tabsRoot,component:"div",indicatorColor:"primary",style:{position:"relative",width:"100%"},value:this.state.toolsTab,onChange:(i,a)=>{const c={toolsTab:a};this.console&&a==="console"&&(c.console=this.console,this.console=null,c.logs=0,c.logWarnings=0,c.logErrors=0),window.localStorage.setItem("javascript.tools.tab",a),this.setState(c)},scrollButtons:"auto",children:[f.jsx(D.Tab,{style:Ts.tabRoot,disabled:n,label:I.I18n.t("Stack"),value:"stack"}),f.jsx(D.Tab,{style:Ts.tabRoot,disabled:n,label:s,value:"console"})]}),f.jsxs("div",{style:{width:"100%",height:"calc(100% - 36px)",overflow:"hidden"},children:[this.state.toolsTab==="stack"&&!n?this.renderFrames():null,this.state.toolsTab==="console"&&!n?this.renderConsole():null]})]})}render(){return f.jsxs(D.Box,{sx:Ts.root,children:[this.state.starting?f.jsx(D.LinearProgress,{}):null,this.renderToolbar(),f.jsxs(Tv,{direction:Pn.Vertical,initialSizes:this.state.toolSizes,minHeights:[100,100],onResizeFinished:(n,s)=>{this.setState({toolSizes:s}),window.localStorage.setItem("JS.toolSizes",JSON.stringify(s))},gutterClassName:this.props.themeType==="dark"?"Dark visGutter":"Light visGutter",children:[f.jsxs("div",{style:{width:"100%",height:"100%",overflow:"hidden"},children:[this.renderCode(),this.renderQueryBreakpoints()]}),f.jsx("div",{style:{width:"100%",height:"100%",overflow:"hidden"},children:this.renderTools()})]}),this.renderError()]},"debugger")}}const Iw="RFC3986",xw={RFC1738:o=>String(o).replace(/%20/g,"+"),RFC3986:o=>String(o)},UP="RFC1738",HP=Array.isArray,ta=(()=>{const o=[];for(let n=0;n<256;++n)o.push("%"+((n<16?"0":"")+n.toString(16)).toUpperCase());return o})(),N_=1024,WP=(o,n,s,i,a)=>{if(o.length===0)return o;let c=o;if(typeof o=="symbol"?c=Symbol.prototype.toString.call(o):typeof o!="string"&&(c=String(o)),s==="iso-8859-1")return escape(c).replace(/%u[0-9a-f]{4}/gi,function(g){return"%26%23"+parseInt(g.slice(2),16)+"%3B"});let h="";for(let g=0;g<c.length;g+=N_){const b=c.length>=N_?c.slice(g,g+N_):c,$=[];for(let y=0;y<b.length;++y){let w=b.charCodeAt(y);if(w===45||w===46||w===95||w===126||w>=48&&w<=57||w>=65&&w<=90||w>=97&&w<=122||a===UP&&(w===40||w===41)){$[$.length]=b.charAt(y);continue}if(w<128){$[$.length]=ta[w];continue}if(w<2048){$[$.length]=ta[192|w>>6]+ta[128|w&63];continue}if(w<55296||w>=57344){$[$.length]=ta[224|w>>12]+ta[128|w>>6&63]+ta[128|w&63];continue}y+=1,w=65536+((w&1023)<<10|b.charCodeAt(y)&1023),$[$.length]=ta[240|w>>18]+ta[128|w>>12&63]+ta[128|w>>6&63]+ta[128|w&63]}h+=$.join("")}return h};function VP(o){return!o||typeof o!="object"?!1:!!(o.constructor&&o.constructor.isBuffer&&o.constructor.isBuffer(o))}function QC(o,n){if(HP(o)){const s=[];for(let i=0;i<o.length;i+=1)s.push(n(o[i]));return s}return n(o)}const GP=Object.prototype.hasOwnProperty,qk={brackets(o){return String(o)+"[]"},comma:"comma",indices(o,n){return String(o)+"["+n+"]"},repeat(o){return String(o)}},sa=Array.isArray,qP=Array.prototype.push,Kk=function(o,n){qP.apply(o,sa(n)?n:[n])},KP=Date.prototype.toISOString,ks={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:WP,encodeValuesOnly:!1,format:Iw,formatter:xw[Iw],indices:!1,serializeDate(o){return KP.call(o)},skipNulls:!1,strictNullHandling:!1};function JP(o){return typeof o=="string"||typeof o=="number"||typeof o=="boolean"||typeof o=="symbol"||typeof o=="bigint"}const M_={};function Jk(o,n,s,i,a,c,h,g,b,$,y,w,C,S,k,E,R,F){let M=o,L=F,T=0,V=!1;for(;(L=L.get(M_))!==void 0&&!V;){const ne=L.get(o);if(T+=1,typeof ne<"u"){if(ne===T)throw new RangeError("Cyclic object value");V=!0}typeof L.get(M_)>"u"&&(T=0)}if(typeof $=="function"?M=$(n,M):M instanceof Date?M=C==null?void 0:C(M):s==="comma"&&sa(M)&&(M=QC(M,function(ne){return ne instanceof Date?C==null?void 0:C(ne):ne})),M===null){if(c)return b&&!E?b(n,ks.encoder,R,"key",S):n;M=""}if(JP(M)||VP(M)){if(b){const ne=E?n:b(n,ks.encoder,R,"key",S);return[(k==null?void 0:k(ne))+"="+(k==null?void 0:k(b(M,ks.encoder,R,"value",S)))]}return[(k==null?void 0:k(n))+"="+(k==null?void 0:k(String(M)))]}const K=[];if(typeof M>"u")return K;let Y;if(s==="comma"&&sa(M))E&&b&&(M=QC(M,b)),Y=[{value:M.length>0?M.join(",")||null:void 0}];else if(sa($))Y=$;else{const ne=Object.keys(M);Y=y?ne.sort(y):ne}const te=g?String(n).replace(/\./g,"%2E"):String(n),J=i&&sa(M)&&M.length===1?te+"[]":te;if(a&&sa(M)&&M.length===0)return J+"[]";for(let ne=0;ne<Y.length;++ne){const Q=Y[ne],he=typeof Q=="object"&&typeof Q.value<"u"?Q.value:M[Q];if(h&&he===null)continue;const q=w&&g?Q.replace(/\./g,"%2E"):Q,re=sa(M)?typeof s=="function"?s(J,q):J:J+(w?"."+q:"["+q+"]");F.set(o,T);const De=new WeakMap;De.set(M_,F),Kk(K,Jk(he,re,s,i,a,c,h,g,s==="comma"&&E&&sa(M)?null:b,$,y,w,C,S,k,E,R,De))}return K}function YP(o=ks){if(typeof o.allowEmptyArrays<"u"&&typeof o.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof o.encodeDotInKeys<"u"&&typeof o.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(o.encoder!==null&&typeof o.encoder<"u"&&typeof o.encoder!="function")throw new TypeError("Encoder has to be a function.");const n=o.charset||ks.charset;if(typeof o.charset<"u"&&o.charset!=="utf-8"&&o.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let s=Iw;if(typeof o.format<"u"){if(!GP.call(xw,o.format))throw new TypeError("Unknown format option provided.");s=o.format}const i=xw[s];let a=ks.filter;(typeof o.filter=="function"||sa(o.filter))&&(a=o.filter);let c;if(o.arrayFormat&&o.arrayFormat in qk?c=o.arrayFormat:"indices"in o?c=o.indices?"indices":"repeat":c=ks.arrayFormat,"commaRoundTrip"in o&&typeof o.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const h=typeof o.allowDots>"u"?o.encodeDotInKeys?!0:ks.allowDots:!!o.allowDots;return{addQueryPrefix:typeof o.addQueryPrefix=="boolean"?o.addQueryPrefix:ks.addQueryPrefix,allowDots:h,allowEmptyArrays:typeof o.allowEmptyArrays=="boolean"?!!o.allowEmptyArrays:ks.allowEmptyArrays,arrayFormat:c,charset:n,charsetSentinel:typeof o.charsetSentinel=="boolean"?o.charsetSentinel:ks.charsetSentinel,commaRoundTrip:!!o.commaRoundTrip,delimiter:typeof o.delimiter>"u"?ks.delimiter:o.delimiter,encode:typeof o.encode=="boolean"?o.encode:ks.encode,encodeDotInKeys:typeof o.encodeDotInKeys=="boolean"?o.encodeDotInKeys:ks.encodeDotInKeys,encoder:typeof o.encoder=="function"?o.encoder:ks.encoder,encodeValuesOnly:typeof o.encodeValuesOnly=="boolean"?o.encodeValuesOnly:ks.encodeValuesOnly,filter:a,format:s,formatter:i,serializeDate:typeof o.serializeDate=="function"?o.serializeDate:ks.serializeDate,skipNulls:typeof o.skipNulls=="boolean"?o.skipNulls:ks.skipNulls,sort:typeof o.sort=="function"?o.sort:null,strictNullHandling:typeof o.strictNullHandling=="boolean"?o.strictNullHandling:ks.strictNullHandling}}function XP(o,n={}){let s=o;const i=YP(n);let a,c;typeof i.filter=="function"?(c=i.filter,s=c("",s)):sa(i.filter)&&(c=i.filter,a=c);const h=[];if(typeof s!="object"||s===null)return"";const g=qk[i.arrayFormat],b=g==="comma"&&i.commaRoundTrip;a||(a=Object.keys(s)),i.sort&&a.sort(i.sort);const $=new WeakMap;for(let C=0;C<a.length;++C){const S=a[C];i.skipNulls&&s[S]===null||Kk(h,Jk(s[S],S,g,b,i.allowEmptyArrays,i.strictNullHandling,i.skipNulls,i.encodeDotInKeys,i.encode?i.encoder:null,i.filter,i.sort,i.allowDots,i.serializeDate,i.format,i.formatter,i.encodeValuesOnly,i.charset,$))}const y=h.join(i.delimiter);let w=i.addQueryPrefix===!0?"?":"";return i.charsetSentinel&&(i.charset==="iso-8859-1"?w+="utf8=%26%2310003%3B&":w+="utf8=%E2%9C%93&"),y.length>0?w+y:""}const jh="4.77.0";let eT=!1,sm,Yk,Xk,Dw,Zk,Qk,eI,tI,nI;function ZP(o,n={auto:!1}){if(eT)throw new Error(`you must \`import 'openai/shims/${o.kind}'\` before importing anything else from openai`);if(sm)throw new Error(`can't \`import 'openai/shims/${o.kind}'\` after \`import 'openai/shims/${sm}'\``);eT=n.auto,sm=o.kind,Yk=o.fetch,Xk=o.FormData,Dw=o.File,Zk=o.ReadableStream,Qk=o.getMultipartRequestOptions,eI=o.getDefaultAgent,tI=o.fileFromPath,nI=o.isFsReadStream}class QP{constructor(n){this.body=n}get[Symbol.toStringTag](){return"MultipartBody"}}function e2({manuallyImported:o}={}){const n=o?"You may need to use polyfills":"Add one of these imports before your first `import … from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n";let s,i,a,c;try{s=fetch,i=Request,a=Response,c=Headers}catch(h){throw new Error(`this environment is missing the following Web Fetch API type: ${h.message}. ${n}`)}return{kind:"web",fetch:s,Request:i,Response:a,Headers:c,FormData:typeof FormData<"u"?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${n}`)}},Blob:typeof Blob<"u"?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${n}`)}},File:typeof File<"u"?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${n}`)}},ReadableStream:typeof ReadableStream<"u"?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${n}`)}},getMultipartRequestOptions:async(h,g)=>({...g,body:new QP(h)}),getDefaultAgent:h=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:h=>!1}}sm||ZP(e2(),{auto:!0});class Qt extends Error{}class Ys extends Qt{constructor(n,s,i,a){super(`${Ys.makeMessage(n,s,i)}`),this.status=n,this.headers=a,this.request_id=a==null?void 0:a["x-request-id"],this.error=s;const c=s;this.code=c==null?void 0:c.code,this.param=c==null?void 0:c.param,this.type=c==null?void 0:c.type}static makeMessage(n,s,i){const a=s!=null&&s.message?typeof s.message=="string"?s.message:JSON.stringify(s.message):s?JSON.stringify(s):i;return n&&a?`${n} ${a}`:n?`${n} status code (no body)`:a||"(no status code or body)"}static generate(n,s,i,a){if(!n||!a)return new Cy({message:i,cause:Rw(s)});const c=s==null?void 0:s.error;return n===400?new sI(n,c,i,a):n===401?new rI(n,c,i,a):n===403?new iI(n,c,i,a):n===404?new oI(n,c,i,a):n===409?new aI(n,c,i,a):n===422?new lI(n,c,i,a):n===429?new cI(n,c,i,a):n>=500?new uI(n,c,i,a):new Ys(n,c,i,a)}}class $o extends Ys{constructor({message:n}={}){super(void 0,void 0,n||"Request was aborted.",void 0)}}class Cy extends Ys{constructor({message:n,cause:s}){super(void 0,void 0,n||"Connection error.",void 0),s&&(this.cause=s)}}class vS extends Cy{constructor({message:n}={}){super({message:n??"Request timed out."})}}class sI extends Ys{}class rI extends Ys{}class iI extends Ys{}class oI extends Ys{}class aI extends Ys{}class lI extends Ys{}class cI extends Ys{}class uI extends Ys{}class dI extends Qt{constructor(){super("Could not parse response content as the length limit was reached")}}class hI extends Qt{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}class Pu{constructor(){this.buffer=[],this.trailingCR=!1}decode(n){let s=this.decodeText(n);if(this.trailingCR&&(s="\r"+s,this.trailingCR=!1),s.endsWith("\r")&&(this.trailingCR=!0,s=s.slice(0,-1)),!s)return[];const i=Pu.NEWLINE_CHARS.has(s[s.length-1]||"");let a=s.split(Pu.NEWLINE_REGEXP);return i&&a.pop(),a.length===1&&!i?(this.buffer.push(a[0]),[]):(this.buffer.length>0&&(a=[this.buffer.join("")+a[0],...a.slice(1)],this.buffer=[]),i||(this.buffer=[a.pop()||""]),a)}decodeText(n){if(n==null)return"";if(typeof n=="string")return n;if(typeof Buffer<"u"){if(n instanceof Buffer)return n.toString();if(n instanceof Uint8Array)return Buffer.from(n).toString();throw new Qt(`Unexpected: received non-Uint8Array (${n.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder<"u"){if(n instanceof Uint8Array||n instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(n);throw new Qt(`Unexpected: received non-Uint8Array/ArrayBuffer (${n.constructor.name}) in a web platform. Please report this error.`)}throw new Qt("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){if(!this.buffer.length&&!this.trailingCR)return[];const n=[this.buffer.join("")];return this.buffer=[],this.trailingCR=!1,n}}Pu.NEWLINE_CHARS=new Set([`
`,"\r"]);Pu.NEWLINE_REGEXP=/\r\n|[\n\r]/g;class oa{constructor(n,s){this.iterator=n,this.controller=s}static fromSSEResponse(n,s){let i=!1;async function*a(){if(i)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");i=!0;let c=!1;try{for await(const h of t2(n,s))if(!c){if(h.data.startsWith("[DONE]")){c=!0;continue}if(h.event===null){let g;try{g=JSON.parse(h.data)}catch(b){throw console.error("Could not parse message into JSON:",h.data),console.error("From chunk:",h.raw),b}if(g&&g.error)throw new Ys(void 0,g.error,void 0,void 0);yield g}else{let g;try{g=JSON.parse(h.data)}catch(b){throw console.error("Could not parse message into JSON:",h.data),console.error("From chunk:",h.raw),b}if(h.event=="error")throw new Ys(void 0,g.error,g.message,void 0);yield{event:h.event,data:g}}}c=!0}catch(h){if(h instanceof Error&&h.name==="AbortError")return;throw h}finally{c||s.abort()}}return new oa(a,s)}static fromReadableStream(n,s){let i=!1;async function*a(){const h=new Pu,g=pI(n);for await(const b of g)for(const $ of h.decode(b))yield $;for(const b of h.flush())yield b}async function*c(){if(i)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");i=!0;let h=!1;try{for await(const g of a())h||g&&(yield JSON.parse(g));h=!0}catch(g){if(g instanceof Error&&g.name==="AbortError")return;throw g}finally{h||s.abort()}}return new oa(c,s)}[Symbol.asyncIterator](){return this.iterator()}tee(){const n=[],s=[],i=this.iterator(),a=c=>({next:()=>{if(c.length===0){const h=i.next();n.push(h),s.push(h)}return c.shift()}});return[new oa(()=>a(n),this.controller),new oa(()=>a(s),this.controller)]}toReadableStream(){const n=this;let s;const i=new TextEncoder;return new Zk({async start(){s=n[Symbol.asyncIterator]()},async pull(a){try{const{value:c,done:h}=await s.next();if(h)return a.close();const g=i.encode(JSON.stringify(c)+`
`);a.enqueue(g)}catch(c){a.error(c)}},async cancel(){var a;await((a=s.return)==null?void 0:a.call(s))}})}}async function*t2(o,n){if(!o.body)throw n.abort(),new Qt("Attempted to iterate over a response with no body");const s=new r2,i=new Pu,a=pI(o.body);for await(const c of n2(a))for(const h of i.decode(c)){const g=s.decode(h);g&&(yield g)}for(const c of i.flush()){const h=s.decode(c);h&&(yield h)}}async function*n2(o){let n=new Uint8Array;for await(const s of o){if(s==null)continue;const i=s instanceof ArrayBuffer?new Uint8Array(s):typeof s=="string"?new TextEncoder().encode(s):s;let a=new Uint8Array(n.length+i.length);a.set(n),a.set(i,n.length),n=a;let c;for(;(c=s2(n))!==-1;)yield n.slice(0,c),n=n.slice(c)}n.length>0&&(yield n)}function s2(o){for(let i=0;i<o.length-2;i++){if(o[i]===10&&o[i+1]===10||o[i]===13&&o[i+1]===13)return i+2;if(o[i]===13&&o[i+1]===10&&i+3<o.length&&o[i+2]===13&&o[i+3]===10)return i+4}return-1}class r2{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(n){if(n.endsWith("\r")&&(n=n.substring(0,n.length-1)),!n){if(!this.event&&!this.data.length)return null;const c={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],c}if(this.chunks.push(n),n.startsWith(":"))return null;let[s,i,a]=i2(n,":");return a.startsWith(" ")&&(a=a.substring(1)),s==="event"?this.event=a:s==="data"&&this.data.push(a),null}}function i2(o,n){const s=o.indexOf(n);return s!==-1?[o.substring(0,s),n,o.substring(s+n.length)]:[o,"",""]}function pI(o){if(o[Symbol.asyncIterator])return o;const n=o.getReader();return{async next(){try{const s=await n.read();return s!=null&&s.done&&n.releaseLock(),s}catch(s){throw n.releaseLock(),s}},async return(){const s=n.cancel();return n.releaseLock(),await s,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}const gI=o=>o!=null&&typeof o=="object"&&typeof o.url=="string"&&typeof o.blob=="function",fI=o=>o!=null&&typeof o=="object"&&typeof o.name=="string"&&typeof o.lastModified=="number"&&Ty(o),Ty=o=>o!=null&&typeof o=="object"&&typeof o.size=="number"&&typeof o.type=="string"&&typeof o.text=="function"&&typeof o.slice=="function"&&typeof o.arrayBuffer=="function",o2=o=>fI(o)||gI(o)||nI(o);async function mI(o,n,s){var a;if(o=await o,fI(o))return o;if(gI(o)){const c=await o.blob();n||(n=new URL(o.url).pathname.split(/[\\/]/).pop()??"unknown_file");const h=Ty(c)?[await c.arrayBuffer()]:[c];return new Dw(h,n,s)}const i=await a2(o);if(n||(n=c2(o)??"unknown_file"),!(s!=null&&s.type)){const c=(a=i[0])==null?void 0:a.type;typeof c=="string"&&(s={...s,type:c})}return new Dw(i,n,s)}async function a2(o){var s;let n=[];if(typeof o=="string"||ArrayBuffer.isView(o)||o instanceof ArrayBuffer)n.push(o);else if(Ty(o))n.push(await o.arrayBuffer());else if(u2(o))for await(const i of o)n.push(i);else throw new Error(`Unexpected data type: ${typeof o}; constructor: ${(s=o==null?void 0:o.constructor)==null?void 0:s.name}; props: ${l2(o)}`);return n}function l2(o){return`[${Object.getOwnPropertyNames(o).map(s=>`"${s}"`).join(", ")}]`}function c2(o){var n;return L_(o.name)||L_(o.filename)||((n=L_(o.path))==null?void 0:n.split(/[\\/]/).pop())}const L_=o=>{if(typeof o=="string")return o;if(typeof Buffer<"u"&&o instanceof Buffer)return String(o)},u2=o=>o!=null&&typeof o=="object"&&typeof o[Symbol.asyncIterator]=="function",tT=o=>o&&typeof o=="object"&&o.body&&o[Symbol.toStringTag]==="MultipartBody",lp=async o=>{const n=await d2(o.body);return Qk(n,o)},d2=async o=>{const n=new Xk;return await Promise.all(Object.entries(o||{}).map(([s,i])=>Ow(n,s,i))),n},Ow=async(o,n,s)=>{if(s!==void 0){if(s==null)throw new TypeError(`Received null for "${n}"; to pass null in FormData, you must use the string 'null'`);if(typeof s=="string"||typeof s=="number"||typeof s=="boolean")o.append(n,String(s));else if(o2(s)){const i=await mI(s);o.append(n,i)}else if(Array.isArray(s))await Promise.all(s.map(i=>Ow(o,n+"[]",i)));else if(typeof s=="object")await Promise.all(Object.entries(s).map(([i,a])=>Ow(o,`${n}[${i}]`,a)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${s} instead`)}};var Xh={},h2=function(o,n,s,i,a){if(typeof n=="function"?o!==n||!a:!n.has(o))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n.set(o,s),s},p2=function(o,n,s,i){if(s==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof n=="function"?o!==n||!i:!n.has(o))throw new TypeError("Cannot read private member from an object whose class did not declare it");return s==="m"?i:s==="a"?i.call(o):i?i.value:n.get(o)},tv;async function bI(o){const{response:n}=o;if(o.options.stream)return Zh("response",n.status,n.url,n.headers,n.body),o.options.__streamClass?o.options.__streamClass.fromSSEResponse(n,o.controller):oa.fromSSEResponse(n,o.controller);if(n.status===204)return null;if(o.options.__binaryResponse)return n;const s=n.headers.get("content-type");if((s==null?void 0:s.includes("application/json"))||(s==null?void 0:s.includes("application/vnd.api+json"))){const c=await n.json();return Zh("response",n.status,n.url,n.headers,c),$I(c,n)}const a=await n.text();return Zh("response",n.status,n.url,n.headers,a),a}function $I(o,n){return!o||typeof o!="object"||Array.isArray(o)?o:Object.defineProperty(o,"_request_id",{value:n.headers.get("x-request-id"),enumerable:!1})}class Ey extends Promise{constructor(n,s=bI){super(i=>{i(null)}),this.responsePromise=n,this.parseResponse=s}_thenUnwrap(n){return new Ey(this.responsePromise,async s=>$I(n(await this.parseResponse(s),s),s.response))}asResponse(){return this.responsePromise.then(n=>n.response)}async withResponse(){const[n,s]=await Promise.all([this.parse(),this.asResponse()]);return{data:n,response:s,request_id:s.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(n,s){return this.parse().then(n,s)}catch(n){return this.parse().catch(n)}finally(n){return this.parse().finally(n)}}class g2{constructor({baseURL:n,maxRetries:s=2,timeout:i=6e5,httpAgent:a,fetch:c}){this.baseURL=n,this.maxRetries=B_("maxRetries",s),this.timeout=B_("timeout",i),this.httpAgent=a,this.fetch=c??Yk}authHeaders(n){return{}}defaultHeaders(n){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...y2(),...this.authHeaders(n)}}validateHeaders(n,s){}defaultIdempotencyKey(){return`stainless-node-retry-${C2()}`}get(n,s){return this.methodRequest("get",n,s)}post(n,s){return this.methodRequest("post",n,s)}patch(n,s){return this.methodRequest("patch",n,s)}put(n,s){return this.methodRequest("put",n,s)}delete(n,s){return this.methodRequest("delete",n,s)}methodRequest(n,s,i){return this.request(Promise.resolve(i).then(async a=>{const c=a&&Ty(a==null?void 0:a.body)?new DataView(await a.body.arrayBuffer()):(a==null?void 0:a.body)instanceof DataView?a.body:(a==null?void 0:a.body)instanceof ArrayBuffer?new DataView(a.body):a&&ArrayBuffer.isView(a==null?void 0:a.body)?new DataView(a.body.buffer):a==null?void 0:a.body;return{method:n,path:s,...a,body:c}}))}getAPIList(n,s,i){return this.requestAPIList(s,{method:"get",path:n,...i})}calculateContentLength(n){if(typeof n=="string"){if(typeof Buffer<"u")return Buffer.byteLength(n,"utf8").toString();if(typeof TextEncoder<"u")return new TextEncoder().encode(n).length.toString()}else if(ArrayBuffer.isView(n))return n.byteLength.toString();return null}buildRequest(n,{retryCount:s=0}={}){var E;const{method:i,path:a,query:c,headers:h={}}=n,g=ArrayBuffer.isView(n.body)||n.__binaryRequest&&typeof n.body=="string"?n.body:tT(n.body)?n.body.body:n.body?JSON.stringify(n.body,null,2):null,b=this.calculateContentLength(g),$=this.buildURL(a,c);"timeout"in n&&B_("timeout",n.timeout);const y=n.timeout??this.timeout,w=n.httpAgent??this.httpAgent??eI($),C=y+1e3;typeof((E=w==null?void 0:w.options)==null?void 0:E.timeout)=="number"&&C>(w.options.timeout??0)&&(w.options.timeout=C),this.idempotencyHeader&&i!=="get"&&(n.idempotencyKey||(n.idempotencyKey=this.defaultIdempotencyKey()),h[this.idempotencyHeader]=n.idempotencyKey);const S=this.buildHeaders({options:n,headers:h,contentLength:b,retryCount:s});return{req:{method:i,...g&&{body:g},headers:S,...w&&{agent:w},signal:n.signal??null},url:$,timeout:y}}buildHeaders({options:n,headers:s,contentLength:i,retryCount:a}){const c={};i&&(c["content-length"]=i);const h=this.defaultHeaders(n);return iT(c,h),iT(c,s),tT(n.body)&&sm!=="node"&&delete c["content-type"],oT(h,"x-stainless-retry-count")===void 0&&oT(s,"x-stainless-retry-count")===void 0&&(c["x-stainless-retry-count"]=String(a)),this.validateHeaders(c,s),c}async prepareOptions(n){}async prepareRequest(n,{url:s,options:i}){}parseHeaders(n){return n?Symbol.iterator in n?Object.fromEntries(Array.from(n).map(s=>[...s])):{...n}:{}}makeStatusError(n,s,i,a){return Ys.generate(n,s,i,a)}request(n,s=null){return new Ey(this.makeRequest(n,s))}async makeRequest(n,s){var w,C;const i=await n,a=i.maxRetries??this.maxRetries;s==null&&(s=a),await this.prepareOptions(i);const{req:c,url:h,timeout:g}=this.buildRequest(i,{retryCount:a-s});if(await this.prepareRequest(c,{url:h,options:i}),Zh("request",h,i,c.headers),(w=i.signal)!=null&&w.aborted)throw new $o;const b=new AbortController,$=await this.fetchWithTimeout(h,c,g,b).catch(Rw);if($ instanceof Error){if((C=i.signal)!=null&&C.aborted)throw new $o;if(s)return this.retryRequest(i,s);throw $.name==="AbortError"?new vS:new Cy({cause:$})}const y=m2($.headers);if(!$.ok){if(s&&this.shouldRetry($)){const M=`retrying, ${s} attempts remaining`;return Zh(`response (error; ${M})`,$.status,h,y),this.retryRequest(i,s,y)}const S=await $.text().catch(M=>Rw(M).message),k=_2(S),E=k?void 0:S;throw Zh(`response (error; ${s?"(error; no more retries left)":"(error; not retryable)"})`,$.status,h,y,E),this.makeStatusError($.status,k,E,y)}return{response:$,options:i,controller:b}}requestAPIList(n,s){const i=this.makeRequest(s,null);return new f2(this,i,n)}buildURL(n,s){const i=S2(n)?new URL(n):new URL(this.baseURL+(this.baseURL.endsWith("/")&&n.startsWith("/")?n.slice(1):n)),a=this.defaultQuery();return yI(a)||(s={...a,...s}),typeof s=="object"&&s&&!Array.isArray(s)&&(i.search=this.stringifyQuery(s)),i.toString()}stringifyQuery(n){return Object.entries(n).filter(([s,i])=>typeof i<"u").map(([s,i])=>{if(typeof i=="string"||typeof i=="number"||typeof i=="boolean")return`${encodeURIComponent(s)}=${encodeURIComponent(i)}`;if(i===null)return`${encodeURIComponent(s)}=`;throw new Qt(`Cannot stringify type ${typeof i}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(n,s,i,a){const{signal:c,...h}=s||{};c&&c.addEventListener("abort",()=>a.abort());const g=setTimeout(()=>a.abort(),i);return this.fetch.call(void 0,n,{signal:a.signal,...h}).finally(()=>{clearTimeout(g)})}shouldRetry(n){const s=n.headers.get("x-should-retry");return s==="true"?!0:s==="false"?!1:n.status===408||n.status===409||n.status===429||n.status>=500}async retryRequest(n,s,i){let a;const c=i==null?void 0:i["retry-after-ms"];if(c){const g=parseFloat(c);Number.isNaN(g)||(a=g)}const h=i==null?void 0:i["retry-after"];if(h&&!a){const g=parseFloat(h);Number.isNaN(g)?a=Date.parse(h)-Date.now():a=g*1e3}if(!(a&&0<=a&&a<60*1e3)){const g=n.maxRetries??this.maxRetries;a=this.calculateDefaultRetryTimeoutMillis(s,g)}return await Em(a),this.makeRequest(n,s-1)}calculateDefaultRetryTimeoutMillis(n,s){const c=s-n,h=Math.min(.5*Math.pow(2,c),8),g=1-Math.random()*.25;return h*g*1e3}getUserAgent(){return`${this.constructor.name}/JS ${jh}`}}class vI{constructor(n,s,i,a){tv.set(this,void 0),h2(this,tv,n),this.options=a,this.response=s,this.body=i}hasNextPage(){return this.getPaginatedItems().length?this.nextPageInfo()!=null:!1}async getNextPage(){const n=this.nextPageInfo();if(!n)throw new Qt("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const s={...this.options};if("params"in n&&typeof s.query=="object")s.query={...s.query,...n.params};else if("url"in n){const i=[...Object.entries(s.query||{}),...n.url.searchParams.entries()];for(const[a,c]of i)n.url.searchParams.set(a,c);s.query=void 0,s.path=n.url.toString()}return await p2(this,tv,"f").requestAPIList(this.constructor,s)}async*iterPages(){let n=this;for(yield n;n.hasNextPage();)n=await n.getNextPage(),yield n}async*[(tv=new WeakMap,Symbol.asyncIterator)](){for await(const n of this.iterPages())for(const s of n.getPaginatedItems())yield s}}class f2 extends Ey{constructor(n,s,i){super(s,async a=>new i(n,a.response,await bI(a),a.options))}async*[Symbol.asyncIterator](){const n=await this;for await(const s of n)yield s}}const m2=o=>new Proxy(Object.fromEntries(o.entries()),{get(n,s){const i=s.toString();return n[i.toLowerCase()]||n[i]}}),b2={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},ti=o=>typeof o=="object"&&o!==null&&!yI(o)&&Object.keys(o).every(n=>_I(b2,n)),$2=()=>{var n;if(typeof Deno<"u"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":jh,"X-Stainless-OS":sT(Deno.build.os),"X-Stainless-Arch":nT(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((n=Deno.version)==null?void 0:n.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":jh,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if(Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":jh,"X-Stainless-OS":sT(process.platform),"X-Stainless-Arch":nT(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const o=v2();return o?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":jh,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${o.browser}`,"X-Stainless-Runtime-Version":o.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":jh,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function v2(){if(typeof navigator>"u"||!navigator)return null;const o=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:n,pattern:s}of o){const i=s.exec(navigator.userAgent);if(i){const a=i[1]||0,c=i[2]||0,h=i[3]||0;return{browser:n,version:`${a}.${c}.${h}`}}}return null}const nT=o=>o==="x32"?"x32":o==="x86_64"||o==="x64"?"x64":o==="arm"?"arm":o==="aarch64"||o==="arm64"?"arm64":o?`other:${o}`:"unknown",sT=o=>(o=o.toLowerCase(),o.includes("ios")?"iOS":o==="android"?"Android":o==="darwin"?"MacOS":o==="win32"?"Windows":o==="freebsd"?"FreeBSD":o==="openbsd"?"OpenBSD":o==="linux"?"Linux":o?`Other:${o}`:"Unknown");let rT;const y2=()=>rT??(rT=$2()),_2=o=>{try{return JSON.parse(o)}catch{return}},w2=/^[a-z][a-z0-9+.-]*:/i,S2=o=>w2.test(o),Em=o=>new Promise(n=>setTimeout(n,o)),B_=(o,n)=>{if(typeof n!="number"||!Number.isInteger(n))throw new Qt(`${o} must be an integer`);if(n<0)throw new Qt(`${o} must be a positive integer`);return n},Rw=o=>{if(o instanceof Error)return o;if(typeof o=="object"&&o!==null)try{return new Error(JSON.stringify(o))}catch{}return new Error(o)},nv=o=>{var n,s,i,a;if(typeof process<"u")return((n=Xh==null?void 0:Xh[o])==null?void 0:n.trim())??void 0;if(typeof Deno<"u")return(a=(i=(s=Deno.env)==null?void 0:s.get)==null?void 0:i.call(s,o))==null?void 0:a.trim()};function yI(o){if(!o)return!0;for(const n in o)return!1;return!0}function _I(o,n){return Object.prototype.hasOwnProperty.call(o,n)}function iT(o,n){for(const s in n){if(!_I(n,s))continue;const i=s.toLowerCase();if(!i)continue;const a=n[s];a===null?delete o[i]:a!==void 0&&(o[i]=a)}}function Zh(o,...n){typeof process<"u"&&(Xh==null?void 0:Xh.DEBUG)==="true"&&console.log(`OpenAI:DEBUG:${o}`,...n)}const C2=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,o=>{const n=Math.random()*16|0;return(o==="x"?n:n&3|8).toString(16)}),T2=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u",E2=o=>typeof(o==null?void 0:o.get)=="function",oT=(o,n)=>{var i;const s=n.toLowerCase();if(E2(o)){const a=((i=n[0])==null?void 0:i.toUpperCase())+n.substring(1).replace(/([^\w])(\w)/g,(c,h,g)=>h+g.toUpperCase());for(const c of[n,s,n.toUpperCase(),a]){const h=o.get(c);if(h)return h}}for(const[a,c]of Object.entries(o))if(a.toLowerCase()===s)return Array.isArray(c)?(c.length<=1||console.warn(`Received ${c.length} entries for the ${n} header, using the first entry.`),c[0]):c};function P_(o){return o!=null&&typeof o=="object"&&!Array.isArray(o)}class k2 extends vI{constructor(n,s,i,a){super(n,s,i,a),this.data=i.data||[],this.object=i.object}getPaginatedItems(){return this.data??[]}nextPageParams(){return null}nextPageInfo(){return null}}class Co extends vI{constructor(n,s,i,a){super(n,s,i,a),this.data=i.data||[]}getPaginatedItems(){return this.data??[]}nextPageParams(){const n=this.nextPageInfo();if(!n)return null;if("params"in n)return n.params;const s=Object.fromEntries(n.url.searchParams);return Object.keys(s).length?s:null}nextPageInfo(){var i;const n=this.getPaginatedItems();if(!n.length)return null;const s=(i=n[n.length-1])==null?void 0:i.id;return s?{params:{after:s}}:null}}class Cn{constructor(n){this._client=n}}let wI=class extends Cn{create(n,s){return this._client.post("/chat/completions",{body:n,...s,stream:n.stream??!1})}},yS=class extends Cn{constructor(){super(...arguments),this.completions=new wI(this._client)}};yS.Completions=wI;class SI extends Cn{create(n,s){return this._client.post("/audio/speech",{body:n,...s,__binaryResponse:!0})}}class CI extends Cn{create(n,s){return this._client.post("/audio/transcriptions",lp({body:n,...s}))}}class TI extends Cn{create(n,s){return this._client.post("/audio/translations",lp({body:n,...s}))}}class km extends Cn{constructor(){super(...arguments),this.transcriptions=new CI(this._client),this.translations=new TI(this._client),this.speech=new SI(this._client)}}km.Transcriptions=CI;km.Translations=TI;km.Speech=SI;class _S extends Cn{create(n,s){return this._client.post("/batches",{body:n,...s})}retrieve(n,s){return this._client.get(`/batches/${n}`,s)}list(n={},s){return ti(n)?this.list({},n):this._client.getAPIList("/batches",wS,{query:n,...s})}cancel(n,s){return this._client.post(`/batches/${n}/cancel`,s)}}class wS extends Co{}_S.BatchesPage=wS;class SS extends Cn{create(n,s){return this._client.post("/assistants",{body:n,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}retrieve(n,s){return this._client.get(`/assistants/${n}`,{...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}update(n,s,i){return this._client.post(`/assistants/${n}`,{body:s,...i,headers:{"OpenAI-Beta":"assistants=v2",...i==null?void 0:i.headers}})}list(n={},s){return ti(n)?this.list({},n):this._client.getAPIList("/assistants",CS,{query:n,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}del(n,s){return this._client.delete(`/assistants/${n}`,{...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}}class CS extends Co{}SS.AssistantsPage=CS;function aT(o){return typeof o.parse=="function"}const Qh=o=>(o==null?void 0:o.role)==="assistant",EI=o=>(o==null?void 0:o.role)==="function",kI=o=>(o==null?void 0:o.role)==="tool";var mo=function(o,n,s,i,a){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof n=="function"?o!==n||!a:!n.has(o))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?a.call(o,s):a?a.value=s:n.set(o,s),s},es=function(o,n,s,i){if(s==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof n=="function"?o!==n||!i:!n.has(o))throw new TypeError("Cannot read private member from an object whose class did not declare it");return s==="m"?i:s==="a"?i.call(o):i?i.value:n.get(o)},Aw,$v,vv,Vf,Gf,yv,qf,nl,Kf,ty,ny,zh,II;class xI{constructor(){Aw.add(this),this.controller=new AbortController,$v.set(this,void 0),vv.set(this,()=>{}),Vf.set(this,()=>{}),Gf.set(this,void 0),yv.set(this,()=>{}),qf.set(this,()=>{}),nl.set(this,{}),Kf.set(this,!1),ty.set(this,!1),ny.set(this,!1),zh.set(this,!1),mo(this,$v,new Promise((n,s)=>{mo(this,vv,n,"f"),mo(this,Vf,s,"f")}),"f"),mo(this,Gf,new Promise((n,s)=>{mo(this,yv,n,"f"),mo(this,qf,s,"f")}),"f"),es(this,$v,"f").catch(()=>{}),es(this,Gf,"f").catch(()=>{})}_run(n){setTimeout(()=>{n().then(()=>{this._emitFinal(),this._emit("end")},es(this,Aw,"m",II).bind(this))},0)}_connected(){this.ended||(es(this,vv,"f").call(this),this._emit("connect"))}get ended(){return es(this,Kf,"f")}get errored(){return es(this,ty,"f")}get aborted(){return es(this,ny,"f")}abort(){this.controller.abort()}on(n,s){return(es(this,nl,"f")[n]||(es(this,nl,"f")[n]=[])).push({listener:s}),this}off(n,s){const i=es(this,nl,"f")[n];if(!i)return this;const a=i.findIndex(c=>c.listener===s);return a>=0&&i.splice(a,1),this}once(n,s){return(es(this,nl,"f")[n]||(es(this,nl,"f")[n]=[])).push({listener:s,once:!0}),this}emitted(n){return new Promise((s,i)=>{mo(this,zh,!0,"f"),n!=="error"&&this.once("error",i),this.once(n,s)})}async done(){mo(this,zh,!0,"f"),await es(this,Gf,"f")}_emit(n,...s){if(es(this,Kf,"f"))return;n==="end"&&(mo(this,Kf,!0,"f"),es(this,yv,"f").call(this));const i=es(this,nl,"f")[n];if(i&&(es(this,nl,"f")[n]=i.filter(a=>!a.once),i.forEach(({listener:a})=>a(...s))),n==="abort"){const a=s[0];!es(this,zh,"f")&&!(i!=null&&i.length)&&Promise.reject(a),es(this,Vf,"f").call(this,a),es(this,qf,"f").call(this,a),this._emit("end");return}if(n==="error"){const a=s[0];!es(this,zh,"f")&&!(i!=null&&i.length)&&Promise.reject(a),es(this,Vf,"f").call(this,a),es(this,qf,"f").call(this,a),this._emit("end")}}_emitFinal(){}}$v=new WeakMap,vv=new WeakMap,Vf=new WeakMap,Gf=new WeakMap,yv=new WeakMap,qf=new WeakMap,nl=new WeakMap,Kf=new WeakMap,ty=new WeakMap,ny=new WeakMap,zh=new WeakMap,Aw=new WeakSet,II=function(n){if(mo(this,ty,!0,"f"),n instanceof Error&&n.name==="AbortError"&&(n=new $o),n instanceof $o)return mo(this,ny,!0,"f"),this._emit("abort",n);if(n instanceof Qt)return this._emit("error",n);if(n instanceof Error){const s=new Qt(n.message);return s.cause=n,this._emit("error",s)}return this._emit("error",new Qt(String(n)))};function DI(o){return(o==null?void 0:o.$brand)==="auto-parseable-response-format"}function Im(o){return(o==null?void 0:o.$brand)==="auto-parseable-tool"}function I2(o,n){return!n||!OI(n)?{...o,choices:o.choices.map(s=>({...s,message:{...s.message,parsed:null,tool_calls:s.message.tool_calls??[]}}))}:TS(o,n)}function TS(o,n){const s=o.choices.map(i=>{var a;if(i.finish_reason==="length")throw new dI;if(i.finish_reason==="content_filter")throw new hI;return{...i,message:{...i.message,tool_calls:((a=i.message.tool_calls)==null?void 0:a.map(c=>D2(n,c)))??[],parsed:i.message.content&&!i.message.refusal?x2(n,i.message.content):null}}});return{...o,choices:s}}function x2(o,n){var s,i;return((s=o.response_format)==null?void 0:s.type)!=="json_schema"?null:((i=o.response_format)==null?void 0:i.type)==="json_schema"?"$parseRaw"in o.response_format?o.response_format.$parseRaw(n):JSON.parse(n):null}function D2(o,n){var i;const s=(i=o.tools)==null?void 0:i.find(a=>{var c;return((c=a.function)==null?void 0:c.name)===n.function.name});return{...n,function:{...n.function,parsed_arguments:Im(s)?s.$parseRaw(n.function.arguments):s!=null&&s.function.strict?JSON.parse(n.function.arguments):null}}}function O2(o,n){var i;if(!o)return!1;const s=(i=o.tools)==null?void 0:i.find(a=>{var c;return((c=a.function)==null?void 0:c.name)===n.function.name});return Im(s)||(s==null?void 0:s.function.strict)||!1}function OI(o){var n;return DI(o.response_format)?!0:((n=o.tools)==null?void 0:n.some(s=>Im(s)||s.type==="function"&&s.function.strict===!0))??!1}function R2(o){for(const n of o??[]){if(n.type!=="function")throw new Qt(`Currently only \`function\` tool types support auto-parsing; Received \`${n.type}\``);if(n.function.strict!==!0)throw new Qt(`The \`${n.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}var Xr=function(o,n,s,i){if(s==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof n=="function"?o!==n||!i:!n.has(o))throw new TypeError("Cannot read private member from an object whose class did not declare it");return s==="m"?i:s==="a"?i.call(o):i?i.value:n.get(o)},br,Nw,sy,Mw,Lw,Bw,RI,Pw;const lT=10;class AI extends xI{constructor(){super(...arguments),br.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(n){var i;this._chatCompletions.push(n),this._emit("chatCompletion",n);const s=(i=n.choices[0])==null?void 0:i.message;return s&&this._addMessage(s),n}_addMessage(n,s=!0){if("content"in n||(n.content=null),this.messages.push(n),s){if(this._emit("message",n),(EI(n)||kI(n))&&n.content)this._emit("functionCallResult",n.content);else if(Qh(n)&&n.function_call)this._emit("functionCall",n.function_call);else if(Qh(n)&&n.tool_calls)for(const i of n.tool_calls)i.type==="function"&&this._emit("functionCall",i.function)}}async finalChatCompletion(){await this.done();const n=this._chatCompletions[this._chatCompletions.length-1];if(!n)throw new Qt("stream ended without producing a ChatCompletion");return n}async finalContent(){return await this.done(),Xr(this,br,"m",Nw).call(this)}async finalMessage(){return await this.done(),Xr(this,br,"m",sy).call(this)}async finalFunctionCall(){return await this.done(),Xr(this,br,"m",Mw).call(this)}async finalFunctionCallResult(){return await this.done(),Xr(this,br,"m",Lw).call(this)}async totalUsage(){return await this.done(),Xr(this,br,"m",Bw).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const n=this._chatCompletions[this._chatCompletions.length-1];n&&this._emit("finalChatCompletion",n);const s=Xr(this,br,"m",sy).call(this);s&&this._emit("finalMessage",s);const i=Xr(this,br,"m",Nw).call(this);i&&this._emit("finalContent",i);const a=Xr(this,br,"m",Mw).call(this);a&&this._emit("finalFunctionCall",a);const c=Xr(this,br,"m",Lw).call(this);c!=null&&this._emit("finalFunctionCallResult",c),this._chatCompletions.some(h=>h.usage)&&this._emit("totalUsage",Xr(this,br,"m",Bw).call(this))}async _createChatCompletion(n,s,i){const a=i==null?void 0:i.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort())),Xr(this,br,"m",RI).call(this,s);const c=await n.chat.completions.create({...s,stream:!1},{...i,signal:this.controller.signal});return this._connected(),this._addChatCompletion(TS(c,s))}async _runChatCompletion(n,s,i){for(const a of s.messages)this._addMessage(a,!1);return await this._createChatCompletion(n,s,i)}async _runFunctions(n,s,i){var C;const a="function",{function_call:c="auto",stream:h,...g}=s,b=typeof c!="string"&&(c==null?void 0:c.name),{maxChatCompletions:$=lT}=i||{},y={};for(const S of s.functions)y[S.name||S.function.name]=S;const w=s.functions.map(S=>({name:S.name||S.function.name,parameters:S.parameters,description:S.description}));for(const S of s.messages)this._addMessage(S,!1);for(let S=0;S<$;++S){const E=(C=(await this._createChatCompletion(n,{...g,function_call:c,functions:w,messages:[...this.messages]},i)).choices[0])==null?void 0:C.message;if(!E)throw new Qt("missing message in ChatCompletion response");if(!E.function_call)return;const{name:R,arguments:F}=E.function_call,M=y[R];if(M){if(b&&b!==R){const K=`Invalid function_call: ${JSON.stringify(R)}. ${JSON.stringify(b)} requested. Please try again`;this._addMessage({role:a,name:R,content:K});continue}}else{const K=`Invalid function_call: ${JSON.stringify(R)}. Available options are: ${w.map(Y=>JSON.stringify(Y.name)).join(", ")}. Please try again`;this._addMessage({role:a,name:R,content:K});continue}let L;try{L=aT(M)?await M.parse(F):F}catch(K){this._addMessage({role:a,name:R,content:K instanceof Error?K.message:String(K)});continue}const T=await M.function(L,this),V=Xr(this,br,"m",Pw).call(this,T);if(this._addMessage({role:a,name:R,content:V}),b)return}}async _runTools(n,s,i){var S,k,E;const a="tool",{tool_choice:c="auto",stream:h,...g}=s,b=typeof c!="string"&&((S=c==null?void 0:c.function)==null?void 0:S.name),{maxChatCompletions:$=lT}=i||{},y=s.tools.map(R=>{if(Im(R)){if(!R.$callback)throw new Qt("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:R.$callback,name:R.function.name,description:R.function.description||"",parameters:R.function.parameters,parse:R.$parseRaw,strict:!0}}}return R}),w={};for(const R of y)R.type==="function"&&(w[R.function.name||R.function.function.name]=R.function);const C="tools"in s?y.map(R=>R.type==="function"?{type:"function",function:{name:R.function.name||R.function.function.name,parameters:R.function.parameters,description:R.function.description,strict:R.function.strict}}:R):void 0;for(const R of s.messages)this._addMessage(R,!1);for(let R=0;R<$;++R){const M=(k=(await this._createChatCompletion(n,{...g,tool_choice:c,tools:C,messages:[...this.messages]},i)).choices[0])==null?void 0:k.message;if(!M)throw new Qt("missing message in ChatCompletion response");if(!((E=M.tool_calls)!=null&&E.length))return;for(const L of M.tool_calls){if(L.type!=="function")continue;const T=L.id,{name:V,arguments:K}=L.function,Y=w[V];if(Y){if(b&&b!==V){const Q=`Invalid tool_call: ${JSON.stringify(V)}. ${JSON.stringify(b)} requested. Please try again`;this._addMessage({role:a,tool_call_id:T,content:Q});continue}}else{const Q=`Invalid tool_call: ${JSON.stringify(V)}. Available options are: ${Object.keys(w).map(he=>JSON.stringify(he)).join(", ")}. Please try again`;this._addMessage({role:a,tool_call_id:T,content:Q});continue}let te;try{te=aT(Y)?await Y.parse(K):K}catch(Q){const he=Q instanceof Error?Q.message:String(Q);this._addMessage({role:a,tool_call_id:T,content:he});continue}const J=await Y.function(te,this),ne=Xr(this,br,"m",Pw).call(this,J);if(this._addMessage({role:a,tool_call_id:T,content:ne}),b)return}}}}br=new WeakSet,Nw=function(){return Xr(this,br,"m",sy).call(this).content??null},sy=function(){let n=this.messages.length;for(;n-- >0;){const s=this.messages[n];if(Qh(s)){const{function_call:i,...a}=s,c={...a,content:s.content??null,refusal:s.refusal??null};return i&&(c.function_call=i),c}}throw new Qt("stream ended without producing a ChatCompletionMessage with role=assistant")},Mw=function(){var n,s;for(let i=this.messages.length-1;i>=0;i--){const a=this.messages[i];if(Qh(a)&&(a!=null&&a.function_call))return a.function_call;if(Qh(a)&&((n=a==null?void 0:a.tool_calls)!=null&&n.length))return(s=a.tool_calls.at(-1))==null?void 0:s.function}},Lw=function(){for(let n=this.messages.length-1;n>=0;n--){const s=this.messages[n];if(EI(s)&&s.content!=null||kI(s)&&s.content!=null&&typeof s.content=="string"&&this.messages.some(i=>{var a;return i.role==="assistant"&&((a=i.tool_calls)==null?void 0:a.some(c=>c.type==="function"&&c.id===s.tool_call_id))}))return s.content}},Bw=function(){const n={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:s}of this._chatCompletions)s&&(n.completion_tokens+=s.completion_tokens,n.prompt_tokens+=s.prompt_tokens,n.total_tokens+=s.total_tokens);return n},RI=function(n){if(n.n!=null&&n.n>1)throw new Qt("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},Pw=function(n){return typeof n=="string"?n:n===void 0?"undefined":JSON.stringify(n)};class hm extends AI{static runFunctions(n,s,i){const a=new hm,c={...i,headers:{...i==null?void 0:i.headers,"X-Stainless-Helper-Method":"runFunctions"}};return a._run(()=>a._runFunctions(n,s,c)),a}static runTools(n,s,i){const a=new hm,c={...i,headers:{...i==null?void 0:i.headers,"X-Stainless-Helper-Method":"runTools"}};return a._run(()=>a._runTools(n,s,c)),a}_addMessage(n,s=!0){super._addMessage(n,s),Qh(n)&&n.content&&this._emit("content",n.content)}}const NI=1,MI=2,LI=4,BI=8,PI=16,FI=32,jI=64,zI=128,UI=256,HI=zI|UI,WI=PI|FI|HI|jI,VI=NI|MI|WI,GI=LI|BI,A2=VI|GI,Bs={STR:NI,NUM:MI,ARR:LI,OBJ:BI,NULL:PI,BOOL:FI,NAN:jI,INFINITY:zI,MINUS_INFINITY:UI,INF:HI,SPECIAL:WI,ATOM:VI,COLLECTION:GI,ALL:A2};class N2 extends Error{}class M2 extends Error{}function L2(o,n=Bs.ALL){if(typeof o!="string")throw new TypeError(`expecting str, got ${typeof o}`);if(!o.trim())throw new Error(`${o} is empty`);return B2(o.trim(),n)}const B2=(o,n)=>{const s=o.length;let i=0;const a=C=>{throw new N2(`${C} at position ${i}`)},c=C=>{throw new M2(`${C} at position ${i}`)},h=()=>(w(),i>=s&&a("Unexpected end of input"),o[i]==='"'?g():o[i]==="{"?b():o[i]==="["?$():o.substring(i,i+4)==="null"||Bs.NULL&n&&s-i<4&&"null".startsWith(o.substring(i))?(i+=4,null):o.substring(i,i+4)==="true"||Bs.BOOL&n&&s-i<4&&"true".startsWith(o.substring(i))?(i+=4,!0):o.substring(i,i+5)==="false"||Bs.BOOL&n&&s-i<5&&"false".startsWith(o.substring(i))?(i+=5,!1):o.substring(i,i+8)==="Infinity"||Bs.INFINITY&n&&s-i<8&&"Infinity".startsWith(o.substring(i))?(i+=8,1/0):o.substring(i,i+9)==="-Infinity"||Bs.MINUS_INFINITY&n&&1<s-i&&s-i<9&&"-Infinity".startsWith(o.substring(i))?(i+=9,-1/0):o.substring(i,i+3)==="NaN"||Bs.NAN&n&&s-i<3&&"NaN".startsWith(o.substring(i))?(i+=3,NaN):y()),g=()=>{const C=i;let S=!1;for(i++;i<s&&(o[i]!=='"'||S&&o[i-1]==="\\");)S=o[i]==="\\"?!S:!1,i++;if(o.charAt(i)=='"')try{return JSON.parse(o.substring(C,++i-Number(S)))}catch(k){c(String(k))}else if(Bs.STR&n)try{return JSON.parse(o.substring(C,i-Number(S))+'"')}catch{return JSON.parse(o.substring(C,o.lastIndexOf("\\"))+'"')}a("Unterminated string literal")},b=()=>{i++,w();const C={};try{for(;o[i]!=="}";){if(w(),i>=s&&Bs.OBJ&n)return C;const S=g();w(),i++;try{const k=h();Object.defineProperty(C,S,{value:k,writable:!0,enumerable:!0,configurable:!0})}catch(k){if(Bs.OBJ&n)return C;throw k}w(),o[i]===","&&i++}}catch{if(Bs.OBJ&n)return C;a("Expected '}' at end of object")}return i++,C},$=()=>{i++;const C=[];try{for(;o[i]!=="]";)C.push(h()),w(),o[i]===","&&i++}catch{if(Bs.ARR&n)return C;a("Expected ']' at end of array")}return i++,C},y=()=>{if(i===0){o==="-"&&Bs.NUM&n&&a("Not sure what '-' is");try{return JSON.parse(o)}catch(S){if(Bs.NUM&n)try{return o[o.length-1]==="."?JSON.parse(o.substring(0,o.lastIndexOf("."))):JSON.parse(o.substring(0,o.lastIndexOf("e")))}catch{}c(String(S))}}const C=i;for(o[i]==="-"&&i++;o[i]&&!",]}".includes(o[i]);)i++;i==s&&!(Bs.NUM&n)&&a("Unterminated number literal");try{return JSON.parse(o.substring(C,i))}catch{o.substring(C,i)==="-"&&Bs.NUM&n&&a("Not sure what '-' is");try{return JSON.parse(o.substring(C,o.lastIndexOf("e")))}catch(k){c(String(k))}}},w=()=>{for(;i<s&&` 
\r	`.includes(o[i]);)i++};return h()},cT=o=>L2(o,Bs.ALL^Bs.NUM);var Lh=function(o,n,s,i,a){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof n=="function"?o!==n||!a:!n.has(o))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?a.call(o,s):a?a.value=s:n.set(o,s),s},Rn=function(o,n,s,i){if(s==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof n=="function"?o!==n||!i:!n.has(o))throw new TypeError("Cannot read private member from an object whose class did not declare it");return s==="m"?i:s==="a"?i.call(o):i?i.value:n.get(o)},Es,tl,Bh,ac,F_,sv,j_,z_,U_,rv,H_,uT;class pm extends AI{constructor(n){super(),Es.add(this),tl.set(this,void 0),Bh.set(this,void 0),ac.set(this,void 0),Lh(this,tl,n,"f"),Lh(this,Bh,[],"f")}get currentChatCompletionSnapshot(){return Rn(this,ac,"f")}static fromReadableStream(n){const s=new pm(null);return s._run(()=>s._fromReadableStream(n)),s}static createChatCompletion(n,s,i){const a=new pm(s);return a._run(()=>a._runChatCompletion(n,{...s,stream:!0},{...i,headers:{...i==null?void 0:i.headers,"X-Stainless-Helper-Method":"stream"}})),a}async _createChatCompletion(n,s,i){var h;super._createChatCompletion;const a=i==null?void 0:i.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort())),Rn(this,Es,"m",F_).call(this);const c=await n.chat.completions.create({...s,stream:!0},{...i,signal:this.controller.signal});this._connected();for await(const g of c)Rn(this,Es,"m",j_).call(this,g);if((h=c.controller.signal)!=null&&h.aborted)throw new $o;return this._addChatCompletion(Rn(this,Es,"m",rv).call(this))}async _fromReadableStream(n,s){var h;const i=s==null?void 0:s.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort())),Rn(this,Es,"m",F_).call(this),this._connected();const a=oa.fromReadableStream(n,this.controller);let c;for await(const g of a)c&&c!==g.id&&this._addChatCompletion(Rn(this,Es,"m",rv).call(this)),Rn(this,Es,"m",j_).call(this,g),c=g.id;if((h=a.controller.signal)!=null&&h.aborted)throw new $o;return this._addChatCompletion(Rn(this,Es,"m",rv).call(this))}[(tl=new WeakMap,Bh=new WeakMap,ac=new WeakMap,Es=new WeakSet,F_=function(){this.ended||Lh(this,ac,void 0,"f")},sv=function(s){let i=Rn(this,Bh,"f")[s.index];return i||(i={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},Rn(this,Bh,"f")[s.index]=i,i)},j_=function(s){var a,c,h,g,b,$,y,w,C,S,k,E,R,F,M;if(this.ended)return;const i=Rn(this,Es,"m",uT).call(this,s);this._emit("chunk",s,i);for(const L of s.choices){const T=i.choices[L.index];L.delta.content!=null&&((a=T.message)==null?void 0:a.role)==="assistant"&&((c=T.message)!=null&&c.content)&&(this._emit("content",L.delta.content,T.message.content),this._emit("content.delta",{delta:L.delta.content,snapshot:T.message.content,parsed:T.message.parsed})),L.delta.refusal!=null&&((h=T.message)==null?void 0:h.role)==="assistant"&&((g=T.message)!=null&&g.refusal)&&this._emit("refusal.delta",{delta:L.delta.refusal,snapshot:T.message.refusal}),((b=L.logprobs)==null?void 0:b.content)!=null&&(($=T.message)==null?void 0:$.role)==="assistant"&&this._emit("logprobs.content.delta",{content:(y=L.logprobs)==null?void 0:y.content,snapshot:((w=T.logprobs)==null?void 0:w.content)??[]}),((C=L.logprobs)==null?void 0:C.refusal)!=null&&((S=T.message)==null?void 0:S.role)==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:(k=L.logprobs)==null?void 0:k.refusal,snapshot:((E=T.logprobs)==null?void 0:E.refusal)??[]});const V=Rn(this,Es,"m",sv).call(this,T);T.finish_reason&&(Rn(this,Es,"m",U_).call(this,T),V.current_tool_call_index!=null&&Rn(this,Es,"m",z_).call(this,T,V.current_tool_call_index));for(const K of L.delta.tool_calls??[])V.current_tool_call_index!==K.index&&(Rn(this,Es,"m",U_).call(this,T),V.current_tool_call_index!=null&&Rn(this,Es,"m",z_).call(this,T,V.current_tool_call_index)),V.current_tool_call_index=K.index;for(const K of L.delta.tool_calls??[]){const Y=(R=T.message.tool_calls)==null?void 0:R[K.index];Y!=null&&Y.type&&((Y==null?void 0:Y.type)==="function"?this._emit("tool_calls.function.arguments.delta",{name:(F=Y.function)==null?void 0:F.name,index:K.index,arguments:Y.function.arguments,parsed_arguments:Y.function.parsed_arguments,arguments_delta:((M=K.function)==null?void 0:M.arguments)??""}):(Y==null||Y.type,void 0))}}},z_=function(s,i){var h,g,b;if(Rn(this,Es,"m",sv).call(this,s).done_tool_calls.has(i))return;const c=(h=s.message.tool_calls)==null?void 0:h[i];if(!c)throw new Error("no tool call snapshot");if(!c.type)throw new Error("tool call snapshot missing `type`");if(c.type==="function"){const $=(b=(g=Rn(this,tl,"f"))==null?void 0:g.tools)==null?void 0:b.find(y=>y.type==="function"&&y.function.name===c.function.name);this._emit("tool_calls.function.arguments.done",{name:c.function.name,index:i,arguments:c.function.arguments,parsed_arguments:Im($)?$.$parseRaw(c.function.arguments):$!=null&&$.function.strict?JSON.parse(c.function.arguments):null})}else c.type},U_=function(s){var a,c;const i=Rn(this,Es,"m",sv).call(this,s);if(s.message.content&&!i.content_done){i.content_done=!0;const h=Rn(this,Es,"m",H_).call(this);this._emit("content.done",{content:s.message.content,parsed:h?h.$parseRaw(s.message.content):null})}s.message.refusal&&!i.refusal_done&&(i.refusal_done=!0,this._emit("refusal.done",{refusal:s.message.refusal})),(a=s.logprobs)!=null&&a.content&&!i.logprobs_content_done&&(i.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:s.logprobs.content})),(c=s.logprobs)!=null&&c.refusal&&!i.logprobs_refusal_done&&(i.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:s.logprobs.refusal}))},rv=function(){if(this.ended)throw new Qt("stream has ended, this shouldn't happen");const s=Rn(this,ac,"f");if(!s)throw new Qt("request ended without sending any chunks");return Lh(this,ac,void 0,"f"),Lh(this,Bh,[],"f"),P2(s,Rn(this,tl,"f"))},H_=function(){var i;const s=(i=Rn(this,tl,"f"))==null?void 0:i.response_format;return DI(s)?s:null},uT=function(s){var i,a,c,h;let g=Rn(this,ac,"f");const{choices:b,...$}=s;g?Object.assign(g,$):g=Lh(this,ac,{...$,choices:[]},"f");for(const{delta:y,finish_reason:w,index:C,logprobs:S=null,...k}of s.choices){let E=g.choices[C];if(E||(E=g.choices[C]={finish_reason:w,index:C,message:{},logprobs:S,...k}),S)if(!E.logprobs)E.logprobs=Object.assign({},S);else{const{content:K,refusal:Y,...te}=S;Object.assign(E.logprobs,te),K&&((i=E.logprobs).content??(i.content=[]),E.logprobs.content.push(...K)),Y&&((a=E.logprobs).refusal??(a.refusal=[]),E.logprobs.refusal.push(...Y))}if(w&&(E.finish_reason=w,Rn(this,tl,"f")&&OI(Rn(this,tl,"f")))){if(w==="length")throw new dI;if(w==="content_filter")throw new hI}if(Object.assign(E,k),!y)continue;const{content:R,refusal:F,function_call:M,role:L,tool_calls:T,...V}=y;if(Object.assign(E.message,V),F&&(E.message.refusal=(E.message.refusal||"")+F),L&&(E.message.role=L),M&&(E.message.function_call?(M.name&&(E.message.function_call.name=M.name),M.arguments&&((c=E.message.function_call).arguments??(c.arguments=""),E.message.function_call.arguments+=M.arguments)):E.message.function_call=M),R&&(E.message.content=(E.message.content||"")+R,!E.message.refusal&&Rn(this,Es,"m",H_).call(this)&&(E.message.parsed=cT(E.message.content))),T){E.message.tool_calls||(E.message.tool_calls=[]);for(const{index:K,id:Y,type:te,function:J,...ne}of T){const Q=(h=E.message.tool_calls)[K]??(h[K]={});Object.assign(Q,ne),Y&&(Q.id=Y),te&&(Q.type=te),J&&(Q.function??(Q.function={name:J.name??"",arguments:""})),J!=null&&J.name&&(Q.function.name=J.name),J!=null&&J.arguments&&(Q.function.arguments+=J.arguments,O2(Rn(this,tl,"f"),Q)&&(Q.function.parsed_arguments=cT(Q.function.arguments)))}}}return g},Symbol.asyncIterator)](){const n=[],s=[];let i=!1;return this.on("chunk",a=>{const c=s.shift();c?c.resolve(a):n.push(a)}),this.on("end",()=>{i=!0;for(const a of s)a.resolve(void 0);s.length=0}),this.on("abort",a=>{i=!0;for(const c of s)c.reject(a);s.length=0}),this.on("error",a=>{i=!0;for(const c of s)c.reject(a);s.length=0}),{next:async()=>n.length?{value:n.shift(),done:!1}:i?{value:void 0,done:!0}:new Promise((c,h)=>s.push({resolve:c,reject:h})).then(c=>c?{value:c,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new oa(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function P2(o,n){const{id:s,choices:i,created:a,model:c,system_fingerprint:h,...g}=o,b={...g,id:s,choices:i.map(({message:$,finish_reason:y,index:w,logprobs:C,...S})=>{if(!y)throw new Qt(`missing finish_reason for choice ${w}`);const{content:k=null,function_call:E,tool_calls:R,...F}=$,M=$.role;if(!M)throw new Qt(`missing role for choice ${w}`);if(E){const{arguments:L,name:T}=E;if(L==null)throw new Qt(`missing function_call.arguments for choice ${w}`);if(!T)throw new Qt(`missing function_call.name for choice ${w}`);return{...S,message:{content:k,function_call:{arguments:L,name:T},role:M,refusal:$.refusal??null},finish_reason:y,index:w,logprobs:C}}return R?{...S,index:w,finish_reason:y,logprobs:C,message:{...F,role:M,content:k,refusal:$.refusal??null,tool_calls:R.map((L,T)=>{const{function:V,type:K,id:Y,...te}=L,{arguments:J,name:ne,...Q}=V||{};if(Y==null)throw new Qt(`missing choices[${w}].tool_calls[${T}].id
${iv(o)}`);if(K==null)throw new Qt(`missing choices[${w}].tool_calls[${T}].type
${iv(o)}`);if(ne==null)throw new Qt(`missing choices[${w}].tool_calls[${T}].function.name
${iv(o)}`);if(J==null)throw new Qt(`missing choices[${w}].tool_calls[${T}].function.arguments
${iv(o)}`);return{...te,id:Y,type:K,function:{...Q,name:ne,arguments:J}}})}}:{...S,message:{...F,content:k,role:M,refusal:$.refusal??null},finish_reason:y,index:w,logprobs:C}}),created:a,model:c,object:"chat.completion",...h?{system_fingerprint:h}:{}};return I2(b,n)}function iv(o){return JSON.stringify(o)}class ep extends pm{static fromReadableStream(n){const s=new ep(null);return s._run(()=>s._fromReadableStream(n)),s}static runFunctions(n,s,i){const a=new ep(null),c={...i,headers:{...i==null?void 0:i.headers,"X-Stainless-Helper-Method":"runFunctions"}};return a._run(()=>a._runFunctions(n,s,c)),a}static runTools(n,s,i){const a=new ep(s),c={...i,headers:{...i==null?void 0:i.headers,"X-Stainless-Helper-Method":"runTools"}};return a._run(()=>a._runTools(n,s,c)),a}}let qI=class extends Cn{parse(n,s){return R2(n.tools),this._client.chat.completions.create(n,{...s,headers:{...s==null?void 0:s.headers,"X-Stainless-Helper-Method":"beta.chat.completions.parse"}})._thenUnwrap(i=>TS(i,n))}runFunctions(n,s){return n.stream?ep.runFunctions(this._client,n,s):hm.runFunctions(this._client,n,s)}runTools(n,s){return n.stream?ep.runTools(this._client,n,s):hm.runTools(this._client,n,s)}stream(n,s){return pm.createChatCompletion(this._client,n,s)}};class KI extends Cn{constructor(){super(...arguments),this.completions=new qI(this._client)}}(function(o){o.Completions=qI})(KI);var ct=function(o,n,s,i){if(s==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof n=="function"?o!==n||!i:!n.has(o))throw new TypeError("Cannot read private member from an object whose class did not declare it");return s==="m"?i:s==="a"?i.call(o):i?i.value:n.get(o)},hi=function(o,n,s,i,a){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof n=="function"?o!==n||!a:!n.has(o))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?a.call(o,s):a?a.value=s:n.set(o,s),s},Js,Fw,ra,_v,bo,Ru,Vh,Du,ry,pi,wv,Sv,rm,Jf,Yf,dT,hT,pT,gT,fT,mT,bT;class vo extends xI{constructor(){super(...arguments),Js.add(this),Fw.set(this,[]),ra.set(this,{}),_v.set(this,{}),bo.set(this,void 0),Ru.set(this,void 0),Vh.set(this,void 0),Du.set(this,void 0),ry.set(this,void 0),pi.set(this,void 0),wv.set(this,void 0),Sv.set(this,void 0),rm.set(this,void 0)}[(Fw=new WeakMap,ra=new WeakMap,_v=new WeakMap,bo=new WeakMap,Ru=new WeakMap,Vh=new WeakMap,Du=new WeakMap,ry=new WeakMap,pi=new WeakMap,wv=new WeakMap,Sv=new WeakMap,rm=new WeakMap,Js=new WeakSet,Symbol.asyncIterator)](){const n=[],s=[];let i=!1;return this.on("event",a=>{const c=s.shift();c?c.resolve(a):n.push(a)}),this.on("end",()=>{i=!0;for(const a of s)a.resolve(void 0);s.length=0}),this.on("abort",a=>{i=!0;for(const c of s)c.reject(a);s.length=0}),this.on("error",a=>{i=!0;for(const c of s)c.reject(a);s.length=0}),{next:async()=>n.length?{value:n.shift(),done:!1}:i?{value:void 0,done:!0}:new Promise((c,h)=>s.push({resolve:c,reject:h})).then(c=>c?{value:c,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(n){const s=new vo;return s._run(()=>s._fromReadableStream(n)),s}async _fromReadableStream(n,s){var c;const i=s==null?void 0:s.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort())),this._connected();const a=oa.fromReadableStream(n,this.controller);for await(const h of a)ct(this,Js,"m",Jf).call(this,h);if((c=a.controller.signal)!=null&&c.aborted)throw new $o;return this._addRun(ct(this,Js,"m",Yf).call(this))}toReadableStream(){return new oa(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(n,s,i,a,c){const h=new vo;return h._run(()=>h._runToolAssistantStream(n,s,i,a,{...c,headers:{...c==null?void 0:c.headers,"X-Stainless-Helper-Method":"stream"}})),h}async _createToolAssistantStream(n,s,i,a,c){var $;const h=c==null?void 0:c.signal;h&&(h.aborted&&this.controller.abort(),h.addEventListener("abort",()=>this.controller.abort()));const g={...a,stream:!0},b=await n.submitToolOutputs(s,i,g,{...c,signal:this.controller.signal});this._connected();for await(const y of b)ct(this,Js,"m",Jf).call(this,y);if(($=b.controller.signal)!=null&&$.aborted)throw new $o;return this._addRun(ct(this,Js,"m",Yf).call(this))}static createThreadAssistantStream(n,s,i){const a=new vo;return a._run(()=>a._threadAssistantStream(n,s,{...i,headers:{...i==null?void 0:i.headers,"X-Stainless-Helper-Method":"stream"}})),a}static createAssistantStream(n,s,i,a){const c=new vo;return c._run(()=>c._runAssistantStream(n,s,i,{...a,headers:{...a==null?void 0:a.headers,"X-Stainless-Helper-Method":"stream"}})),c}currentEvent(){return ct(this,wv,"f")}currentRun(){return ct(this,Sv,"f")}currentMessageSnapshot(){return ct(this,bo,"f")}currentRunStepSnapshot(){return ct(this,rm,"f")}async finalRunSteps(){return await this.done(),Object.values(ct(this,ra,"f"))}async finalMessages(){return await this.done(),Object.values(ct(this,_v,"f"))}async finalRun(){if(await this.done(),!ct(this,Ru,"f"))throw Error("Final run was not received.");return ct(this,Ru,"f")}async _createThreadAssistantStream(n,s,i){var g;const a=i==null?void 0:i.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort()));const c={...s,stream:!0},h=await n.createAndRun(c,{...i,signal:this.controller.signal});this._connected();for await(const b of h)ct(this,Js,"m",Jf).call(this,b);if((g=h.controller.signal)!=null&&g.aborted)throw new $o;return this._addRun(ct(this,Js,"m",Yf).call(this))}async _createAssistantStream(n,s,i,a){var b;const c=a==null?void 0:a.signal;c&&(c.aborted&&this.controller.abort(),c.addEventListener("abort",()=>this.controller.abort()));const h={...i,stream:!0},g=await n.create(s,h,{...a,signal:this.controller.signal});this._connected();for await(const $ of g)ct(this,Js,"m",Jf).call(this,$);if((b=g.controller.signal)!=null&&b.aborted)throw new $o;return this._addRun(ct(this,Js,"m",Yf).call(this))}static accumulateDelta(n,s){for(const[i,a]of Object.entries(s)){if(!n.hasOwnProperty(i)){n[i]=a;continue}let c=n[i];if(c==null){n[i]=a;continue}if(i==="index"||i==="type"){n[i]=a;continue}if(typeof c=="string"&&typeof a=="string")c+=a;else if(typeof c=="number"&&typeof a=="number")c+=a;else if(P_(c)&&P_(a))c=this.accumulateDelta(c,a);else if(Array.isArray(c)&&Array.isArray(a)){if(c.every(h=>typeof h=="string"||typeof h=="number")){c.push(...a);continue}for(const h of a){if(!P_(h))throw new Error(`Expected array delta entry to be an object but got: ${h}`);const g=h.index;if(g==null)throw console.error(h),new Error("Expected array delta entry to have an `index` property");if(typeof g!="number")throw new Error(`Expected array delta entry \`index\` property to be a number but got ${g}`);const b=c[g];b==null?c.push(h):c[g]=this.accumulateDelta(b,h)}continue}else throw Error(`Unhandled record type: ${i}, deltaValue: ${a}, accValue: ${c}`);n[i]=c}return n}_addRun(n){return n}async _threadAssistantStream(n,s,i){return await this._createThreadAssistantStream(s,n,i)}async _runAssistantStream(n,s,i,a){return await this._createAssistantStream(s,n,i,a)}async _runToolAssistantStream(n,s,i,a,c){return await this._createToolAssistantStream(i,n,s,a,c)}}Jf=function(n){if(!this.ended)switch(hi(this,wv,n,"f"),ct(this,Js,"m",pT).call(this,n),n.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":ct(this,Js,"m",bT).call(this,n);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":ct(this,Js,"m",hT).call(this,n);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":ct(this,Js,"m",dT).call(this,n);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},Yf=function(){if(this.ended)throw new Qt("stream has ended, this shouldn't happen");if(!ct(this,Ru,"f"))throw Error("Final run has not been received");return ct(this,Ru,"f")},dT=function(n){const[s,i]=ct(this,Js,"m",fT).call(this,n,ct(this,bo,"f"));hi(this,bo,s,"f"),ct(this,_v,"f")[s.id]=s;for(const a of i){const c=s.content[a.index];(c==null?void 0:c.type)=="text"&&this._emit("textCreated",c.text)}switch(n.event){case"thread.message.created":this._emit("messageCreated",n.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",n.data.delta,s),n.data.delta.content)for(const a of n.data.delta.content){if(a.type=="text"&&a.text){let c=a.text,h=s.content[a.index];if(h&&h.type=="text")this._emit("textDelta",c,h.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(a.index!=ct(this,Vh,"f")){if(ct(this,Du,"f"))switch(ct(this,Du,"f").type){case"text":this._emit("textDone",ct(this,Du,"f").text,ct(this,bo,"f"));break;case"image_file":this._emit("imageFileDone",ct(this,Du,"f").image_file,ct(this,bo,"f"));break}hi(this,Vh,a.index,"f")}hi(this,Du,s.content[a.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(ct(this,Vh,"f")!==void 0){const a=n.data.content[ct(this,Vh,"f")];if(a)switch(a.type){case"image_file":this._emit("imageFileDone",a.image_file,ct(this,bo,"f"));break;case"text":this._emit("textDone",a.text,ct(this,bo,"f"));break}}ct(this,bo,"f")&&this._emit("messageDone",n.data),hi(this,bo,void 0,"f")}},hT=function(n){const s=ct(this,Js,"m",gT).call(this,n);switch(hi(this,rm,s,"f"),n.event){case"thread.run.step.created":this._emit("runStepCreated",n.data);break;case"thread.run.step.delta":const i=n.data.delta;if(i.step_details&&i.step_details.type=="tool_calls"&&i.step_details.tool_calls&&s.step_details.type=="tool_calls")for(const c of i.step_details.tool_calls)c.index==ct(this,ry,"f")?this._emit("toolCallDelta",c,s.step_details.tool_calls[c.index]):(ct(this,pi,"f")&&this._emit("toolCallDone",ct(this,pi,"f")),hi(this,ry,c.index,"f"),hi(this,pi,s.step_details.tool_calls[c.index],"f"),ct(this,pi,"f")&&this._emit("toolCallCreated",ct(this,pi,"f")));this._emit("runStepDelta",n.data.delta,s);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":hi(this,rm,void 0,"f"),n.data.step_details.type=="tool_calls"&&ct(this,pi,"f")&&(this._emit("toolCallDone",ct(this,pi,"f")),hi(this,pi,void 0,"f")),this._emit("runStepDone",n.data,s);break}},pT=function(n){ct(this,Fw,"f").push(n),this._emit("event",n)},gT=function(n){switch(n.event){case"thread.run.step.created":return ct(this,ra,"f")[n.data.id]=n.data,n.data;case"thread.run.step.delta":let s=ct(this,ra,"f")[n.data.id];if(!s)throw Error("Received a RunStepDelta before creation of a snapshot");let i=n.data;if(i.delta){const a=vo.accumulateDelta(s,i.delta);ct(this,ra,"f")[n.data.id]=a}return ct(this,ra,"f")[n.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":ct(this,ra,"f")[n.data.id]=n.data;break}if(ct(this,ra,"f")[n.data.id])return ct(this,ra,"f")[n.data.id];throw new Error("No snapshot available")},fT=function(n,s){let i=[];switch(n.event){case"thread.message.created":return[n.data,i];case"thread.message.delta":if(!s)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let a=n.data;if(a.delta.content)for(const c of a.delta.content)if(c.index in s.content){let h=s.content[c.index];s.content[c.index]=ct(this,Js,"m",mT).call(this,c,h)}else s.content[c.index]=c,i.push(c);return[s,i];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(s)return[s,i];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},mT=function(n,s){return vo.accumulateDelta(s,n)},bT=function(n){switch(hi(this,Sv,n.data,"f"),n.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":hi(this,Ru,n.data,"f"),ct(this,pi,"f")&&(this._emit("toolCallDone",ct(this,pi,"f")),hi(this,pi,void 0,"f"));break}};class ES extends Cn{create(n,s,i){return this._client.post(`/threads/${n}/messages`,{body:s,...i,headers:{"OpenAI-Beta":"assistants=v2",...i==null?void 0:i.headers}})}retrieve(n,s,i){return this._client.get(`/threads/${n}/messages/${s}`,{...i,headers:{"OpenAI-Beta":"assistants=v2",...i==null?void 0:i.headers}})}update(n,s,i,a){return this._client.post(`/threads/${n}/messages/${s}`,{body:i,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}list(n,s={},i){return ti(s)?this.list(n,{},s):this._client.getAPIList(`/threads/${n}/messages`,kS,{query:s,...i,headers:{"OpenAI-Beta":"assistants=v2",...i==null?void 0:i.headers}})}del(n,s,i){return this._client.delete(`/threads/${n}/messages/${s}`,{...i,headers:{"OpenAI-Beta":"assistants=v2",...i==null?void 0:i.headers}})}}class kS extends Co{}ES.MessagesPage=kS;class IS extends Cn{retrieve(n,s,i,a={},c){return ti(a)?this.retrieve(n,s,i,{},a):this._client.get(`/threads/${n}/runs/${s}/steps/${i}`,{query:a,...c,headers:{"OpenAI-Beta":"assistants=v2",...c==null?void 0:c.headers}})}list(n,s,i={},a){return ti(i)?this.list(n,s,{},i):this._client.getAPIList(`/threads/${n}/runs/${s}/steps`,xS,{query:i,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}}class xS extends Co{}IS.RunStepsPage=xS;class xm extends Cn{constructor(){super(...arguments),this.steps=new IS(this._client)}create(n,s,i){const{include:a,...c}=s;return this._client.post(`/threads/${n}/runs`,{query:{include:a},body:c,...i,headers:{"OpenAI-Beta":"assistants=v2",...i==null?void 0:i.headers},stream:s.stream??!1})}retrieve(n,s,i){return this._client.get(`/threads/${n}/runs/${s}`,{...i,headers:{"OpenAI-Beta":"assistants=v2",...i==null?void 0:i.headers}})}update(n,s,i,a){return this._client.post(`/threads/${n}/runs/${s}`,{body:i,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}list(n,s={},i){return ti(s)?this.list(n,{},s):this._client.getAPIList(`/threads/${n}/runs`,DS,{query:s,...i,headers:{"OpenAI-Beta":"assistants=v2",...i==null?void 0:i.headers}})}cancel(n,s,i){return this._client.post(`/threads/${n}/runs/${s}/cancel`,{...i,headers:{"OpenAI-Beta":"assistants=v2",...i==null?void 0:i.headers}})}async createAndPoll(n,s,i){const a=await this.create(n,s,i);return await this.poll(n,a.id,i)}createAndStream(n,s,i){return vo.createAssistantStream(n,this._client.beta.threads.runs,s,i)}async poll(n,s,i){const a={...i==null?void 0:i.headers,"X-Stainless-Poll-Helper":"true"};for(i!=null&&i.pollIntervalMs&&(a["X-Stainless-Custom-Poll-Interval"]=i.pollIntervalMs.toString());;){const{data:c,response:h}=await this.retrieve(n,s,{...i,headers:{...i==null?void 0:i.headers,...a}}).withResponse();switch(c.status){case"queued":case"in_progress":case"cancelling":let g=5e3;if(i!=null&&i.pollIntervalMs)g=i.pollIntervalMs;else{const b=h.headers.get("openai-poll-after-ms");if(b){const $=parseInt(b);isNaN($)||(g=$)}}await Em(g);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return c}}}stream(n,s,i){return vo.createAssistantStream(n,this._client.beta.threads.runs,s,i)}submitToolOutputs(n,s,i,a){return this._client.post(`/threads/${n}/runs/${s}/submit_tool_outputs`,{body:i,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers},stream:i.stream??!1})}async submitToolOutputsAndPoll(n,s,i,a){const c=await this.submitToolOutputs(n,s,i,a);return await this.poll(n,c.id,a)}submitToolOutputsStream(n,s,i,a){return vo.createToolAssistantStream(n,s,this._client.beta.threads.runs,i,a)}}class DS extends Co{}xm.RunsPage=DS;xm.Steps=IS;xm.RunStepsPage=xS;class up extends Cn{constructor(){super(...arguments),this.runs=new xm(this._client),this.messages=new ES(this._client)}create(n={},s){return ti(n)?this.create({},n):this._client.post("/threads",{body:n,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}retrieve(n,s){return this._client.get(`/threads/${n}`,{...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}update(n,s,i){return this._client.post(`/threads/${n}`,{body:s,...i,headers:{"OpenAI-Beta":"assistants=v2",...i==null?void 0:i.headers}})}del(n,s){return this._client.delete(`/threads/${n}`,{...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}createAndRun(n,s){return this._client.post("/threads/runs",{body:n,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers},stream:n.stream??!1})}async createAndRunPoll(n,s){const i=await this.createAndRun(n,s);return await this.runs.poll(i.thread_id,i.id,s)}createAndRunStream(n,s){return vo.createThreadAssistantStream(n,this._client.beta.threads,s)}}up.Runs=xm;up.RunsPage=DS;up.Messages=ES;up.MessagesPage=kS;const F2=async o=>{const n=await Promise.allSettled(o),s=n.filter(a=>a.status==="rejected");if(s.length){for(const a of s)console.error(a.reason);throw new Error(`${s.length} promise(s) failed - see the above errors`)}const i=[];for(const a of n)a.status==="fulfilled"&&i.push(a.value);return i};let OS=class extends Cn{create(n,s,i){return this._client.post(`/vector_stores/${n}/files`,{body:s,...i,headers:{"OpenAI-Beta":"assistants=v2",...i==null?void 0:i.headers}})}retrieve(n,s,i){return this._client.get(`/vector_stores/${n}/files/${s}`,{...i,headers:{"OpenAI-Beta":"assistants=v2",...i==null?void 0:i.headers}})}list(n,s={},i){return ti(s)?this.list(n,{},s):this._client.getAPIList(`/vector_stores/${n}/files`,ky,{query:s,...i,headers:{"OpenAI-Beta":"assistants=v2",...i==null?void 0:i.headers}})}del(n,s,i){return this._client.delete(`/vector_stores/${n}/files/${s}`,{...i,headers:{"OpenAI-Beta":"assistants=v2",...i==null?void 0:i.headers}})}async createAndPoll(n,s,i){const a=await this.create(n,s,i);return await this.poll(n,a.id,i)}async poll(n,s,i){const a={...i==null?void 0:i.headers,"X-Stainless-Poll-Helper":"true"};for(i!=null&&i.pollIntervalMs&&(a["X-Stainless-Custom-Poll-Interval"]=i.pollIntervalMs.toString());;){const c=await this.retrieve(n,s,{...i,headers:a}).withResponse(),h=c.data;switch(h.status){case"in_progress":let g=5e3;if(i!=null&&i.pollIntervalMs)g=i.pollIntervalMs;else{const b=c.response.headers.get("openai-poll-after-ms");if(b){const $=parseInt(b);isNaN($)||(g=$)}}await Em(g);break;case"failed":case"completed":return h}}}async upload(n,s,i){const a=await this._client.files.create({file:s,purpose:"assistants"},i);return this.create(n,{file_id:a.id},i)}async uploadAndPoll(n,s,i){const a=await this.upload(n,s,i);return await this.poll(n,a.id,i)}};class ky extends Co{}OS.VectorStoreFilesPage=ky;class JI extends Cn{create(n,s,i){return this._client.post(`/vector_stores/${n}/file_batches`,{body:s,...i,headers:{"OpenAI-Beta":"assistants=v2",...i==null?void 0:i.headers}})}retrieve(n,s,i){return this._client.get(`/vector_stores/${n}/file_batches/${s}`,{...i,headers:{"OpenAI-Beta":"assistants=v2",...i==null?void 0:i.headers}})}cancel(n,s,i){return this._client.post(`/vector_stores/${n}/file_batches/${s}/cancel`,{...i,headers:{"OpenAI-Beta":"assistants=v2",...i==null?void 0:i.headers}})}async createAndPoll(n,s,i){const a=await this.create(n,s);return await this.poll(n,a.id,i)}listFiles(n,s,i={},a){return ti(i)?this.listFiles(n,s,{},i):this._client.getAPIList(`/vector_stores/${n}/file_batches/${s}/files`,ky,{query:i,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}async poll(n,s,i){const a={...i==null?void 0:i.headers,"X-Stainless-Poll-Helper":"true"};for(i!=null&&i.pollIntervalMs&&(a["X-Stainless-Custom-Poll-Interval"]=i.pollIntervalMs.toString());;){const{data:c,response:h}=await this.retrieve(n,s,{...i,headers:a}).withResponse();switch(c.status){case"in_progress":let g=5e3;if(i!=null&&i.pollIntervalMs)g=i.pollIntervalMs;else{const b=h.headers.get("openai-poll-after-ms");if(b){const $=parseInt(b);isNaN($)||(g=$)}}await Em(g);break;case"failed":case"cancelled":case"completed":return c}}}async uploadAndPoll(n,{files:s,fileIds:i=[]},a){if(s==null||s.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const c=(a==null?void 0:a.maxConcurrency)??5,h=Math.min(c,s.length),g=this._client,b=s.values(),$=[...i];async function y(C){for(let S of C){const k=await g.files.create({file:S,purpose:"assistants"},a);$.push(k.id)}}const w=Array(h).fill(b).map(y);return await F2(w),await this.createAndPoll(n,{file_ids:$})}}class dp extends Cn{constructor(){super(...arguments),this.files=new OS(this._client),this.fileBatches=new JI(this._client)}create(n,s){return this._client.post("/vector_stores",{body:n,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}retrieve(n,s){return this._client.get(`/vector_stores/${n}`,{...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}update(n,s,i){return this._client.post(`/vector_stores/${n}`,{body:s,...i,headers:{"OpenAI-Beta":"assistants=v2",...i==null?void 0:i.headers}})}list(n={},s){return ti(n)?this.list({},n):this._client.getAPIList("/vector_stores",RS,{query:n,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}del(n,s){return this._client.delete(`/vector_stores/${n}`,{...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}}class RS extends Co{}dp.VectorStoresPage=RS;dp.Files=OS;dp.VectorStoreFilesPage=ky;dp.FileBatches=JI;class zu extends Cn{constructor(){super(...arguments),this.vectorStores=new dp(this._client),this.chat=new KI(this._client),this.assistants=new SS(this._client),this.threads=new up(this._client)}}zu.VectorStores=dp;zu.VectorStoresPage=RS;zu.Assistants=SS;zu.AssistantsPage=CS;zu.Threads=up;class YI extends Cn{create(n,s){return this._client.post("/completions",{body:n,...s,stream:n.stream??!1})}}class XI extends Cn{create(n,s){return this._client.post("/embeddings",{body:n,...s})}}class AS extends Cn{create(n,s){return this._client.post("/files",lp({body:n,...s}))}retrieve(n,s){return this._client.get(`/files/${n}`,s)}list(n={},s){return ti(n)?this.list({},n):this._client.getAPIList("/files",NS,{query:n,...s})}del(n,s){return this._client.delete(`/files/${n}`,s)}content(n,s){return this._client.get(`/files/${n}/content`,{...s,__binaryResponse:!0})}retrieveContent(n,s){return this._client.get(`/files/${n}/content`,{...s,headers:{Accept:"application/json",...s==null?void 0:s.headers}})}async waitForProcessing(n,{pollInterval:s=5e3,maxWait:i=30*60*1e3}={}){const a=new Set(["processed","error","deleted"]),c=Date.now();let h=await this.retrieve(n);for(;!h.status||!a.has(h.status);)if(await Em(s),h=await this.retrieve(n),Date.now()-c>i)throw new vS({message:`Giving up on waiting for file ${n} to finish processing after ${i} milliseconds.`});return h}}class NS extends Co{}AS.FileObjectsPage=NS;class MS extends Cn{list(n,s={},i){return ti(s)?this.list(n,{},s):this._client.getAPIList(`/fine_tuning/jobs/${n}/checkpoints`,LS,{query:s,...i})}}class LS extends Co{}MS.FineTuningJobCheckpointsPage=LS;class hp extends Cn{constructor(){super(...arguments),this.checkpoints=new MS(this._client)}create(n,s){return this._client.post("/fine_tuning/jobs",{body:n,...s})}retrieve(n,s){return this._client.get(`/fine_tuning/jobs/${n}`,s)}list(n={},s){return ti(n)?this.list({},n):this._client.getAPIList("/fine_tuning/jobs",BS,{query:n,...s})}cancel(n,s){return this._client.post(`/fine_tuning/jobs/${n}/cancel`,s)}listEvents(n,s={},i){return ti(s)?this.listEvents(n,{},s):this._client.getAPIList(`/fine_tuning/jobs/${n}/events`,PS,{query:s,...i})}}class BS extends Co{}class PS extends Co{}hp.FineTuningJobsPage=BS;hp.FineTuningJobEventsPage=PS;hp.Checkpoints=MS;hp.FineTuningJobCheckpointsPage=LS;class Dm extends Cn{constructor(){super(...arguments),this.jobs=new hp(this._client)}}Dm.Jobs=hp;Dm.FineTuningJobsPage=BS;Dm.FineTuningJobEventsPage=PS;class ZI extends Cn{createVariation(n,s){return this._client.post("/images/variations",lp({body:n,...s}))}edit(n,s){return this._client.post("/images/edits",lp({body:n,...s}))}generate(n,s){return this._client.post("/images/generations",{body:n,...s})}}class FS extends Cn{retrieve(n,s){return this._client.get(`/models/${n}`,s)}list(n){return this._client.getAPIList("/models",jS,n)}del(n,s){return this._client.delete(`/models/${n}`,s)}}class jS extends k2{}FS.ModelsPage=jS;class QI extends Cn{create(n,s){return this._client.post("/moderations",{body:n,...s})}}class ex extends Cn{create(n,s,i){return this._client.post(`/uploads/${n}/parts`,lp({body:s,...i}))}}class zS extends Cn{constructor(){super(...arguments),this.parts=new ex(this._client)}create(n,s){return this._client.post("/uploads",{body:n,...s})}cancel(n,s){return this._client.post(`/uploads/${n}/cancel`,s)}complete(n,s,i){return this._client.post(`/uploads/${n}/complete`,{body:s,...i})}}zS.Parts=ex;var tx;class cn extends g2{constructor({baseURL:n=nv("OPENAI_BASE_URL"),apiKey:s=nv("OPENAI_API_KEY"),organization:i=nv("OPENAI_ORG_ID")??null,project:a=nv("OPENAI_PROJECT_ID")??null,...c}={}){if(s===void 0)throw new Qt("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const h={apiKey:s,organization:i,project:a,...c,baseURL:n||"https://api.openai.com/v1"};if(!h.dangerouslyAllowBrowser&&T2())throw new Qt(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);super({baseURL:h.baseURL,timeout:h.timeout??6e5,httpAgent:h.httpAgent,maxRetries:h.maxRetries,fetch:h.fetch}),this.completions=new YI(this),this.chat=new yS(this),this.embeddings=new XI(this),this.files=new AS(this),this.images=new ZI(this),this.audio=new km(this),this.moderations=new QI(this),this.models=new FS(this),this.fineTuning=new Dm(this),this.beta=new zu(this),this.batches=new _S(this),this.uploads=new zS(this),this._options=h,this.apiKey=s,this.organization=i,this.project=a}defaultQuery(){return this._options.defaultQuery}defaultHeaders(n){return{...super.defaultHeaders(n),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project,...this._options.defaultHeaders}}authHeaders(n){return{Authorization:`Bearer ${this.apiKey}`}}stringifyQuery(n){return XP(n,{arrayFormat:"brackets"})}}tx=cn;cn.OpenAI=tx;cn.DEFAULT_TIMEOUT=6e5;cn.OpenAIError=Qt;cn.APIError=Ys;cn.APIConnectionError=Cy;cn.APIConnectionTimeoutError=vS;cn.APIUserAbortError=$o;cn.NotFoundError=oI;cn.ConflictError=aI;cn.RateLimitError=cI;cn.BadRequestError=sI;cn.AuthenticationError=rI;cn.InternalServerError=uI;cn.PermissionDeniedError=iI;cn.UnprocessableEntityError=lI;cn.toFile=mI;cn.fileFromPath=tI;cn.Completions=YI;cn.Chat=yS;cn.Embeddings=XI;cn.Files=AS;cn.FileObjectsPage=NS;cn.Images=ZI;cn.Audio=km;cn.Moderations=QI;cn.Models=FS;cn.ModelsPage=jS;cn.FineTuning=Dm;cn.Beta=zu;cn.Batches=_S;cn.BatchesPage=wS;cn.Uploads=zS;var US={},Iy={},fc={};Object.defineProperty(fc,"__esModule",{value:!0});fc.StateType=fc.Types=void 0;var $T;(function(o){o.unknown="unknown",o.airCondition="airCondition",o.blind="blind",o.blindButtons="blindButtons",o.button="button",o.buttonSensor="buttonSensor",o.camera="camera",o.chart="chart",o.cie="cie",o.ct="ct",o.dimmer="dimmer",o.door="door",o.fireAlarm="fireAlarm",o.floodAlarm="floodAlarm",o.gate="gate",o.hue="hue",o.humidity="humidity",o.illuminance="illuminance",o.image="image",o.info="info",o.instance="instance",o.light="light",o.location="location",o.lock="lock",o.media="media",o.motion="motion",o.rgb="rgb",o.rgbSingle="rgbSingle",o.rgbwSingle="rgbwSingle",o.slider="slider",o.socket="socket",o.temperature="temperature",o.thermostat="thermostat",o.vacuumCleaner="vacuumCleaner",o.volume="volume",o.volumeGroup="volumeGroup",o.warning="warning",o.weatherCurrent="weatherCurrent",o.weatherForecast="weatherForecast",o.window="window",o.windowTilt="windowTilt"})($T||(fc.Types=$T={}));var vT;(function(o){o.Number="number",o.String="string",o.Boolean="boolean"})(vT||(fc.StateType=vT={}));var Dr={};Object.defineProperty(Dr,"__esModule",{value:!0});Dr.checkEnum=nx;Dr.roleOrEnum=pp;Dr.roleOrEnumLight=j2;Dr.roleOrEnumBlind=z2;Dr.roleOrEnumGate=U2;Dr.roleOrEnumWindow=H2;Dr.roleOrEnumDoor=W2;Dr.getEnums=V2;Dr.getAllStatesInChannel=G2;Dr.getAllStatesInDevice=q2;Dr.getFunctionEnums=K2;Dr.getParentId=J2;function nx(o,n){let s=!1;return o&&o.forEach(i=>{const a=i.lastIndexOf(".");a!==-1&&(i=i.substring(a+1));for(const c in n)if(Object.prototype.hasOwnProperty.call(n,c)&&n[c].find(h=>h.test(i)))return s=!0,!1}),s}function pp(o,n,s,i){return s&&o.common.role&&s.includes(o.common.role)?!0:nx(n,i)}const sx={en:[/lights?/i,/lamps?/i,/ceilings?/i],de:[/licht(er)?/i,/lampen?/i,/beleuchtung(en)?/i],ru:[/свет/i,/ламп[аы]/i,/торшеры?/,/подсветк[аи]/i,/лампочк[аи]/i,/светильники?/i]},rx=["switch.light","dimmer","value.dimmer","level.dimmer","sensor.light","state.light"];function j2(o,n){return pp(o,n,rx,sx)}const iy={en:[/blinds?/i,/windows?/i,/shutters?/i],de:[/rollladen?/i,/fenstern?/i,/beschattung(en)?/i,/jalousien?/i],ru:[/ставни/i,/рольставни/i,/окна|окно/,/жалюзи/i]},ix=["blind","level.blind","value.blind","action.stop","button.stop","button.stop.blind","button.open.blind","button.close.blind","level.tilt","value.tilt","button.tilt.open","button.tilt.close","button.tilt.stop"];function z2(o,n){return pp(o,n,ix,iy)}const ox={en:[/gates?/i],de:[/^toren$/i,/^tor$/i],ru:[/ворота/i]},ax=["gate","value.gate","switch.gate","action.stop","button.stop"];function U2(o,n){return pp(o,n,ax,ox)}const lx=["window","state.window","sensor.window","value.window"];function H2(o,n){return pp(o,n,lx,iy)}const cx={en:[/doors?/i,/gates?/i,/wickets?/i,/entry|entries/i],de:[/^türe?/i,/^tuere?/i,/^tore?$/i,/einfahrt(en)?/i,/pforten?/i],ru:[/двери|дверь/i,/ворота/i,/калитка|калитки/,/въезды?/i,/входы?/i]},ux=["door","state.door","sensor.door"];function W2(o,n){return pp(o,n,ux,cx)}function V2(){return{door:{roles:ux,words:cx},window:{roles:lx,words:iy},blind:{roles:ix,words:iy},gate:{roles:ax,words:ox},light:{roles:rx,words:sx}}}function G2(o,n){const s=[],i=new RegExp(`^${n.replace(/([$^.)([\]{}])/g,"\\$1")}\\.[^.]+$`);return o.forEach(a=>i.test(a)&&s.push(a)),s}function q2(o,n){const s=[],i=new RegExp(`^${n.replace(/([$^.)([\]{}])/g,"\\$1")}\\.[^.]+\\.[^.]+$`);return o.forEach(a=>i.test(a)&&s.push(a)),s}function K2(o){const n=[],s=/^enum\.functions\./;for(const i in o)Object.prototype.hasOwnProperty.call(o,i)&&s.test(i)&&o[i]&&o[i].type==="enum"&&o[i].common&&o[i].common.members&&o[i].common.members.length&&n.push(i);return n}function J2(o){const n=o.lastIndexOf(".");return n!==-1?o.substring(0,n):o}var xy={};Object.defineProperty(xy,"__esModule",{value:!0});xy.patterns=void 0;const P=fc,mn=Dr,se={working:{role:/^indicator\.working$/,indicator:!0,notSingle:!0,name:"WORKING",required:!1,defaultRole:"indicator.working",defaultType:P.StateType.Boolean},unreach:{role:/^indicator(\.maintenance)?\.unreach$/,indicator:!0,type:P.StateType.Boolean,notSingle:!0,name:"UNREACH",required:!1,defaultRole:"indicator.maintenance.unreach"},lowbat:{role:/^indicator(\.maintenance)?\.lowbat$|^indicator(\.maintenance)?\.battery$/,indicator:!0,type:P.StateType.Boolean,notSingle:!0,name:"LOWBAT",required:!1,defaultRole:"indicator.maintenance.lowbat"},maintain:{role:/^indicator\.maintenance$/,indicator:!0,type:P.StateType.Boolean,notSingle:!0,name:"MAINTAIN",required:!1,defaultRole:"indicator.maintenance"},error:{role:/^indicator\.error$/,indicator:!0,notSingle:!0,name:"ERROR",required:!1,defaultRole:"indicator.error",defaultType:P.StateType.String},direction:{role:/^indicator\.direction$/,indicator:!0,notSingle:!0,name:"DIRECTION",required:!1,defaultRole:"indicator.direction"},reachable:{role:/^indicator\.reachable$/,indicator:!0,type:P.StateType.Boolean,notSingle:!0,name:"CONNECTED",required:!1,defaultRole:"indicator.reachable",inverted:!0},battery:{role:/^value\.battery$/,indicator:!1,type:P.StateType.Number,write:!1,name:"BATTERY",required:!1,defaultRole:"value.battery",defaultUnit:"%"}},na={power:{role:/^value\.power$/,indicator:!1,type:P.StateType.Number,write:!1,name:"ELECTRIC_POWER",required:!1,defaultRole:"value.power",defaultUnit:"W"},current:{role:/^value\.current$/,indicator:!1,type:P.StateType.Number,write:!1,name:"CURRENT",required:!1,defaultRole:"value.current",defaultUnit:"mA"},voltage:{role:/^value\.voltage$/,indicator:!1,type:P.StateType.Number,write:!1,name:"VOLTAGE",required:!1,defaultRole:"value.voltage",defaultUnit:"V"},consumption:{role:/^value\.power\.consumption$/,indicator:!1,type:P.StateType.Number,write:!1,name:"CONSUMPTION",required:!1,defaultRole:"value.power.consumption",defaultUnit:"Wh"},frequency:{role:/^value\.frequency$/,indicator:!1,type:P.StateType.Number,write:!1,name:"FREQUENCY",required:!1,defaultRole:"value.frequency",defaultUnit:"Hz"}};xy.patterns={chart:{states:[{objectType:"chart",name:"CHART"}],type:P.Types.chart},mediaPlayer:{states:[{role:/^media.state(\..*)?$/,indicator:!1,type:[P.StateType.Boolean,P.StateType.Number],name:"STATE",required:!0,defaultRole:"media.state"},{role:/^button.play(\..*)?$|^action.play(\..*)?$/,indicator:!1,write:!0,type:P.StateType.Boolean,name:"PLAY",required:!1,noSubscribe:!0,defaultRole:"button.play"},{role:/^button.pause(\..*)?$|^action.pause(\..*)?$/,indicator:!1,write:!0,type:P.StateType.Boolean,name:"PAUSE",required:!1,noSubscribe:!0,defaultRole:"button.pause"},{role:/^button.stop(\..*)?$|^action.stop(\..*)?$/,indicator:!1,write:!0,type:P.StateType.Boolean,name:"STOP",required:!1,noSubscribe:!0,defaultRole:"button.stop"},{role:/^button.next(\..*)?$|^action.next(\..*)?$/,indicator:!1,write:!0,type:P.StateType.Boolean,name:"NEXT",required:!1,noSubscribe:!0,defaultRole:"button.next"},{role:/^button.prev(\..*)?$|^action.prev(\..*)?$/,indicator:!1,write:!0,type:P.StateType.Boolean,name:"PREV",required:!1,noSubscribe:!0,defaultRole:"button.prev"},{role:/^media.mode.shuffle(\..*)?$/,indicator:!1,write:!0,type:P.StateType.Boolean,name:"SHUFFLE",required:!1,noSubscribe:!0,defaultRole:"media.mode.shuffle"},{role:/^media.mode.repeat(\..*)?$/,indicator:!1,write:!0,type:P.StateType.Number,name:"REPEAT",required:!1,noSubscribe:!0,defaultRole:"media.mode.repeat"},{role:/^media.artist(\..*)?$/,indicator:!1,write:!1,type:P.StateType.String,name:"ARTIST",required:!1,defaultRole:"media.artist"},{role:/^media.album(\..*)?$/,indicator:!1,write:!1,type:P.StateType.String,name:"ALBUM",required:!1,defaultRole:"media.album"},{role:/^media.title(\..*)?$/,indicator:!1,write:!1,type:P.StateType.String,name:"TITLE",required:!1,defaultRole:"media.title"},{role:/^media.cover$|^media.cover.big$/,indicator:!1,write:!1,type:P.StateType.String,name:"COVER",required:!1,notSingle:!0,defaultRole:"media.cover"},{role:/^media.cover(\..*)$/,indicator:!1,write:!1,type:P.StateType.String,name:"COVER",required:!1,notSingle:!0},{role:/^media.duration(\..*)?$/,indicator:!1,write:!1,type:P.StateType.Number,name:"DURATION",required:!1,noSubscribe:!0,defaultRole:"media.duration",defaultUnit:"sec"},{role:/^media.elapsed(\..*)?$/,indicator:!1,type:P.StateType.Number,name:"ELAPSED",required:!1,noSubscribe:!0,defaultRole:"media.elapsed",defaultUnit:"sec"},{role:/^media.seek(\..*)?$/,indicator:!1,write:!0,type:P.StateType.Number,name:"SEEK",required:!1,noSubscribe:!0,defaultRole:"media.seek"},{role:/^media.track(\..*)?$/,indicator:!1,type:P.StateType.String,name:"TRACK",required:!1,noSubscribe:!0,defaultRole:"media.track"},{role:/^media.episode(\..*)?$/,indicator:!1,type:P.StateType.String,name:"EPISODE",required:!1,noSubscribe:!0,defaultRole:"media.episode"},{role:/^media.season(\..*)?$/,indicator:!1,type:P.StateType.String,name:"SEASON",required:!1,noSubscribe:!0,defaultRole:"media.season"},{role:/^level.volume?$/,indicator:!1,type:P.StateType.Number,min:P.StateType.Number,max:P.StateType.Number,write:!0,name:"VOLUME",required:!1,notSingle:!0,noSubscribe:!0,defaultRole:"level.volume"},{role:/^value.volume?$/,indicator:!1,type:P.StateType.Number,min:P.StateType.Number,max:P.StateType.Number,write:!1,name:"VOLUME_ACTUAL",required:!1,notSingle:!0,noSubscribe:!0,defaultRole:"value.volume"},{role:/^media.mute?$/,indicator:!1,type:P.StateType.Boolean,write:!0,name:"MUTE",required:!1,notSingle:!0,noSubscribe:!0,defaultRole:"media.mute"},{stateName:/\.paused$|\.playerState$/,indicator:!1,name:"IGNORE",required:!1,multiple:!0,noSubscribe:!0},se.reachable,se.lowbat,se.maintain,se.error,se.battery],type:P.Types.media},weatherForecast:{states:[{role:/^weather.icon$|^weather.icon.forecast.0$/,indicator:!1,type:P.StateType.String,name:"ICON",required:!0,defaultRole:"weather.icon.forecast.0"},{role:/^value.temperature.min.forecast.0$/,indicator:!1,type:P.StateType.Number,name:"TEMP_MIN",required:!0,defaultRole:"value.temperature.min.forecast.0"},{role:/^value.temperature.max.forecast.0$/,indicator:!1,type:P.StateType.Number,name:"TEMP_MAX",required:!0,defaultRole:"value.temperature.max.forecast.0"},{role:/^value.precipitation$|^value.precipitation.forecast.0$/,indicator:!1,type:P.StateType.Number,name:"PRECIPITATION_CHANCE",unit:"%",required:!1,defaultRole:"value.precipitation.forecast.0"},{role:/^value.precipitation$|^value.precipitation.forecast.0$/,indicator:!1,type:P.StateType.Number,name:"PRECIPITATION",unit:"mm",required:!1,defaultRole:"value.precipitation.forecast.0"},{role:/^date$|^date.forecast.0$/,indicator:!1,type:P.StateType.String,name:"DATE",required:!1,defaultRole:"date.forecast.0"},{role:/^dayofweek$|^dayofweek.forecast.0$/,indicator:!1,type:P.StateType.String,name:"DOW",required:!1,defaultRole:"dayofweek.forecast.0"},{role:/^weather.state$|^weather.state.forecast.0$/,indicator:!1,type:P.StateType.String,name:"STATE",required:!1,defaultRole:"weather.state.forecast.0"},{role:/^value.temperature$|^value.temperature.forecast.0$/,indicator:!1,type:P.StateType.Number,name:"TEMP",required:!1,defaultRole:"value.temperature.forecast.0"},{role:/^value.pressure$/,indicator:!1,type:P.StateType.Number,name:"PRESSURE",required:!1,defaultRole:"weather.icon.forecast.0"},{role:/^value.humidity$|value.humidity.forecast.0$/,indicator:!1,type:P.StateType.Number,name:"HUMIDITY",required:!1,defaultRole:"value.humidity.forecast.0"},{role:/^(?:date|time).sunrise(?:.forecast\.0)?$/,indicator:!1,type:P.StateType.String,name:"TIME_SUNRISE",required:!1,defaultRole:"date.sunrise"},{role:/^(?:date|time).sunset(?:.forecast\.0)?$/,indicator:!1,type:P.StateType.String,name:"TIME_SUNSET",required:!1,defaultRole:"date.sunset"},{role:/^value.temperature.windchill$|^value.temperature.windchill.forecast.0$/,indicator:!1,type:P.StateType.Number,name:"WIND_CHILL",required:!1,defaultRole:"value.temperature.windchill.forecast.0"},{role:/^value.temperature.feelslike$|^value.temperature.feelslike.forecast.0$/,indicator:!1,type:P.StateType.Number,name:"FEELS_LIKE",required:!1,defaultRole:"value.temperature.feelslike.forecast.0"},{role:/^value.speed.wind$|^value.speed.wind.forecast.0$/,indicator:!1,type:P.StateType.Number,name:"WIND_SPEED",required:!1,defaultRole:"value.speed.wind.forecast.0"},{role:/^value.direction.wind$|^value.direction.wind.forecast.0$/,indicator:!1,type:P.StateType.Number,name:"WIND_DIRECTION",required:!1,defaultRole:"value.direction.wind.forecast.0"},{role:/^weather.direction.wind$|^weather.direction.wind.forecast.0$/,indicator:!1,type:P.StateType.String,name:"WIND_DIRECTION_STR",required:!1,defaultRole:"weather.direction.wind.forecast.0"},{role:/^weather.icon.wind$|^weather.icon.wind.forecast.0$/,indicator:!1,type:P.StateType.String,name:"WIND_ICON",required:!1,defaultRole:"weather.icon.wind.forecast.0"},{role:/^weather.chart.url$/,indicator:!1,type:P.StateType.String,name:"HISTORY_CHART",required:!1,noSubscribe:!0,defaultRole:"weather.chart.url"},{role:/^weather.chart.url.forecast$/,indicator:!1,type:P.StateType.String,name:"FORECAST_CHART",required:!1,noSubscribe:!0,defaultRole:"weather.chart.url.forecast"},{role:/^location$/,indicator:!1,type:P.StateType.String,name:"LOCATION",required:!1,defaultRole:"location"},{role:/^weather.icon.forecast.(\d)$/,indicator:!1,type:P.StateType.String,name:"ICON%d",required:!1,searchInParent:!0,multiple:!0,noSubscribe:!0,notSingle:!0},{role:/^value.temperature.min.forecast.(\d)$/,indicator:!1,type:P.StateType.Number,name:"TEMP_MIN%d",required:!1,searchInParent:!0,multiple:!0,noSubscribe:!0},{role:/^value.temperature.max.forecast.(\d)$/,indicator:!1,type:P.StateType.Number,name:"TEMP_MAX%d",required:!1,searchInParent:!0,multiple:!0,noSubscribe:!0},{role:/^date.forecast.(\d)$/,indicator:!1,type:P.StateType.String,name:"DATE%d",required:!1,searchInParent:!0,multiple:!0,noSubscribe:!0},{role:/^dayofweek.forecast.(\d)$/,indicator:!1,type:P.StateType.String,name:"DOW%d",required:!1,searchInParent:!0,multiple:!0,noSubscribe:!0},{role:/^weather.state.forecast.(\d)$/,indicator:!1,type:P.StateType.String,name:"STATE%d",required:!1,searchInParent:!0,multiple:!0,noSubscribe:!0},{role:/^value.temperature.forecast.(\d)$/,indicator:!1,type:P.StateType.Number,name:"TEMP%d",required:!1,searchInParent:!0,multiple:!0,noSubscribe:!0},{role:/^value.humidity.forecast.(\d)$/,indicator:!1,type:P.StateType.Number,name:"HUMIDITY%d",required:!1,searchInParent:!0,multiple:!0,noSubscribe:!0},{role:/^value.humidity.max.forecast.(\d)$/,indicator:!1,type:P.StateType.Number,name:"HUMIDITY_MAX%d",required:!1,searchInParent:!0,multiple:!0,noSubscribe:!0},{role:/^value.precipitation.forecast.(\d)$/,indicator:!1,type:P.StateType.Number,unit:"%",name:"PRECIPITATION_CHANCE%d",required:!1,searchInParent:!0,multiple:!0,noSubscribe:!0},{role:/^value.precipitation.forecast.(\d)$/,indicator:!1,type:P.StateType.Number,unit:"mm",name:"PRECIPITATION%d",required:!1,searchInParent:!0,multiple:!0,noSubscribe:!0},{role:/^value.speed.wind.forecast.(\d)$/,indicator:!1,type:P.StateType.Number,name:"WIND_SPEED%d",required:!1,searchInParent:!0,multiple:!0,noSubscribe:!0},{role:/^value.direction.wind.forecast.(\d)$/,indicator:!1,type:P.StateType.Number,name:"WIND_DIRECTION%d",required:!1,searchInParent:!0,multiple:!0,noSubscribe:!0},{role:/^weather.direction.wind.forecast.(\d)$/,indicator:!1,type:P.StateType.String,name:"WIND_DIRECTION_STR%d",required:!1,searchInParent:!0,multiple:!0,noSubscribe:!0},{role:/^weather.icon.wind.forecast.(\d)$/,indicator:!1,type:P.StateType.String,name:"WIND_ICON%d",required:!1,searchInParent:!0,multiple:!0,noSubscribe:!0}],type:P.Types.weatherForecast},rgb:{states:[{role:/^level\.color\.red$/,indicator:!1,type:P.StateType.Number,write:!0,name:"RED",required:!0,defaultRole:"level.color.red"},{role:/^level\.color\.green$/,indicator:!1,type:P.StateType.Number,write:!0,name:"GREEN",required:!0,defaultRole:"level.color.green"},{role:/^level\.color\.blue$/,indicator:!1,type:P.StateType.Number,write:!0,name:"BLUE",required:!0,defaultRole:"level.color.blue"},{role:/^level\.color\.white$/,indicator:!1,type:P.StateType.Number,write:!0,name:"WHITE",required:!1,defaultRole:"level.color.white"},{role:/^level\.dimmer$/,indicator:!1,type:P.StateType.Number,write:!0,name:"DIMMER",required:!1,defaultRole:"level.dimmer",defaultUnit:"%"},{role:/^level\.brightness$/,indicator:!1,type:P.StateType.Number,write:!0,name:"BRIGHTNESS",required:!1},{role:/^level\.color\.saturation$/,indicator:!1,type:P.StateType.Number,write:!0,name:"SATURATION",required:!1},{role:/^level\.color\.temperature$/,indicator:!1,type:P.StateType.Number,write:!0,name:"TEMPERATURE",required:!1,defaultRole:"level.color.temperature",defaultUnit:"°K"},{role:/^switch\.light$/,indicator:!1,type:P.StateType.Boolean,write:!0,name:"ON",required:!1,defaultRole:"switch.light"},{role:/^switch$/,indicator:!1,type:P.StateType.Boolean,write:!0,name:"ON",required:!1},{role:/^(state|switch|sensor)\.light|switch$/,indicator:!1,type:P.StateType.Boolean,write:!1,name:"ON_ACTUAL",required:!1,defaultRole:"sensor.light"},{role:/^time(\.span|\.interval)$/,indicator:!1,type:P.StateType.Number,write:!0,name:"TRANSITION_TIME",required:!1,defaultRole:"time.span",defaultUnit:"ms"},...Object.values(na),se.working,se.unreach,se.lowbat,se.maintain,se.error,se.battery],type:P.Types.rgb},rgbwSingle:{states:[{role:/^level\.color\.rgbw$/,indicator:!1,type:P.StateType.String,write:!0,name:"RGBW",required:!0,defaultRole:"level.color.rgbw"},{role:/^level\.dimmer$/,indicator:!1,type:P.StateType.Number,write:!0,name:"DIMMER",required:!1,defaultRole:"level.dimmer",defaultUnit:"%"},{role:/^level\.brightness$/,indicator:!1,type:P.StateType.Number,write:!0,name:"BRIGHTNESS",required:!1,defaultUnit:"%"},{role:/^level\.color\.saturation$/,indicator:!1,type:P.StateType.Number,write:!0,name:"SATURATION",required:!1},{role:/^level\.color\.temperature$/,indicator:!1,type:P.StateType.Number,write:!0,name:"TEMPERATURE",required:!1,defaultRole:"level.color.temperature",defaultUnit:"°K"},{role:/^switch\.light$/,indicator:!1,type:P.StateType.Boolean,write:!0,name:"ON",required:!1,defaultRole:"switch.light"},{role:/^switch$/,indicator:!1,type:P.StateType.Boolean,write:!0,name:"ON",required:!1},{role:/^(state|switch|sensor)\.light|switch$/,indicator:!1,type:P.StateType.Boolean,write:!1,name:"ON_ACTUAL",required:!1,defaultRole:"sensor.light"},{role:/^time(\.span|\.interval)$/,indicator:!1,type:P.StateType.Number,write:!0,name:"TRANSITION_TIME",required:!1,defaultRole:"time.span",defaultUnit:"ms"},...Object.values(na),se.working,se.unreach,se.lowbat,se.maintain,se.error,se.battery],type:P.Types.rgbwSingle},rgbSingle:{states:[{role:/^level\.color\.rgb$/,indicator:!1,type:P.StateType.String,write:!0,name:"RGB",required:!0,defaultRole:"level.color.rgb"},{role:/^level\.dimmer$/,indicator:!1,type:P.StateType.Number,write:!0,name:"DIMMER",required:!1,defaultRole:"level.dimmer",defaultUnit:"%"},{role:/^level\.brightness$/,indicator:!1,type:P.StateType.Number,write:!0,name:"BRIGHTNESS",required:!1,defaultUnit:"%"},{role:/^level\.color\.saturation$/,indicator:!1,type:P.StateType.Number,write:!0,name:"SATURATION",required:!1},{role:/^level\.color\.temperature$/,indicator:!1,type:P.StateType.Number,write:!0,name:"TEMPERATURE",required:!1,defaultRole:"level.color.temperature",defaultUnit:"°K"},{role:/^switch\.light$/,indicator:!1,type:P.StateType.Boolean,write:!0,name:"ON",required:!1,defaultRole:"switch.light"},{role:/^switch$/,indicator:!1,type:P.StateType.Boolean,write:!0,name:"ON",required:!1},{role:/^(state|switch|sensor)\.light|switch$/,indicator:!1,type:P.StateType.Boolean,write:!1,name:"ON_ACTUAL",required:!1,defaultRole:"sensor.light"},{role:/^time(\.span|\.interval)$/,indicator:!1,type:P.StateType.Number,write:!0,name:"TRANSITION_TIME",required:!1,defaultRole:"time.span",defaultUnit:"ms"},...Object.values(na),se.working,se.unreach,se.lowbat,se.maintain,se.error,se.battery],type:P.Types.rgbSingle},cie:{states:[{role:/^level\.color\.cie$/,indicator:!1,type:P.StateType.String,write:!0,name:"CIE",required:!0,defaultRole:"level.color.cie"},{role:/^level\.dimmer$/,indicator:!1,type:P.StateType.Number,write:!0,name:"DIMMER",required:!1,defaultRole:"level.dimmer",defaultUnit:"%"},{role:/^level\.brightness$/,indicator:!1,type:P.StateType.Number,write:!0,name:"BRIGHTNESS",required:!1,defaultUnit:"%"},{role:/^level\.color\.saturation$/,indicator:!1,type:P.StateType.Number,write:!0,name:"SATURATION",required:!1},{role:/^level\.color\.temperature$/,indicator:!1,type:P.StateType.Number,write:!0,name:"TEMPERATURE",required:!1,defaultRole:"level.color.temperature",defaultUnit:"°K"},{role:/^switch(\.light)?$/,indicator:!1,type:P.StateType.Boolean,write:!0,name:"ON",required:!1,defaultRole:"switch.light"},{role:/^(state|switch|sensor)\.light|switch$/,indicator:!1,type:P.StateType.Boolean,write:!1,name:"ON_ACTUAL",required:!1,defaultRole:"sensor.light"},{role:/^time(\.span|\.interval)$/,indicator:!1,type:P.StateType.Number,write:!0,name:"TRANSITION_TIME",required:!1,defaultRole:"time.span",defaultUnit:"ms"},...Object.values(na),se.working,se.unreach,se.lowbat,se.maintain,se.error,se.battery],type:P.Types.cie},hue:{states:[{role:/^level\.color\.hue$/,indicator:!1,type:P.StateType.Number,write:!0,name:"HUE",required:!0,defaultRole:"level.color.hue",defaultUnit:"°"},{role:/^level\.dimmer$/,indicator:!1,type:P.StateType.Number,write:!0,name:"DIMMER",required:!1,searchInParent:!0,defaultRole:"level.dimmer",defaultUnit:"%"},{role:/^level\.brightness$/,indicator:!1,type:P.StateType.Number,write:!0,name:"BRIGHTNESS",required:!1},{role:/^level\.color\.saturation$/,indicator:!1,type:P.StateType.Number,write:!0,name:"SATURATION",required:!1},{role:/^level\.color\.temperature$/,indicator:!1,type:P.StateType.Number,write:!0,name:"TEMPERATURE",required:!1,defaultRole:"level.color.temperature",defaultUnit:"°K"},{role:/^switch\.light$/,indicator:!1,type:P.StateType.Boolean,write:!0,name:"ON",required:!1,defaultRole:"switch.light"},{role:/^switch$/,indicator:!1,type:P.StateType.Boolean,write:!0,name:"ON",required:!1},{role:/^(state|switch|sensor)\.light|switch$/,indicator:!1,type:P.StateType.Boolean,write:!1,name:"ON_ACTUAL",required:!1,defaultRole:"sensor.light"},{role:/^time(\.span|\.interval)$/,indicator:!1,type:P.StateType.Number,write:!0,name:"TRANSITION_TIME",required:!1,defaultRole:"time.span",defaultUnit:"ms"},...Object.values(na),se.working,se.unreach,se.lowbat,se.maintain,se.error,se.battery],type:P.Types.hue},ct:{states:[{role:/^level\.color\.temperature$/,indicator:!1,type:P.StateType.Number,write:!0,name:"TEMPERATURE",required:!0,defaultRole:"level.color.temperature",defaultUnit:"°K"},{role:/^level\.dimmer$/,indicator:!1,type:P.StateType.Number,write:!0,name:"DIMMER",required:!1,defaultRole:"level.dimmer",defaultUnit:"%"},{role:/^level\.brightness$/,indicator:!1,type:P.StateType.Number,write:!0,name:"BRIGHTNESS",required:!1},{role:/^level\.color\.saturation$/,indicator:!1,type:P.StateType.Number,write:!0,name:"SATURATION",required:!1},{role:/^switch\.light$/,indicator:!1,type:P.StateType.Boolean,write:!0,name:"ON",required:!1,defaultRole:"switch.light"},{role:/^switch$/,indicator:!1,type:P.StateType.Boolean,write:!0,name:"ON",required:!1},{role:/^(state|switch|sensor)\.light|switch$/,indicator:!1,type:P.StateType.Boolean,write:!1,name:"ON_ACTUAL",required:!1,defaultRole:"sensor.light"},{role:/^time(\.span|\.interval)$/,indicator:!1,type:P.StateType.Number,write:!0,name:"TRANSITION_TIME",required:!1,defaultRole:"time.span",defaultUnit:"ms"},...Object.values(na),se.working,se.unreach,se.lowbat,se.maintain,se.error,se.battery],type:P.Types.ct},warning:{states:[{role:/^value\.warning$/,indicator:!1,name:"LEVEL",required:!0,defaultRole:"value.warning"},{role:/^weather\.title\.short$/,indicator:!1,type:P.StateType.String,name:"TITLE",required:!1,defaultRole:"weather.title.short"},{role:/^weather\.title$/,indicator:!1,type:P.StateType.String,name:"INFO",required:!1,defaultRole:"weather.title"},{role:/^date\.start$/,indicator:!1,type:P.StateType.String,name:"START",required:!1,defaultRole:"date.start"},{role:/^date\.end$/,indicator:!1,type:P.StateType.String,name:"END",required:!1,defaultRole:"date.end"},{role:/^date$/,indicator:!1,type:P.StateType.String,name:"START",required:!1},{role:/^weather\.chart\.url/,indicator:!1,type:P.StateType.String,name:"ICON",required:!1,defaultRole:"weather.chart.url"},{role:/^weather\.state$/,indicator:!1,type:P.StateType.String,name:"DESC",required:!1,noSubscribe:!0,defaultRole:"weather.state"}],type:P.Types.warning},airCondition:{states:[{role:/temperature(\..*)?$/,indicator:!1,write:!0,type:P.StateType.Number,name:"SET",required:!0,defaultRole:"level.temperature",defaultUnit:"°C"},{role:/airconditioner$/,indicator:!1,write:!0,type:P.StateType.Number,searchInParent:!0,name:"MODE",required:!0,defaultRole:"level.mode.airconditioner",defaultStates:{0:"OFF",1:"AUTO",2:"COOL",3:"HEAT",4:"ECO",5:"FAN_ONLY",6:"DRY"}},{role:/(speed|mode)\.fan$/,indicator:!1,write:!0,type:P.StateType.Number,name:"SPEED",required:!1,defaultRole:"level.mode.fan",defaultStates:{0:"AUTO",1:"HIGH",2:"LOW",3:"MEDIUM",4:"QUIET",5:"TURBO"}},{role:/^switch\.power$/,indicator:!1,write:!0,type:[P.StateType.Boolean,P.StateType.Number],searchInParent:!0,name:"POWER",required:!1,defaultRole:"switch.power"},{role:/^switch$/,indicator:!1,write:!0,type:P.StateType.Boolean,searchInParent:!0,name:"POWER",required:!1},{role:/temperature(\..*)?$/,indicator:!1,write:!1,type:P.StateType.Number,searchInParent:!0,name:"ACTUAL",required:!1,defaultRole:"value.temperature",defaultUnit:"°C"},{role:/humidity(\..*)?$/,indicator:!1,write:!1,type:P.StateType.Number,searchInParent:!0,name:"HUMIDITY",required:!1,defaultRole:"value.humidity",defaultUnit:"%"},{role:/^switch\.boost(\..*)?$/,indicator:!1,write:!0,type:[P.StateType.Boolean,P.StateType.Number],searchInParent:!0,name:"BOOST",required:!1,defaultRole:"switch.boost"},{role:/swing$/,indicator:!1,write:!0,type:P.StateType.Number,searchInParent:!0,name:"SWING",required:!1,defaultRole:"level.mode.swing",defaultStates:{0:"AUTO",1:"HORIZONTAL",2:"STATIONARY",3:"VERTICAL"}},{role:/swing$/,indicator:!1,write:!0,type:P.StateType.Boolean,searchInParent:!0,name:"SWING",required:!1,defaultRole:"switch.mode.swing"},...Object.values(na),se.unreach,se.maintain,se.error],type:P.Types.airCondition},thermostat:{states:[{role:/temperature(\..*)?$/,indicator:!1,write:!0,type:P.StateType.Number,name:"SET",required:!0,defaultRole:"level.temperature",defaultUnit:"°C"},{role:/temperature(\..*)?$/,indicator:!1,write:!1,type:P.StateType.Number,searchInParent:!0,name:"ACTUAL",required:!1,defaultRole:"value.temperature",defaultUnit:"°C"},{role:/humidity(\..*)?$/,indicator:!1,write:!1,type:P.StateType.Number,searchInParent:!0,name:"HUMIDITY",required:!1,defaultRole:"value.humidity",defaultUnit:"%"},{role:/^switch(\.mode)?\.boost(\..*)?$/,indicator:!1,write:!0,type:[P.StateType.Boolean,P.StateType.Number],searchInParent:!0,name:"BOOST",required:!1,defaultRole:"switch.mode.boost"},{role:/^switch\.power$/,indicator:!1,write:!0,type:[P.StateType.Boolean,P.StateType.Number],searchInParent:!0,name:"POWER",required:!1,defaultRole:"switch.power"},{role:/^switch(\.mode)?\.party$/,indicator:!1,write:!0,type:[P.StateType.Boolean,P.StateType.Number],searchInParent:!0,name:"PARTY",required:!1,defaultRole:"switch.mode.party"},{role:/^switch$/,indicator:!1,write:!0,type:P.StateType.Boolean,searchInParent:!0,name:"POWER",required:!1},{role:/^level(\.mode)?\.thermostat$/,indicator:!1,write:!0,type:P.StateType.Number,searchInParent:!0,name:"MODE",required:!1,defaultRole:"level.mode.thermostat",defaultStates:{0:"AUTO",1:"MANUAL"}},se.working,se.unreach,se.lowbat,se.maintain,se.error,se.battery],type:P.Types.thermostat},vacuumCleaner:{states:[{role:/^switch\.power$/,indicator:!1,write:!0,type:[P.StateType.Boolean,P.StateType.Number],searchInParent:!0,name:"POWER",required:!0,defaultRole:"switch.power"},{role:/mode\.cleanup$/,indicator:!1,write:!0,type:P.StateType.Number,searchInParent:!0,name:"MODE",required:!0,defaultRole:"level.mode.cleanup",defaultStates:{0:"AUTO",1:"NORMAL",2:"QUIET",3:"ECO",4:"EXPRESS"}},{role:/vacuum\.map\.base64$/,indicator:!1,write:!1,type:P.StateType.String,searchInParent:!0,name:"MAP_BASE64",required:!1,defaultRole:"vacuum.map.base64"},{role:/vacuum\.map\.url$/,indicator:!1,write:!1,type:P.StateType.String,searchInParent:!0,name:"MAP_URL",required:!1},{role:/mode\.work$/,indicator:!1,write:!0,type:P.StateType.Number,searchInParent:!0,name:"WORK_MODE",required:!1,defaultRole:"level.mode.work",defaultStates:{0:"AUTO",1:"FAST",2:"MEDIUM",3:"SLOW",4:"TURBO"}},{role:/^value\.water$/,indicator:!1,write:!1,type:P.StateType.Number,searchInParent:!0,unit:"%",name:"WATER",required:!1,defaultRole:"value.water",defaultUnit:"%"},{role:/^value\.waste$/,indicator:!1,write:!1,type:P.StateType.Number,searchInParent:!0,unit:"%",name:"WASTE",required:!1,defaultRole:"value.waste",defaultUnit:"%"},{role:/^value\.battery$/,indicator:!1,write:!1,type:P.StateType.Number,searchInParent:!0,unit:"%",name:"BATTERY",required:!1,defaultRole:"value.battery",defaultUnit:"%"},{role:/^value\.state$/,indicator:!1,write:!1,type:[P.StateType.Number,P.StateType.String],searchInParent:!0,name:"STATE",required:!1,defaultRole:"value.state"},{role:/^switch\.pause$/,indicator:!1,write:!0,type:P.StateType.Boolean,searchInParent:!0,name:"PAUSE",required:!1,defaultRole:"switch.pause"},{role:/^indicator(\.maintenance)?\.waste$|^indicator(\.alarm)?\.waste/,indicator:!0,type:P.StateType.Boolean,searchInParent:!0,name:"WASTE_ALARM",required:!1,defaultRole:"indicator.maintenance.waste"},{role:/^indicator(\.maintenance)?\.water$|^indicator(\.alarm)?\.water/,indicator:!0,type:P.StateType.Boolean,searchInParent:!0,name:"WATER_ALARM",required:!1,defaultRole:"indicator.maintenance.water"},{role:/^value(\.usage)?\.filter/,indicator:!0,type:P.StateType.Number,searchInParent:!0,name:"FILTER",required:!1,defaultRole:"value.usage.filter",defaultUnit:"%"},{role:/^value(\.usage)?\.brush/,indicator:!0,type:P.StateType.Number,searchInParent:!0,name:"BRUSH",required:!1,defaultRole:"value.usage.brush",defaultUnit:"%"},{role:/^value(\.usage)?\.sensors/,indicator:!0,type:P.StateType.Number,searchInParent:!0,name:"SENSORS",required:!1,defaultRole:"value.usage.sensors",defaultUnit:"%"},{role:/^value(\.usage)?\.brush\.side/,indicator:!0,type:P.StateType.Number,searchInParent:!0,name:"SIDE_BRUSH",required:!1,defaultRole:"value.usage.brush.side",defaultUnit:"%"},se.unreach,se.lowbat,se.maintain,se.error,se.battery],type:P.Types.vacuumCleaner},blinds:{states:[{role:/^level(\.blind)?$/,indicator:!1,type:P.StateType.Number,write:!0,enums:mn.roleOrEnumBlind,name:"SET",required:!0,defaultRole:"level.blind",defaultUnit:"%"},{role:/^value(\.blind)?$/,indicator:!1,type:P.StateType.Number,enums:mn.roleOrEnumBlind,name:"ACTUAL",required:!1,defaultRole:"value.blind",defaultUnit:"%"},{role:/^button\.stop(\.blind)?$|^action\.stop$/,indicator:!1,type:P.StateType.Boolean,write:!0,enums:mn.roleOrEnumBlind,name:"STOP",required:!1,noSubscribe:!0,defaultRole:"button.stop.blind"},{role:/^button\.open(\.blind)?$/,indicator:!1,type:P.StateType.Boolean,write:!0,enums:mn.roleOrEnumBlind,name:"OPEN",required:!1,noSubscribe:!0,defaultRole:"button.open.blind"},{role:/^button\.close(\.blind)?$/,indicator:!1,type:P.StateType.Boolean,write:!0,enums:mn.roleOrEnumBlind,name:"CLOSE",required:!1,noSubscribe:!0,defaultRole:"button.close.blind"},{role:/^level(\.open)?\.tilt$/,indicator:!1,type:P.StateType.Number,write:!0,enums:mn.roleOrEnumBlind,name:"TILT_SET",required:!1,defaultRole:"level.tilt"},{role:/^value(\.open)?\.tilt$/,indicator:!1,type:P.StateType.Number,enums:mn.roleOrEnumBlind,name:"TILT_ACTUAL",required:!1,defaultRole:"value.tilt"},{role:/^button\.stop\.tilt$/,indicator:!1,type:P.StateType.Boolean,write:!0,enums:mn.roleOrEnumBlind,name:"TILT_STOP",required:!1,noSubscribe:!0,defaultRole:"button.stop.tilt"},{role:/^button\.open\.tilt$/,indicator:!1,type:P.StateType.Boolean,write:!0,enums:mn.roleOrEnumBlind,name:"TILT_OPEN",required:!1,noSubscribe:!0,defaultRole:"button.open.tilt"},{role:/^button\.close\.tilt$/,indicator:!1,type:P.StateType.Boolean,write:!0,enums:mn.roleOrEnumBlind,name:"TILT_CLOSE",required:!1,noSubscribe:!0,defaultRole:"button.close.tilt"},se.direction,se.working,se.unreach,se.lowbat,se.maintain,se.error,se.battery],type:P.Types.blind},blindButtons:{states:[{role:/^button\.stop(\.blind)?$|^action\.stop$/,indicator:!1,type:P.StateType.Boolean,write:!0,enums:mn.roleOrEnumBlind,name:"STOP",required:!0,noSubscribe:!0,defaultRole:"button.stop.blind"},{role:/^button\.open(\.blind)?$/,indicator:!1,type:P.StateType.Boolean,write:!0,enums:mn.roleOrEnumBlind,name:"OPEN",required:!0,noSubscribe:!0,defaultRole:"button.open.blind"},{role:/^button\.close(\.blind)?$/,indicator:!1,type:P.StateType.Boolean,write:!0,enums:mn.roleOrEnumBlind,name:"CLOSE",required:!0,noSubscribe:!0,defaultRole:"button.close.blind"},{role:/^level\.tilt$/,indicator:!1,type:P.StateType.Number,write:!0,enums:mn.roleOrEnumBlind,name:"TILT_SET",required:!1,defaultRole:"level.tilt"},{role:/^value\.tilt$/,indicator:!1,type:P.StateType.Number,enums:mn.roleOrEnumBlind,name:"TILT_ACTUAL",required:!1,defaultRole:"value.tilt"},{role:/^button\.stop\.tilt$/,indicator:!1,type:P.StateType.Boolean,write:!0,enums:mn.roleOrEnumBlind,name:"TILT_STOP",required:!1,noSubscribe:!0,defaultRole:"button.stop.tilt"},{role:/^button\.open\.tilt$/,indicator:!1,type:P.StateType.Boolean,write:!0,enums:mn.roleOrEnumBlind,name:"TILT_OPEN",required:!1,noSubscribe:!0,defaultRole:"button.open.tilt"},{role:/^button\.close\.tilt$/,indicator:!1,type:P.StateType.Boolean,write:!0,enums:mn.roleOrEnumBlind,name:"TILT_CLOSE",required:!1,noSubscribe:!0,defaultRole:"button.close.tilt"},se.direction,se.working,se.unreach,se.lowbat,se.maintain,se.error,se.battery],type:P.Types.blindButtons},gate:{states:[{role:/^switch(\.gate)?$/,indicator:!1,type:P.StateType.Boolean,write:!0,enums:mn.roleOrEnumGate,name:"SET",required:!0,defaultRole:"switch.gate"},{role:/^value(\.position)?|^value(\.gate)?$/,indicator:!1,type:P.StateType.Number,enums:mn.roleOrEnumGate,name:"ACTUAL",required:!1,defaultRole:"value.blind",defaultUnit:"%"},{role:/^button\.stop$|^action\.stop$/,indicator:!1,type:P.StateType.Boolean,write:!0,enums:mn.roleOrEnumGate,name:"STOP",required:!1,noSubscribe:!0,defaultRole:"button.stop"},se.direction,se.working,se.unreach,se.maintain,se.error],type:P.Types.gate},weatherCurrent:{states:[{role:/^value(\.temperature)?$/,indicator:!1,type:P.StateType.Number,name:"ACTUAL",required:!0,defaultRole:"value.temperature",defaultUnit:"°C"},{role:/^weather\.icon$/,indicator:!1,name:"ICON",required:!0,defaultRole:"weather.icon"},{role:/^value\.precipitation\.chance$/,indicator:!1,type:P.StateType.Number,name:"PRECIPITATION_CHANCE",defaultRole:"value.precipitation.chance",defaultUnit:"%"},{role:/^value\.precipitation\.type$/,indicator:!1,type:P.StateType.Number,name:"PRECIPITATION_TYPE",defaultRole:"value.precipitation.type",defaultStates:{0:"NO",1:"RAIN",2:"SNOW",3:"HAIL"}},{role:/^value\.pressure$/,indicator:!1,type:P.StateType.Number,name:"PRESSURE",defaultRole:"value.pressure",defaultUnit:"mbar"},{role:/^value\.pressure\.tendency$/,indicator:!1,type:P.StateType.String,name:"PRESSURE_TENDENCY",defaultRole:"value.pressure.tendency"},{role:/^value\.temperature\.windchill$/,indicator:!1,type:P.StateType.Number,name:"REAL_FEEL_TEMPERATURE",defaultRole:"value.temperature.windchill",defaultUnit:"°C"},{role:/^value.humidity$/,indicator:!1,type:P.StateType.Number,name:"HUMIDITY",defaultRole:"value.humidity",defaultUnit:"%"},{role:/^value.uv$/,indicator:!1,type:P.StateType.Number,name:"UV",defaultRole:"value.uv"},{role:/^weather\.state$/,indicator:!1,type:P.StateType.String,name:"WEATHER",defaultRole:"weather.state"},{role:/^value\.direction\.wind$/,indicator:!1,type:P.StateType.String,name:"WIND_DIRECTION",defaultRole:"value.direction.wind",defaultUnit:"°"},{role:/^value\.speed\.wind\.gust$/,indicator:!1,type:P.StateType.Number,name:"WIND_GUST",defaultRole:"value.speed.wind.gust",defaultUnit:"km/h"},{role:/^value\.speed\.wind$/,indicator:!1,type:P.StateType.Number,name:"WIND_SPEED",defaultRole:"value.speed.wind$",defaultUnit:"km/h"},se.lowbat,se.unreach,se.maintain,se.error,se.battery],type:P.Types.weatherCurrent},camera:{states:[{role:/^link\.camera(\.\w+)?$/,indicator:!1,type:P.StateType.String,name:"URL",required:!0,defaultRole:"link.camera"},{role:/^switch(\.camera)?\.autofocus$/,indicator:!1,type:P.StateType.Boolean,write:!0,name:"AUTOFOCUS",required:!1,defaultRole:"switch.camera.autofocus"},{role:/^switch(\.camera)?\.autowhitebalance$/,indicator:!1,type:P.StateType.Boolean,write:!0,name:"AUTOWHITEBALANCE",required:!1,defaultRole:"switch.camera.autowhitebalance"},{role:/^switch(\.camera)?\.brightness$/,indicator:!1,type:P.StateType.Boolean,write:!0,name:"BRIGHTNESS",required:!1,defaultRole:"switch.camera.brightness"},{role:/^switch(\.camera)?\.nightmode$/,indicator:!1,type:P.StateType.Boolean,write:!0,name:"NIGHTMODE",required:!1,defaultRole:"switch.camera.nightmode"},{role:/^level(\.camera)?\.position$|^level(\.camera)?(\.ptz)$/,indicator:!1,type:P.StateType.Number,write:!0,name:"PTZ",required:!1,defaultRole:"level.camera.position"},se.unreach,se.lowbat,se.maintain,se.error,se.battery],type:P.Types.camera,enumRequired:!1},lock:{states:[{role:/^switch\.lock$/,indicator:!1,type:P.StateType.Boolean,write:!0,name:"SET",required:!0,defaultRole:"switch.lock"},{role:/^state$/,indicator:!1,type:P.StateType.Boolean,write:!1,name:"ACTUAL",required:!1,defaultRole:"state"},{indicator:!1,type:P.StateType.Boolean,write:!0,read:!1,name:"OPEN",required:!1,noSubscribe:!0,defaultRole:"button"},se.direction,se.working,se.unreach,se.lowbat,se.maintain,se.error,se.battery],type:P.Types.lock},motion:{states:[{role:/^state\.motion$|^sensor\.motion$/,indicator:!1,type:P.StateType.Boolean,name:"ACTUAL",required:!0,defaultRole:"sensor.motion"},{role:/brightness$/,indicator:!1,type:P.StateType.Number,name:"SECOND",required:!1,defaultRole:"value.brightness",defaultUnit:"lux"},se.unreach,se.lowbat,se.maintain,se.error,se.battery],type:P.Types.motion},window:{states:[{role:/^state(\.window)?$|^sensor(\.window)?/,indicator:!1,type:P.StateType.Boolean,enums:mn.roleOrEnumWindow,name:"ACTUAL",required:!0,defaultRole:"sensor.window"},se.unreach,se.lowbat,se.maintain,se.error,se.battery],type:P.Types.window},windowTilt:{states:[{role:/^state?$|^value(\.window)?$/,indicator:!1,type:P.StateType.Number,enums:mn.roleOrEnumWindow,name:"ACTUAL",required:!0,defaultRole:"value.window"},se.unreach,se.lowbat,se.maintain,se.error,se.battery],type:P.Types.windowTilt},fireAlarm:{states:[{role:/^(state|sensor|indicator)(\.alarm)?\.fire$/,indicator:!1,type:P.StateType.Boolean,name:"ACTUAL",required:!0,defaultRole:"sensor.alarm.fire",defaultChannelRole:"sensor.alarm.fire"},se.unreach,se.lowbat,se.maintain,se.error,se.battery],type:P.Types.fireAlarm,enumRequired:!1},floodAlarm:{states:[{role:/^(state|sensor|indicator)(\.alarm)?\.flood$/,indicator:!1,type:P.StateType.Boolean,name:"ACTUAL",required:!0,defaultRole:"sensor.alarm.flood",defaultChannelRole:"sensor.alarm.flood"},se.unreach,se.lowbat,se.maintain,se.error,se.battery],type:P.Types.floodAlarm},door:{states:[{role:/^state?$|^state(\.door)?$|^sensor(\.door)?/,indicator:!1,type:P.StateType.Boolean,write:!1,enums:mn.roleOrEnumDoor,name:"ACTUAL",required:!0,defaultRole:"sensor.door"},se.unreach,se.lowbat,se.maintain,se.error,se.battery],type:P.Types.door},dimmer:{states:[{role:/^level(\.dimmer)?$|^level\.brightness$/,indicator:!1,type:P.StateType.Number,write:!0,enums:mn.roleOrEnumLight,name:"SET",required:!0,defaultRole:"level.dimmer",ignoreRole:/^level\.dimspeed$/,defaultUnit:"%"},{role:/^value(\.dimmer)?$/,indicator:!1,type:P.StateType.Number,write:!1,enums:mn.roleOrEnumLight,name:"ACTUAL",required:!1,defaultRole:"value.dimmer",defaultUnit:"%"},{role:/^switch(\.light)?$|^state$/,indicator:!1,type:P.StateType.Boolean,write:!0,enums:mn.roleOrEnumLight,name:"ON_SET",required:!1,defaultRole:"switch.light"},{role:/^(state|switch|sensor)\.light|switch$/,indicator:!1,type:P.StateType.Boolean,write:!1,enums:mn.roleOrEnumLight,name:"ON_ACTUAL",required:!1,defaultRole:"sensor.light"},{role:/^time(\.span|\.interval)$/,indicator:!1,type:P.StateType.Number,write:!0,enums:mn.roleOrEnumLight,name:"TRANSITION_TIME",required:!1,defaultRole:"time.span",defaultUnit:"ms"},...Object.values(na),se.working,se.unreach,se.lowbat,se.maintain,se.error,se.battery],type:P.Types.dimmer},light:{states:[{role:/^switch(\.light)?$|^state$/,enums:mn.roleOrEnumLight,indicator:!1,type:P.StateType.Boolean,write:!0,name:"SET",required:!0,defaultRole:"switch.light"},{role:/^(state|switch|sensor)\.light|switch$/,indicator:!1,type:P.StateType.Boolean,write:!1,enums:mn.roleOrEnumLight,name:"ON_ACTUAL",required:!1,defaultRole:"sensor.light"},...Object.values(na),se.working,se.unreach,se.lowbat,se.maintain,se.error,se.battery],type:P.Types.light},volume:{states:[{role:/^level\.volume$/,indicator:!1,type:P.StateType.Number,min:P.StateType.Number,max:P.StateType.Number,write:!0,name:"SET",required:!0,defaultRole:"level.volume"},{role:/^value\.volume$/,indicator:!1,type:P.StateType.Number,min:P.StateType.Number,max:P.StateType.Number,write:!1,name:"ACTUAL",required:!1,defaultRole:"value.volume"},{role:/^media\.mute$/,indicator:!1,type:P.StateType.Boolean,write:!0,name:"MUTE",required:!1,defaultRole:"media.mute"},se.working,se.unreach,se.lowbat,se.maintain,se.error,se.battery],type:P.Types.volume},location_one:{states:[{role:/^value\.gps$/,indicator:!1,type:P.StateType.String,write:!1,name:"GPS",required:!0,defaultRole:"value.gps"},{role:/^value\.gps\.elevation$/,indicator:!1,type:P.StateType.Number,write:!1,name:"ELEVATION",required:!1,defaultRole:"value.gps.elevation"},{role:/^value\.radius$|value\.gps\.radius$/,indicator:!1,type:P.StateType.Number,write:!1,name:"RADIUS",required:!1,defaultRole:"value.gps.radius"},{role:/^value\.accuracy$|^value\.gps\.accuracy$/,indicator:!1,type:P.StateType.Number,write:!1,name:"ACCURACY",required:!1,defaultRole:"value.gps.accuracy"},se.unreach,se.lowbat,se.maintain,se.error,se.battery],type:P.Types.location},location:{states:[{role:/^value\.gps\.longitude$/,indicator:!1,type:P.StateType.Number,write:!1,name:"LONGITUDE",required:!0,defaultRole:"value.gps.longitude",defaultUnit:"°"},{role:/^value\.gps\.latitude$/,indicator:!1,type:P.StateType.Number,write:!1,name:"LATITUDE",required:!0,defaultRole:"value.gps.latitude",defaultUnit:"°"},{role:/^value\.gps\.elevation$/,indicator:!1,type:P.StateType.Number,write:!1,name:"ELEVATION",required:!1,defaultRole:"value.gps.elevation"},{role:/^value\.radius$|value\.gps\.radius$/,indicator:!1,type:P.StateType.Number,write:!1,name:"RADIUS",required:!1,defaultRole:"value.gps.radius"},{role:/^value\.accuracy$|^value\.gps\.accuracy$/,indicator:!1,type:P.StateType.Number,write:!1,name:"ACCURACY",required:!1,defaultRole:"value.gps.accuracy"},se.unreach,se.lowbat,se.maintain,se.error,se.battery],type:P.Types.location},volumeGroup:{states:[{role:/^level\.volume\.group?$/,indicator:!1,type:P.StateType.Number,min:P.StateType.Number,max:P.StateType.Number,write:!0,name:"SET",required:!0,defaultRole:"level.volume.group"},{role:/^value\.volume\.group$/,indicator:!1,type:P.StateType.Number,min:P.StateType.Number,max:P.StateType.Number,write:!1,name:"ACTUAL",required:!1,defaultRole:"value.volume.group"},{role:/^media\.mute\.group$/,indicator:!1,type:P.StateType.Boolean,write:!0,name:"MUTE",required:!1,defaultRole:"media.mute.group"},se.working,se.unreach,se.lowbat,se.maintain,se.error,se.battery],type:P.Types.volumeGroup},levelSlider:{states:[{role:/^level(\..*)?$/,indicator:!1,type:P.StateType.Number,min:P.StateType.Number,max:P.StateType.Number,write:!0,name:"SET",required:!0,defaultRole:"level",defaultUnit:"%"},{role:/^value(\..*)?$/,indicator:!1,type:P.StateType.Number,min:P.StateType.Number,max:P.StateType.Number,write:!1,name:"ACTUAL",required:!1,defaultRole:"value"},se.working,se.unreach,se.lowbat,se.maintain,se.error,se.battery],type:P.Types.slider},socket:{states:[{role:/^switch$|^state$|^switch\.active$/,indicator:!1,type:P.StateType.Boolean,write:!0,name:"SET",required:!0,defaultRole:"switch"},{role:/^state$|^state\.active$/,indicator:!1,type:P.StateType.Boolean,write:!1,name:"ACTUAL",required:!1,defaultRole:"sensor.switch"},...Object.values(na),se.working,se.unreach,se.lowbat,se.maintain,se.error],type:P.Types.socket},button:{states:[{role:/^button(\.[.\w]+)?$|^action(\.[.\w]+)?$/,indicator:!1,type:P.StateType.Boolean,read:!1,write:!0,name:"SET",required:!0,noSubscribe:!0,defaultRole:"button"},se.unreach,se.lowbat,se.maintain,se.error,se.battery],type:P.Types.button},buttonSensor:{states:[{role:/^button(\.[.\w]+)?$/,indicator:!1,type:P.StateType.Boolean,read:!0,write:!1,name:"PRESS",required:!0,defaultRole:"button.press"},{role:/^button\.long/,indicator:!1,type:P.StateType.Boolean,read:!0,write:!1,name:"PRESS_LONG",required:!1,defaultRole:"button.long"},se.unreach,se.lowbat,se.maintain,se.error,se.battery],type:P.Types.buttonSensor},temperature:{states:[{role:/temperature$/,indicator:!1,write:!1,type:P.StateType.Number,name:"ACTUAL",required:!0,defaultRole:"value.temperature",defaultUnit:"°C"},{role:/humidity$/,indicator:!1,write:!1,type:P.StateType.Number,name:"SECOND",required:!1,defaultRole:"value.humidity",defaultUnit:"%"},se.unreach,se.lowbat,se.maintain,se.error,se.battery],type:P.Types.temperature},humidity:{states:[{role:/humidity$/,indicator:!1,write:!1,type:P.StateType.Number,name:"ACTUAL",required:!0,defaultRole:"value.humidity",defaultUnit:"%"},se.unreach,se.lowbat,se.maintain,se.error,se.battery],type:P.Types.humidity},illuminance:{states:[{role:/brightness$/,indicator:!1,write:!1,type:P.StateType.Number,name:"ACTUAL",required:!0,defaultRole:"value.brightness",defaultUnit:"lux"},se.unreach,se.lowbat,se.maintain,se.error,se.battery],type:P.Types.illuminance},image:{states:[{role:/\.icon$|^icon$|^icon\.|\.icon\.|\.chart\.url\.|\.chart\.url$|^url.icon$/,indicator:!1,write:!1,type:P.StateType.String,name:"URL",required:!0},se.unreach,se.lowbat,se.maintain,se.error,se.battery],type:P.Types.image},info:{states:[{indicator:!1,name:"ACTUAL",required:!0,multiple:!0,noDeviceDetection:!0,ignoreRole:/\.inhibit$/,defaultRole:"state"},se.working,se.unreach,se.lowbat,se.maintain,se.error,se.battery],type:P.Types.info}};Object.defineProperty(Iy,"__esModule",{value:!0});Iy.ChannelDetector=void 0;const Ph=fc,sl=Dr,lc=xy;let dx=class uc{constructor(){this.enums=null,this.cache={}}_applyPattern(n,s,i){var a;if(n[s]&&n[s].common){let c=null;if(i.role&&(c=i.role.test(n[s].common.role||""),c&&i.channelRole)){const h=(0,sl.getParentId)(s),g=((a=n[h])===null||a===void 0?void 0:a.common.role)||"";g&&(n[h].type==="channel"||n[h].type==="device")?c=i.channelRole.test(g):c=!1}if(c===!1||i.objectType&&n[s].type!==i.objectType||i.stateName&&!i.stateName.test(s)||i.unit&&i.unit!==n[s].common.unit)return!1;if(i.ignoreRole){const h=n[s].common.role||"";if(h&&i.ignoreRole.test(h))return!1}if(i.indicator===!1&&(n[s].common.role||"").match(/^indicator(\.[.\w]+)?$/))return!1;if(i.state){const h=s.split(".").pop()||"";if(h&&!i.state.test(h))return!1}if(i.write!==void 0&&i.write!==!!n[s].common.write||i.min===Ph.StateType.Number&&typeof n[s].common.min!==Ph.StateType.Number||i.max===Ph.StateType.Number&&typeof n[s].common.max!==Ph.StateType.Number||i.read!==void 0&&i.read!==(n[s].common.read===void 0?!0:n[s].common.read))return!1;if(i.type)if(typeof i.type===Ph.StateType.String){if(i.type!==n[s].common.type)return!1}else{let h=!0;for(let g=0;g<i.type.length;g++)if(i.type[g]===n[s].common.type){h=!1;break}if(h)return!1}if(i.enums&&typeof i.enums=="function"){const h=this._getEnumsForId(n,s);if(!i.enums(n[s],h||[]))return!1}return!0}return!1}_getEnumsForId(n,s){this.enums=this.enums||(0,sl.getFunctionEnums)(n);const i=[];if(this.enums.forEach(a=>{n[a].common.members.includes(s)&&i.push(a)}),!i.length&&n[s]&&n[s].type==="state"){const a=(0,sl.getParentId)(s);n[a]&&(n[a].type==="channel"||n[a].type==="device")&&this.enums.forEach(c=>{n[c].common.members.includes(a)&&i.push(c)})}return i.length?i:null}static copyState(n,s){const i=s||JSON.parse(JSON.stringify(n));return i.original=n.original||n,"enums"in n&&n.enums&&(i.enums=n.enums),"role"in n&&n.role&&(i.role=n.role),"channelRole"in n&&n.channelRole&&(i.channelRole=n.channelRole),i}_testOneState(n){const s=n.objects,i=n.pattern,a=n.state,c=n.channelStates,h=n.usedIds,g=n.usedInCurrentDevice,b=n.ignoreIndicators;let $=n.result,y=!1;return c.forEach(w=>{if(!(a.name==="COVER"&&($!=null&&$.states.find(C=>C.id&&C.name==="COVER")))){if(a.indicator&&b){const S=w.split(".").pop()||"";if(S&&b.includes(S))return}if((a.indicator||!g.includes(w)&&(a.notSingle||!h.includes(w)))&&this._applyPattern(s,w,a)&&(a.indicator||g.push(w),$||($=JSON.parse(JSON.stringify(lc.patterns[i])),n.result=$,$==null||$.states.forEach((C,S)=>uc.copyState(lc.patterns[i].states[S],C))),$)){if(!$.states.find(C=>C.id===w)){let C=!1;for(let S=0;S<$.states.length;S++)if($.states[S].name===a.name){$.states[S].id=w,C=!0;break}C||console.error(`Cannot find state for ${w}`)}y=!0,a.multiple&&c.length>1&&c.forEach(C=>{if(C!==w&&(a.indicator||!g.includes(C)&&(a.notSingle||!h.includes(C)))&&this._applyPattern(s,C,a)&&(a.indicator||g.push(C),$))if(Array.isArray(a)){const S=uc.copyState(a[0]);S.id=C,$.states.push(S)}else{const S=uc.copyState(a);S.id=C,$.states.push(S)}})}}}),y}static getChannelStates(n,s,i){switch(n[s].type){case"chart":case"state":return[s];case"device":{const a=(0,sl.getAllStatesInDevice)(i,s),c=(0,sl.getAllStatesInChannel)(i,s);return a.concat(c)}default:return(0,sl.getAllStatesInChannel)(i,s)}}static patternIsAllowed(n,s,i){if(!n)return!1;if(Array.isArray(n.type)){for(let a=0;a<n.type.length;a++)if(s&&!s.includes(n.type[a])||i&&i.includes(n.type[a]))return!1;return!0}return s&&!s.includes(n.type)?!1:!i||!i.includes(n.type)}static allRequiredStatesFound(n){if(!n.result)return!1;const s=n.result.states;for(let i=0;i<s.length;i++)if(s[i].required&&!s[i].id)return!1;return!0}static cleanState(n,s){var i,a;const c=((a=(i=s[n.id])===null||i===void 0?void 0:i.common)===null||a===void 0?void 0:a.role)||"";if(n.name.includes("%d")&&n.role&&n.id&&c){const h=n.role.exec(c);h&&(n.name=n.name.replace("%d",h[1]))}n.role&&delete n.role,n.enums&&delete n.enums,n.original&&delete n.original}_detectNext(n){const s=n.objects,i=n.id,a=n._keysOptional||[];let c=n._usedIdsOptional||[];const h=n.ignoreIndicators;if(c||(c=[],n._usedIdsOptional=c),!s[i]||!s[i].common)return null;const g={objects:s,channelStates:uc.getChannelStates(s,i,a),usedIds:c,ignoreIndicators:h||[],result:null,pattern:Ph.Types.unknown,usedInCurrentDevice:[],state:{}};for(const b in lc.patterns){if(!uc.patternIsAllowed(lc.patterns[b],n.allowedTypes,n.excludedTypes)||(g.result=null,g.pattern=b,g.usedInCurrentDevice=[],lc.patterns[b].states.forEach(y=>{let w=!1;if(g.state=y,this._testOneState(g)&&(w=!0),y.required&&!w)return g.result=null,!1}),!uc.allRequiredStatesFound(g)))continue;g.usedInCurrentDevice.forEach(y=>c.push(y));let $;if(s[i].type!=="device"){const y=(0,sl.getParentId)(i);s[y]&&(s[y].type==="channel"||s[y].type==="device")&&($=(0,sl.getAllStatesInDevice)(a,y),$==null||$.forEach(w=>{var C;(C=g.result)===null||C===void 0||C.states.forEach((S,k)=>{!S.id&&(S.indicator||S.searchInParent)&&!S.noDeviceDetection&&this._applyPattern(s,w,S.original)&&g.result&&(g.result.states[k].id=w)})}))}if(g.result){const y=g.result;y&&y.states.forEach(w=>uc.cleanState(w,g.objects))}return g.result}return null}detect(n){const s=n.objects,i=n.id;let a=n._keysOptional,c=n._usedIdsOptional;if(this.cache[i]!==void 0)return this.cache[i];a||(a=Object.keys(s),a.sort(),n._keysOptional=a),c&&(c=[],n._usedIdsOptional=c);const h=[];let g;for(;g=this._detectNext(n);)h.push(g);return this.cache[i]=h.length?h:null,this.cache[i]}static getPatterns(){const n={};return Object.keys(lc.patterns).forEach(s=>{const i=JSON.parse(JSON.stringify(lc.patterns[s]));i.states.forEach((a,c)=>{const h=lc.patterns[s].states[c];h.role&&(i.states[c].role=h.role.toString()),h.enums&&(i.states[c].enums=!0)}),n[s]=i}),n}};Iy.ChannelDetector=dx;dx.getEnums=sl.getEnums;(function(o){Object.defineProperty(o,"__esModule",{value:!0}),o.StateType=o.Types=void 0;const n=Iy;o.default=n.ChannelDetector;var s=fc;Object.defineProperty(o,"Types",{enumerable:!0,get:function(){return s.Types}}),Object.defineProperty(o,"StateType",{enumerable:!0,get:function(){return s.StateType}})})(US);const Y2=aa(US),X2=Hx(()=>import("./docs-6na4NFtj.js"),[],import.meta.url);let ov=null;async function Z2(o){if(ov)return ov;const n=await o.getObjectViewSystem("state","","香"),s=await o.getObjectViewSystem("channel","","香"),i=await o.getObjectViewSystem("device","","香"),a=await o.getObjectViewSystem("folder","","香"),c=await o.getObjectViewSystem("enum","","香");return ov=Object.assign(n,s,i,a,c),ov}function Fh(o,n){return o&&typeof o=="object"?o[n]||o.en:o||""}async function Q2(o){var k,E,R,F;const n=I.I18n.getLanguage(),s=await Z2(o),i=Object.keys(s).sort(),a=new Y2,c=[],h=["UNREACH_STICKY"],g=[US.Types.info],b=[],$=[],y=[],w=[];i.forEach(M=>{var L,T,V;((L=s[M])==null?void 0:L.type)==="enum"?b.push(M):(V=(T=s[M])==null?void 0:T.common)!=null&&V.smartName&&w.push(M)}),b.forEach(M=>{M.startsWith("enum.rooms.")?$.push(M):M.startsWith("enum.functions.")&&y.push(M);const L=s[M].common.members;L!=null&&L.length&&L.forEach(T=>{s[T]&&(w.includes(T)||w.push(T))})});const C={id:"",objects:s,_keysOptional:i,_usedIdsOptional:c,ignoreIndicators:h,excludedTypes:g},S=[];w.forEach(M=>{C.id=M;const L=a.detect(C);L&&L.forEach(T=>{var q;const V=(q=T.states.find(re=>re.id))==null?void 0:q.id;if(!V||S.find(re=>re.id===V))return;const K=s[V],Y={id:V,name:Fh(K.common.name,n),type:K.type,deviceType:T.type,states:T.states.filter(re=>re.id).map(re=>({id:re.id,name:re.name,role:re.defaultRole,type:s[re.id].common.type,unit:s[re.id].common.unit,read:s[re.id].common.read===void 0?!0:s[re.id].common.read,write:s[re.id].common.write===void 0?!0:s[re.id].common.write}))},te=V.split(".");let J,ne;(K.type==="channel"||K.type==="state")&&(te.pop(),J=te.join("."),s[J]&&(s[J].type==="channel"||s[J].type==="folder")?(te.pop(),ne=te.join("."),(!s[ne]||s[ne].type!=="device"&&s[J].type!=="folder")&&(ne=void 0)):J=void 0);const Q=$.find(re=>{var De,ee,Fe;return(De=s[re].common.members)!=null&&De.includes(V)||J&&((ee=s[re].common.members)!=null&&ee.includes(J))?!0:ne&&((Fe=s[re].common.members)==null?void 0:Fe.includes(ne))});Q&&(Y.room=Fh(s[Q].common.name,n));const he=y.find(re=>{var De,ee,Fe;return(De=s[re].common.members)!=null&&De.includes(V)||J&&((ee=s[re].common.members)!=null&&ee.includes(J))?!0:ne&&((Fe=s[re].common.members)==null?void 0:Fe.includes(ne))});he&&(Y.function=Fh(s[he].common.name,n)),S.push(Y)})});for(let M=0;M<S.length;M++){const L=S[M];if(L.type==="state"||L.type==="channel"){const T=L.id.split(".");T.pop();const V=s[T.join(".")];if(V&&(V.type==="channel"||V.type==="device"||V.type==="folder")){L.name=Fh(((k=V.common)==null?void 0:k.name)||L.name,n),T.pop();const K=s[T.join(".")];(K==null?void 0:K.type)==="device"&&((E=K.common)!=null&&E.icon)&&(L.name=Fh(((R=K.common)==null?void 0:R.name)||L.name,n))}else L.name=Fh(((F=V==null?void 0:V.common)==null?void 0:F.name)||L.name,n)}}return S}const eF=async()=>(await X2).default,tF={ru:"Russian",en:"English",de:"German",es:"Spanish",fr:"French",it:"Italian",pl:"Polish",nl:"Dutch",pt:"Portuguese",uk:"Ukrainian","zh-cn":"Chinese"};function nF(){return f.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 2406 2406",children:[f.jsx("path",{d:"M1 578.4C1 259.5 259.5 1 578.4 1h1249.1c319 0 577.5 258.5 577.5 577.4V2406H578.4C259.5 2406 1 2147.5 1 1828.6V578.4z",fill:"#74aa9c"}),f.jsx("path",{d:"M1107.3 299.1c-198 0-373.9 127.3-435.2 315.3C544.8 640.6 434.9 720.2 370.5 833c-99.3 171.4-76.6 386.9 56.4 533.8-41.1 123.1-27 257.7 38.6 369.2 98.7 172 297.3 260.2 491.6 219.2 86.1 97 209.8 152.3 339.6 151.8 198 0 373.9-127.3 435.3-315.3 127.5-26.3 237.2-105.9 301-218.5 99.9-171.4 77.2-386.9-55.8-533.9v-.6c41.1-123.1 27-257.8-38.6-369.8-98.7-171.4-297.3-259.6-491-218.6-86.6-96.8-210.5-151.8-340.3-151.2zm0 117.5-.6.6c79.7 0 156.3 27.5 217.6 78.4-2.5 1.2-7.4 4.3-11 6.1L952.8 709.3c-18.4 10.4-29.4 30-29.4 51.4V1248l-155.1-89.4V755.8c-.1-187.1 151.6-338.9 339-339.2zm434.2 141.9c121.6-.2 234 64.5 294.7 169.8 39.2 68.6 53.9 148.8 40.4 226.5-2.5-1.8-7.3-4.3-10.4-6.1l-360.4-208.2c-18.4-10.4-41-10.4-59.4 0L1024 984.2V805.4L1372.7 604c51.3-29.7 109.5-45.4 168.8-45.5zM650 743.5v427.9c0 21.4 11 40.4 29.4 51.4l421.7 243-155.7 90L597.2 1355c-162-93.8-217.4-300.9-123.8-462.8C513.1 823.6 575.5 771 650 743.5zm807.9 106 348.8 200.8c162.5 93.7 217.6 300.6 123.8 462.8l.6.6c-39.8 68.6-102.4 121.2-176.5 148.2v-428c0-21.4-11-41-29.4-51.4l-422.3-243.7 155-89.3zM1201.7 997l177.8 102.8v205.1l-177.8 102.8-177.8-102.8v-205.1L1201.7 997zm279.5 161.6 155.1 89.4v402.2c0 187.3-152 339.2-339 339.2v-.6c-79.1 0-156.3-27.6-217-78.4 2.5-1.2 8-4.3 11-6.1l360.4-207.5c18.4-10.4 30-30 29.4-51.4l.1-486.8zM1380 1421.9v178.8l-348.8 200.8c-162.5 93.1-369.6 38-463.4-123.7h.6c-39.8-68-54-148.8-40.5-226.5 2.5 1.8 7.4 4.3 10.4 6.1l360.4 208.2c18.4 10.4 41 10.4 59.4 0l421.9-243.7z",fill:"white"})]})}const yT={toolbarButtons:{padding:4,marginLeft:4},fullHeightDialog:{height:"calc(100% - 100px)"}},sF=o=>{const[n,s]=ve.useState(window.localStorage.getItem("openai-question")||""),[i,a]=ve.useState(""),[c,h]=ve.useState(!1),[g,b]=ve.useState(!1),[$,y]=ve.useState(!1),[w,C]=ve.useState(window.localStorage.getItem("openai-model")||"gpt-4o"),[S,k]=ve.useState(!1),E=ve.useRef(null),R=ve.useRef(null),F=ve.useRef(null),M=ve.useCallback(async()=>{var K;let L;E.current?L=E.current:(L=await Q2(o.socket),E.current=L,console.log(`devices: ${JSON.stringify(L,null,2)}`));let T;if(R.current)T=R.current;else{const Y=Object.keys(o.runningInstances);for(let te=0;te<Y.length;te++){const J=await o.socket.getObject(Y[te]);if(T=((J==null?void 0:J.native.gptKey)||"").trim(),T)break}R.current=T||null}let V;if(F.current?V=F.current:(V=await eF(),F.current=V),!T){k(!0);return}b(!0),y(!1);try{const J=(await new cn({apiKey:T,dangerouslyAllowBrowser:!0}).chat.completions.create({model:w,messages:[{role:"system",content:`You are programmer. Here is a documentation:

${V}`},{role:"system",content:`Here is list of devices:

${JSON.stringify(L,null,2)}`},{role:"user",content:`Write JavaScript code that does:

${n}
Return only code.
Write comments in ${tF[I.I18n.getLanguage()]||"English"}.
You can call async function directly in the code without encapsulate them in async function as this code will be already executed in async function.
Do not import any libraries as all functions are already imported.`}]})).choices[0].message,ne=(K=J.content)==null?void 0:K.match(/```(javascript|js|typescript)\n?(.*)```(.*)/ms);let Q;if(!ne)Q=J.content,Q!=null&&Q.startsWith("`")&&(Q=Q.substring(1)),Q!=null&&Q.endsWith("`")&&(Q=Q.substring(0,Q.length-1));else if(Q=ne[2],ne[3]){const he=ne[3].split(`
`).map(q=>q.trim());for(;he[0]==="";)he.shift();Q=`${he.map(q=>`// ${q}`).join(`
`)}
${Q}`}console.log(J),a(Q||"")}catch(Y){console.log(JSON.stringify(Y)),Y.error&&y(Y.error.message),console.error(`Cannot request: ${Y}, ${JSON.stringify(Y.error||Y,null,2)}`)}b(!1)},[n,w,o.runningInstances,o.socket]);return f.jsxs(f.Fragment,{children:[f.jsx(D.IconButton,{"aria-label":"AI",title:I.I18n.t("AI code generator"),style:yT.toolbarButtons,size:"medium",onClick:()=>h(!0),children:f.jsx(nF,{})},"ai"),S&&f.jsxs(D.Dialog,{maxWidth:"lg",open:!0,onClose:()=>k(!1),fullWidth:!0,children:[f.jsx(D.DialogTitle,{children:I.I18n.t("No Chat GPT Key found")}),f.jsxs(D.DialogContent,{style:{display:"flex",flexDirection:"column",gap:8},children:[f.jsx("div",{children:I.I18n.t("You have to enter OpenAI API key in the configuration of javascript adapter.")}),f.jsx(D.Button,{variant:"contained",onClick:()=>{const L=Object.keys(o.runningInstances);window.open(`../../#tab-instances/config/${L[0]||"system.adapter.javascript.0"}`,"_blank"),k(!1)},children:I.I18n.t("Open configuration")})]}),f.jsx(D.DialogActions,{children:f.jsx(D.Button,{variant:"contained",startIcon:f.jsx(K_,{}),onClick:()=>k(!1),children:I.I18n.t("Close")})})]}),c&&f.jsxs(D.Dialog,{maxWidth:"lg",sx:{"& .MuiDialog-paper":yT.fullHeightDialog},open:!0,onClose:()=>h(!1),fullWidth:!0,children:[f.jsx(D.DialogTitle,{children:I.I18n.t("AI code generator")}),f.jsxs(D.DialogContent,{style:{display:"flex",flexDirection:"column",gap:8,height:"100%"},children:[f.jsx("div",{children:f.jsx(D.TextField,{variant:"standard",multiline:!0,autoFocus:!0,disabled:g,fullWidth:!0,onKeyUp:L=>{L.key==="Enter"&&L.ctrlKey&&M()},label:I.I18n.t("Enter your question"),helperText:I.I18n.t("Press Ctrl+Enter to get the answer"),value:n,onChange:L=>{window.localStorage.setItem("openai-question",L.target.value),s(L.target.value)}})}),f.jsxs("div",{style:{display:"flex",alignItems:"baseline"},children:[f.jsx(D.Button,{variant:"contained",disabled:g||!n,startIcon:f.jsx(Ux,{}),onClick:async()=>M(),children:g?f.jsx(D.CircularProgress,{size:24}):I.I18n.t("Ask")}),f.jsxs(D.FormControl,{style:{width:150,marginLeft:20},variant:"standard",children:[f.jsx(D.InputLabel,{children:I.I18n.t("Model")}),f.jsxs(D.Select,{variant:"standard",value:w,onChange:L=>{window.localStorage.setItem("openai-model",L.target.value),$&&y(!1),C(L.target.value)},children:[f.jsx(D.MenuItem,{value:"gpt-4o",children:"GPT-4o"}),f.jsx(D.MenuItem,{value:"gpt-4-turbo",children:"GPT-4 Turbo"}),f.jsx(D.MenuItem,{value:"gpt-4-32k",children:"GPT-4 32k"}),f.jsx(D.MenuItem,{value:"gpt-4",children:"GPT-4"}),f.jsx(D.MenuItem,{value:"gpt-3.5-turbo-16k",children:"GPT-3.5 Turbo"})]})]})]}),f.jsx("div",{children:I.I18n.t("Result")}),f.jsx("div",{style:{height:"calc(100% - 155px)"},children:$?f.jsx("div",{style:{color:o.themeType==="dark"?"#984242":"#bb0000"},children:$}):f.jsx(wy,{adapterName:o.adapterName,runningInstances:o.runningInstances,style:{height:"100%",width:"100%",resize:"none"},name:"ai",socket:o.socket,readOnly:!0,checkJs:!0,code:i,isDark:o.themeType==="dark",language:o.language||"javascript"})})]}),f.jsxs(D.DialogActions,{children:[f.jsx(D.Button,{color:"grey",variant:"outlined",disabled:!i,startIcon:f.jsx(pE,{}),onClick:()=>{I.Utils.copyToClipboard(i),window.alert(I.I18n.t("Copied"))},children:I.I18n.t("Copy to clipboard")}),f.jsx(D.Button,{color:"primary",variant:"contained",disabled:!i||$,startIcon:f.jsx(ol,{}),onClick:()=>{o.onAddCode(i),h(!1)},children:I.I18n.t("Use generated code")}),f.jsx(D.Button,{color:"grey",variant:"contained",startIcon:f.jsx(K_,{}),onClick:()=>h(!1),children:I.I18n.t("Close")})]})]})]})},_T="./assets/js.svg",rF="./assets/blockly.svg",iF="./assets/typescript.svg",oF="./assets/blockly2js.svg",aF="./assets/rules2js.svg",lF="./assets/rules.svg",wT={Blockly:rF,"Javascript/js":_T,Rules:lF,def:_T,"TypeScript/ts":iF},cF=48,ST="#02a102",W_="#70aae9",uF=ET[400],dF=kT[400],$t={toolbar:o=>({minHeight:38,boxShadow:"0px 2px 4px -1px rgba(0, 0, 0, 0.2), 0px 4px 5px 0px rgba(0, 0, 0, 0.14), 0px 1px 10px 0px rgba(0, 0, 0, 0.12)",backgroundColor:o.palette.mode==="dark"?"#1e1e1e":"#E2E2E2"}),toolbarButtons:{padding:4,marginLeft:4},toolbarButtonsDisabled:{filter:"grayscale(100%)",opacity:.5},editorDiv:o=>({height:`calc(100% - ${(parseInt(o.toolbar.height,10)||48)+38+10}px)`,width:"100%",overflow:"hidden",position:"relative"}),textButton:{marginRight:10,minHeight:24,padding:"6px 16px"},saveButton:{background:"#ff9900"},textIcon:{marginLeft:8},tabIcon:{width:24,height:24,verticalAlign:"middle",marginBottom:2,marginRight:2,borderRadius:3},hintIcon:{padding:"0 8px 0 8px"},hintText:{},hintButton:{marginTop:8,marginLeft:20},tabMenuButton:{position:"absolute",top:0,right:0},tabChanged:o=>({color:o.palette.secondary.main}),tabText:{maxWidth:130,textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",display:"inline-block",verticalAlign:"middle"},tabChangedIcon:{color:"#FF0000",fontSize:16,marginLeft:5},closeButton:{marginLeft:5},notRunning:{color:"#ffbc00",marginRight:8,marginLeft:8},tabButton:{minHeight:48},tabButtonWrapper:{display:"inline-block"},menuIcon:{width:18,height:18,borderRadius:2,marginRight:5}};class Gh extends Le.Component{getSelect=null;cron={initValue:null,callback:null};scriptDialog={initValue:null,callback:null,args:null,isReturn:!1};objects;scripts;selectId={initValue:null,callback:null};confirmCallback=null;constructor(n){super(n);const s=window.localStorage.getItem("Editor.selected")||"",i=window.localStorage.getItem("Editor.editing")||"[]";let a;try{a=JSON.parse(i)}catch{a=[]}s&&!a.includes(s)&&a.push(s),this.state={askAboutDebug:!1,astroEvents:null,blockly:null,changed:{},cmdToBlockly:"",cmdToRules:"",confirm:"",debugEnabled:!1,editing:a,insert:"",instancesLoaded:!1,isTourOpen:window.localStorage.getItem("tour")!=="true",menuDebugAnchorEl:null,menuOpened:!!this.props.menuOpened,menuTabsOpened:!1,rules:null,runningInstances:this.props.runningInstances||{},searchText:"",selected:s,showAdapterDebug:!1,showAstro:!1,showCompiledCode:!1,showCron:!1,showDebugMenu:!1,showScript:!1,showSelectId:!1,themeType:this.props.themeType,toast:"",tourStep:Is.selectTriggers,verboseEnabled:!1,visible:n.visible},this.setChangedInAdmin(),window.systemLang=I.I18n.getLanguage(),window.main={objects:{},getObject:(c,h)=>this.props.socket.getObject(c).then(g=>h&&h(null,g)).catch(g=>h&&h(g)),instances:[],selectIdDialog:(c,h,g)=>{typeof h=="function"&&(g=h,h=null),this.selectId.callback=g,this.selectId.initValue=c,this.selectId.type=h,this.setState({showSelectId:!0})},cronDialog:(c,h)=>{this.cron.callback=h,this.cron.initValue=c,this.setState({showCron:!0})},showScriptDialog:(c,h,g,b)=>{this.scriptDialog.callback=b,this.scriptDialog.initValue=c,this.scriptDialog.args=h,this.scriptDialog.isReturn=g||!1,this.setState({showScript:!0})}},this.objects=n.objects,this.scripts={},!this.state.selected&&this.state.editing.length&&Object.assign(this.state,{selected:this.state.editing[0]}),this.getAllAdapterInstances().then(()=>{this.props.onSelectedChange&&this.state.selected&&setTimeout(()=>this.props.onSelectedChange(this.state.selected,this.state.editing),100)})}getAllAdapterInstances(){return this.props.socket.getAdapterInstances(!0).then(n=>{const s={},i=n.map(a=>(s[a._id]=a,a._id));window.main.objects=s,window.main.instances=i,this.setState({instancesLoaded:!0})})}static onInstanceChanged(n,s){if(n)if(!s&&window.main.instances.includes[n]){delete window.main.objects[n];const i=window.main.instances.indexOf(n);window.main.instances.splice(i,1)}else s&&s.type==="instance"&&(window.main.instances.includes(n)||(window.main.instances.push(n),window.main.instances.sort()),window.main.objects[n]=s)}setChangedInAdmin(){const n=Object.keys(this.state.changed).find(s=>this.state.changed[s]);typeof window.parent<"u"&&window.parent&&(window.parent.configNotSaved=!!n)}componentDidMount(){window.addEventListener("beforeunload",this.onBrowserClose,!1),this.props.socket.subscribeObject("system.adapter.*",Gh.onInstanceChanged)}componentWillUnmount(){window.removeEventListener("beforeunload",this.onBrowserClose),this.props.socket.unsubscribeObject("system.adapter.*",Gh.onInstanceChanged)}onBrowserClose=n=>{const s=Object.keys(this.scripts).find(i=>JSON.stringify(this.scripts[i])!==JSON.stringify(this.props.objects[i].common));if(s){console.log(`Script ${JSON.stringify(this.scripts[s])}`);const i=I.I18n.t("Configuration not saved.");return n=n||window.event,n&&(n.returnValue=i),i}};removeNonExistingScripts(n,s){n=n||this.props,s=s||{};let i=!1;if(this.state.editing&&this.state.editing.find(c=>n&&!n.objects[c])){const c=JSON.parse(JSON.stringify(this.state.editing));for(let h=c.length-1;h>=0;h--)this.objects[c[h]]||(i=!0,c.splice(h,1));i&&(s.editing=c),this.state.selected&&!this.objects[this.state.selected]&&(i=!0,s.selected=c[0]||"",s.selected&&this.scripts[s.selected]&&(this.state.blockly!==(this.scripts[s.selected].engineType==="Blockly")&&(s.blockly=this.scripts[s.selected].engineType==="Blockly",i=!0),this.state.rules!==(this.scripts[s.selected].engineType==="Rules")&&(s.rules=this.scripts[s.selected].engineType==="Rules",i=!0),this.state.verboseEnabled!==this.scripts[s.selected].verbose&&(s.verboseEnabled=this.scripts[s.selected].verbose,i=!0),this.state.debugEnabled!==this.scripts[s.selected].debug&&(s.debugEnabled=this.scripts[s.selected].debug,i=!0)))}return i}UNSAFE_componentWillReceiveProps(n){var a,c;const s={};let i=!1;if(JSON.stringify(n.runningInstances)!==JSON.stringify(this.state.runningInstances)&&(i=!0,s.runningInstances=n.runningInstances),this.state.menuOpened!==n.menuOpened&&(s.menuOpened=n.menuOpened,i=!0),this.state.themeType!==n.themeType&&(s.themeType=n.themeType,i=!0),this.removeNonExistingScripts(n,s)&&(i=!0),this.state.searchText!==n.searchText&&(s.searchText=n.searchText,i=!0),this.objects!==n.objects){this.objects=n.objects,window.main.objects=n.objects,Object.keys(this.scripts).forEach(g=>{const b=this.scripts[g].source;this.scripts[g]=JSON.parse(JSON.stringify(this.objects[g].common)),this.scripts[g].source=b}),this.state.selected&&this.objects[this.state.selected]&&(this.scripts[this.state.selected]=this.scripts[this.state.selected]||JSON.parse(JSON.stringify(this.objects[this.state.selected].common)),this.state.blockly!==(this.scripts[this.state.selected].engineType==="Blockly")&&(s.blockly=this.scripts[this.state.selected].engineType==="Blockly",i=!0),this.state.rules!==(this.scripts[this.state.selected].engineType==="Rules")&&(s.rules=this.scripts[this.state.selected].engineType==="Rules",i=!0),this.state.verboseEnabled!==this.scripts[this.state.selected].verbose&&(s.verboseEnabled=this.scripts[this.state.selected].verbose,i=!0),this.state.debugEnabled!==this.scripts[this.state.selected].debug&&(s.debugEnabled=this.scripts[this.state.selected].debug,i=!0));const h=JSON.parse(JSON.stringify(this.state.editing));for(let g=h.length-1;g>=0;g--)this.objects[h[g]]||(i=!0,h.splice(g,1),this.state.changed[h[g]]!==void 0&&(s.changed=s.changed||JSON.parse(JSON.stringify(this.state.changed)),s.changed&&delete s.changed[h[g]]));this.state.selected&&!this.objects[this.state.selected]&&(s.selected=h[0]||""),i&&(s.editing=h)}else for(const h in this.scripts)if(Object.prototype.hasOwnProperty.call(this.scripts,h)){if((a=this.objects[h])!=null&&a.common){if(this.objects[h].type==="script"){const g=this.scripts[h].source,b=JSON.parse(JSON.stringify(this.scripts[h]));b.source=this.objects[h].common.source,JSON.stringify(b)!==JSON.stringify(this.objects[h].common)&&(this.scripts[h]=JSON.parse(JSON.stringify(this.objects[h].common)),this.scripts[h].source=g),g!==this.objects[h].common.source?this.state.changed[h]?(c=this.objects[h].from)!=null&&c.startsWith("system.adapter.javascript.")&&(this.objects[h].from="system.adapter.admin.0",this.setState({toast:I.I18n.t("Script %s was modified on disk.",h.split(".").pop())})):this.scripts[h].source=this.objects[h].common.source:this.state.changed[h]&&(s.changed=s.changed||JSON.parse(JSON.stringify(this.state.changed)),s.changed&&(s.changed[h]=!1),i=!0)}}else if(this.scripts[h]&&(delete this.scripts[h],this.state.selected===h)){if(this.state.editing.indexOf(h)!==-1){const g=JSON.parse(JSON.stringify(this.state.editing)),b=g.indexOf(h);b!==-1&&(g.splice(b,1),s.editing=g,i=!0)}s.selected=this.state.editing[0]||"",i=!0}}if(this.state.selected!==n.selected&&n.selected){n.selected&&(this.scripts[n.selected]=this.scripts[n.selected]||JSON.parse(JSON.stringify(this.props.objects[n.selected].common)));const h=this.props.objects[n.selected]&&this.props.objects[n.selected].common,g=h&&JSON.stringify(this.scripts[n.selected])!==JSON.stringify(h),b=JSON.parse(JSON.stringify(this.state.editing));n.selected&&b.indexOf(n.selected)===-1&&(b.push(n.selected),this.props.onSelectedChange(n.selected,b),window.localStorage&&window.localStorage.setItem("Editor.editing",JSON.stringify(b))),i=!0,s.changed=s.changed||JSON.parse(JSON.stringify(this.state.changed)),s.changed&&(s.changed[n.selected]=g),s.editing=b,s.selected=n.selected,s.blockly=this.scripts[n.selected].engineType==="Blockly",s.rules=this.scripts[n.selected].engineType==="Rules",s.verboseEnabled=this.scripts[n.selected].verbose,s.debugEnabled=this.scripts[n.selected].debug,s.showCompiledCode=!1}this.state.visible!==n.visible&&(i=!0,s.visible=n.visible),i&&this.setState(s,()=>this.setChangedInAdmin())}onRestart(){this.props.onRestart&&this.props.onRestart(this.state.selected)}onStartStop(){const n=JSON.parse(JSON.stringify(this.scripts[this.state.selected]));n.enabled=!n.enabled,this.props.onChange&&this.props.onChange(this.state.selected,n)}onSave(){if(this.state.isTourOpen&&this.state.tourStep===Is.saveTheScript&&(this.setState({isTourOpen:!1}),window.localStorage.setItem("tour","true")),this.state.changed[this.state.selected]){const n=JSON.parse(JSON.stringify(this.state.changed));n[this.state.selected]=!1,this.setState({changed:n},()=>{this.setChangedInAdmin(),this.props.onChange&&this.props.onChange(this.state.selected,this.scripts[this.state.selected])})}}onSaveAll(){const n=JSON.parse(JSON.stringify(this.state.changed));Object.keys(n).forEach(s=>{n[s]&&(n[s]=!1,this.props.onChange&&this.props.onChange(s,this.scripts[s]))}),this.setState({changed:n},()=>this.setChangedInAdmin())}onCancel(){this.scripts[this.state.selected]=JSON.parse(JSON.stringify(this.props.objects[this.state.selected].common));const n=JSON.parse(JSON.stringify(this.state.changed));n[this.state.selected]=!1,this.setState({changed:n},()=>this.setChangedInAdmin())}onRegisterSelect(n){this.getSelect=n}onConvertBlockly2JS(){this.showConfirmDialog(I.I18n.t("It will not be possible to revert this operation."),n=>{if(n){this.scripts[this.state.selected].engineType="Javascript/js";const i=this.scripts[this.state.selected].source.split(`
`);i.pop(),this.scripts[this.state.selected].source=i.join(`
`);const a=this.state.selected,c=JSON.parse(JSON.stringify(this.state.changed));c[this.state.selected]=!0,this.setState({changed:c,blockly:!1,selected:""},()=>{this.setChangedInAdmin(),setTimeout(()=>this.setState({selected:a}),100)})}})}onChange(n){n=n||{},n&&(n.script!==void 0&&(this.scripts[this.state.selected].source=n.script),n.debug!==void 0&&(this.scripts[this.state.selected].debug=n.debug),n.verbose!==void 0&&(this.scripts[this.state.selected].verbose=n.verbose));const s=JSON.stringify(this.scripts[this.state.selected])!==JSON.stringify(this.props.objects[this.state.selected].common);if(s!==(this.state.changed[this.state.selected]||!1)){const i=JSON.parse(JSON.stringify(this.state.changed));i[this.state.selected]=s,this.objects[this.state.selected].from="system.adapter.admin.0",this.setState({changed:i},()=>this.setChangedInAdmin())}}onTabChange(n){if(this.props.debugMode)return;window.localStorage&&window.localStorage.setItem("Editor.selected",n);const s=this.scripts[n]||this.props.objects[n]&&this.props.objects[n].common;this.setState({selected:n,rules:s.engineType==="Rules",blockly:s.engineType==="Blockly",showCompiledCode:!1,verboseEnabled:s.verbose,debugEnabled:s.debug}),this.props.onSelectedChange&&this.props.onSelectedChange(n,this.state.editing)}isScriptChanged(n){return!!(this.scripts[n]&&this.props.objects[n]&&JSON.stringify(this.scripts[n])!==JSON.stringify(this.props.objects[n].common))}onTabClose(n,s){s==null||s.stopPropagation();const i=this.state.editing.indexOf(n);if(this.state.editing.includes(n))if(this.isScriptChanged(n))this.showConfirmDialog(I.I18n.t("Discard changes for %s",this.props.objects[n].common.name),a=>{a&&(delete this.scripts[n],this.onTabClose(n))});else{const a=JSON.parse(JSON.stringify(this.state.editing));a.splice(i,1);const c={editing:a};if(n===this.state.selected?a.length?i===0||a.length===1?c.selected=a[0]:c.selected=a[i-1]:c.selected="":this.state.selected&&!a.length&&(c.selected=""),window.localStorage&&window.localStorage.setItem("Editor.editing",JSON.stringify(a)),c.selected!==void 0){c.changed=c.changed||JSON.parse(JSON.stringify(this.state.changed))||{},c.changed&&(c.changed[c.selected]=this.isScriptChanged(c.selected));const h=c.selected&&(this.scripts[c.selected]||this.props.objects[c.selected]&&this.props.objects[c.selected].common);c.blockly=h?h.engineType==="Blockly":!1,c.rules=h?h.engineType==="Rules":!1,c.verboseEnabled=h?h.verbose:!1,c.debugEnabled=h?h.debug:!1,c.showCompiledCode=!1}this.setState(c,()=>{this.setChangedInAdmin(),c.selected!==void 0?(this.props.onSelectedChange&&this.props.onSelectedChange(c.selected,this.state.editing),window.localStorage&&window.localStorage.setItem("Editor.selected",c.selected)):this.props.onSelectedChange&&this.props.onSelectedChange(this.state.selected,this.state.editing)})}}showConfirmDialog(n,s){this.confirmCallback=s,this.setState({confirm:n})}sendCommandToBlockly(n){this.setState({cmdToBlockly:n},()=>setTimeout(()=>this.setState({cmdToBlockly:""}),200))}sendCommandToRules(n){this.setState({cmdToRules:n},()=>setTimeout(()=>this.setState({cmdToRules:""}),200))}static getText(n){return typeof n=="object"?n[I.I18n.getLanguage()]||n.en:n}getScriptFullName(n){const s=n.split(".");s.shift(),s.shift();const i=[];let a="script.js";for(let c=0;c<s.length;c++)a+=`.${s[c]}`,this.props.objects[a]&&this.props.objects[a].common?i.push(Gh.getText(this.props.objects[a].common.name)):i.push(s[c]);return`/ ${i.join(" / ")}`}getTabs(){return this.state.editing.length?[f.jsxs(D.Tabs,{component:"div",value:this.props.debugInstance?this.props.debugInstance.adapter:this.state.selected,onChange:(n,s)=>this.onTabChange(s),indicatorColor:"primary",style:{position:"relative",marginLeft:10,width:this.state.editing.length>1?"calc(100% - 50px)":"100%",display:"inline-block"},textColor:"primary",variant:"scrollable",scrollButtons:"auto",allowScrollButtonsMobile:!0,children:[this.state.editing.map(n=>{if(!this.props.objects[n]){const h=[f.jsx(D.Box,{sx:this.isScriptChanged(n)?$t.tabChanged:void 0,style:$t.tabText,children:n.split(".").pop()},"text"),f.jsx(D.IconButton,{onClick:g=>this.onTabClose(n,g),style:$t.closeButton,size:"small",component:"span",children:f.jsx(Uh,{})},"icon")];return f.jsx(D.Tab,{wrapped:!0,href:`#${n}`,label:h,value:n,sx:{"& .MuiTab-wrapper":$t.tabButtonWrapper}},n)}let s=Gh.getText(this.props.objects[n].common.name)||"";const i=this.getScriptFullName(n);s.length>18&&(s=`${s.substring(0,15)}...`);const a=this.scripts[n]&&this.props.objects[n].common&&this.props.objects[n].common.source!==this.scripts[n].source,c=[f.jsx(D.Box,{sx:this.isScriptChanged(n)?$t.tabChanged:void 0,style:$t.tabText,children:s},"text"),a?f.jsx("span",{style:$t.tabChangedIcon,children:"▣"},"changedSign"):null,!this.props.debugInstance&&(!this.props.debugMode||this.state.selected!==n)&&f.jsx(D.IconButton,{onClick:h=>this.onTabClose(n,h),style:$t.closeButton,size:"small",component:"span",children:f.jsx(Uh,{})},"icon")];return f.jsx(D.Tab,{disabled:!!this.props.debugInstance||this.state.selected!==n&&this.props.debugMode,wrapped:!0,iconPosition:"start",icon:f.jsx("img",{alt:"",src:wT[this.props.objects[n].common.engineType]||wT.def,style:$t.tabIcon},"icon"),href:`#${n}`,label:c,style:$t.tabButton,value:n,title:i,sx:{"& .MuiTab-wrapper":$t.tabButtonWrapper}},n)}),this.props.debugInstance?f.jsx(D.Tab,{disabled:!1,wrapped:!0,href:`#${this.props.debugInstance.adapter}`,label:this.props.debugInstance.adapter,style:$t.tabButton,value:this.props.debugInstance.adapter,title:this.props.debugInstance.adapter,sx:{"& .MuiTab-wrapper":$t.tabButtonWrapper}},this.props.debugInstance.adapter):""]},"tabs1"),this.state.editing.length>1?f.jsx(D.IconButton,{href:"#","aria-label":"Close all but current",style:$t.tabMenuButton,title:I.I18n.t("Close all but current"),"aria-haspopup":"false",onClick:n=>{const s=[this.state.selected];Object.keys(this.scripts).forEach(i=>i!==this.state.selected&&JSON.stringify(this.scripts[i])!==JSON.stringify(this.props.objects[i].common)&&s.push(i)),window.localStorage&&window.localStorage.setItem("Editor.editing",JSON.stringify(s)),this.setState({menuTabsOpened:!1,editing:s})},size:"medium",children:f.jsx(T1,{})},"menuButton"):null]:f.jsx(D.Box,{sx:$t.toolbar,children:f.jsxs(D.Button,{color:"grey",disabled:!0,style:$t.hintButton,href:"",children:[f.jsx("span",{children:I.I18n.t("Click on this icon")},"select2"),f.jsx(zT,{style:$t.hintIcon},"select3"),f.jsx("span",{children:I.I18n.t("for edit or create script")},"select4")]},"select1")},"tabs2")}getDebugMenu(){return this.state.showDebugMenu?f.jsxs(D.Menu,{id:"menu-debug",anchorEl:this.state.menuDebugAnchorEl,open:this.state.showDebugMenu,onClose:()=>this.setState({showDebugMenu:!1,menuDebugAnchorEl:null}),slotProps:{root:{style:{maxHeight:cF*7.5}}},children:[f.jsxs(D.MenuItem,{title:I.I18n.t("debug_help"),onClick:n=>{n.stopPropagation(),n.preventDefault(),this.setState({showDebugMenu:!1,menuDebugAnchorEl:null,debugEnabled:!this.state.debugEnabled},()=>this.onChange({debug:this.state.debugEnabled}))},children:[f.jsx(D.Checkbox,{checked:this.state.debugEnabled}),f.jsx(Hf,{style:{...$t.menuIcon,color:ST}}),I.I18n.t("debug_label")]},"debugEnabled"),f.jsxs(D.MenuItem,{title:I.I18n.t("verbose_help"),onClick:n=>{n.stopPropagation(),n.preventDefault(),this.setState({showDebugMenu:!1,menuDebugAnchorEl:null,verboseEnabled:!this.state.verboseEnabled},()=>this.onChange({verbose:this.state.verboseEnabled}))},children:[f.jsx(D.Checkbox,{checked:this.state.verboseEnabled}),f.jsx(R0,{style:{...$t.menuIcon,color:W_}}),I.I18n.t("verbose_label")]},"verboseEnabled")]},"menuDebug"):null}getDebugBadge(){return[this.state.debugEnabled&&this.state.verboseEnabled?f.jsx(Hf,{style:{...$t.menuIcon,color:W_}},"DebugVerbose"):null,this.state.debugEnabled&&!this.state.verboseEnabled?f.jsx(Hf,{style:{...$t.menuIcon,color:ST}},"DebugNoVerbose"):null,!this.state.debugEnabled&&this.state.verboseEnabled?f.jsx(R0,{style:{...$t.menuIcon,color:W_}},"noDebugVerbose"):null]}getAskAboutDebug(){return this.state.askAboutDebug?f.jsx(I.Confirm,{onClose:()=>{this.setState({askAboutDebug:!1},()=>this.props.onDebugModeChange(!0))},ok:I.I18n.t("Yes"),cancel:I.I18n.t("Cancel"),text:I.I18n.t("The script will be stopped and must be activated manually after debugging. Continue?")}):null}getToolbar(){const n=!!(this.state.selected&&this.scripts[this.state.selected]&&this.scripts[this.state.selected].engine&&this.state.runningInstances[this.scripts[this.state.selected].engine]),s=!!(this.state.selected&&this.scripts[this.state.selected]&&this.scripts[this.state.selected].enabled);if(this.state.selected){const i=Object.keys(this.state.changed).filter(c=>this.state.changed[c]).length,a=this.state.changed[this.state.selected];return f.jsxs(D.Toolbar,{variant:"dense",sx:$t.toolbar,children:[!this.props.debugInstance&&this.state.menuOpened&&this.props.onLocate&&f.jsx(D.IconButton,{style:$t.toolbarButtons,title:I.I18n.t("Locate file"),onClick:()=>this.props.onLocate(this.state.selected),size:"medium",children:f.jsx(E1,{})},"locate"),!this.props.debugInstance&&!a&&n?f.jsx(D.IconButton,{disabled:this.props.debugMode,style:$t.toolbarButtons,onClick:()=>this.onRestart(),title:I.I18n.t("Restart"),size:"medium",children:f.jsx(WT,{})},"restart"):null,!this.props.debugInstance&&!a?f.jsx(D.IconButton,{disabled:this.props.debugMode,onClick:()=>this.onStartStop(),title:s?I.I18n.t("Pause script"):I.I18n.t("Run script"),size:"medium",style:{...$t.toolbarButtons,color:s?uF:dF},children:s?f.jsx(Xf,{}):f.jsx(Iv,{})},"start-stop"):null,!this.props.debugInstance&&!a&&!s?f.jsx("span",{style:$t.notRunning,children:I.I18n.t("Script is not running")}):null,!a&&s&&!n?f.jsx("span",{style:$t.notRunning,children:I.I18n.t("Instance is disabled")}):null,a?f.jsx(D.Button,{color:"grey",variant:"contained",style:{...$t.textButton,...$t.saveButton},className:"button-save",onClick:()=>this.onSave(),endIcon:f.jsx(A0,{}),children:I.I18n.t("Save")},"save"):null,i>1||i===1&&!a?f.jsx(D.Button,{color:"grey",variant:"contained",style:$t.textButton,onClick:()=>this.onSaveAll(),endIcon:f.jsx(A0,{}),children:I.I18n.t("Save all")},"saveall"):null,a?f.jsx(D.Button,{color:"grey",variant:"contained",style:$t.textButton,onClick:()=>this.onCancel(),endIcon:f.jsx(uy,{}),children:I.I18n.t("Cancel")},"cancel"):null,f.jsx("div",{style:{flex:2}}),this.state.blockly&&!this.state.showCompiledCode?f.jsx(D.IconButton,{"aria-label":"Export Blocks",title:I.I18n.t("Export blocks"),style:$t.toolbarButtons,onClick:()=>this.sendCommandToBlockly("export"),size:"medium",children:f.jsx(xv,{})},"export"):null,this.state.blockly&&!this.state.showCompiledCode&&f.jsx(D.IconButton,{"aria-label":"Import Blocks",title:I.I18n.t("Import blocks"),style:$t.toolbarButtons,onClick:()=>this.sendCommandToBlockly("import"),size:"medium",children:f.jsx(sw,{})},"import"),this.state.blockly&&!this.state.showCompiledCode&&f.jsx(D.IconButton,{"aria-label":"Check code",title:I.I18n.t("Check blocks"),style:$t.toolbarButtons,onClick:()=>this.sendCommandToBlockly("check"),size:"medium",children:f.jsx(XO,{})},"check"),!this.props.debugMode&&!this.state.blockly&&!this.state.rules&&!this.state.showCompiledCode?f.jsx(D.IconButton,{"aria-label":"create CRON",title:I.I18n.t("Create or edit CRON or time wizard"),style:$t.toolbarButtons,onClick:()=>this.setState({showCron:!0}),size:"medium",children:f.jsx(YO,{})},"select-cron"):null,this.scripts[this.state.selected]&&this.scripts[this.state.selected].engineType!=="Blockly"&&this.scripts[this.state.selected].engineType!=="Rules"?f.jsx(sF,{adapterName:this.props.adapterName,socket:this.props.socket,runningInstances:this.state.runningInstances,themeType:this.state.themeType,language:this.scripts[this.state.selected].engineType==="TypeScript/ts"?"typescript":"javascript",onAddCode:c=>this.setState({insert:c})}):null,f.jsx(D.IconButton,{"aria-label":"Show astronomical events",title:I.I18n.t("Show astronomical events"),style:$t.toolbarButtons,disabled:!n,onClick:()=>{this.setState({showAstro:!0,astroEvents:null}),this.props.socket.sendTo(this.scripts[this.state.selected].engine.replace("system.adapter.",""),"calcAstroAll",{}).then(c=>this.setState({astroEvents:c}))},size:"medium",children:f.jsx(x1,{})},"show-astro"),!this.props.debugMode&&!this.state.blockly&&!this.state.rules&&!this.state.showCompiledCode&&f.jsx(D.IconButton,{"aria-label":"select ID",title:I.I18n.t("Insert object ID"),style:$t.toolbarButtons,onClick:()=>this.setState({showSelectId:!0}),size:"medium",children:f.jsx(JO,{})},"select-id"),this.state.blockly&&!this.state.rules&&this.state.showCompiledCode&&f.jsx(D.Button,{color:"grey","aria-label":"convert to javascript",title:I.I18n.t("Convert blockly to javascript for ever."),onClick:()=>this.onConvertBlockly2JS(),children:"Blockly=>JS"},"convert2js"),this.state.rules&&!this.state.showCompiledCode&&f.jsx(D.IconButton,{"aria-label":"Export Blocks",title:I.I18n.t("Export blocks"),style:$t.toolbarButtons,onClick:()=>this.sendCommandToRules("export"),size:"medium",children:f.jsx(xv,{})},"export"),this.state.rules&&!this.state.showCompiledCode&&f.jsx(D.IconButton,{"aria-label":"Import Blocks",title:I.I18n.t("Import blocks"),style:$t.toolbarButtons,onClick:()=>this.sendCommandToRules("import"),size:"medium",children:f.jsx(sw,{})},"import"),this.props.expertMode&&!a&&(this.props.debugMode||!this.state.blockly&&!this.state.rules||(this.state.blockly||this.state.rules)&&this.state.showCompiledCode)&&f.jsx(D.IconButton,{style:$t.toolbarButtons,color:this.props.debugMode?"primary":"default",disabled:!this.props.debugMode&&!n,onClick:()=>{!this.props.debugMode&&s?this.setState({askAboutDebug:!0}):this.props.onDebugModeChange(!this.props.debugMode)},size:"medium",children:f.jsx(Hf,{style:{fontSize:32}})}),(this.state.blockly||this.state.rules)&&f.jsx(D.Button,{"aria-label":"blockly",title:I.I18n.t("Show javascript code"),className:"button-js-code",color:this.state.showCompiledCode?"secondary":"inherit",disabled:this.props.debugMode,style:{...$t.toolbarButtons,...this.props.debugMode?$t.toolbarButtonsDisabled:void 0,padding:"0 5px"},onClick:()=>{this.props.debugMode||(this.setState({showCompiledCode:!this.state.showCompiledCode}),this.state.isTourOpen&&this.state.tourStep===Is.showJavascript&&this.setState({tourStep:Is.switchBackToRules}),this.state.isTourOpen&&this.state.tourStep===Is.switchBackToRules&&this.setState({tourStep:Is.saveTheScript}))},children:f.jsx("img",{alt:this.state.blockly?"blockly2js":"rules2js",src:this.state.blockly?oF:aF})},"blockly-code"),f.jsx(D.IconButton,{disabled:this.props.debugMode,"aria-label":"Debug menu",title:I.I18n.t("Debug options"),style:$t.toolbarButtons,onClick:c=>this.setState({showDebugMenu:!0,menuDebugAnchorEl:c.currentTarget}),size:"medium",children:f.jsx(D.Badge,{style:$t.badgeMargin,badgeContent:this.getDebugBadge(),children:f.jsx($1,{})})},"debug")]},"toolbar1")}return null}getScriptEditor(){return!this.props.debugMode&&this.state.selected&&this.props.objects[this.state.selected]&&this.state.blockly!==null&&(!this.state.blockly||this.state.showCompiledCode)&&(!this.state.rules||this.state.showCompiledCode)?(this.scripts[this.state.selected]=this.scripts[this.state.selected]||JSON.parse(JSON.stringify(this.props.objects[this.state.selected].common)),f.jsx(D.Box,{sx:$t.editorDiv,children:f.jsx(wy,{name:this.state.selected,adapterName:this.props.adapterName,insert:this.state.insert,onInserted:()=>this.setState({insert:""}),onForceSave:()=>this.onSave(),searchText:this.state.searchText,onRegisterSelect:n=>this.onRegisterSelect(n),readOnly:this.state.showCompiledCode,changed:this.state.changed[this.state.selected],code:this.scripts[this.state.selected].source||"",isDark:this.state.themeType==="dark",socket:this.props.socket,runningInstances:this.state.runningInstances,onChange:n=>this.onChange({script:n}),language:this.scripts[this.state.selected].engineType==="TypeScript/ts"?"typescript":"javascript"},"scriptEditor1")},"scriptEditorDiv")):null}getBlocklyEditor(){return!this.props.debugMode&&this.state.instancesLoaded&&this.state.selected&&this.props.objects[this.state.selected]&&this.state.blockly&&!this.state.showCompiledCode&&this.state.visible?(this.scripts[this.state.selected]=this.scripts[this.state.selected]||JSON.parse(JSON.stringify(this.props.objects[this.state.selected].common)),f.jsx(D.Box,{sx:$t.editorDiv,children:f.jsx(hn,{command:this.state.cmdToBlockly,themeType:this.state.themeType,searchText:this.state.searchText,code:this.scripts[this.state.selected].source||"",scriptId:this.state.selected,onChange:n=>this.onChange({script:n})},"BlocklyEditor")},"blocklyEditorDiv")):null}getRulesEditor(){var n,s;if(!this.props.debugMode&&this.state.instancesLoaded&&this.state.selected&&this.props.objects[this.state.selected]&&this.state.rules&&!this.state.showCompiledCode&&this.state.visible){this.scripts[this.state.selected]=this.scripts[this.state.selected]||JSON.parse(JSON.stringify(this.props.objects[this.state.selected].common));const i=!!this.state.selected&&!!((n=this.scripts[this.state.selected])!=null&&n.engine)&&this.state.runningInstances[this.scripts[this.state.selected].engine],a=!!this.state.selected&&((s=this.scripts[this.state.selected])==null?void 0:s.enabled);return f.jsx(D.Box,{sx:$t.editorDiv,children:f.jsx(AP,{scriptId:this.state.selected,setTourStep:this.setTourStep,tourStep:this.state.tourStep,isTourOpen:this.state.isTourOpen,changed:this.state.changed[this.state.selected],running:i&&a,command:this.state.cmdToRules,themeType:this.state.themeType,themeName:this.props.themeName,theme:this.props.theme,searchText:this.state.searchText,resizing:this.props.resizing,code:this.scripts[this.state.selected].source||"",onChange:c=>this.onChange({script:c})},"flowEditor")},"flowEditorDiv")}return null}getConfirmDialog(){return this.state.confirm?f.jsx(I.Confirm,{text:this.state.confirm,onClose:n=>{if(this.confirmCallback){const s=this.confirmCallback;this.confirmCallback=null,s(n)}this.setState({confirm:""})}},"dialogConfirm1"):null}getSelectIdDialog(){var n;if(this.state.showSelectId){const s=["state","channel","device","adapter","instance","enum","host","config","script","user","group"],i=["adapter","instance","enum","host","config","script","user","group"];let a=this.selectId.callback?this.selectId.initValue||"":this.getSelect&&this.getSelect()||"",c=a.indexOf("/*");c!==-1&&(a=a.substring(0,c)),c=a.indexOf("//"),c!==-1&&(a=a.substring(0,c));let h=a.match(/"([^"]+)"/);return h&&(a=h[1]),h=a.match(/'([^']+)'/),h&&(a=h[1]),f.jsx(I.SelectID,{theme:this.props.theme,imagePrefix:"../..",themeName:this.props.themeName,themeType:this.state.themeType,socket:this.props.socket,selected:a,expertMode:this.selectId.type&&i.includes(this.selectId.type)?!0:void 0,types:((n=this.selectId)==null?void 0:n.type)==="all"?s:[this.selectId.type||"state"],onClose:()=>{this.setState({showSelectId:!1}),this.selectId.callback&&(this.selectId.callback=null)},onOk:(g,b)=>{this.selectId.initValue=null,this.selectId.callback?(this.selectId.callback(g),this.selectId.callback=null):this.setState({insert:`'${g}'/*${b}*/`})}},"dialogSelectID1")}return null}getCronDialog(){return this.state.showCron?f.jsx(I.Cron,{theme:this.props.theme,cron:this.cron.callback?this.cron.initValue||"":this.getSelect?this.getSelect():"* * * * *",onClose:()=>this.setState({showCron:!1}),onOk:n=>{this.cron.initValue=null,this.cron.callback?(this.cron.callback(n),this.cron.callback=null):this.setState({insert:`'${n}'`})}},"dialogCron1"):null}getAstroDialog(){return this.state.showAstro?f.jsxs(D.Dialog,{open:!0,onClose:()=>this.setState({showAstro:!1}),children:[f.jsx(D.DialogTitle,{children:I.I18n.t("Astronomical events today")}),f.jsx(D.DialogContent,{children:this.state.astroEvents?f.jsx(D.TableContainer,{component:D.Paper,children:f.jsxs(D.Table,{size:"small",children:[f.jsx(D.TableHead,{children:f.jsxs(D.TableRow,{children:[f.jsx(D.TableCell,{children:I.I18n.t("Name")}),f.jsx(D.TableCell,{children:I.I18n.t("Server time")}),f.jsx(D.TableCell,{children:I.I18n.t("Description")})]})}),f.jsx(D.TableBody,{children:Object.keys(this.state.astroEvents).map(n=>{var s,i,a,c;return f.jsxs(D.TableRow,{children:[f.jsx(D.TableCell,{component:"th",scope:"row",children:n.startsWith("next")?"":n}),f.jsx(D.Tooltip,{title:`${I.I18n.t("Local time")}: ${(s=this.state.astroEvents)!=null&&s[n].isValidDate?new Date((i=this.state.astroEvents)==null?void 0:i[n].date).toLocaleTimeString():"n/a"}`,children:f.jsx(D.TableCell,{align:"right",children:(a=this.state.astroEvents)!=null&&a[n].isValidDate?(c=this.state.astroEvents)==null?void 0:c[n].serverTime:"n/a"})}),f.jsx(D.TableCell,{children:I.I18n.t(n)})]},n)})})]})}):f.jsx(D.LinearProgress,{})}),f.jsx(D.DialogActions,{children:f.jsx(D.Button,{variant:"contained",onClick:()=>this.setState({showAstro:!1}),color:"primary",startIcon:f.jsx(Uh,{}),children:I.I18n.t("Close")})})]},"dialogAstro"):null}getEditorDialog(){return this.state.showScript?f.jsx(pL,{adapterName:this.props.adapterName,source:this.scriptDialog.initValue||"",args:this.scriptDialog.args?this.scriptDialog.args.join(", "):"",isReturn:this.scriptDialog.isReturn,socket:this.props.socket,runningInstances:this.state.runningInstances,themeType:this.state.themeType,onClose:n=>{this.scriptDialog.initValue=null,this.scriptDialog.callback&&(n!==!1&&this.scriptDialog.callback(n||""),this.scriptDialog.callback=null),this.setState({showScript:!1})}},"scriptEditorDialog"):null}getToast(){return f.jsx(D.Snackbar,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:!!this.state.toast,autoHideDuration:6e3,onClose:()=>this.setState({toast:""}),ContentProps:{"aria-describedby":"message-id"},message:f.jsx("span",{id:"message-id",children:this.state.toast}),action:[f.jsx(D.IconButton,{"aria-label":"close",color:"inherit",style:$t.closeToast,onClick:()=>this.setState({toast:""}),size:"medium",children:f.jsx(Uh,{})},"close")]},"toast")}setTourStep=n=>this.setState({tourStep:n});getTour(){return this.state.instancesLoaded&&this.state.selected&&this.props.isAnyRulesExists===1&&this.props.objects[this.state.selected]&&this.state.rules&&this.state.visible?f.jsx(bS,{steps:TB,isOpen:this.state.isTourOpen,onRequestClose:()=>{this.setState({isTourOpen:!1}),window.localStorage.setItem("tour","true"),this.props.socket.setState("javascript.0.variables.rulesTour",{val:!0,ack:!0})},goToStep:this.state.tourStep},"tour"):null}getDebug(){return this.props.debugMode?this.state.selected&&this.scripts[this.state.selected]&&this.scripts[this.state.selected].engine&&this.state.runningInstances[this.scripts[this.state.selected].engine]?f.jsx(ey,{runningInstances:this.state.runningInstances,adapterName:this.props.adapterName,socket:this.props.socket,theme:this.props.theme,themeName:this.props.themeName,themeType:this.props.themeType,src:this.props.debugInstance?this.props.debugInstance.adapter:this.state.selected,debugInstance:this.props.debugInstance},"debugger"):(setTimeout(()=>this.props.onDebugModeChange(!1)),null):null}render(){return this.state.selected&&this.props.objects[this.state.selected]&&this.state.blockly===null&&this.state.rules===null&&(this.scripts[this.state.selected]=this.scripts[this.state.selected]||JSON.parse(JSON.stringify(this.props.objects[this.state.selected].common)),setTimeout(()=>{const n={blockly:this.scripts[this.state.selected].engineType==="Blockly",rules:this.scripts[this.state.selected].engineType==="Rules",showCompiledCode:!1,debugEnabled:this.scripts[this.state.selected].debug,verboseEnabled:this.scripts[this.state.selected].verbose};this.removeNonExistingScripts(null,n),this.setState(n)},100)),[this.getTabs(),this.getToolbar(),this.getScriptEditor(),this.getAskAboutDebug(),this.getBlocklyEditor(),this.getRulesEditor(),this.getDebug(),this.getConfirmDialog(),this.getSelectIdDialog(),this.getCronDialog(),this.getEditorDialog(),this.getAstroDialog(),this.getDebugMenu(),this.getToast(),this.getTour()]}}const xr={dialog:{height:"95%"},fullHeight:{height:"100%",overflow:"hidden"},dropzone:{marginTop:20,width:"100%",borderWidth:5,borderStyle:"dashed",borderColor:"#d0cccc",textAlign:"center",boxSizing:"border-box",paddingTop:45,borderRadius:10,height:"calc(100% - 10px)"},dropzoneDiv:{width:"100%",height:"100%"},dropzoneRejected:{borderColor:"#970000"},dropzoneAccepted:{borderColor:"#17cd02"},icon:{height:"30%",width:"30%",color:"#eeeeee",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%,-50%)",zIndex:0},iconError:{color:"#ffc3c6"},iconOk:{color:"#aaeebc"},text:{top:"50%",left:"50%",transform:"translate(-50%,-50%)",color:"#868686",position:"absolute",zIndex:1}};class HS extends Le.Component{constructor(n){super(n),this.state={error:"",imageStatus:""}}componentDidMount(){setTimeout(()=>{var n;try{(n=window.document.getElementById("import-text-area"))==null||n.focus()}catch{}},100)}handleCancel(){this.props.onClose()}static readFileDataUrl(n,s){const i=new FileReader;i.onload=()=>{s(null,{data:i.result,name:n.name})},i.onabort=()=>{console.error("file reading was aborted"),s(I.I18n.t("file reading was aborted"))},i.onerror=a=>{console.error("file reading has failed"),s(I.I18n.t("file reading has failed: %s",a))},i.readAsDataURL(n)}handleDropFile(n){if(!(n!=null&&n.length))return;const s=n[n.length-1];s&&HS.readFileDataUrl(s,(i,a)=>{var c;i||!a?this.setState({error:i||"No data"}):this.props.onClose(((c=a.data)==null?void 0:c.toString())||"")})}render(){const n={...xr.dropzone,...this.state.imageStatus==="accepted"?xr.dropzoneAccepted:this.state.imageStatus==="rejected"?xr.dropzoneRejected:void 0};return f.jsxs(D.Dialog,{onClose:()=>!1,maxWidth:"lg",sx:{"& .MuiDialog-paper":xr.dialog},fullWidth:!0,open:!0,"aria-labelledby":"import-dialog-title",PaperProps:{style:{minHeight:"90%",maxHeight:"90%"}},children:[f.jsx(D.DialogTitle,{id:"import-dialog-title",children:I.I18n.t("Import scripts")}),f.jsxs(D.DialogContent,{children:[f.jsx(xT,{maxSize:5e7,onDrop:(s,i)=>{var a,c,h;s.length?this.handleDropFile(s):window.alert(((h=(c=(a=i==null?void 0:i[0])==null?void 0:a.errors)==null?void 0:c[0])==null?void 0:h.message)||I.I18n.t("ra_Cannot upload"))},multiple:!1,accept:{"application/zip":[],"application/x-zip-compressed":[]},children:({getRootProps:s,getInputProps:i,isDragActive:a,isDragReject:c})=>c?(this.state.imageStatus!=="rejected"&&this.setState({imageStatus:"rejected"}),f.jsxs("div",{style:{...n,...xr.dropzoneDiv},...s(),children:[f.jsx("input",{...i()}),f.jsx("span",{style:xr.text,children:I.I18n.t("Some files will be rejected")},"text"),f.jsx(uy,{style:{...xr.icon,...xr.iconError}},"icon")]})):a?(this.state.imageStatus!=="accepted"&&this.setState({imageStatus:"accepted"}),f.jsxs("div",{style:{...n,...xr.dropzoneDiv},...s(),children:[f.jsx("input",{...i()}),f.jsx("span",{style:xr.text,children:I.I18n.t("All files will be accepted")},"text"),f.jsx(cy,{style:{...xr.icon,...xr.iconOk}},"icon")]})):(this.state.imageStatus!=="wait"&&this.setState({imageStatus:"wait"}),f.jsxs("div",{style:{...n,...xr.dropzoneDiv},...s(),children:[f.jsx("input",{...i()}),f.jsx("span",{style:xr.text,children:I.I18n.t("Drop some files here or click...")},"text"),f.jsx(HT,{style:xr.icon},"icon")]}))},"image-drop"),this.state.error?f.jsx(Sm,{text:this.state.error,onClose:()=>this.setState({error:""})}):null]}),f.jsx(D.DialogActions,{children:f.jsx(D.Button,{color:"grey",variant:"contained",onClick:()=>this.handleCancel(),startIcon:f.jsx(la,{}),children:I.I18n.t("Close")})})]})}}const hF="Acknowledged",pF="Actions",gF="Add",fF="All",mF="Any",bF="Apply",$F="April",vF="Ask",yF="Astronomical",_F="August",wF="Cancel",SF="Close",CF="Condition",TF="Conditions",EF="Console",kF="Copied",IF="December",xF="Default",DF="Delay",OF="Delete",RF="Description",AF="Done",NF="Exec shell",MF="Explanation",LF="Export",BF="Februar",PF="February",FF="Filter",jF="Folder",zF="Fr",UF="Friday",HF="ID",WF="ID1",VF="ID2",GF="Import",qF="Instance",KF="Instances",JF="Instructions",YF="Januar",XF="January",ZF="July",QF="June",ej="Limit",tj="March",nj="May",sj="Menu",rj="Message",ij="Mo",oj="Model",aj="Monday",lj="Month",cj="Name",uj="November",dj="OK",hj="October",pj="Ok",gj="Pause",fj="Pushover",mj="Pushsafer",bj="Rename",$j="Repeat",vj="Restart",yj="Result",_j="Sa",wj="Saturday",Sj="Save",Cj="Schedule",Tj="Script",Ej="September",kj="Simulate",Ij="Stack",xj="Start",Dj="State",Oj="Su",Rj="Sunday",Aj="Telegram",Nj="Th",Mj="Thursday",Lj="Time",Bj="Triggered",Pj="Triggers",Fj="Tu",jj="Tuesday",zj="URL",Uj="Value",Hj="Volume",Wj="We",Vj="Wednesday",Gj="Write",qj="Yes",Kj="acknowledgment",Jj="all",Yj="and",Xj="Astro",Zj="at",Qj="control",e4="copy",t4="CRON",n4="Dawn",s4="This is a special mode in which states and objects will not change. But only information about each planned change will be displayed in the protocol.",r4="Debug",i4="Dusk",o4="easy",a4="every",l4="Function",c4="ID",u4="Name",d4="Role",h4="Room",p4="Golden hour",g4="End of golden hour",f4='The code will be executed only every time when condition is true. E.g. if triggering on the temperature sensor value and the condition is "if temperature is greater than 20°C", the "then" actions will be executed every time when sensor sends the temperature and it is over 20°C. By 21°C, by 22°C and so on.',m4='The code will be executed only if the condition result changes. E.g. if triggering on the temperature sensor value and the condition is "if temperature is greater than 20°C", the "then" actions will be executed once when temperature is over 20. Next time the "then" actions will be executed when the temperature fails under 20 and then rises over 20 again.',b4="hours",$4="includes",v4="interval",y4="magic",_4="milliseconds",w4="minutes",S4="ms",C4="Nadir",T4="Nautical dawn",E4="Nautical dusk",k4="Next Sunrise",I4="Next sunset",x4="Night",D4="Night end",O4="normal",R4="offset",A4="one",N4="or",M4="quiet",L4="search",B4="seconds",P4="Solar noon",F4="sunrise",j4="Sunrise end",z4="Sunset",U4="Sunset start",H4="then",W4="Acknowledge",V4="From",G4="Last changed",q4="Quality",K4="Timestamp",J4="User",Y4="Value",X4="two",Z4="update",Q4="Adds debug output to the log for many system commands",ez="Verbose log outputs",tz="when",nz="Wizard",sz={"()":"()","(optional)":"(optional)","-":"-",".":".",Ack:hF,Actions:pF,"Actual time of day":"Actual time of day",Add:gF,"Add new script":"Add new script",All:fF,"All files will be accepted":"All files will be accepted",Any:mF,"Any month":"Any month",Apply:bF,April:$F,"Are you sure?":"Are you sure?",Ask:vF,Astronomical:yF,"Astronomical events today":"Astronomical events today",August:_F,"Blockly description":"Creating rules by graphic blocks","Body:":"Body:",Cancel:wF,"Cannot delete non empty item!":"Cannot delete non empty item!","Change layout":"Change layout",'Change theme (actual "%s")':'Change theme (now - "%s")',"Check blocks":"Check blocks","Check is not active, because javascript adapter is disabled":"Check is not active, because Javascript adapter is disabled","Clear search input":"Clear search input","Click on this icon":"Click on this icon",Close:SF,"Close all but current":"Close all but current","Collapse all":"Collapse all","Compares current time with astronomical event":"Compares current time with astronomical event","Compares current time with the user specific time":"Compares current time with the user specific time","Compares the state value with user defined value":"Compares the state value with user defined value",Condition:CF,Conditions:TF,"Configuration not saved.":"Configuration not saved.",Console:EF,"Control or update some state":"Control or update some state","Control or update some state with delay":"Control or update some state with delay","Convert blockly to javascript for ever.":"Permanently convert Blockly to Javascript.",Copied:kF,"Copy script":"Copy script","Copy to clipboard":"Copy to clipboard","Create new":"Create new","Create new folder":"Create new folder","Create new script":"Create new script","Create or edit CRON or time wizard":"Create or edit CRON or time wizard","Dark Theme":"Dark theme","Dark style":"Dark style",Date:"Date","Debug instance":"Debug instance","Debug options":"Debug options",December:IF,Default:xF,"Define cron...":"Define cron...","Define schedule...":"Define schedule...",Delay:DF,Delete:OF,"Delete %s":"Delete %s...","Delete folder":"Delete folder","Delete script":"Delete script",Description:RF,"Deselect all":"Deselect all","Discard changes for %s":"Discard changes for %s",Done:AF,"Double click to write value":"Double click to write value","Download as file":"Download as file","Drop some files here or click...":"Drop some files here or click...","Duplicate name":"Duplicate name","Edit script or just double click":"Edit script or just double click","Empty name is not allowed":"Empty name is not allowed","End search mode":"End search mode","Enter your question":"Enter your request",Error:"Error","Error was found":"Error was found","Every day":"Every day",Exec:NF,"Executes some shell command":"Executes some shell command","Existing scripts will be overwritten.":"Existing scripts will be overwritten.","Expand all":"Expand all","Expert mode":"Expert mode",Explanation:MF,Export:LF,"Export all scripts":"Export all scripts","Export blocks":"Export blocks","Export selected blocks":"Export selected blocks",Februar:BF,February:PF,Filter:FF,Folder:jF,Fr:zF,Friday:UF,Function:"Function","Function editor":"Function editor","Function: executed":"Function: executed","Go to next line":"Go to next line","HTTP Call":"HTTP Call","Hide logs":"Hide logs",ID:HF,ID1:WF,ID2:VF,Import:GF,"Import blocks":"Import blocks","Import error":"Import error","Import scripts":"Import scripts","Insert object ID":"Insert object ID",Instance:qF,"Instance is disabled":"Instance is disabled","Instance:":"Instance:",Instances:KF,Instructions:JF,"Invalid CRON":"Invalid CRON","It will not be possible to revert this operation.":"It will not be possible to revert this operation.","JS description":"Creating rules by writing Javascript",Januar:YF,January:XF,July:ZF,June:QF,"Just check":"Just check","Language:":"Language:","Learn More":"Learn More","Light style":"Light style",Limit:ej,"Local time":"Local time","Locate file":"Locate file","Log outputs":"Log outputs","Log text":"Log text","Log: %s":"Log: %s","Make a HTTP get request":"Make a HTTP get request","Make a pause between actions":"Make a pause between actions",March:tj,"March ":"March ",May:nj,Menu:sj,Message:rj,Mo:ij,Model:oj,Monday:aj,Month:lj,Name:cj,"No Chat GPT Key found":"No Chat GPT Key found","No active host found":"No active host found","Nothing found":"Nothing found",November:uj,OK:dj,October:hj,Ok:pj,"On condition change":"On condition result change","On script save or adapter start":"On script save or adapter start","On weekdays":"On weekdays","Open configuration":"Open configuration","Operate two states":"Operate two states","Operations with two states":"Operations with two states",Pause:gj,"Pause execution":"Pause execution","Pause script":"Pause script","Phone:":"Phone:","Please select object ID...":"Please select object ID...","Press Ctrl+Enter to get the answer":"Press Ctrl+Enter to get the answer","Print some text in log":"Print some text in log","Priority:":"Priority:",Pushover:fj,Pushsafer:mj,"Read only ID selected: %s":"Read only ID selected: %s",Rename:bj,"Reorder scripts in folders":"Reorder scripts in folders",Repeat:$j,Restart:vj,Result:yj,"Resume execution":"Resume execution","Root folder":"Root folder","Rules description":"Create rules with IF, THEN, ELSE blocks","Run script":"Run script",Sa:_j,Saturday:wj,Save:Sj,"Save all":"Save all","Say It":"Say It","Say some text via sayit adapter":"Say some text via sayit adapter",Schedule:Cj,Script:Tj,"Script %s was modified on disk":"Script %s was modified on disk","Script is not running":"Script is not running","Search in scripts":"Search in scripts","Search...":"Search...","Select all":"Select all","Send email":"Send email","Sends an email":"Sends an email","Sends message via Pushsafer":"Sends message via Pushsafer","Sends message via pushover":"Sends message via pushover","Sends message via telegram":"Sends message via telegram","Sends message via whatsapp-cmb":"Sends message via whatsapp-cmb",September:Ej,"Server time":"Server time","Set state action":"Set state action","Set with delay":"Set with delay","Shell command":"Shell command","Show astronomical events":"Show astronomical events","Show javascript code":"Show Javascript code","Show logs":"Show logs","Show only paused scripts":"Show only paused scripts","Show only running scripts":"Show only running scripts","Show only scripts with problems":"Show only scripts with problems",Simulate:kj,"Some files will be rejected":"Some files will be rejected","Sound:":"Sound:",Stack:Ij,Start:xj,"Start script":"Start script",State:Dj,"State condition":"State condition","Step into function":"Step into function","Step out from function":"Step out from function","Stop on exception":"Stop on exception",Su:Oj,"Subject:":"Subject:",Sunday:Rj,"TS description":"Creating rules by writing Typescript",Telegram:Aj,"Text:":"Text:",Th:Nj,"The script will be stopped and must be activated manually after debugging. Continue?":"The script will be stopped and must be activated manually after debugging. Continue?","This is advances option. You can write your own code here and it will be executed on trigger":"This is advances option. You can write your own code here and it will be executed on trigger",Thursday:Mj,Time:Lj,"Time condition":"Time condition","Title:":"Title:","To:":"To:","Trigger with value":"Trigger with value",Triggered:Bj,Triggers:Pj,"Triggers the on script saving or the javascript instance restart":"Triggers the on script saving or the javascript instance restart","Triggers the rule on update or change of some state":"Triggers the rule on update or change of some state","Triggers the rule periodically or on some specific time":"Triggers the rule periodically or on some specific time",Tu:Fj,Tuesday:jj,URL:zj,"Unknown error":"Unknown error","Unknown error!":"Unknown error!","Use generated code":"Use generated code","User function":"User function","User:":"User:",Value:Uj,"Vibration:":"Vibration:",Volume:Hj,We:Wj,Wednesday:Vj,"Whatsapp-cmb":"Whatsapp-cmb",Write:Gj,"Write your own code":"Write your own code",Yes:qj,"Yet exists!":"Yet exists!","You can use %s in the URL to use current trigger value or %id to use the triggered object ID":"You can use %s in the URL to use current trigger value, %id to use the triggered object ID, %name to show triggered object ID name or %old to use old trigger value","You can use %s in the command to use current trigger value or %id to use the triggered object ID":"You can use %s in the command to use current trigger value, %id to use the triggered object ID, %name to show triggered object ID name or %old to use old trigger value","You can use %s in the text to display current trigger value or %id to display the triggered object ID":"You can use %s in the text to display current trigger value, %id to use the triggered object ID, %name to show triggered object ID name or %old to use old trigger value","You can use %s in the value to use the current trigger value or %id to display the triggered object ID":"You can use %s in the value to use the current trigger value, %id to use the triggered object ID, %name to show triggered object ID name or %old to use old trigger value","You have to enter OpenAI API key in the configuration of javascript adapter.":"You have to enter OpenAI API key in the configuration of javascript adapter.","[equal]":"[equal]","[greater or equal]":"[greater or equal]","[greater]":"[greater]","[hysteresis]":"[hysteresis]","[includes]":"[includes]","[less or equal]":"[less or equal]","[less]":"[less]","[not equal]":"[not equal]",acknowledgment:Kj,all:Jj,and:Yj,astro:Xj,at:Zj,"clear running":"clear running",control:Qj,copy:e4,cron:t4,dawn:n4,debug_help:s4,debug_label:r4,default:"default",dusk:i4,easy:o4,else:"else","equal to":"equal to",every:a4,"every hour at 0 minutes":"every hour at 0 minutes",false:"false","file reading has failed: %s":"file reading has failed: %s","file reading was aborted":"file reading was aborted",filter_func:l4,filter_id:c4,filter_name:u4,filter_role:d4,filter_room:h4,"for edit or create script":"for edit or create a new script","for professionals":"for professionals","for programmers":"for programmers",goldenHour:p4,goldenHourEnd:g4,"greater or equal":"greater or equal","greater or equal to":"greater or equal to","greater than":"greater than",help_just_check:f4,help_on_change:m4,"high priority":"high priority","high-priority":"high-priority","highest priority":"highest priority",hours:b4,includes:$4,interval:v4,"just check":"just check","less or equal":"less or equal","less or equal to":"less or equal to","less than":"less than","lower priority":"lower priority","lowest priority":"lowest priority",magic:y4,milliseconds:_4,minutes:w4,ms:S4,nadir:C4,nauticalDawn:T4,nauticalDusk:E4,nextSunrise:k4,nextSunset:I4,night:x4,nightEnd:D4,"no blocks found":"No blocks found","no group":"NO GROUP",normal:O4,"normal priority":"normal priority","not equal to":"not equal to","not properly connected":"This block is not properly connected to other blocks.",offset:R4,"on change":"on change","on condition change":"on condition change","on update":"on update",one:A4,or:N4,quiet:M4,"reset search":"reset search",search:L4,seconds:B4,solarNoon:P4,"store in":"store in",sunrise:F4,sunriseEnd:j4,sunset:z4,sunsetStart:U4,then:H4,"toggle value":"toggle value",tooltip_ack:W4,tooltip_from:V4,tooltip_lc:G4,tooltip_quality:q4,tooltip_ts:K4,tooltip_user:J4,tooltip_value:Y4,true:"true",two:X4,undefined:"undefined",update:Z4,"use seconds":"use seconds","use trigger value":"use trigger value",verbose_help:Q4,verbose_label:ez,when:tz,with:"with","with date":"with date","with offset":"with offset",wizard:nz},rz="Bestätigt",iz="Aktionen",oz="Hinzufügen",az="Alle",lz="Egal",cz="Anwenden",uz="April",dz="Fragen",hz="Astronomisch",pz="August",gz="Abbrechen",fz="Schließen",mz="Bedingung",bz="Bedingungen",$z="Konsole",vz="Kopiert",yz="Dezember",_z="Standard",wz="Verzögerung",Sz="Löschen",Cz="Beschreibung",Tz="Fertig",Ez="Exec shell",kz="Erläuterung",Iz="Export",xz="Februar",Dz="Februar",Oz="Filter",Rz="Ordner",Az="Fr",Nz="Freitag",Mz="ID",Lz="ID1",Bz="ID2",Pz="Import",Fz="Instanz",jz="Instanzen",zz="Anleitung",Uz="Januar",Hz="Januar",Wz="Juli",Vz="Juni",Gz="Grenze",qz="März",Kz="Mai",Jz="Menü",Yz="Nachricht",Xz="Mo",Zz="Modell",Qz="Montag",eU="Monat",tU="Name",nU="November",sU="OK",rU="Oktober",iU="Ok",oU="Pause",aU="Pushover",lU="Pushsafer",cU="Umbenennen",uU="Wiederholen",dU="Neustart",hU="Ergebnis",pU="Sa",gU="Samstag",fU="Speichern",mU="Zeitplan",bU="Skript",$U="September",vU="Simulieren",yU="Stack",_U="Start",wU="Zustand",SU="So",CU="Sonntag",TU="Telegram",EU="Do",kU="Donnerstag",IU="Zeit",xU="Ausgelöst",DU="Löst aus",OU="Di",RU="Dienstag",AU="URL",NU="Wert",MU="Volumen",LU="Mi",BU="Mittwoch",PU="Schreiben",FU="Ja",jU="Wissen",zU="alle",UU="und",HU="Astro",WU="beim",VU="Steuerung",GU="Kopie",qU="CRON",KU="Morgendämmerung",JU="Dies ist ein spezieller Modus, in dem sich Zustände und Objekte nicht ändern. Im Protokoll werden jedoch nur Informationen zu jeder geplanten Änderung angezeigt.",YU="Debuggen",XU="nautische Abenddämmerung",ZU="einfach",QU="jeder",e3="Funktion",t3="ID",n3="Name",s3="Rolle",r3="Raum",i3="Goldene Abendstunde",o3="Vormittag",a3='Der Code wird jedes Mal ausgeführt, wenn die Bedingung erfüllt ist. z.B. wenn der Temperatur wert sich ändert und die Bedingung "Wenn die Temperatur größer als 20°C ist" lautet, werden die "Dann" -Aktionen jedes Mal ausgeführt, wenn der Sensor die Temperatur sendet und diese über 20°C liegt. Bei 21°C, bei 22°C und so weiter.',l3='Der Code wird nur ausgeführt, wenn sich das Ergebnis der Bedingung ändert. z.B. wenn sich der Temperatur wert ändert und die Bedingung "Wenn die Temperatur größer als 20°C ist" lautet, werden die "Dann" -Aktionen einmal ausgeführt, wenn die Temperatur über 20°C liegt. Das nächste Mal werden die "Dann" -Aktionen ausgeführt, wenn die Temperatur unter 20°C gefallen ist und dann wieder über 20°C ansteigt.',c3="Stunden",u3="beinhaltet",d3="Intervall",h3="Magie",p3="Millisekunden",g3="Minuten",f3="ms",m3="Nadir",b3="nautische Morgendämmerung",$3="astronomische Abenddämmerung",v3="Nächster Sonnenaufgang",y3="Nächster Sonnenuntergang",_3="Nacht",w3="astronomische Morgendämmerung",S3="Normal",C3="Versatz",T3="einer",E3="oder",k3="ruhig",I3="Suche",x3="Sekunden",D3="(Nach-)Mittag",O3="Sonnenaufgang",R3="Goldene Morgenstunde",A3="Abenddämmerung",N3="Sonnenuntergang (Anfang)",M3="dann",L3="Bestätigen",B3="Von",P3="Zuletzt geändert",F3="Qualität",j3="Zeitstempel",z3="Benutzer",U3="Wert",H3="zwei",W3="Aktualisieren",V3="Fügt Debug-Ausgaben für viele Systembefehle zum Protokoll hinzu",G3="Ausführliche Protokollausgaben",q3="falls",K3="Assistent",J3={"()":"()","(optional)":"(optional)","-":"-",".":".",Ack:rz,Actions:iz,"Actual time of day":"Tatsächliche Tageszeit",Add:oz,"Add new script":"Neues Skript hinzufügen",All:az,"All files will be accepted":"Alle Dateien werden akzeptiert",Any:lz,"Any month":"Jeden Monat",Apply:cz,April:uz,"Are you sure?":"Wirklich sicher?",Ask:dz,Astronomical:hz,"Astronomical events today":"Astronomische Ereignisse heute",August:pz,"Blockly description":"Erstellen von Regeln durch Grafikblöcke","Body:":"Körper:",Cancel:gz,"Cannot delete non empty item!":"Kann nicht gelöscht werden, weil noch einige Elementen darin sind!","Change layout":"Layout ändern",'Change theme (actual "%s")':'Thema ändern (jetzt - "%s")',"Check blocks":"Blöcke prüfen","Check is not active, because javascript adapter is disabled":"Syntax-Check ist nicht aktiv, weil der Javascript Adapter nicht aktiv ist.","Clear search input":"Sucheingabe löschen","Click on this icon":"Auf dieses Symbol klicken",Close:fz,"Close all but current":"Alle anderen außer dem Aktiven schließen","Collapse all":"Alles einklappen","Compares current time with astronomical event":"Vergleicht die aktuelle Zeit mit einem astronomischen Ereignis","Compares current time with the user specific time":"Vergleicht die aktuelle Zeit mit der benutzerspezifischen Zeit","Compares the state value with user defined value":"Vergleicht den Zustandswert mit dem benutzerdefinierten Wert",Condition:mz,Conditions:bz,"Configuration not saved.":"Die Konfiguration ist nicht gespeichert.",Console:$z,"Control or update some state":"Zustand steuern oder aktualisieren","Control or update some state with delay":"Zustand mit Verzögerung steuern oder aktualisieren","Convert blockly to javascript for ever.":"Blockly dauerhaft in Javascript konvertieren.",Copied:vz,"Copy script":"Skript kopieren","Copy to clipboard":"In die Zwischenablage kopieren","Create new":"Neu erstellen","Create new folder":"Neuen Ordner erstellen","Create new script":"Neues Skript erstellen","Create or edit CRON or time wizard":"CRON- oder Zeit-Assistenten erstellen oder bearbeiten","Dark Theme":"Dunkles Thema","Dark style":"Dunkler Stil",Date:"Datum","Debug instance":"Debug-Instanz","Debug options":"Debug-Optionen",December:yz,Default:_z,"Define cron...":"Cron definieren ...","Define schedule...":"Zeitplan definieren ...",Delay:wz,Delete:Sz,"Delete %s":"Löschen %s...","Delete folder":"Ordner löschen","Delete script":"Skript löschen",Description:Cz,"Deselect all":"Alles abwählen","Discard changes for %s":"Änderungen für %s verwerfen",Done:Tz,"Double click to write value":"Doppelklick zum Schreiben des Wertes","Download as file":"Download als Datei","Drop some files here or click...":"Dateien hier ablegen oder klicken ...","Duplicate name":"Doppelter Name","Edit script or just double click":"Skript bearbeiten oder einfach doppelklicken","Empty name is not allowed":"Leerer Name ist nicht zulässig","End search mode":"Suchmodus beenden","Enter your question":"Anfrage eingeben",Error:"Fehler","Error was found":"Fehler wurde gefunden","Every day":"Täglich",Exec:Ez,"Executes some shell command":"Führt einen Shell-Befehl aus","Existing scripts will be overwritten.":"Vorhandene Skripte werden überschrieben.","Expand all":"Alle erweitern","Expert mode":"Expertenmodus",Explanation:kz,Export:Iz,"Export all scripts":"Alle Skripte exportieren","Export blocks":"Blöcke exportieren","Export selected blocks":"Ausgewählte Blöcke exportieren",Februar:xz,February:Dz,Filter:Oz,Folder:Rz,Fr:Az,Friday:Nz,Function:"Funktion","Function editor":"Funktions-Editor","Function: executed":"Funktion: ausgeführt","Go to next line":"Gehe zur nächsten Zeile","HTTP Call":"HTTP-Aufruf","Hide logs":"Protokoll ausblenden",ID:Mz,ID1:Lz,ID2:Bz,Import:Pz,"Import blocks":"Blöcke importieren","Import error":"Fehler beim Importieren","Import scripts":"Skripte importieren","Insert object ID":"Objekt-ID einfügen",Instance:Fz,"Instance is disabled":"Instanz ist deaktiviert","Instance:":"Instanz:",Instances:jz,Instructions:zz,"Invalid CRON":"Ungültiger CRON","It will not be possible to revert this operation.":"Dieser Vorgang kann nicht rückgängig gemacht werden.","JS description":"Regeln erstellen mit JavaScript",Januar:Uz,January:Hz,July:Wz,June:Vz,"Just check":"Einfach überprüfen","Language:":"Sprache:","Learn More":"Mehr erfahren","Light style":"Heller Stil",Limit:Gz,"Local time":"Lokale Zeit","Locate file":"Datei zeigen","Log outputs":"Protokoll","Log text":"Protokolltext","Log: %s":"Log: %s","Make a HTTP get request":"Eine HTTP-Abrufanforderung stellen","Make a pause between actions":"Eine Pause zwischen den Aktionen machen",March:qz,"March ":"März ",May:Kz,Menu:Jz,Message:Yz,Mo:Xz,Model:Zz,Monday:Qz,Month:eU,Name:tU,"No Chat GPT Key found":"Kein Chat-GPT-Schlüssel gefunden","No active host found":"Kein aktiver Host gefunden","Nothing found":"Nichts gefunden",November:nU,OK:sU,October:rU,Ok:iU,"On condition change":"Bei Änderung des Ergebnis der Bedingung","On script save or adapter start":"Beim Speichern des Skripts oder beim Starten des Adapters","On weekdays":"An Wochentagen","Open configuration":"Konfiguration öffnen","Operate two states":"Zwei Zustände operieren","Operations with two states":"Operationen mit zwei Zuständen",Pause:oU,"Pause execution":"Ausführung pausieren","Pause script":"Skript anhalten","Phone:":"Telefon:","Please select object ID...":"Objekt-ID auswählen ...","Press Ctrl+Enter to get the answer":"Strg+Eingabetaste, um die Antwort zu erhalten","Print some text in log":"Einen Text im Protokoll ausdrucken","Priority:":"Priorität:",Pushover:aU,Pushsafer:lU,"Read only ID selected: %s":"Schreibgeschützte ID ausgewählt: %s",Rename:cU,"Reorder scripts in folders":"Skripte in Ordnern neu ordnen",Repeat:uU,Restart:dU,Result:hU,"Resume execution":"Ausführung fortsetzen","Root folder":"Root-Verzeichnis","Rules description":"Regeln erstellen mit WENN-, DANN- und SONST-Blöcken","Run script":"Skript ausführen",Sa:pU,Saturday:gU,Save:fU,"Save all":"Alle speichern","Say It":"Say It","Say some text via sayit adapter":"Einen Text über den Sayit-Adapter sagen",Schedule:mU,Script:bU,"Script %s was modified on disk":'Skript "%s" wurde auf der Festplatte geändert',"Script is not running":"Skript läuft nicht","Search in scripts":"Suche in Skripten","Search...":"Suche...","Select all":"Alles auswählen","Send email":"E-Mail senden","Sends an email":"Sendet eine E-Mail","Sends message via Pushsafer":"Sendet eine Nachricht über Pushsafer","Sends message via pushover":"Sendet eine Nachricht per Pushover","Sends message via telegram":"Sendet eine Nachricht per telegram","Sends message via whatsapp-cmb":"Sendet eine Nachricht über WhatsApp-Cmb",September:$U,"Server time":"Server-Zeit","Set state action":"Zustand setzten","Set with delay":"Setzen mit Verzögerung","Shell command":"Shell-Befehl","Show astronomical events":"Astronomische Ereignisse anzeigen","Show javascript code":"Javascript-Code zeigen","Show logs":"Protokoll anzeigen","Show only paused scripts":"Nur angehaltene Skripte zeigen","Show only running scripts":"Nur laufende Skripte zeigen","Show only scripts with problems":"Nur Skripte mit Problemen zeigen",Simulate:vU,"Some files will be rejected":"Einige Dateien werden abgelehnt","Sound:":"Klang:",Stack:yU,Start:_U,"Start script":"Skript starten",State:wU,"State condition":"Zustandsbedingung","Step into function":"Schritt in die Funktion","Step out from function":"Raus aus der Funktion","Stop on exception":"Bei Ausnahme anhalten",Su:SU,"Subject:":"Gegenstand:",Sunday:CU,"TS description":"Regeln erstellen mit TypeScript",Telegram:TU,"Text:":"Text:",Th:EU,"The script will be stopped and must be activated manually after debugging. Continue?":"Das Skript wird gestoppt und muss nach dem Debuggen manuell aktiviert werden. Fortsetzen?","This is advances option. You can write your own code here and it will be executed on trigger":"Dies ist eine erweiterte Option. Sie können hier Ihren eigenen Code schreiben, der beim Auslösen ausgeführt wird",Thursday:kU,Time:IU,"Time condition":"Zeitbedingung","Title:":"Titel:","To:":"Zu:","Trigger with value":"Trigger mit Wert",Triggered:xU,Triggers:DU,"Triggers the on script saving or the javascript instance restart":"Löst das Speichern des Skripts oder den Neustart der Javascript-Instanz aus","Triggers the rule on update or change of some state":"Löst die Regel beim Aktualisieren oder Ändern eines Zustands aus","Triggers the rule periodically or on some specific time":"Löst periodisch oder zu einem bestimmten Zeitpunkt aus",Tu:OU,Tuesday:RU,URL:AU,"Unknown error":"Unbekannter Fehler","Unknown error!":"Unbekannter Fehler!","Use generated code":"Code verwenden","User function":"Benutzerfunktion","User:":"Benutzer:",Value:NU,"Vibration:":"Vibration:",Volume:MU,We:LU,Wednesday:BU,"Whatsapp-cmb":"WhatsApp-cmb",Write:PU,"Write your own code":"Eigenen Code schreiben",Yes:FU,"Yet exists!":"Existiert schon!","You can use %s in the URL to use current trigger value or %id to use the triggered object ID":"Sie können %s in der URL verwenden, um den aktuellen Triggerwert zu verwenden, %id, um die ausgelöste Objekt-ID zu verwenden, %name, um den ID-Namen des ausgelösten Objekts anzuzeigen, oder %old, um den alten Triggerwert zu verwenden","You can use %s in the command to use current trigger value or %id to use the triggered object ID":"Sie können %s im Befehl verwenden, um den aktuellen Triggerwert zu verwenden, %id, um die ausgelöste Objekt-ID zu verwenden, %name, um den ID-Namen des ausgelösten Objekts anzuzeigen, oder %old, um den alten Triggerwert zu verwenden","You can use %s in the text to display current trigger value or %id to display the triggered object ID":"Sie können %s im Text verwenden, um den aktuellen Triggerwert anzuzeigen, %id, um die ausgelöste Objekt-ID zu verwenden, %name, um den ID-Namen des ausgelösten Objekts anzuzeigen, oder %old, um den alten Triggerwert zu verwenden","You can use %s in the value to use the current trigger value or %id to display the triggered object ID":"Sie können %s im Wert verwenden, um den aktuellen Triggerwert zu verwenden, %id, um die ID des ausgelösten Objekts zu verwenden, %name, um den ID-Namen des ausgelösten Objekts anzuzeigen, oder %old, um den alten Triggerwert zu verwenden","You have to enter OpenAI API key in the configuration of javascript adapter.":"Sie müssen den OpenAI-API-Schlüssel in der Konfiguration des Javascript-Adapters eingeben.","[equal]":"[gleich]","[greater or equal]":"[größer oder gleich]","[greater]":"[größer]","[hysteresis]":"[Hysterese]","[includes]":"[enthält]","[less or equal]":"[kleiner oder gleich]","[less]":"[kleiner]","[not equal]":"[ungleich]",acknowledgment:jU,all:zU,and:UU,astro:HU,at:WU,"clear running":"laufende abbrechen",control:VU,copy:GU,cron:qU,dawn:KU,debug_help:JU,debug_label:YU,default:"Standard",dusk:XU,easy:ZU,else:"sonst","equal to":"gleich",every:QU,"every hour at 0 minutes":"jede Stunde bei 0 Minuten",false:"falsch","file reading has failed: %s":"Das Lesen der Datei ist fehlgeschlagen: %s","file reading was aborted":"Das Lesen der Datei wurde abgebrochen",filter_func:e3,filter_id:t3,filter_name:n3,filter_role:s3,filter_room:r3,"for edit or create script":"zum Bearbeiten oder zum Erstellen eines neues Skripts","for professionals":"für Profis","for programmers":"für Programmierer",goldenHour:i3,goldenHourEnd:o3,"greater or equal":"größer oder gleich","greater or equal to":"größer oder gleich","greater than":"größer als",help_just_check:a3,help_on_change:l3,"high priority":"hohe Priorität","high-priority":"hohe Priorität","highest priority":"höchste Priorität",hours:c3,includes:u3,interval:d3,"just check":"einfach prüfen","less or equal":"kleiner oder gleich","less or equal to":"kleiner oder gleich","less than":"kleiner als","lower priority":"geringere Priorität","lowest priority":"niedrigste Priorität",magic:h3,milliseconds:p3,minutes:g3,ms:f3,nadir:m3,nauticalDawn:b3,nauticalDusk:$3,nextSunrise:v3,nextSunset:y3,night:_3,nightEnd:w3,"no blocks found":"Keine Blöcke gefunden","no group":"KEINE GRUPPE",normal:S3,"normal priority":"normale Priorität","not equal to":"ungleich","not properly connected":"Dieser Block ist mit anderen nicht richtig verbunden.",offset:C3,"on change":"bei Änderung","on condition change":"bei Zustandsänderung","on update":"beim Aktualisieren",one:T3,or:E3,quiet:k3,"reset search":"Suche zurücksetzen",search:I3,seconds:x3,solarNoon:D3,"store in":"speichern in",sunrise:O3,sunriseEnd:R3,sunset:A3,sunsetStart:N3,then:M3,"toggle value":"Wert umschalten",tooltip_ack:L3,tooltip_from:B3,tooltip_lc:P3,tooltip_quality:F3,tooltip_ts:j3,tooltip_user:z3,tooltip_value:U3,true:"wahr",two:H3,undefined:"nicht definiert",update:W3,"use seconds":"Sekunden verwenden","use trigger value":"Triggerwert benutzen",verbose_help:V3,verbose_label:G3,when:q3,with:"mit","with date":"mit Datum","with offset":"mit Versatz",wizard:K3},Y3="Admitido",X3="Comportamiento",Z3="Añadir",Q3="Todos",eH="Alguna",tH="Apply",nH="abril",sH="Preguntar",rH="Astronómico",iH="agosto",oH="Cancelar",aH="Cerrar",lH="Condición",cH="Condiciones",uH="Consola",dH="Copiado",hH="diciembre",pH="Defecto",gH="Demora",fH="Eliminar",mH="Descripción",bH="Hecho",$H="Ejecutivo shell",vH="Explicación",yH="Exportar",_H="Februar",wH="febrero",SH="Filtrar",CH="Carpeta",TH="P.",EH="viernes",kH="CARNÉ DE IDENTIDAD",IH="ID1",xH="ID2",DH="Importar",OH="Ejemplo",RH="Instancias",AH="Instrucciones",NH="Enero",MH="enero",LH="julio",BH="junio",PH="Límite",FH="marzo",jH="Mayo",zH="Menú",UH="Mensaje",HH="Mes",WH="Modelo",VH="lunes",GH="Mes",qH="Nombre",KH="noviembre",JH="OK",YH="octubre",XH="Okay",ZH="Pausa",QH="Persona fácil de convencer",e5="Pushsafer",t5="Rebautizar",n5="Repetir",s5="Reiniciar",r5="Resultado",i5="Sa",o5="sábado",a5="Salvar",l5="Calendario",c5="Guión",u5="septiembre",d5="Simular",h5="Stack",p5="Comienzo",g5="Expresar",f5="Su",m5="domingo",b5="Telegrama",$5="4",v5="jueves",y5="Tiempo",_5="Motivado",w5="Disparadores",S5="Tu",C5="martes",T5="URL",E5="Valor",k5="Volumen",I5="3",x5="miércoles",D5="Escribir",O5="sí",R5="Reconocimiento",A5="todos",N5="y",M5="astro",L5="a",B5="control",P5="Copiar",F5="CRON",j5="Amanecer",z5="Este es un modo especial en el que los estados y los objetos no cambiarán. Pero solo se mostrará información sobre cada cambio planificado en el protocolo.",U5="Depurar",H5="Oscuridad",W5="fácil",V5="cada",G5="Función",q5="CARNÉ DE IDENTIDAD",K5="Nombre",J5="Papel",Y5="Habitación",X5="hora dorada",Z5="Fin de la hora dorada",Q5='El código se ejecutará solo cada vez que la condición sea verdadera. P.ej. si se activa en el valor del sensor de temperatura y la condición es "si la temperatura es superior a 20 ° C", las acciones "entonces" se ejecutarán cada vez que el sensor envíe la temperatura y supere los 20 ° C. Por 21 ° C, por 22 ° C y así sucesivamente.',eW='El código se ejecutará solo si cambia el resultado de la condición. P.ej. si se activa en el valor del sensor de temperatura y la condición es "si la temperatura es superior a 20 ° C", las acciones "entonces" se ejecutarán una vez cuando la temperatura sea superior a 20. La próxima vez, las acciones "entonces" se ejecutarán cuando la temperatura falla por debajo de 20 y luego sube por encima de 20 nuevamente.',tW="horas",nW="incluye",sW="intervalo",rW="magia",iW="milisegundos",oW="minutos",aW="ms",lW="nadir",cW="Amanecer náutico",uW="Atardecer náutico",dW="próximo amanecer",hW="Próxima puesta de sol",pW="Noche",gW="Fin de la noche",fW="normal",mW="compensar",bW="uno",$W="o",vW="tranquilo",yW="buscar",_W="segundos",wW="Mediodía solar",SW="amanecer",CW="Final del amanecer",TW="puesta de sol",EW="Inicio al atardecer",kW="entonces",IW="Reconocer",xW="De",DW="Último cambio",OW="Calidad",RW="Marca de tiempo",AW="Usuario",NW="Valor",MW="dos",LW="actualizar",BW="Agrega salida de depuración al registro para muchos comandos del sistema",PW="Salidas de registro detalladas",FW="cuando",jW="Wizard",zW={"()":"()","(optional)":"(Opcional)","-":"-",".":".",Ack:Y3,Actions:X3,"Actual time of day":"Hora real del día",Add:Z3,"Add new script":"Agregar nuevo script",All:Q3,"All files will be accepted":"Todos los archivos serán aceptados.",Any:eH,"Any month":"Cualquier mes",Apply:tH,April:nH,"Are you sure?":"¿Estás seguro?",Ask:sH,Astronomical:rH,"Astronomical events today":"Eventos astronómicos hoy",August:iH,"Blockly description":"Crear reglas por bloques gráficos","Body:":"Cuerpo:",Cancel:oH,"Cannot delete non empty item!":"¡No se puede eliminar un elemento no vacío!","Change layout":"Cambia el diseño",'Change theme (actual "%s")':'Cambiar tema (ahora - "%s")',"Check blocks":"Comprobar bloques","Check is not active, because javascript adapter is disabled":"La comprobación no está activa porque el adaptador Javascript está desactivado","Clear search input":"Borrar entrada de búsqueda","Click on this icon":"Haga clic en este ícono",Close:aH,"Close all but current":"Cerrar todo menos el actual","Collapse all":"Desplegar todo","Compares current time with astronomical event":"Compara la hora actual con un evento astronómico","Compares current time with the user specific time":"Compara la hora actual con la hora específica del usuario","Compares the state value with user defined value":"Compara el valor del estado con el valor definido por el usuario",Condition:lH,Conditions:cH,"Configuration not saved.":"Configuración no guardada.",Console:uH,"Control or update some state":"Controlar o actualizar algún estado","Control or update some state with delay":"Controlar o actualizar algún estado con retraso","Convert blockly to javascript for ever.":"Convierta instantáneamente en bloque a Javascript.",Copied:dH,"Copy script":"Copiar guion","Copy to clipboard":"Copiar al portapapeles","Create new":"Crear nuevo","Create new folder":"Crear nueva carpeta","Create new script":"Crear nuevo script","Create or edit CRON or time wizard":"Crear o editar CRON o asistente de tiempo","Dark Theme":"Tema oscuro","Dark style":"Estilo oscuro",Date:"Fecha","Debug instance":"Instancia de depuración","Debug options":"Opciones de depuración",December:hH,Default:pH,"Define cron...":"Definir cron ...","Define schedule...":"Definir horario ...",Delay:gH,Delete:fH,"Delete %s":"Eliminar %s ...","Delete folder":"Eliminar carpeta","Delete script":"Eliminar guión",Description:mH,"Deselect all":"Deseleccionar todo","Discard changes for %s":"Descartar cambios para %s",Done:bH,"Double click to write value":"Doble clic para escribir el valor","Download as file":"Descargar como archivo","Drop some files here or click...":"Suelta algunos archivos aquí o haz clic ...","Duplicate name":"Nombre duplicado","Edit script or just double click":"Editar guión o simplemente hacer doble clic","Empty name is not allowed":"No se permite el nombre vacío","End search mode":"Fin del modo de búsqueda","Enter your question":"Ingrese su solicitud",Error:"Error","Error was found":"Error encontrado","Every day":"Diario",Exec:$H,"Executes some shell command":"Ejecuta algún comando de shell","Existing scripts will be overwritten.":"Los guiones existentes se sobrescribirán.","Expand all":"Expandir todo","Expert mode":"Modo experto",Explanation:vH,Export:yH,"Export all scripts":"Exportar todos los scripts","Export blocks":"Exportar bloques","Export selected blocks":"Exportar bloques seleccionados",Februar:_H,February:wH,Filter:SH,Folder:CH,Fr:TH,Friday:EH,Function:"Función","Function editor":"Editor de funciones","Function: executed":"Función: ejecutada","Go to next line":"Ir a la siguiente línea","HTTP Call":"Llamada HTTP","Hide logs":"Ocultar registros",ID:kH,ID1:IH,ID2:xH,Import:DH,"Import blocks":"Importar bloques","Import error":"Error de importación","Import scripts":"Importar guiones","Insert object ID":"Insertar ID de objeto",Instance:OH,"Instance is disabled":"La instancia está deshabilitada","Instance:":"Ejemplo:",Instances:RH,Instructions:AH,"Invalid CRON":"CRON inválido","It will not be possible to revert this operation.":"No será posible revertir esta operación.","JS description":"Crear reglas escribiendo Javascript",Januar:NH,January:MH,July:LH,June:BH,"Just check":"Sólo revisa","Language:":"Idioma:","Learn More":"Aprende más","Light style":"Estilo ligero",Limit:PH,"Local time":"Hora local","Locate file":"Localizar el archivo","Log outputs":"Salidas de registro","Log text":"Texto de registro","Log: %s":"Log: %s","Make a HTTP get request":"Realizar una solicitud de obtención HTTP","Make a pause between actions":"Hacer una pausa entre acciones",March:FH,"March ":"marzo",May:jH,Menu:zH,Message:UH,Mo:HH,Model:WH,Monday:VH,Month:GH,Name:qH,"No Chat GPT Key found":"No se ha encontrado ninguna clave GPT de chat","No active host found":"No se encontró un host activo","Nothing found":"Nada Encontrado",November:KH,OK:JH,October:YH,Ok:XH,"On condition change":"En condición de cambio","On script save or adapter start":"Al guardar el script o al iniciar el adaptador","On weekdays":"De lunes a viernes","Open configuration":"Configuración abierta","Operate two states":"Operar dos estados","Operations with two states":"Operaciones con dos estados",Pause:ZH,"Pause execution":"Pausar ejecución","Pause script":"Pausar guion","Phone:":"Teléfono:","Please select object ID...":"Por favor, seleccione la ID del objeto ...","Press Ctrl+Enter to get the answer":"Presiona Ctrl+Enter para obtener la respuesta","Print some text in log":"Imprime texto en el registro","Priority:":"Prioridad:",Pushover:QH,Pushsafer:e5,"Read only ID selected: %s":"ID de solo lectura seleccionado: %s",Rename:t5,"Reorder scripts in folders":"Reordenar guiones en carpetas",Repeat:n5,Restart:s5,Result:r5,"Resume execution":"Reanudar ejecución","Root folder":"Carpeta raíz","Rules description":"Crea reglas con bloques IF, THEN, ELSE","Run script":"Ejecutar guión",Sa:i5,Saturday:o5,Save:a5,"Save all":"Salvar a todos","Say It":"Say It","Say some text via sayit adapter":"Di un mensaje de texto a través del adaptador sayit",Schedule:l5,Script:c5,"Script %s was modified on disk":"El script %s fue modificado en el disco","Script is not running":"El script no se está ejecutando","Search in scripts":"Buscar en guiones","Search...":"Buscar...","Select all":"Seleccionar todo","Send email":"Enviar correo electrónico","Sends an email":"Envía un correo electrónico","Sends message via Pushsafer":"Envía mensaje a través de Pushsafer","Sends message via pushover":"Envía un mensaje a través de un pushover","Sends message via telegram":"Envía mensaje por telegrama","Sends message via whatsapp-cmb":"Envía mensaje vía whatsapp-cmb",September:u5,"Server time":"Tiempo del servidor","Set state action":"Establecer acción estatal","Set with delay":"Establecer con retraso","Shell command":"Comando de Shell","Show astronomical events":"Mostrar eventos astronómicos","Show javascript code":"Mostrar código Javascript","Show logs":"Mostrar registros","Show only paused scripts":"Mostrar solo secuencias de comandos pausadas","Show only running scripts":"Mostrar solo scripts en ejecución","Show only scripts with problems":"Mostrar solo guiones con problemas",Simulate:d5,"Some files will be rejected":"Algunos archivos serán rechazados","Sound:":"Sonido:",Stack:h5,Start:p5,"Start script":"Iniciar guion",State:g5,"State condition":"Condición del estado","Step into function":"Entra en función","Step out from function":"Sal de la función","Stop on exception":"Deténgase en excepción",Su:f5,"Subject:":"Sujeto:",Sunday:m5,"TS description":"Crear reglas escribiendo el mecanografiado",Telegram:b5,"Text:":"Texto:",Th:$5,"The script will be stopped and must be activated manually after debugging. Continue?":"El script se detendrá y deberá activarse manualmente después de la depuración. ¿Continuar?","This is advances option. You can write your own code here and it will be executed on trigger":"Esta es la opción de avances. Puede escribir su propio código aquí y se ejecutará en el disparador",Thursday:v5,Time:y5,"Time condition":"Condición de tiempo","Title:":"Título:","To:":"A:","Trigger with value":"Activar con valor",Triggered:_5,Triggers:w5,"Triggers the on script saving or the javascript instance restart":"Activa el guardado de la secuencia de comandos o el reinicio de la instancia de JavaScript","Triggers the rule on update or change of some state":"Activa la regla de actualización o cambio de algún estado","Triggers the rule periodically or on some specific time":"Activa la regla periódicamente o en un momento específico",Tu:S5,Tuesday:C5,URL:T5,"Unknown error":"Error desconocido","Unknown error!":"¡Error desconocido!","Use generated code":"Usar código generado","User function":"Función de usuario","User:":"Usuario:",Value:E5,"Vibration:":"Vibración:",Volume:k5,We:I5,Wednesday:x5,"Whatsapp-cmb":"Whatsapp-cmb",Write:D5,"Write your own code":"Escribe tu propio código",Yes:O5,"Yet exists!":"¡Sin embargo existe!","You can use %s in the URL to use current trigger value or %id to use the triggered object ID":"Puede usar %s en la URL para usar el valor de activación actual, %id para usar el ID de objeto activado, %name para mostrar el nombre de ID de objeto activado o %old para usar el valor de activación antiguo","You can use %s in the command to use current trigger value or %id to use the triggered object ID":"Puede usar %s en el comando para usar el valor de activación actual, %id para usar el ID de objeto activado, %name para mostrar el nombre de ID de objeto activado o %old para usar el valor de activación anterior","You can use %s in the text to display current trigger value or %id to display the triggered object ID":"Puede usar %s en el texto para mostrar el valor de activación actual, %id para usar el ID de objeto activado, %name para mostrar el nombre de ID de objeto activado o %old para usar el valor de activación antiguo","You can use %s in the value to use the current trigger value or %id to display the triggered object ID":"Puede usar %s en el valor para usar el valor de activación actual, %id para usar el ID de objeto activado, %name para mostrar el nombre de ID de objeto activado o %old para usar el valor de activación antiguo","You have to enter OpenAI API key in the configuration of javascript adapter.":"Debe ingresar la clave API de OpenAI en la configuración del adaptador de JavaScript.","[equal]":"[igual]","[greater or equal]":"[mayor o igual]","[greater]":"[mayor que]","[hysteresis]":"[histéresis]","[includes]":"[incluye]","[less or equal]":"[menor o igual]","[less]":"[menos]","[not equal]":"[no es igual]",acknowledgment:R5,all:A5,and:N5,astro:M5,at:L5,"clear running":"carrera clara",control:B5,copy:P5,cron:F5,dawn:j5,debug_help:z5,debug_label:U5,default:"defecto",dusk:H5,easy:W5,else:"demás","equal to":"igual a",every:V5,"every hour at 0 minutes":"cada hora a los 0 minutos",false:"falso","file reading has failed: %s":"la lectura del archivo ha fallado: %s","file reading was aborted":"la lectura del archivo fue abortada",filter_func:G5,filter_id:q5,filter_name:K5,filter_role:J5,filter_room:Y5,"for edit or create script":"para editar o crear un nuevo script","for professionals":"para profesionales","for programmers":"para programadores",goldenHour:X5,goldenHourEnd:Z5,"greater or equal":"mayor o igual","greater or equal to":"mayor o igual a","greater than":"mas grande que",help_just_check:Q5,help_on_change:eW,"high priority":"alta prioridad","high-priority":"alta prioridad","highest priority":"más alta prioridad",hours:tW,includes:nW,interval:sW,"just check":"Sólo revisa","less or equal":"menor o igual","less or equal to":"menor o igual a","less than":"menos que","lower priority":"prioridad más baja","lowest priority":"prioridad más baja",magic:rW,milliseconds:iW,minutes:oW,ms:aW,nadir:lW,nauticalDawn:cW,nauticalDusk:uW,nextSunrise:dW,nextSunset:hW,night:pW,nightEnd:gW,"no blocks found":"No se encontraron bloques","no group":"NO GRUPO",normal:fW,"normal priority":"prioridad normal","not equal to":"no igual a","not properly connected":"Este bloque no está conectado correctamente a otros bloques.",offset:mW,"on change":"en el cambio","on condition change":"con cambio de condición","on update":"en actualización",one:bW,or:$W,quiet:vW,"reset search":"restablecer la búsqueda",search:yW,seconds:_W,solarNoon:wW,"store in":"almacenar en",sunrise:SW,sunriseEnd:CW,sunset:TW,sunsetStart:EW,then:kW,"toggle value":"alternar valor",tooltip_ack:IW,tooltip_from:xW,tooltip_lc:DW,tooltip_quality:OW,tooltip_ts:RW,tooltip_user:AW,tooltip_value:NW,true:"cierto",two:MW,undefined:"indefinido",update:LW,"use seconds":"usar segundos","use trigger value":"usar valor de activación",verbose_help:BW,verbose_label:PW,when:FW,with:"con","with date":"con fecha","with offset":"con desplazamiento",wizard:jW},UW="Reconnu",HW="Actions",WW="Ajouter",VW="Tout",GW="Tout",qW="Postuler",KW="avril",JW="Demander",YW="Astronomique",XW="août",ZW="Annuler",QW="proche",e8="État",t8="Conditions",n8="Console",s8="Copié",r8="décembre",i8="Défaut",o8="Retard",a8="Effacer",l8="Description",c8="Terminé",u8="Exec shell",d8="Explication",h8="Exportation",p8="Février",g8="février",f8="Filtre",m8="Dossier",b8="Fr",$8="Vendredi",v8="ID",y8="ID1",_8="ID2",w8="Importation",S8="Exemple",C8="Instances",T8="Instructions",E8="Janvier",k8="janvier",I8="juillet",x8="juin",D8="Limite",O8="Mars",R8="Mai",A8="M e n u",N8="Message",M8="Mo",L8="Modèle",B8="Lundi",P8="Mois",F8="Nom",j8="novembre",z8="OK",U8="octobre",H8="D'accord",W8="Pause",V8="Pushover",G8="Pushsafer",q8="Renommer",K8="Répéter",J8="Redémarrer",Y8="Résultat",X8="Sa",Z8="samedi",Q8="sauver",eV="Horaire",tV="Scénario",nV="septembre",sV="Simuler",rV="Stack",iV="Début",oV="État",aV="Su",lV="dimanche",cV="Télégramme",uV="4",dV="Jeudi",hV="Temps",pV="Déclenché",gV="Déclencheurs",fV="Tu",mV="Mardi",bV="URL",$V="Valeur",vV="Le volume",yV="3",_V="Mercredi",wV="Écrivez",SV="Oui",CV="reconnaissance",TV="tout",EV="et",kV="astro",IV="à",xV="contrôler",DV="copie",OV="CRON",RV="Aube",AV="Il s'agit d'un mode spécial dans lequel les états et les objets ne changeront pas. Mais seules les informations sur chaque changement prévu seront affichées dans le protocole.",NV="Déboguer",MV="Crépuscule",LV="facile",BV="chaque",PV="Une fonction",FV="ID",jV="Nom",zV="Rôle",UV="Pièce",HV="Heure d'or",WV="Fin de l'heure d'or",VV="Le code ne sera exécuté que chaque fois que la condition est vraie. Par exemple. si déclenchement sur la valeur du capteur de température et que la condition est «si la température est supérieure à 20 ° C», les actions «alors» seront exécutées à chaque fois que le capteur envoie la température et qu'elle est supérieure à 20 ° C. À 21 ° C, à 22 ° C et ainsi de suite.",GV="Le code ne sera exécuté que si le résultat de la condition change. Par exemple. si le déclenchement sur la valeur du capteur de température et que la condition est «si la température est supérieure à 20 ° C», les actions «alors» seront exécutées une fois lorsque la température est supérieure à 20. La prochaine fois, les actions «alors» seront exécutées lorsque la température échoue sous 20 puis remonte au-dessus de 20.",qV="les heures",KV="comprend",JV="intervalle",YV="la magie",XV="millisecondes",ZV="minutes",QV="ms",e6="nadir",t6="Aube nautique",n6="Crépuscule nautique",s6="Prochain lever de soleil",r6="Prochain coucher de soleil",i6="Nuit",o6="Fin de nuit",a6="Ordinaire",l6="décalage",c6="une",u6="ou",d6="calmer",h6="chercher",p6="secondes",g6="Midi solaire",f6="lever du soleil",m6="Fin du lever du soleil",b6="le coucher du soleil",$6="Début du coucher du soleil",v6="alors",y6="Reconnaître",_6="De",w6="Dernière modification",S6="Qualité",C6="Horodatage",T6="Utilisateur",E6="Valeur",k6="deux",I6="mettre à jour",x6="Ajoute une sortie de débogage au journal pour de nombreuses commandes système",D6="Sorties de journal détaillées",O6="lorsque",R6="Wizard",A6={"()":"()","(optional)":"(optionnel)","-":"-",".":".",Ack:UW,Actions:HW,"Actual time of day":"Heure réelle de la journée",Add:WW,"Add new script":"Ajouter un nouveau script",All:VW,"All files will be accepted":"Tous les fichiers seront acceptés",Any:GW,"Any month":"N'importe quel mois",Apply:qW,April:KW,"Are you sure?":"Êtes-vous sûr?",Ask:JW,Astronomical:YW,"Astronomical events today":"Événements astronomiques aujourd'hui",August:XW,"Blockly description":"Création de règles par blocs graphiques","Body:":"Corps:",Cancel:ZW,"Cannot delete non empty item!":"Impossible de supprimer un élément non vide!","Change layout":"Changer la disposition",'Change theme (actual "%s")':'Changer de thème (maintenant - "%s")',"Check blocks":"Vérifier les blocs","Check is not active, because javascript adapter is disabled":"La vérification n'est pas active, car l'adaptateur Javascript est désactivé","Clear search input":"Effacer la recherche","Click on this icon":"Cliquez sur cette icône",Close:QW,"Close all but current":"Ferme tout sauf courant","Collapse all":"Réduire tout","Compares current time with astronomical event":"Compare l'heure actuelle avec un événement astronomique","Compares current time with the user specific time":"Compare l'heure actuelle avec l'heure spécifique de l'utilisateur","Compares the state value with user defined value":"Compare la valeur d'état avec la valeur définie par l'utilisateur",Condition:e8,Conditions:t8,"Configuration not saved.":"Configuration non enregistrée.",Console:n8,"Control or update some state":"Contrôler ou mettre à jour un état","Control or update some state with delay":"Contrôler ou mettre à jour un état avec un délai","Convert blockly to javascript for ever.":"Convertissez instantanément en Javascript.",Copied:s8,"Copy script":"Copier le script","Copy to clipboard":"Copier dans le presse-papier","Create new":"Créer un nouveau","Create new folder":"Créer un nouveau dossier","Create new script":"Créer un nouveau script","Create or edit CRON or time wizard":"Créer ou éditer CRON ou un assistant de temps","Dark Theme":"Thème sombre","Dark style":"Style sombre",Date:"Date","Debug instance":"Instance de débogage","Debug options":"Options de débogage",December:r8,Default:i8,"Define cron...":"Définir le cron ...","Define schedule...":"Définir le calendrier ...",Delay:o8,Delete:a8,"Delete %s":"Supprimer %s ...","Delete folder":"Supprimer le dossier","Delete script":"Supprimer le script",Description:l8,"Deselect all":"Tout déselectionner","Discard changes for %s":"Ignorer les modifications pour %s",Done:c8,"Double click to write value":"Double clic pour écrire la valeur","Download as file":"Télécharger le fichier","Drop some files here or click...":"Déposer des fichiers ici ou cliquez sur ...","Duplicate name":"Nom en double","Edit script or just double click":"Modifiez le script ou double-cliquez simplement sur","Empty name is not allowed":"Le nom vide n'est pas autorisé","End search mode":"Fin du mode de recherche","Enter your question":"Entrez votre demande",Error:"Erreur","Error was found":"Une erreur a été trouvée","Every day":"Tous les jours",Exec:u8,"Executes some shell command":"Exécute une commande shell","Existing scripts will be overwritten.":"Les scripts existants seront écrasés.","Expand all":"Développer tout","Expert mode":"Mode expert",Explanation:d8,Export:h8,"Export all scripts":"Exporter tous les scripts","Export blocks":"Blocs d'exportation","Export selected blocks":"Exporter les blocs sélectionnés",Februar:p8,February:g8,Filter:f8,Folder:m8,Fr:b8,Friday:$8,Function:"Fonction","Function editor":"Éditeur de fonction","Function: executed":"Fonction : exécutée","Go to next line":"Aller à la ligne suivante","HTTP Call":"Appel HTTP","Hide logs":"Masquer les journaux",ID:v8,ID1:y8,ID2:_8,Import:w8,"Import blocks":"Blocs d'importation","Import error":"Erreur d'importation","Import scripts":"Importer des scripts","Insert object ID":"Insérer un identifiant d'objet",Instance:S8,"Instance is disabled":"L'instance est désactivée","Instance:":"Exemple:",Instances:C8,Instructions:T8,"Invalid CRON":"CRON invalide","It will not be possible to revert this operation.":"Il ne sera pas possible de revenir sur cette opération.","JS description":"Créer des règles en écrivant du Javascript",Januar:E8,January:k8,July:I8,June:x8,"Just check":"Vérifiez simplement","Language:":"Langue:","Learn More":"Apprendre encore plus","Light style":"Style de lumière",Limit:D8,"Local time":"Heure locale","Locate file":"Localiser le fichier","Log outputs":"Journal des sorties","Log text":"Texte du journal","Log: %s":"Log : %s","Make a HTTP get request":"Faire une requête HTTP Get","Make a pause between actions":"Faites une pause entre les actions",March:O8,"March ":"mars",May:R8,Menu:A8,Message:N8,Mo:M8,Model:L8,Monday:B8,Month:P8,Name:F8,"No Chat GPT Key found":"Aucune clé GPT de chat trouvée","No active host found":"Aucun hôte actif trouvé","Nothing found":"Rien n'a été trouvé",November:j8,OK:z8,October:U8,Ok:H8,"On condition change":"En cas de changement de condition","On script save or adapter start":"Lors de l'enregistrement du script ou du démarrage de l'adaptateur","On weekdays":"En semaine","Open configuration":"Configuration ouverte","Operate two states":"Opérer deux états","Operations with two states":"Opérations à deux états",Pause:W8,"Pause execution":"Suspendre l'exécution","Pause script":"Script de pause","Phone:":"Téléphone:","Please select object ID...":"Veuillez sélectionner l'ID d'objet ...","Press Ctrl+Enter to get the answer":"Appuyez sur Ctrl+Entrée pour obtenir la réponse","Print some text in log":"Imprimer du texte dans le journal","Priority:":"Priorité:",Pushover:V8,Pushsafer:G8,"Read only ID selected: %s":"ID en lecture seule sélectionné: %s",Rename:q8,"Reorder scripts in folders":"Réorganiser les scripts dans des dossiers",Repeat:K8,Restart:J8,Result:Y8,"Resume execution":"Reprendre l'exécution","Root folder":"Dossier racine","Rules description":"Créer des règles avec des blocs IF, THEN, ELSE","Run script":"Script de lancement",Sa:X8,Saturday:Z8,Save:Q8,"Save all":"Sauver tous","Say It":"Say It","Say some text via sayit adapter":"Dites du texte via l'adaptateur sayit",Schedule:eV,Script:tV,"Script %s was modified on disk":"Le script %s a été modifié sur le disque","Script is not running":"Le script n'est pas en cours d'exécution","Search in scripts":"Rechercher dans les scripts","Search...":"Chercher...","Select all":"Tout sélectionner","Send email":"Envoyer un e-mail","Sends an email":"Envoie un e-mail","Sends message via Pushsafer":"Envoie un message via Pushsafer","Sends message via pushover":"Envoie un message via pushover","Sends message via telegram":"Envoie un message par télégramme","Sends message via whatsapp-cmb":"Envoie un message via whatsapp-cmb",September:nV,"Server time":"Heure du serveur","Set state action":"Définir l'action de l'état","Set with delay":"Set avec retard","Shell command":"Commande Shell","Show astronomical events":"Afficher les événements astronomiques","Show javascript code":"Afficher le code Javascript","Show logs":"Afficher les journaux","Show only paused scripts":"Afficher uniquement les scripts en pause","Show only running scripts":"Afficher uniquement les scripts en cours d'exécution","Show only scripts with problems":"Afficher uniquement les scripts avec des problèmes",Simulate:sV,"Some files will be rejected":"Certains fichiers seront rejetés","Sound:":"Sonner:",Stack:rV,Start:iV,"Start script":"Lancer le script",State:oV,"State condition":"État condition","Step into function":"Entrez dans la fonction","Step out from function":"Sortez de la fonction","Stop on exception":"Arrêt sur exception",Su:aV,"Subject:":"Sujet:",Sunday:lV,"TS description":"Créer des règles en écrivant des caractères dactylographiés",Telegram:cV,"Text:":"Texte:",Th:uV,"The script will be stopped and must be activated manually after debugging. Continue?":"Le script sera arrêté et doit être activé manuellement après le débogage. Continuez?","This is advances option. You can write your own code here and it will be executed on trigger":"C'est une option avancée. Vous pouvez écrire votre propre code ici et il sera exécuté au déclenchement",Thursday:dV,Time:hV,"Time condition":"Condition de temps","Title:":"Titre:","To:":"À:","Trigger with value":"Déclencheur avec valeur",Triggered:pV,Triggers:gV,"Triggers the on script saving or the javascript instance restart":"Déclenche l'enregistrement du script ou le redémarrage de l'instance javascript","Triggers the rule on update or change of some state":"Déclenche la règle sur la mise à jour ou le changement d'un état","Triggers the rule periodically or on some specific time":"Déclenche la règle périodiquement ou à une heure précise",Tu:fV,Tuesday:mV,URL:bV,"Unknown error":"Erreur inconnue","Unknown error!":"Erreur inconnue!","Use generated code":"Utiliser le code généré","User function":"Fonction utilisateur","User:":"Utilisateur:",Value:$V,"Vibration:":"Vibration:",Volume:vV,We:yV,Wednesday:_V,"Whatsapp-cmb":"Whatsapp-cmb",Write:wV,"Write your own code":"Écrivez votre propre code",Yes:SV,"Yet exists!":"Pourtant existe!","You can use %s in the URL to use current trigger value or %id to use the triggered object ID":"Vous pouvez utiliser %s dans l'URL pour utiliser la valeur de déclenchement actuelle, %id pour utiliser l'ID de l'objet déclenché, %name pour afficher le nom de l'ID de l'objet déclenché ou %old pour utiliser l'ancienne valeur de déclenchement","You can use %s in the command to use current trigger value or %id to use the triggered object ID":"Vous pouvez utiliser %s dans la commande pour utiliser la valeur de déclenchement actuelle, %id pour utiliser l'ID de l'objet déclenché, %name pour afficher le nom de l'ID de l'objet déclenché ou %old pour utiliser l'ancienne valeur de déclenchement","You can use %s in the text to display current trigger value or %id to display the triggered object ID":"Vous pouvez utiliser %s dans le texte pour afficher la valeur de déclenchement actuelle, %id pour utiliser l'ID de l'objet déclenché, %name pour afficher le nom de l'ID de l'objet déclenché ou %old pour utiliser l'ancienne valeur de déclenchement","You can use %s in the value to use the current trigger value or %id to display the triggered object ID":"Vous pouvez utiliser %s dans la valeur pour utiliser la valeur de déclenchement actuelle, %id pour utiliser l'ID de l'objet déclenché, %name pour afficher le nom de l'ID de l'objet déclenché ou %old pour utiliser l'ancienne valeur de déclenchement","You have to enter OpenAI API key in the configuration of javascript adapter.":"Vous devez entrer la clé API OpenAI dans la configuration de l'adaptateur javascript.","[equal]":"[égal]","[greater or equal]":"[supérieur ou égal]","[greater]":"[plus grand]","[hysteresis]":"[hystérèse]","[includes]":"[comprend]","[less or equal]":"[inférieur ou égal]","[less]":"[moins]","[not equal]":"[inégal]",acknowledgment:CV,all:TV,and:EV,astro:kV,at:IV,"clear running":"course claire",control:xV,copy:DV,cron:OV,dawn:RV,debug_help:AV,debug_label:NV,default:"défaut",dusk:MV,easy:LV,else:"autre","equal to":"égal à",every:BV,"every hour at 0 minutes":"toutes les heures à 0 minute",false:"faux","file reading has failed: %s":"La lecture du fichier a échoué: %s","file reading was aborted":"la lecture du fichier a été abandonnée",filter_func:PV,filter_id:FV,filter_name:jV,filter_role:zV,filter_room:UV,"for edit or create script":"pour éditer ou créer un nouveau script","for professionals":"pour les professionnels","for programmers":"pour les programmeurs",goldenHour:HV,goldenHourEnd:WV,"greater or equal":"supérieur ou égal","greater or equal to":"supérieur ou égal à","greater than":"plus grand que",help_just_check:VV,help_on_change:GV,"high priority":"haute priorité","high-priority":"haute priorité","highest priority":"priorité la plus élevée",hours:qV,includes:KV,interval:JV,"just check":"Vérifiez simplement","less or equal":"inférieur ou égal","less or equal to":"inférieur ou égal à","less than":"moins que","lower priority":"priorité inférieure","lowest priority":"priorité la plus basse",magic:YV,milliseconds:XV,minutes:ZV,ms:QV,nadir:e6,nauticalDawn:t6,nauticalDusk:n6,nextSunrise:s6,nextSunset:r6,night:i6,nightEnd:o6,"no blocks found":"Aucun bloc trouvé","no group":"PAS DE GROUPE",normal:a6,"normal priority":"priorité normale","not equal to":"pas égal à","not properly connected":"Ce bloc n'est pas correctement connecté à d'autres blocs.",offset:l6,"on change":"sur le changement","on condition change":"sur changement de condition","on update":"sur mise à jour",one:c6,or:u6,quiet:d6,"reset search":"Réinitialiser la recherche",search:h6,seconds:p6,solarNoon:g6,"store in":"stocker dans",sunrise:f6,sunriseEnd:m6,sunset:b6,sunsetStart:$6,then:v6,"toggle value":"valeur de bascule",tooltip_ack:y6,tooltip_from:_6,tooltip_lc:w6,tooltip_quality:S6,tooltip_ts:C6,tooltip_user:T6,tooltip_value:E6,true:"vrai",two:k6,undefined:"indéfini",update:I6,"use seconds":"utiliser les secondes","use trigger value":"use trigger value",verbose_help:x6,verbose_label:D6,when:O6,with:"avec","with date":"avec date","with offset":"avec offset",wizard:R6},N6="Riconosciuto",M6="Azioni",L6="Inserisci",B6="Tutti",P6="Qualunque",F6="Applica",j6="aprile",z6="Chiedere",U6="Astronomico",H6="agosto",W6="Annulla",V6="Vicino",G6="Condizione",q6="Condizioni",K6="Console",J6="Copiato",Y6="dicembre",X6="Predefinito",Z6="Ritardo",Q6="Elimina",eG="Descrizione",tG="Fatto",nG="Execshell",sG="Spiegazione",rG="Esportare",iG="Februar",oG="febbraio",aG="Filtro",lG="Cartella",cG="P",uG="Venerdì",dG="ID",hG="ID1",pG="ID2",gG="Importare",fG="Esempio",mG="istanze",bG="Istruzioni",$G="Januar",vG="gennaio",yG="luglio",_G="giugno",wG="Limite",SG="marzo",CG="Maggio",TG="Menu",EG="Messaggio",kG="Mo",IG="Modello",xG="Lunedi",DG="Mese",OG="Nome",RG="novembre",AG="OK",NG="ottobre",MG="Ok",LG="Pausa",BG="Pushover",PG="Pushsafer",FG="Rinominare",jG="Ripetere",zG="Ricomincia",UG="Risultato",HG="Sa",WG="Sabato",VG="Salva",GG="Programma",qG="copione",KG="settembre",JG="Simulare",YG="Stack",XG="Cominciare",ZG="Stato",QG="Su",e9="Domenica",t9="Telegramma",n9="4",s9="giovedi",r9="Tempo",i9="Innescato",o9="Trigger",a9="Tu",l9="martedì",c9="URL",u9="Valore",d9="Volume",h9="3",p9="mercoledì",g9="Scrivi",f9="sì",m9="riconoscimento",b9="tutti",$9="e",v9="astro",y9="a",_9="controllo",w9="copia",S9="CRON",C9="alba",T9="Questa è una modalità speciale in cui gli stati e gli oggetti non cambieranno. Ma nel protocollo verranno visualizzate solo le informazioni su ogni modifica pianificata.",E9="Debug",k9="crepuscolo",I9="facile",x9="ogni",D9="Funzione",O9="ID",R9="Nome",A9="Ruolo",N9="Camera",M9="Ora d'oro",L9="Fine dell'ora d'oro",B9='Il codice verrà eseguito solo ogni volta che la condizione è vera. Per esempio. se si attiva il valore del sensore di temperatura e la condizione è "se la temperatura è maggiore di 20 ° C", le azioni "allora" verranno eseguite ogni volta che il sensore invia la temperatura e questa è superiore a 20 ° C. Di 21 ° C, di 22 ° C e così via.',P9='Il codice verrà eseguito solo se il risultato della condizione cambia. Per esempio. se si attiva il valore del sensore di temperatura e la condizione è "se la temperatura è maggiore di 20 ° C", le azioni "allora" verranno eseguite una volta quando la temperatura è superiore a 20. La prossima volta le azioni "allora" verranno eseguite quando la temperatura fallisce sotto 20 e poi sale di nuovo oltre 20.',F9="ore",j9="include",z9="intervallo",U9="Magia",H9="millisecondi",W9="minuti",V9="ms",G9="nadir",q9="Alba nautica",K9="Crepuscolo nautico",J9="Prossima alba",Y9="Prossimo tramonto",X9="Notte",Z9="Fine della notte",Q9="normale",e7="compensare",t7="uno",n7="o",s7="silenzioso",r7="ricerca",i7="secondi",o7="Mezzogiorno solare",a7="Alba",l7="Fine dell'alba",c7="tramonto",u7="Inizio del tramonto",d7="poi",h7="Riconoscere",p7="A partire dal",g7="Ultima modifica",f7="Qualità",m7="timestamp",b7="Utente",$7="Valore",v7="Due",y7="aggiornare",_7="Aggiunge l'output di debug al registro per molti comandi di sistema",w7="Output di log dettagliati",S7="quando",C7="procedura guidata",T7={"()":"()","(optional)":"(opzionale)","-":"-",".":".",Ack:N6,Actions:M6,"Actual time of day":"Ora effettiva della giornata",Add:L6,"Add new script":"Aggiungi nuovo script",All:B6,"All files will be accepted":"Tutti i file saranno accettati",Any:P6,"Any month":"Ogni mese",Apply:F6,April:j6,"Are you sure?":"Sei sicuro?",Ask:z6,Astronomical:U6,"Astronomical events today":"Eventi astronomici oggi",August:H6,"Blockly description":"Creazione di regole tramite blocchi grafici","Body:":"Corpo:",Cancel:W6,"Cannot delete non empty item!":"Impossibile eliminare l'elemento non vuoto!","Change layout":"Cambia layout",'Change theme (actual "%s")':'Cambia tema (ora - "%s")',"Check blocks":"Controlla i blocchi","Check is not active, because javascript adapter is disabled":"Il controllo non è attivo perché l'adattatore Javascript è disabilitato","Clear search input":"Cancella input di ricerca","Click on this icon":"Clicca su questa icona",Close:V6,"Close all but current":"Chiudi tutto tranne corrente","Collapse all":"Comprimi tutto","Compares current time with astronomical event":"Confronta l'ora corrente con l'evento astronomico","Compares current time with the user specific time":"Confronta l'ora corrente con l'ora specifica dell'utente","Compares the state value with user defined value":"Confronta il valore dello stato con il valore definito dall'utente",Condition:G6,Conditions:q6,"Configuration not saved.":"Configurazione non salvata.",Console:K6,"Control or update some state":"Controlla o aggiorna uno stato","Control or update some state with delay":"Controlla o aggiorna uno stato con ritardo","Convert blockly to javascript for ever.":"Converti istantaneamente a blocchi in Javascript.",Copied:J6,"Copy script":"Copia script","Copy to clipboard":"Copia negli appunti","Create new":"Creare nuovo","Create new folder":"Crea una nuova cartella","Create new script":"Crea nuovo script","Create or edit CRON or time wizard":"Crea o modifica la procedura guidata CRON o time","Dark Theme":"Tema scuro","Dark style":"Stile scuro",Date:"Data","Debug instance":"Istanza di debug","Debug options":"Opzioni di debug",December:Y6,Default:X6,"Define cron...":"Definisci cron ...","Define schedule...":"Definisci programma ...",Delay:Z6,Delete:Q6,"Delete %s":"Elimina %s ...","Delete folder":"Elimina cartella","Delete script":"Elimina script",Description:eG,"Deselect all":"Deselezionare tutto","Discard changes for %s":"Annulla modifiche per %s",Done:tG,"Double click to write value":"Doppio clic per scrivere il valore","Download as file":"Scarica come file","Drop some files here or click...":"Trascina alcuni file qui o fai clic su ...","Duplicate name":"Nome duplicato","Edit script or just double click":"Modifica lo script o fai doppio clic","Empty name is not allowed":"Il nome vuoto non è consentito","End search mode":"Termina la modalità di ricerca","Enter your question":"Inserisci la tua richiesta",Error:"Errore","Error was found":"Errore trovato","Every day":"Ogni giorno",Exec:nG,"Executes some shell command":"Esegue alcuni comandi della shell","Existing scripts will be overwritten.":"Gli script esistenti verranno sovrascritti.","Expand all":"Espandi tutto","Expert mode":"Modalità esperto",Explanation:sG,Export:rG,"Export all scripts":"Esporta tutti gli script","Export blocks":"Esporta blocchi","Export selected blocks":"Esporta i blocchi selezionati",Februar:iG,February:oG,Filter:aG,Folder:lG,Fr:cG,Friday:uG,Function:"Funzione","Function editor":"Editor di funzioni","Function: executed":"Funzione: eseguita","Go to next line":"Vai alla riga successiva","HTTP Call":"Chiamata HTTP","Hide logs":"Nascondi i registri",ID:dG,ID1:hG,ID2:pG,Import:gG,"Import blocks":"Importa blocchi","Import error":"Errore di importazione","Import scripts":"Importa script","Insert object ID":"Inserisci l'ID oggetto",Instance:fG,"Instance is disabled":"L'istanza è disabilitata","Instance:":"Esempio:",Instances:mG,Instructions:bG,"Invalid CRON":"CRON non valido","It will not be possible to revert this operation.":"Non sarà possibile ripristinare questa operazione.","JS description":"Creare regole scrivendo Javascript",Januar:$G,January:vG,July:yG,June:_G,"Just check":"Controlla solamente","Language:":"Linguaggio:","Learn More":"Per saperne di più","Light style":"Stile leggero",Limit:wG,"Local time":"Ora locale","Locate file":"Localizza file","Log outputs":"Registra le uscite","Log text":"Testo del registro","Log: %s":"Log: %s","Make a HTTP get request":"Effettua una richiesta get HTTP","Make a pause between actions":"Fai una pausa tra le azioni",March:SG,"March ":"marzo",May:CG,Menu:TG,Message:EG,Mo:kG,Model:IG,Monday:xG,Month:DG,Name:OG,"No Chat GPT Key found":"Nessuna chiave GPT chat trovata","No active host found":"Nessun host attivo trovato","Nothing found":"Non abbiamo trovato nulla",November:RG,OK:AG,October:NG,Ok:MG,"On condition change":"A condizione che cambino","On script save or adapter start":"Al salvataggio dello script o all'avvio dell'adattatore","On weekdays":"Nei giorni della settimana","Open configuration":"Configurazione aperta","Operate two states":"Gestisci due stati","Operations with two states":"Operazioni con due stati",Pause:LG,"Pause execution":"Metti in pausa l'esecuzione","Pause script":"Metti in pausa lo script","Phone:":"Telefono:","Please select object ID...":"Seleziona l'ID oggetto ...","Press Ctrl+Enter to get the answer":"Premi Ctrl+Invio per ottenere la risposta","Print some text in log":"Stampa del testo nel registro","Priority:":"Priorità:",Pushover:BG,Pushsafer:PG,"Read only ID selected: %s":"ID di sola lettura selezionato: %s",Rename:FG,"Reorder scripts in folders":"Riordina gli script nelle cartelle",Repeat:jG,Restart:zG,Result:UG,"Resume execution":"Riprendi esecuzione","Root folder":"Cartella root","Rules description":"Crea regole con i blocchi IF, THEN, ELSE","Run script":"Esegui script",Sa:HG,Saturday:WG,Save:VG,"Save all":"Salva tutto","Say It":"Say It","Say some text via sayit adapter":"Pronuncia del testo tramite l'adattatore sayit",Schedule:GG,Script:qG,"Script %s was modified on disk":"Lo script %s è stato modificato sul disco","Script is not running":"Lo script non è in esecuzione","Search in scripts":"Cerca negli script","Search...":"Ricerca...","Select all":"Seleziona tutto","Send email":"Invia una email","Sends an email":"Invia un'e-mail","Sends message via Pushsafer":"Invia messaggio tramite Pushsafer","Sends message via pushover":"Invia messaggio tramite pushover","Sends message via telegram":"Invia messaggio tramite telegramma","Sends message via whatsapp-cmb":"Invia messaggio tramite whatsapp-cmb",September:KG,"Server time":"Ora del server","Set state action":"Imposta l'azione dello stato","Set with delay":"Impostato con ritardo","Shell command":"Comando Shell","Show astronomical events":"Mostra eventi astronomici","Show javascript code":"Mostra codice Javascript","Show logs":"Mostra i log","Show only paused scripts":"Mostra solo script in pausa","Show only running scripts":"Mostra solo gli script in esecuzione","Show only scripts with problems":"Mostra solo script con problemi",Simulate:JG,"Some files will be rejected":"Alcuni file verranno rifiutati","Sound:":"Suono:",Stack:YG,Start:XG,"Start script":"Avvia script",State:ZG,"State condition":"Condizione dello stato","Step into function":"Entra in funzione","Step out from function":"Esci dalla funzione","Stop on exception":"Ferma in caso di eccezione",Su:QG,"Subject:":"Soggetto:",Sunday:e9,"TS description":"Creare regole scrivendo dattiloscritto",Telegram:t9,"Text:":"Testo:",Th:n9,"The script will be stopped and must be activated manually after debugging. Continue?":"Lo script verrà interrotto e dovrà essere attivato manualmente dopo il debug. Continua?","This is advances option. You can write your own code here and it will be executed on trigger":"Questa è un'opzione anticipata. Puoi scrivere il tuo codice qui e verrà eseguito al trigger",Thursday:s9,Time:r9,"Time condition":"Condizione temporale","Title:":"Titolo:","To:":"Per:","Trigger with value":"Trigger con valore",Triggered:i9,Triggers:o9,"Triggers the on script saving or the javascript instance restart":"Attiva il salvataggio dello script o il riavvio dell'istanza javascript","Triggers the rule on update or change of some state":"Attiva la regola in caso di aggiornamento o modifica di uno stato","Triggers the rule periodically or on some specific time":"Attiva la regola periodicamente o in un momento specifico",Tu:a9,Tuesday:l9,URL:c9,"Unknown error":"Errore sconosciuto","Unknown error!":"Errore sconosciuto!","Use generated code":"Usa il codice generato","User function":"Funzione utente","User:":"Utente:",Value:u9,"Vibration:":"Vibrazione:",Volume:d9,We:h9,Wednesday:p9,"Whatsapp-cmb":"Whatsapp-cmb",Write:g9,"Write your own code":"Scrivi il tuo codice",Yes:f9,"Yet exists!":"Esiste ancora!","You can use %s in the URL to use current trigger value or %id to use the triggered object ID":"È possibile utilizzare %s nell'URL per utilizzare il valore di trigger corrente, %id per utilizzare l'ID dell'oggetto attivato, %name per mostrare il nome dell'ID dell'oggetto attivato o %old per utilizzare il vecchio valore di trigger","You can use %s in the command to use current trigger value or %id to use the triggered object ID":"È possibile utilizzare %s nel comando per utilizzare il valore di trigger corrente, %id per utilizzare l'ID dell'oggetto attivato, %name per mostrare il nome dell'ID dell'oggetto attivato o %old per utilizzare il vecchio valore di trigger","You can use %s in the text to display current trigger value or %id to display the triggered object ID":"È possibile utilizzare %s nel testo per visualizzare il valore di trigger corrente, %id per utilizzare l'ID dell'oggetto attivato, %name per mostrare il nome dell'ID dell'oggetto attivato o %old per utilizzare il vecchio valore di trigger","You can use %s in the value to use the current trigger value or %id to display the triggered object ID":"È possibile utilizzare %s nel valore per utilizzare il valore di trigger corrente, %id per utilizzare l'ID dell'oggetto attivato, %name per mostrare il nome dell'ID dell'oggetto attivato o %old per utilizzare il vecchio valore di trigger","You have to enter OpenAI API key in the configuration of javascript adapter.":"Devi inserire la chiave API OpenAI nella configurazione dell'adattatore javascript.","[equal]":"[pari]","[greater or equal]":"[maggiore o uguale]","[greater]":"[maggiore]","[hysteresis]":"[isteresi]","[includes]":"[include]","[less or equal]":"[minore o uguale]","[less]":"[Di meno]","[not equal]":"[non uguale]",acknowledgment:m9,all:b9,and:$9,astro:v9,at:y9,"clear running":"chiara esecuzione",control:_9,copy:w9,cron:S9,dawn:C9,debug_help:T9,debug_label:E9,default:"predefinito",dusk:k9,easy:I9,else:"altro","equal to":"uguale a",every:x9,"every hour at 0 minutes":"ogni ora a 0 minuti",false:"falso","file reading has failed: %s":"lettura file non riuscita: %s","file reading was aborted":"la lettura del file è stata interrotta",filter_func:D9,filter_id:O9,filter_name:R9,filter_role:A9,filter_room:N9,"for edit or create script":"per modificare o creare un nuovo script","for professionals":"per i professionisti","for programmers":"per i programmatori",goldenHour:M9,goldenHourEnd:L9,"greater or equal":"maggiore o uguale","greater or equal to":"maggiore o uguale a","greater than":"più grande di",help_just_check:B9,help_on_change:P9,"high priority":"priorità alta","high-priority":"priorità alta","highest priority":"massima priorità",hours:F9,includes:j9,interval:z9,"just check":"controlla solamente","less or equal":"inferiore o uguale","less or equal to":"minore o uguale a","less than":"meno di","lower priority":"priorità inferiore","lowest priority":"priorità più bassa",magic:U9,milliseconds:H9,minutes:W9,ms:V9,nadir:G9,nauticalDawn:q9,nauticalDusk:K9,nextSunrise:J9,nextSunset:Y9,night:X9,nightEnd:Z9,"no blocks found":"Nessun blocco trovato","no group":"NESSUN GRUPPO",normal:Q9,"normal priority":"priorità normale","not equal to":"non uguale a","not properly connected":"Questo blocco non è correttamente collegato ad altri blocchi.",offset:e7,"on change":"sul cambiamento","on condition change":"a cambio di condizione","on update":"in aggiornamento",one:t7,or:n7,quiet:s7,"reset search":"resetta la ricerca",search:r7,seconds:i7,solarNoon:o7,"store in":"conservare in",sunrise:a7,sunriseEnd:l7,sunset:c7,sunsetStart:u7,then:d7,"toggle value":"alterna valore",tooltip_ack:h7,tooltip_from:p7,tooltip_lc:g7,tooltip_quality:f7,tooltip_ts:m7,tooltip_user:b7,tooltip_value:$7,true:"vero",two:v7,undefined:"non definito",update:y7,"use seconds":"usa i secondi","use trigger value":"usa il trigger",verbose_help:_7,verbose_label:w7,when:S7,with:"con","with date":"con data","with offset":"con offset",wizard:C7},E7="Erkend",k7="Acties",I7="Toevoegen",x7="Alle",D7="Ieder",O7="Solliciteer",R7="april",A7="Vragen",N7="Astronomisch",M7="augustus",L7="annuleren",B7="Dichtbij",P7="Staat",F7="Voorwaarden",j7="Troosten",z7="Gekopieerd",U7="december",H7="Standaard",W7="Vertraging",V7="Verwijder",G7="Beschrijving",q7="Gedaan",K7="Exec shell",J7="Uitleg",Y7="Exporteren",X7="Februari",Z7="februari",Q7="Filter",eq="Map",tq="Vr",nq="vrijdag",sq="ID kaart",rq="ID1",iq="ID2",oq="Importeren",aq="Voorbeeld",lq="Instanties",cq="Instructies",uq="Januar",dq="januari",hq="juli",pq="juni",gq="Begrenzing",fq="maart",mq="mei",bq="Menu",$q="Bericht",vq="Ma",yq="Model",_q="maandag",wq="Maand",Sq="Naam",Cq="november",Tq="OK",Eq="oktober",kq="OK",Iq="Pauze",xq="Pushover",Dq="Duwijzer",Oq="andere naam geven",Rq="Herhaling",Aq="Herstarten",Nq="Resultaat",Mq="Za",Lq="zaterdag",Bq="Opslaan",Pq="Schema",Fq="Script",jq="september",zq="Simuleren",Uq="Stack",Hq="Begin",Wq="Staat",Vq="Zo",Gq="zondag",qq="Telegram",Kq="4",Jq="donderdag",Yq="Tijd",Xq="Veroorzaakt",Zq="Triggers",Qq="Di",eK="dinsdag",tK="URL",nK="Waarde",sK="Volume",rK="3",iK="woensdag",oK="Schrijven",aK="Ja",lK="erkenning",cK="alle",uK="en",dK="astro",hK="Bij",pK="controle",gK="kopiëren",fK="cron",mK="dageraad",bK="Dit is een speciale modus waarin toestanden en objecten niet veranderen. Maar alleen informatie over elke geplande wijziging wordt in het protocol weergegeven.",$K="Debuggen",vK="schemer",yK="eenvoudig",_K="elke",wK="Functie",SK="ID kaart",CK="Naam",TK="Rol",EK="Kamer",kK="gouden uur",IK="Einde van gouden uur",xK='De code wordt alleen uitgevoerd als de voorwaarde waar is. Bijv. als het triggeren op de temperatuursensorwaarde en de conditie is "als de temperatuur hoger is dan 20 ° C", zullen de "dan" acties worden uitgevoerd elke keer dat de sensor de temperatuur verzendt en deze hoger is dan 20 ° C. Bij 21 ° C, bij 22 ° C enzovoort.',DK='De code wordt alleen uitgevoerd als het conditieresultaat verandert. Bijv. als de temperatuursensor wordt geactiveerd en de conditie is "als de temperatuur hoger is dan 20 ° C", worden de "dan" -acties eenmaal uitgevoerd wanneer de temperatuur hoger is dan 20. De volgende keer worden de "dan" -acties uitgevoerd wanneer de temperatuur faalt onder de 20 en stijgt dan weer boven de 20.',OK="uren",RK="omvat",AK="interval",NK="magie",MK="milliseconden",LK="minuten",BK="ms",PK="nadir",FK="Nautische dageraad",jK="Nautische schemering",zK="Volgende zonsopgang",UK="Volgende zonsondergang",HK="nacht",WK="Einde van de nacht",VK="normaal",GK="compensatie",qK="een",KK="of",JK="stil",YK="zoeken",XK="seconden",ZK="Zonne-middag",QK="zonsopkomst",eJ="Einde zonsopgang",tJ="zonsondergang",nJ="Begin van de zonsondergang",sJ="vervolgens",rJ="Erkennen",iJ="Van",oJ="Laatst gewijzigd",aJ="Kwaliteit",lJ="tijdstempel",cJ="Gebruiker",uJ="Waarde",dJ="twee",hJ="bijwerken",pJ="Voegt foutopsporingsuitvoer toe aan het logboek voor veel systeemopdrachten",gJ="Uitgebreide log-uitgangen",fJ="wanneer",mJ="tovenaar",bJ={"()":"()","(optional)":"(optioneel)","-":"-",".":".",Ack:E7,Actions:k7,"Actual time of day":"Werkelijke tijd van de dag",Add:I7,"Add new script":"Nieuw script toevoegen",All:x7,"All files will be accepted":"Alle bestanden worden geaccepteerd",Any:D7,"Any month":"Elke maand",Apply:O7,April:R7,"Are you sure?":"Weet je zeker dat?",Ask:A7,Astronomical:N7,"Astronomical events today":"Astronomische gebeurtenissen vandaag",August:M7,"Blockly description":"Regels maken door grafische blokken","Body:":"Lichaam:",Cancel:L7,"Cannot delete non empty item!":"Kan niet leeg item niet verwijderen!","Change layout":"Opmaak veranderen",'Change theme (actual "%s")':'Thema wijzigen (nu - "%s")',"Check blocks":"Controleer blokken","Check is not active, because javascript adapter is disabled":"Controle is niet actief, omdat Javascript-adapter is uitgeschakeld","Clear search input":"Zoekopdracht wissen","Click on this icon":"Klik op dit pictogram",Close:B7,"Close all but current":"Alles sluiten behalve huidig","Collapse all":"Alles inklappen","Compares current time with astronomical event":"Vergelijkt huidige tijd met astronomische gebeurtenis","Compares current time with the user specific time":"Vergelijkt de huidige tijd met de gebruikerspecifieke tijd","Compares the state value with user defined value":"Vergelijkt de statuswaarde met de door de gebruiker gedefinieerde waarde",Condition:P7,Conditions:F7,"Configuration not saved.":"Configuratie niet opgeslagen.",Console:j7,"Control or update some state":"Beheer of update een bepaalde staat","Control or update some state with delay":"Beheer of update een bepaalde staat met vertraging","Convert blockly to javascript for ever.":"Converteer direct blockly naar Javascript.",Copied:z7,"Copy script":"Kopieer script","Copy to clipboard":"Kopieer naar klembord","Create new":"Maak nieuw","Create new folder":"Maak een nieuwe map","Create new script":"Maak een nieuw script","Create or edit CRON or time wizard":"Creëer of bewerk CRON of tijdwizard","Dark Theme":"Donker thema","Dark style":"Donkere stijl",Date:"Datum","Debug instance":"Debug-instantie","Debug options":"Foutopsporingsopties",December:U7,Default:H7,"Define cron...":"Definieer cron ...","Define schedule...":"Definieer schema ...",Delay:W7,Delete:V7,"Delete %s":"%s verwijderen ...","Delete folder":"Verwijder map","Delete script":"Script verwijderen",Description:G7,"Deselect all":"Deselecteer alles","Discard changes for %s":"Wijzigingen voor %s annuleren",Done:q7,"Double click to write value":"Dubbelklikken om waarde te schrijven","Download as file":"Download","Drop some files here or click...":"Zet hier enkele bestanden neer of klik op ...","Duplicate name":"Dubbele naam","Edit script or just double click":"Bewerk het script of dubbelklik erop","Empty name is not allowed":"Lege naam is niet toegestaan","End search mode":"Zoekmodus beëindigen","Enter your question":"Voer uw verzoek in",Error:"Fout","Error was found":"Er is een fout gevonden","Every day":"Elke dag",Exec:K7,"Executes some shell command":"Voert een shell-commando uit","Existing scripts will be overwritten.":"Bestaande scripts worden overschreven.","Expand all":"Alles uitvouwen","Expert mode":"Expert modus",Explanation:J7,Export:Y7,"Export all scripts":"Exporteer alle scripts","Export blocks":"Blokken exporteren","Export selected blocks":"Exporteer geselecteerde blokken",Februar:X7,February:Z7,Filter:Q7,Folder:eq,Fr:tq,Friday:nq,Function:"Functie","Function editor":"Functie-editor","Function: executed":"Functie: uitgevoerd","Go to next line":"Ga naar de volgende regel","HTTP Call":"HTTP-oproep","Hide logs":"Verberg logboeken",ID:sq,ID1:rq,ID2:iq,Import:oq,"Import blocks":"Blokken importeren","Import error":"Importfout","Import scripts":"Scripts importeren","Insert object ID":"Object-ID invoegen",Instance:aq,"Instance is disabled":"Exemplaar is uitgeschakeld","Instance:":"Voorbeeld:",Instances:lq,Instructions:cq,"Invalid CRON":"Ongeldige CRON","It will not be possible to revert this operation.":"Het is niet mogelijk om deze bewerking terug te zetten.","JS description":"Regels maken door Javascript te schrijven",Januar:uq,January:dq,July:hq,June:pq,"Just check":"Kijk maar","Language:":"Taal:","Learn More":"Leer meer","Light style":"Lichte stijl",Limit:gq,"Local time":"Lokale tijd","Locate file":"Vind het bestand","Log outputs":"Log uitgangen","Log text":"Log tekst","Log: %s":"Logboek: %s","Make a HTTP get request":"Maak een HTTP-ophaalverzoek","Make a pause between actions":"Pauzeer tussen acties",March:fq,"March ":"maart",May:mq,Menu:bq,Message:$q,Mo:vq,Model:yq,Monday:_q,Month:wq,Name:Sq,"No Chat GPT Key found":"Geen Chat GPT-sleutel gevonden","No active host found":"Geen actieve host gevonden","Nothing found":"Niets gevonden",November:Cq,OK:Tq,October:Eq,Ok:kq,"On condition change":"Op voorwaarde verandering","On script save or adapter start":"Bij het opslaan van het script of het starten van de adapter","On weekdays":"Op weekdagen","Open configuration":"Configuratie openen","Operate two states":"Bedien twee toestanden:","Operations with two states":"Bewerkingen met twee toestanden",Pause:Iq,"Pause execution":"Uitvoering pauzeren","Pause script":"Pauzeer script","Phone:":"Telefoon:","Please select object ID...":"Selecteer object-ID ...","Press Ctrl+Enter to get the answer":"Druk op Ctrl+Enter om het antwoord te krijgen","Print some text in log":"Druk wat tekst af in het logboek","Priority:":"Prioriteit:",Pushover:xq,Pushsafer:Dq,"Read only ID selected: %s":"Alleen-lezen ID geselecteerd: %s",Rename:Oq,"Reorder scripts in folders":"Sorteer scripts in mappen opnieuw",Repeat:Rq,Restart:Aq,Result:Nq,"Resume execution":"Uitvoering hervatten","Root folder":"Hoofdmap","Rules description":"Maak regels met IF, THEN, ELSE blokken","Run script":"Voer script uit",Sa:Mq,Saturday:Lq,Save:Bq,"Save all":"Sla alles op","Say It":"Say It","Say some text via sayit adapter":"Zeg wat tekst via de sayit-adapter",Schedule:Pq,Script:Fq,"Script %s was modified on disk":"Script %s is gewijzigd op schijf","Script is not running":"Script is niet actief","Search in scripts":"Zoeken in scripts","Search...":"Zoeken...","Select all":"Selecteer alles","Send email":"E-mail verzenden","Sends an email":"Stuurt een e-mail","Sends message via Pushsafer":"Stuurt bericht via Pushsafer","Sends message via pushover":"Stuurt bericht via pushover","Sends message via telegram":"Verzendt bericht via telegram","Sends message via whatsapp-cmb":"Stuurt bericht via whatsapp-cmb",September:jq,"Server time":"Servertijd","Set state action":"Stel statusactie in","Set with delay":"Met vertraging ingesteld","Shell command":"Shell-opdracht","Show astronomical events":"Laat astronomische gebeurtenissen zien","Show javascript code":"Javascript-code weergeven","Show logs":"Toon logboeken","Show only paused scripts":"Toon alleen onderbroken scripts","Show only running scripts":"Toon alleen actieve scripts","Show only scripts with problems":"Toon alleen scripts met problemen",Simulate:zq,"Some files will be rejected":"Sommige bestanden worden geweigerd","Sound:":"Geluid:",Stack:Uq,Start:Hq,"Start script":"Start het script",State:Wq,"State condition":"Staat staat","Step into function":"Stap in functie","Step out from function":"Stap uit de functie","Stop on exception":"Stop bij uitzondering",Su:Vq,"Subject:":"Onderwerpen:",Sunday:Gq,"TS description":"Regels maken door Typescript te schrijven",Telegram:qq,"Text:":"Tekst:",Th:Kq,"The script will be stopped and must be activated manually after debugging. Continue?":"Het script wordt gestopt en moet na het debuggen handmatig worden geactiveerd. Doorgaan met?","This is advances option. You can write your own code here and it will be executed on trigger":"Dit is een voorschotoptie. U kunt hier uw eigen code schrijven en deze wordt bij een trigger uitgevoerd",Thursday:Jq,Time:Yq,"Time condition":"Tijdsvoorwaarde","Title:":"Titel:","To:":"Naar:","Trigger with value":"Trigger met waarde",Triggered:Xq,Triggers:Zq,"Triggers the on script saving or the javascript instance restart":"Activeert het opslaan van het script of het opnieuw opstarten van de JavaScript-instantie","Triggers the rule on update or change of some state":"Activeert de regel voor het bijwerken of wijzigen van een bepaalde staat","Triggers the rule periodically or on some specific time":"Activeert de regel periodiek of op een specifieke tijd",Tu:Qq,Tuesday:eK,URL:tK,"Unknown error":"Onbekende fout","Unknown error!":"Onbekende fout!","Use generated code":"Gebruik gegenereerde code","User function":"Gebruikersfunctie","User:":"Gebruiker:",Value:nK,"Vibration:":"Trilling:",Volume:sK,We:rK,Wednesday:iK,"Whatsapp-cmb":"Whatsapp-cmb",Write:oK,"Write your own code":"Schrijf je eigen code",Yes:aK,"Yet exists!":"Toch bestaat!","You can use %s in the URL to use current trigger value or %id to use the triggered object ID":"U kunt %s in de URL gebruiken om de huidige triggerwaarde te gebruiken, %id om de geactiveerde object-ID te gebruiken, %name om de geactiveerde object-ID-naam te tonen of %old om de oude triggerwaarde te gebruiken","You can use %s in the command to use current trigger value or %id to use the triggered object ID":"U kunt %s in de opdracht gebruiken om de huidige triggerwaarde te gebruiken, %id om de getriggerde object-ID te gebruiken, %name om de getriggerde object-ID-naam te tonen of %old om de oude triggerwaarde te gebruiken","You can use %s in the text to display current trigger value or %id to display the triggered object ID":"U kunt %s in de tekst gebruiken om de huidige triggerwaarde weer te geven, %id om de geactiveerde object-ID te gebruiken, %name om de geactiveerde object-ID-naam weer te geven of %old om de oude triggerwaarde te gebruiken","You can use %s in the value to use the current trigger value or %id to display the triggered object ID":"U kunt %s in de waarde gebruiken om de huidige triggerwaarde te gebruiken, %id om de geactiveerde object-ID te gebruiken, %name om de geactiveerde object-ID-naam te tonen of %old om de oude triggerwaarde te gebruiken","You have to enter OpenAI API key in the configuration of javascript adapter.":"U moet de OpenAI API-sleutel invoeren in de configuratie van de javascript-adapter.","[equal]":"[Gelijk]","[greater or equal]":"[groter of gelijk]","[greater]":"[groter]","[hysteresis]":"[hysterese]","[includes]":"[inclusief]","[less or equal]":"[minder of gelijk]","[less]":"[minder]","[not equal]":"[niet gelijk]",acknowledgment:lK,all:cK,and:uK,astro:dK,at:hK,"clear running":"duidelijk rennen",control:pK,copy:gK,cron:fK,dawn:mK,debug_help:bK,debug_label:$K,default:"standaard",dusk:vK,easy:yK,else:"anders","equal to":"gelijk aan",every:_K,"every hour at 0 minutes":"elk uur op 0 minuten",false:"false","file reading has failed: %s":"bestands lezen is mislukt: %s","file reading was aborted":"bestands lezen is afgebroken",filter_func:wK,filter_id:SK,filter_name:CK,filter_role:TK,filter_room:EK,"for edit or create script":"voor bewerken of een nieuw script maken","for professionals":"voor professionals","for programmers":"voor programmeurs",goldenHour:kK,goldenHourEnd:IK,"greater or equal":"groter of gelijk","greater or equal to":"groter of gelijk aan","greater than":"groter dan",help_just_check:xK,help_on_change:DK,"high priority":"hoge prioriteit","high-priority":"hoge prioriteit","highest priority":"hoogste prioriteit",hours:OK,includes:RK,interval:AK,"just check":"kijk maar","less or equal":"minder of gelijk","less or equal to":"minder of gelijk aan","less than":"minder dan","lower priority":"lagere prioriteit","lowest priority":"laagste prioriteit",magic:NK,milliseconds:MK,minutes:LK,ms:BK,nadir:PK,nauticalDawn:FK,nauticalDusk:jK,nextSunrise:zK,nextSunset:UK,night:HK,nightEnd:WK,"no blocks found":"Geen blokken gevonden","no group":"GEEN GROEP",normal:VK,"normal priority":"normale prioriteit","not equal to":"niet gelijk aan","not properly connected":"Dit blok is niet correct verbonden met andere blokken.",offset:GK,"on change":"bij verandering","on condition change":"op voorwaarde verandering","on update":"bij update",one:qK,or:KK,quiet:JK,"reset search":"reset zoeken",search:YK,seconds:XK,solarNoon:ZK,"store in":"opslaan in",sunrise:QK,sunriseEnd:eJ,sunset:tJ,sunsetStart:nJ,then:sJ,"toggle value":"schakelwaarde",tooltip_ack:rJ,tooltip_from:iJ,tooltip_lc:oJ,tooltip_quality:aJ,tooltip_ts:lJ,tooltip_user:cJ,tooltip_value:uJ,true:"waar",two:dJ,undefined:"ongedefinieerd",update:hJ,"use seconds":"gebruik seconden","use trigger value":"triggerwaarde gebruiken",verbose_help:pJ,verbose_label:gJ,when:fJ,with:"met","with date":"met datum","with offset":"met offset",wizard:mJ},$J="Potwierdzony",vJ="Działania",yJ="Dodaj",_J="Wszystko",wJ="Każdy",SJ="Zastosuj",CJ="Kwiecień",TJ="Zapytać",EJ="Astronomiczny",kJ="Sierpień",IJ="Odwołaj",xJ="Zamknij",DJ="Stan",OJ="Warunki",RJ="Konsola",AJ="Skopiowano",NJ="Grudzień",MJ="Domyślna",LJ="Opóźnienie",BJ="Usuń",PJ="Opis",FJ="Gotowe",jJ="Uruchom shell",zJ="Wyjaśnienie",UJ="Eksport",HJ="Luty",WJ="Luty",VJ="Filtr",GJ="Folder",qJ="Pt",KJ="Piątek",JJ="ID",YJ="ID1",XJ="ID2",ZJ="Import",QJ="Instancja",eY="Instancje",tY="Instrukcje",nY="Styczeń",sY="Styczeń",rY="Lipiec",iY="Czerwiec",oY="Limit",aY="Marzec",lY="Maj",cY="Menu",uY="Wiadomość",dY="Po",hY="Model",pY="Poniedziałek",gY="Miesiąc",fY="Nazwa",mY="Listopad",bY="OK",$Y="Październik",vY="Ok",yY="Pauza",_Y="Pushover",wY="Pushsafer",SY="Przemianuj",CY="Powtórz",TY="Uruchom ponownie",EY="Wynik",kY="So",IY="Sobota",xY="Zapisz",DY="Harmonogram",OY="Skrypt",RY="Wrzesień",AY="Symulacja",NY="Stos",MY="Początek",LY="Stan",BY="Nd",PY="Niedziela",FY="Telegram",jY="Cz",zY="Czwartek",UY="Czas",HY="Wyzwolony",WY="Wyzwalacze",VY="Wt",GY="Wtorek",qY="URL",KY="Wartość",JY="Wolumen",YY="Śr",XY="Środa",ZY="Pisać",QY="Tak",eX="potwierdzenie",tX="wszystko",nX="i",sX="Astro",rX="w",iX="kontrola",oX="Kopiuj",aX="CRON",lX="Świt",cX="Jest to specjalny tryb, w którym stany i obiekty się nie zmieniają. Jednak w protokole będą wyświetlane tylko informacje o każdej planowanej zmianie.",uX="Odpluskwić",dX="Zmierzch",hX="łatwy",pX="każdy",gX="Funkcja",fX="ID",mX="Nazwa",bX="Rola",$X="Pokój",vX="Złota godzina",yX="Koniec złotej godziny",_X="Kod zostanie wykonany tylko za każdym razem, gdy warunek będzie spełniony. Na przykład. jeśli wyzwalanie na wartość czujnika temperatury i warunek to „jeśli temperatura jest wyższa niż 20 ° C”, to działania „następnie” będą wykonywane za każdym razem, gdy czujnik wyśle temperaturę i jest powyżej 20 ° C. O 21 ° C, o 22 ° C i tak dalej.",wX="Kod zostanie wykonany tylko wtedy, gdy wynik warunku ulegnie zmianie. Na przykład. jeśli wyzwalanie na wartość czujnika temperatury i warunek „jeśli temperatura jest wyższa niż 20 ° C”, to akcje „następnie” zostaną wykonane raz, gdy temperatura przekroczy 20. Następnym razem działania „następnie” zostaną wykonane, gdy temperatura nie udaje się poniżej 20, a następnie ponownie wzrasta powyżej 20.",SX="godziny",CX="zawiera",TX="interwał",EX="magia",kX="milisekund",IX="minuty",xX="ms",DX="Północ słoneczna",OX="Żeglarski świt",RX="Żeglarski zmierzch",AX="Następny wschód słońca",NX="Następny zachód słońca",MX="Noc",LX="Koniec nocy",BX="normalny",PX="przesunięcie",FX="jeden",jX="lub",zX="cisza",UX="Szukaj",HX="sekundy",WX="Południe słoneczne",VX="Wschód słońca",GX="Koniec wschodu słońca",qX="Zachód słońca",KX="Początek zachodu słońca",JX="następnie",YX="Akceptuj",XX="Od",ZX="Ostatnia zmiana",QX="Jakość",eZ="Znacznik czasu",tZ="Użytkownik",nZ="Wartość",sZ="dwa",rZ="aktualizacja",iZ="Dodaje wyniki debugowania do dziennika dla wielu poleceń systemowych",oZ="Pełne dane wyjściowe dziennika",aZ="gdy",lZ="Wizard",cZ={"()":"()","(optional)":"(opcjonalny)","-":"-",".":".",Ack:$J,Actions:vJ,"Actual time of day":"Aktualna pora dnia",Add:yJ,"Add new script":"Dodaj nowy skrypt",All:_J,"All files will be accepted":"Wszystkie pliki zostaną zaakceptowane",Any:wJ,"Any month":"Dowolny miesiąc",Apply:SJ,April:CJ,"Are you sure?":"Jesteś pewny?",Ask:TJ,Astronomical:EJ,"Astronomical events today":"Wydarzenia astronomiczne dzisiaj",August:kJ,"Blockly description":"Tworzenie reguł za pomocą bloków graficznych","Body:":"Treść:",Cancel:IJ,"Cannot delete non empty item!":"Nie można usunąć niepustego elementu!","Change layout":"Zmiana układu",'Change theme (actual "%s")':"Zmień motyw (obecnie - „%s”)","Check blocks":"Sprawdź bloki","Check is not active, because javascript adapter is disabled":"Sprawdzanie nie jest aktywne, ponieważ adapter Javascript jest wyłączony","Clear search input":"Wyczyść dane wyszukiwania","Click on this icon":"Kliknij tę ikonę",Close:xJ,"Close all but current":"Zamknij wszystkie oprócz bieżących","Collapse all":"Zwinąć wszystkie","Compares current time with astronomical event":"Porównuje aktualny czas z wydarzeniem astronomicznym","Compares current time with the user specific time":"Porównuje aktualny czas z czasem określonym przez użytkownika","Compares the state value with user defined value":"Porównuje wartość stanu z wartością zdefiniowaną przez użytkownika",Condition:DJ,Conditions:OJ,"Configuration not saved.":"Konfiguracja nie została zapisana.",Console:RJ,"Control or update some state":"Kontroluj lub aktualizuj stan","Control or update some state with delay":"Kontroluj lub aktualizuj jakiś stan z opóźnieniem","Convert blockly to javascript for ever.":"Bezpowrotna konwersja Blockly na Javascript.",Copied:AJ,"Copy script":"Skopiuj skrypt","Copy to clipboard":"Skopiuj do schowka","Create new":"Utwórz nowy","Create new folder":"Utwórz nowy folder","Create new script":"Utwórz nowy skrypt","Create or edit CRON or time wizard":"Utwórz lub edytuj CRON lub kreator czasu","Dark Theme":"Ciemny schemat","Dark style":"Ciemny styl",Date:"Data","Debug instance":"Debuguj instancję","Debug options":"Opcje debugowania",December:NJ,Default:MJ,"Define cron...":"Zdefiniuj CRON ...","Define schedule...":"Zdefiniuj harmonogram ...",Delay:LJ,Delete:BJ,"Delete %s":"Usuń %s ...","Delete folder":"Usuń folder","Delete script":"Usuń skrypt",Description:PJ,"Deselect all":"Odznacz wszystkie","Discard changes for %s":"Odrzuć zmiany dla %s",Done:FJ,"Double click to write value":"Kliknij dwukrotnie, aby zapisać wartość","Download as file":"Download jako plik plik","Drop some files here or click...":"Upuść niektóre pliki tutaj lub kliknij ...","Duplicate name":"Duplikat nazwy","Edit script or just double click":"Edytuj skrypt lub po prostu kliknij dwukrotnie","Empty name is not allowed":"Pusta nazwa jest niedozwolona","End search mode":"Zakończ tryb wyszukiwania","Enter your question":"Wpisz swoją prośbę",Error:"Błąd","Error was found":"Błąd został znaleziony","Every day":"Codziennie",Exec:jJ,"Executes some shell command":"Wykonuje polecenie powłoki","Existing scripts will be overwritten.":"Istniejące skrypty zostaną zastąpione.","Expand all":"Rozwiń wszystkie","Expert mode":"Tryb ekspercki",Explanation:zJ,Export:UJ,"Export all scripts":"Wyeksportuj wszystkie skrypty","Export blocks":"Eksportuj bloki","Export selected blocks":"Eksportuj wybrane bloki",Februar:HJ,February:WJ,Filter:VJ,Folder:GJ,Fr:qJ,Friday:KJ,Function:"Funkcja","Function editor":"Edytor funkcji","Function: executed":"Funkcja: wykonywana","Go to next line":"Przejdź do następnej linii","HTTP Call":"Połączenie HTTP","Hide logs":"Ukryj dzienniki",ID:JJ,ID1:YJ,ID2:XJ,Import:ZJ,"Import blocks":"Importuj bloki","Import error":"Błąd importowania","Import scripts":"Importuj skrypty","Insert object ID":"Wstaw identyfikator obiektu",Instance:QJ,"Instance is disabled":"Instancja jest wyłączona","Instance:":"Instancja:",Instances:eY,Instructions:tY,"Invalid CRON":"Nieprawidłowy CRON","It will not be possible to revert this operation.":"Cofnięcie tej operacji nie będzie możliwe.","JS description":"Tworzenie reguł w Javascript",Januar:nY,January:sY,July:rY,June:iY,"Just check":"Po prostu sprawdź","Language:":"Język:","Learn More":"Ucz się więcej","Light style":"Lekki styl",Limit:oY,"Local time":"Czas lokalny","Locate file":"Znajdź plik","Log outputs":"Log dziennika","Log text":"Tekst dziennika","Log: %s":"Dziennik: %s","Make a HTTP get request":"Złóż żądanie HTTP get","Make a pause between actions":"Zrób przerwę między czynnościami",March:aY,"March ":"Marzec ",May:lY,Menu:cY,Message:uY,Mo:dY,Model:hY,Monday:pY,Month:gY,Name:fY,"No Chat GPT Key found":"Nie znaleziono klucza GPT czatu","No active host found":"Nie znaleziono aktywnego hosta","Nothing found":"Nic nie znaleziono",November:mY,OK:bY,October:$Y,Ok:vY,"On condition change":"W przypadku zmiany warunków","On script save or adapter start":"Podczas zapisywania skryptu lub uruchamiania adaptera","On weekdays":"W dni powszednie","Open configuration":"Otwarta konfiguracja","Operate two states":"Obsługuj dwa stany","Operations with two states":"Operacje z dwoma stanami",Pause:yY,"Pause execution":"Wstrzymaj wykonanie","Pause script":"Wstrzymaj skrypt","Phone:":"Telefon:","Please select object ID...":"Wybierz identyfikator obiektu ...","Press Ctrl+Enter to get the answer":"Naciśnij klawisze Ctrl+Enter, aby uzyskać odpowiedź","Print some text in log":"Wydrukuj tekst w dzienniku","Priority:":"Priorytet:",Pushover:_Y,Pushsafer:wY,"Read only ID selected: %s":"Wybrano identyfikator tylko do odczytu: %s",Rename:SY,"Reorder scripts in folders":"Zmień kolejność skryptów w folderach",Repeat:CY,Restart:TY,Result:EY,"Resume execution":"Wznów wykonanie","Root folder":"Folder główny","Rules description":"Twórz reguły z blokami IF, THEN, ELSE","Run script":"Uruchom skrypt",Sa:kY,Saturday:IY,Save:xY,"Save all":"Zapisz wszystko","Say It":"Wypowiedz","Say some text via sayit adapter":"Powiedz tekst przez adapter sayit",Schedule:DY,Script:OY,"Script %s was modified on disk":"Skrypt %s został zmodyfikowany na dysku","Script is not running":"Skrypt nie działa","Search in scripts":"Szukaj w skryptach","Search...":"Szukaj...","Select all":"Zaznacz wszystko","Send email":"Wysłać email","Sends an email":"Wysyła e-mail","Sends message via Pushsafer":"Wysyła wiadomość przez Pushsafer","Sends message via pushover":"Wysyła wiadomość przez pushover","Sends message via telegram":"Wysyła wiadomość telegramem","Sends message via whatsapp-cmb":"Wysyła wiadomość przez WhatsApp-cmb",September:RY,"Server time":"Czas serwera","Set state action":"Ustaw stan działania","Set with delay":"Ustaw z opóźnieniem","Shell command":"Polecenie powłoki","Show astronomical events":"Pokaż wydarzenia astronomiczne","Show javascript code":"Pokaż kod JavaScript","Show logs":"Pokaż dzienniki","Show only paused scripts":"Pokaż tylko wstrzymane skrypty","Show only running scripts":"Pokaż tylko działające skrypty","Show only scripts with problems":"Pokaż tylko skrypty z problemami",Simulate:AY,"Some files will be rejected":"Niektóre pliki zostaną odrzucone","Sound:":"Dźwięk:",Stack:NY,Start:MY,"Start script":"Uruchom skrypt",State:LY,"State condition":"Warunek stanu","Step into function":"Wejdź do funkcji","Step out from function":"Wyjdź z funkcji","Stop on exception":"Zatrzymaj się na wyjątku",Su:BY,"Subject:":"Temat:",Sunday:PY,"TS description":"Tworzenie reguł w Typescript",Telegram:FY,"Text:":"Tekst:",Th:jY,"The script will be stopped and must be activated manually after debugging. Continue?":"Skrypt zostanie zatrzymany i należy go aktywować ręcznie po debugowaniu. Kontyntynuj?","This is advances option. You can write your own code here and it will be executed on trigger":"To jest opcja zaawansowana. Możesz tutaj napisać własny kod, który zostanie wykonany po wyzwoleniu",Thursday:zY,Time:UY,"Time condition":"Warunek czasowy","Title:":"Tytuł:","To:":"Do:","Trigger with value":"Wyzwalacz z wartością",Triggered:HY,Triggers:WY,"Triggers the on script saving or the javascript instance restart":"Uruchamia zapisywanie skryptu lub restart instancji javascript","Triggers the rule on update or change of some state":"Uruchamia regułę przy aktualizacji lub zmianie jakiegoś stanu","Triggers the rule periodically or on some specific time":"Uruchamia regułę okresowo lub w określonym czasie",Tu:VY,Tuesday:GY,URL:qY,"Unknown error":"Nieznany błąd","Unknown error!":"Nieznany błąd!","Use generated code":"Użyj wygenerowanego kodu","User function":"Funkcja użytkownika","User:":"Użytkownik:",Value:KY,"Vibration:":"Wibracja:",Volume:JY,We:YY,Wednesday:XY,"Whatsapp-cmb":"Whatsapp-cmb",Write:ZY,"Write your own code":"Napisz swój własny kod",Yes:QY,"Yet exists!":"A jednak istnieje!","You can use %s in the URL to use current trigger value or %id to use the triggered object ID":"Możesz użyć %s w adresie URL, aby użyć bieżącej wartości wyzwalacza, %id, aby użyć wyzwalanego identyfikatora obiektu, %name, aby wyświetlić nazwę identyfikatora wyzwalanego obiektu, lub %old, aby użyć starej wartości wyzwalacza","You can use %s in the command to use current trigger value or %id to use the triggered object ID":"Możesz użyć %s w poleceniu, aby użyć bieżącej wartości wyzwalającej, %id, aby użyć identyfikatora wyzwalanego obiektu, %name, aby wyświetlić nazwę identyfikatora wyzwalanego obiektu, lub %old, aby użyć starej wartości wyzwalającej","You can use %s in the text to display current trigger value or %id to display the triggered object ID":"Możesz użyć %s w tekście, aby wyświetlić aktualną wartość wyzwalającą, %id, aby użyć identyfikatora wyzwolonego obiektu, %name, aby wyświetlić nazwę identyfikatora wyzwolonego obiektu lub %old, aby użyć starej wartości wyzwalającej","You can use %s in the value to use the current trigger value or %id to display the triggered object ID":"Możesz użyć %s w wartości, aby użyć bieżącej wartości wyzwalacza, %id, aby użyć identyfikatora wyzwalanego obiektu, %name, aby wyświetlić nazwę identyfikatora wyzwalanego obiektu, lub %old, aby użyć starej wartości wyzwalacza","You have to enter OpenAI API key in the configuration of javascript adapter.":"Należy wprowadzić klucz OpenAI API w konfiguracji adaptera javascript.","[equal]":"[równy]","[greater or equal]":"[większe lub równe]","[greater]":"[większe]","[hysteresis]":"[histereza]","[includes]":"[obejmuje]","[less or equal]":"[mniejsze lub równe]","[less]":"[mniejsze]","[not equal]":"[nie równe]",acknowledgment:eX,all:tX,and:nX,astro:sX,at:rX,"clear running":"czyste uruchomienie",control:iX,copy:oX,cron:aX,dawn:lX,debug_help:cX,debug_label:uX,default:"domyślna",dusk:dX,easy:hX,else:"inaczej","equal to":"równy",every:pX,"every hour at 0 minutes":"co godzinę po 0 minutach",false:"fałsz","file reading has failed: %s":"odczyt pliku nie powiódł się: %s","file reading was aborted":"odczyt pliku został przerwany",filter_func:gX,filter_id:fX,filter_name:mX,filter_role:bX,filter_room:$X,"for edit or create script":"do edycji lub utwórz nowy skrypt","for professionals":"dla profesjonalistów","for programmers":"dla programistów",goldenHour:vX,goldenHourEnd:yX,"greater or equal":"większe lub równe","greater or equal to":"więcej lub równo","greater than":"więcej niż",help_just_check:_X,help_on_change:wX,"high priority":"wysoki priorytet","high-priority":"wysoki priorytet","highest priority":"najwyższy priorytet",hours:SX,includes:CX,interval:TX,"just check":"po prostu sprawdź","less or equal":"mniejsze lub równe","less or equal to":"mniej lub równo","less than":"mniej niż","lower priority":"niższy priorytet","lowest priority":"najniższy priorytet",magic:EX,milliseconds:kX,minutes:IX,ms:xX,nadir:DX,nauticalDawn:OX,nauticalDusk:RX,nextSunrise:AX,nextSunset:NX,night:MX,nightEnd:LX,"no blocks found":"Nie znaleziono bloków","no group":"BRAK GRUPY",normal:BX,"normal priority":"normalny priorytet","not equal to":"nie równa się","not properly connected":"Ten blok nie jest poprawnie podłączony do innych bloków.",offset:PX,"on change":"na zmianę","on condition change":"pod warunkiem zmiany warunków","on update":"po aktualizacji",one:FX,or:jX,quiet:zX,"reset search":"zresetuj wyszukiwanie",search:UX,seconds:HX,solarNoon:WX,"store in":"przechowaj w",sunrise:VX,sunriseEnd:GX,sunset:qX,sunsetStart:KX,then:JX,"toggle value":"wartość przełączania",tooltip_ack:YX,tooltip_from:XX,tooltip_lc:ZX,tooltip_quality:QX,tooltip_ts:eZ,tooltip_user:tZ,tooltip_value:nZ,true:"prawda",two:sZ,undefined:"nieokreślony",update:rZ,"use seconds":"użyj sekund","use trigger value":"użyj wartości wyzwalającej",verbose_help:iZ,verbose_label:oZ,when:aZ,with:"z","with date":"z datą","with offset":"z przesunięciem",wizard:lZ},uZ="Reconhecido",dZ="Ações",hZ="Adicionar",pZ="Todos",gZ="Nenhum",fZ="Aplique",mZ="abril",bZ="Perguntar",$Z="Astronômico",vZ="agosto",yZ="Cancelar",_Z="Fechar",wZ="Doença",SZ="Condições",CZ="Console",TZ="Copiado",EZ="dezembro",kZ="Predefinição",IZ="Atraso",xZ="Deletar",DZ="Descrição",OZ="Pronto",RZ="Exec shell",AZ="Explicação",NZ="Exportação",MZ="Februar",LZ="fevereiro",BZ="Filtro",PZ="Pasta",FZ="Fr",jZ="Sexta-feira",zZ="ID",UZ="ID1",HZ="ID2",WZ="Importar",VZ="Instância",GZ="Instâncias",qZ="Instruções",KZ="Januar",JZ="janeiro",YZ="julho",XZ="junho",ZZ="Limite",QZ="março",eQ="maio",tQ="Menu",nQ="mensagem",sQ="Mo",rQ="Modelo",iQ="Segunda-feira",oQ="Mês",aQ="Nome",lQ="novembro",cQ="OK",uQ="outubro",dQ="Ok",hQ="Pausa",pQ="Pushover",gQ="Pushsafer",fQ="Renomear",mQ="Repetir",bQ="Reiniciar",$Q="Resultado",vQ="Sá",yQ="Sábado",_Q="Salve",wQ="Cronograma",SQ="Script",CQ="setembro",TQ="Simular",EQ="Pilha",kQ="Começar",IQ="Estado",xQ="Su",DQ="Domingo",OQ="Telegrama",RQ="4",AQ="Quinta-feira",NQ="Tempo",MQ="Provocado",LQ="Gatilhos",BQ="Tu",PQ="terça",FQ="URL",jQ="Valor",zQ="Volume",UQ="3",HQ="quarta",WQ="Escrever",VQ="sim",GQ="reconhecimento",qQ="todos",KQ="e",JQ="astro",YQ="no",XQ="ao controle",ZQ="copiar",QQ="CRON",eee="alvorecer",tee="Este é um modo especial no qual estados e objetos não serão alterados. Mas apenas as informações sobre cada mudança planejada serão exibidas no protocolo.",nee="Depurar",see="Crepúsculo",ree="fácil",iee="cada",oee="Função",aee="ID",lee="Nome",cee="Tipo",uee="Quarto",dee="Hora dourada",hee="Fim da hora de ouro",pee='O código será executado apenas sempre que a condição for verdadeira. Por exemplo. se disparar no valor do sensor de temperatura e a condição for "se a temperatura for maior que 20 ° C", as ações "então" serão executadas toda vez que o sensor enviar a temperatura e ela estiver acima de 20 ° C. Por 21 ° C, por 22 ° C e assim por diante.',gee='O código será executado apenas se o resultado da condição mudar. Por exemplo. se disparar no valor do sensor de temperatura e a condição for "se a temperatura for maior que 20 ° C", as ações "então" serão executadas uma vez quando a temperatura estiver acima de 20. Na próxima vez, as ações "então" serão executadas quando a temperatura falha abaixo de 20 e sobe acima de 20 novamente.',fee="horas",mee="inclui",bee="intervalo",$ee="Magia",vee="milissegundos",yee="minutos",_ee="ms",wee="nadir",See="Madrugada náutica",Cee="Crepúsculo náutico",Tee="próximo nascer do sol",Eee="Próximo pôr do sol",kee="Noite",Iee="Fim de noite",xee="normal",Dee="Deslocamento",Oee="1",Ree="ou",Aee="quieto",Nee="procurar",Mee="segundos",Lee="Meio-dia solar",Bee="nascer do sol",Pee="Fim do nascer do sol",Fee="pôr do sol",jee="Começo do pôr do sol",zee="então",Uee="reconhecer",Hee="de",Wee="Última alteração",Vee="Qualidade",Gee="timestamp",qee="usuário",Kee="valor",Jee="dois",Yee="atualizar",Xee="Adiciona saída de depuração ao log para muitos comandos do sistema",Zee="Saídas de log detalhadas",Qee="quando",ete="Wizard",tte={"()":"()","(optional)":"(opcional)","-":"-",".":".",Ack:uZ,Actions:dZ,"Actual time of day":"Hora real do dia",Add:hZ,"Add new script":"Adicionar novo script",All:pZ,"All files will be accepted":"Todos os arquivos serão aceitos",Any:gZ,"Any month":"Qualquer mês",Apply:fZ,April:mZ,"Are you sure?":"Você tem certeza?",Ask:bZ,Astronomical:$Z,"Astronomical events today":"Eventos astronômicos hoje",August:vZ,"Blockly description":"Criando regras por blocos gráficos","Body:":"Corpo:",Cancel:yZ,"Cannot delete non empty item!":"Não pode ser deletar, porque não está vazio!","Change layout":"Alterar layout",'Change theme (actual "%s")':'Alterar tema (agora - "%s")',"Check blocks":"Verificar blocos","Check is not active, because javascript adapter is disabled":"A verificação de sintaxe não está ativa porque o adaptador javascript não está rodando.","Clear search input":"Limpar entrada de pesquisa","Click on this icon":"Clique neste ícone",Close:_Z,"Close all but current":"Fechar tudo, menos atual","Collapse all":"Recolher todos","Compares current time with astronomical event":"Compara o tempo atual com o evento astronômico","Compares current time with the user specific time":"Compara a hora atual com a hora específica do usuário","Compares the state value with user defined value":"Compara o valor do estado com o valor definido pelo usuário",Condition:wZ,Conditions:SZ,"Configuration not saved.":"Configuração não esta salva.",Console:CZ,"Control or update some state":"Controlar ou atualizar algum estado","Control or update some state with delay":"Controlar ou atualizar algum estado com atraso","Convert blockly to javascript for ever.":"Converter Blockly em Javascript permanentemente.",Copied:TZ,"Copy script":"Copiar script","Copy to clipboard":"Copiar para área de transferência","Create new":"Crie um novo","Create new folder":"Criar nova pasta","Create new script":"Criar novo script","Create or edit CRON or time wizard":"Criar ou editar o assistente cron ou o assistente de horário","Dark Theme":"Layout escuro","Dark style":"Estilo escuro",Date:"Encontro","Debug instance":"Instância de depuração","Debug options":"Opções de depuração",December:EZ,Default:kZ,"Define cron...":"Definir cron...","Define schedule...":"Definir agendamento ...",Delay:IZ,Delete:xZ,"Delete %s":"Deletar %s...","Delete folder":"Deletar pasta","Delete script":"Deletar script",Description:DZ,"Deselect all":"Desmarcar todos","Discard changes for %s":"Descartar alterações para %s",Done:OZ,"Double click to write value":"Clique duas vezes para escrever o valor","Download as file":"Baixar como arquivo","Drop some files here or click...":"Solte alguns arquivos aqui ou clique em...","Duplicate name":"Nome duplicado","Edit script or just double click":"Edite o script ou clique duas vezes","Empty name is not allowed":"Nome vazio não é permitido","End search mode":"Finalizar modo de pesquisa","Enter your question":"Digite sua solicitação",Error:"Erro","Error was found":"Erro foi encontrado","Every day":"Todos os dias",Exec:RZ,"Executes some shell command":"Executa algum comando shell","Existing scripts will be overwritten.":"Os scripts existentes serão substituídos.","Expand all":"Expandir todos","Expert mode":"Modo de especialista",Explanation:AZ,Export:NZ,"Export all scripts":"Exportar todos os scripts","Export blocks":"Exportar blocos","Export selected blocks":"Exportar blocos selecionados",Februar:MZ,February:LZ,Filter:BZ,Folder:PZ,Fr:FZ,Friday:jZ,Function:"Função","Function editor":"Editor de funções","Function: executed":"Função: executado","Go to next line":"Vá para a próxima linha","HTTP Call":"Chamada HTTP","Hide logs":"Ocultar logs",ID:zZ,ID1:UZ,ID2:HZ,Import:WZ,"Import blocks":"Importar blocos","Import error":"Erro de importação","Import scripts":"Importar script","Insert object ID":"Inserir ID do objeto",Instance:VZ,"Instance is disabled":"Instância está desativada","Instance:":"Instância:",Instances:GZ,Instructions:qZ,"Invalid CRON":"CRON inválido","It will not be possible to revert this operation.":"Não será possível reverter esta operação.","JS description":"Criando regras escrevendo Javascript",Januar:KZ,January:JZ,July:YZ,June:XZ,"Just check":"Apenas verifique","Language:":"Língua:","Learn More":"Aprender mais","Light style":"Estilo claro",Limit:ZZ,"Local time":"Hora local","Locate file":"Localize o arquivo","Log outputs":"Saídas de log","Log text":"Texto de registro","Log: %s":"Log: %s","Make a HTTP get request":"Faça uma solicitação HTTP get","Make a pause between actions":"Faça uma pausa entre as ações",March:QZ,"March ":"Março",May:eQ,Menu:tQ,Message:nQ,Mo:sQ,Model:rQ,Monday:iQ,Month:oQ,Name:aQ,"No Chat GPT Key found":"Nenhuma chave GPT de bate-papo encontrada","No active host found":"Nenhum host ativo encontrado","Nothing found":"Nada encontrado",November:lQ,OK:cQ,October:uQ,Ok:dQ,"On condition change":"Na mudança de condição","On script save or adapter start":"Ao salvar o script ou iniciar o adaptador","On weekdays":"Nos dias úteis","Open configuration":"Configuração aberta","Operate two states":"Operar dois estados","Operations with two states":"Operações com dois estados",Pause:hQ,"Pause execution":"Pausar a execução","Pause script":"Pausar script","Phone:":"Telefone:","Please select object ID...":"Selecione o ID do objeto...","Press Ctrl+Enter to get the answer":"Pressione Ctrl+Enter para obter a resposta","Print some text in log":"Imprimir algum texto no log","Priority:":"Prioridade:",Pushover:pQ,Pushsafer:gQ,"Read only ID selected: %s":"ID somente leitura selecionada: %s",Rename:fQ,"Reorder scripts in folders":"Reordenar scripts em pastas",Repeat:mQ,Restart:bQ,Result:$Q,"Resume execution":"Retomar execução","Root folder":"Pasta principal","Rules description":"Crie regras com blocos IF, THEN, ELSE","Run script":"Executar script",Sa:vQ,Saturday:yQ,Save:_Q,"Save all":"Salvar tudo","Say It":"Say It","Say some text via sayit adapter":"Diga algum texto através do adaptador sayit",Schedule:wQ,Script:SQ,"Script %s was modified on disk":'O script "%s" foi modificado no disco rígido',"Script is not running":"Script não está sendo executado","Search in scripts":"Pesquisa em scripts","Search...":"Procurar...","Select all":"Selecionar tudo","Send email":"Enviar email","Sends an email":"Envia um email","Sends message via Pushsafer":"Envia mensagem via Pushsafer","Sends message via pushover":"Envia mensagem via pushover","Sends message via telegram":"Envia mensagem via telegrama","Sends message via whatsapp-cmb":"Envia mensagem via whatsapp-cmb",September:CQ,"Server time":"Tempo de servidor","Set state action":"Definir ação de estado","Set with delay":"Definido com atraso","Shell command":"Comando shell","Show astronomical events":"Mostrar eventos astronômicos","Show javascript code":"Mostrar código Javascript","Show logs":"Mostrar logs","Show only paused scripts":"Mostrar apenas scripts pausados","Show only running scripts":"Mostrar apenas scripts em execução","Show only scripts with problems":"Mostrar apenas scripts com problemas",Simulate:TQ,"Some files will be rejected":"Alguns arquivos serão rejeitados","Sound:":"Som:",Stack:EQ,Start:kQ,"Start script":"Iniciar script",State:IQ,"State condition":"Condição de estado","Step into function":"Entre na função","Step out from function":"Saia da função","Stop on exception":"Pare na exceção",Su:xQ,"Subject:":"Sujeito:",Sunday:DQ,"TS description":"Criando regras escrevendo Typecript",Telegram:OQ,"Text:":"Texto:",Th:RQ,"The script will be stopped and must be activated manually after debugging. Continue?":"O script será interrompido e deve ser ativado manualmente após a depuração. Continuar?","This is advances option. You can write your own code here and it will be executed on trigger":"Esta é a opção de avanços. Você pode escrever seu próprio código aqui e ele será executado no gatilho",Thursday:AQ,Time:NQ,"Time condition":"Condição de tempo","Title:":"Título:","To:":"Para:","Trigger with value":"Trigger com valor",Triggered:MQ,Triggers:LQ,"Triggers the on script saving or the javascript instance restart":"Aciona o salvamento do script ou a reinicialização da instância javascript","Triggers the rule on update or change of some state":"Aciona a regra na atualização ou mudança de algum estado","Triggers the rule periodically or on some specific time":"Aciona a regra periodicamente ou em algum momento específico",Tu:BQ,Tuesday:PQ,URL:FQ,"Unknown error":"Erro desconhecido","Unknown error!":"Erro desconhecido!","Use generated code":"Usar código gerado","User function":"Função do usuário","User:":"Do utilizador:",Value:jQ,"Vibration:":"Vibração:",Volume:zQ,We:UQ,Wednesday:HQ,"Whatsapp-cmb":"Whatsapp-cmb",Write:WQ,"Write your own code":"Escreva seu próprio código",Yes:VQ,"Yet exists!":"Ainda existe!","You can use %s in the URL to use current trigger value or %id to use the triggered object ID":"Você pode usar %s na URL para usar o valor do gatilho atual, %id para usar o ID do objeto acionado, %name para mostrar o nome do ID do objeto acionado ou %old para usar o valor do gatilho antigo","You can use %s in the command to use current trigger value or %id to use the triggered object ID":"Você pode usar %s no comando para usar o valor do acionador atual, %id para usar o ID do objeto acionado, %name para mostrar o nome do ID do objeto acionado ou %old para usar o valor do acionador antigo","You can use %s in the text to display current trigger value or %id to display the triggered object ID":"Você pode usar %s no texto para exibir o valor do acionador atual, %id para usar o ID do objeto acionado, %name para mostrar o nome do ID do objeto acionado ou %old para usar o valor do acionador antigo","You can use %s in the value to use the current trigger value or %id to display the triggered object ID":"Você pode usar %s no valor para usar o valor do acionador atual, %id para usar o ID do objeto acionado, %name para mostrar o nome do ID do objeto acionado ou %old para usar o valor do acionador antigo","You have to enter OpenAI API key in the configuration of javascript adapter.":"Você deve inserir a chave da API OpenAI na configuração do adaptador javascript.","[equal]":"[igual]","[greater or equal]":"[maior ou igual]","[greater]":"[maior]","[hysteresis]":"[histerese]","[includes]":"[inclui]","[less or equal]":"[menor ou igual]","[less]":"[menos]","[not equal]":"[não igual]",acknowledgment:GQ,all:qQ,and:KQ,astro:JQ,at:YQ,"clear running":"corrida limpa",control:XQ,copy:ZQ,cron:QQ,dawn:eee,debug_help:tee,debug_label:nee,default:"predefinição",dusk:see,easy:ree,else:"outro","equal to":"igual a",every:iee,"every hour at 0 minutes":"a cada hora em 0 minutos",false:"falso","file reading has failed: %s":"a leitura do arquivo falhou: %s","file reading was aborted":"a leitura do arquivo foi abortada",filter_func:oee,filter_id:aee,filter_name:lee,filter_role:cee,filter_room:uee,"for edit or create script":"para editar ou criar um novo script","for professionals":"para profissionais","for programmers":"para programadores",goldenHour:dee,goldenHourEnd:hee,"greater or equal":"maior ou igual","greater or equal to":"maior ou igual a","greater than":"Maior que",help_just_check:pee,help_on_change:gee,"high priority":"prioridade máxima","high-priority":"prioridade máxima","highest priority":"Prioridade máxima",hours:fee,includes:mee,interval:bee,"just check":"Apenas verifique","less or equal":"menor ou igual","less or equal to":"menor ou igual a","less than":"Menor que","lower priority":"prioridade mais baixa","lowest priority":"prioridade mais baixa",magic:$ee,milliseconds:vee,minutes:yee,ms:_ee,nadir:wee,nauticalDawn:See,nauticalDusk:Cee,nextSunrise:Tee,nextSunset:Eee,night:kee,nightEnd:Iee,"no blocks found":"Nenhum bloco encontrado","no group":"SEM GRUPO",normal:xee,"normal priority":"prioridade normal","not equal to":"não é igual a","not properly connected":"Este bloco não está conectado corretamente com outros blocos.",offset:Dee,"on change":"em mudança","on condition change":"na mudança de condição","on update":"em atualização",one:Oee,or:Ree,quiet:Aee,"reset search":"redefinir pesquisa",search:Nee,seconds:Mee,solarNoon:Lee,"store in":"armazenar em",sunrise:Bee,sunriseEnd:Pee,sunset:Fee,sunsetStart:jee,then:zee,"toggle value":"valor de alternância",tooltip_ack:Uee,tooltip_from:Hee,tooltip_lc:Wee,tooltip_quality:Vee,tooltip_ts:Gee,tooltip_user:qee,tooltip_value:Kee,true:"verdade",two:Jee,undefined:"Indefinido",update:Yee,"use seconds":"use segundos","use trigger value":"use o gatilho",verbose_help:Xee,verbose_label:Zee,when:Qee,with:"com","with date":"com data","with offset":"com deslocamento",wizard:ete},nte="Подтверждение",ste="Действия",rte="Добавить",ite="Все",ote="Любая",ate="Применить",lte="Апрель",cte="Спросить",ute="Aстрономический",dte="Август",hte="Отмена",pte="Закрыть",gte="Условие",fte="Условия",mte="Приставка",bte="Скопировано",$te="Декабрь",vte="Дефолт",yte="Задержка",_te="Удалить",wte="Описание",Ste="Готово",Cte="Исполнить shell",Tte="Объяснение",Ete="Экспорт",kte="Февраль",Ite="Февраль",xte="Фильтр",Dte="Папка",Ote="Пт",Rte="пятница",Ate="ID",Nte="ID1",Mte="ID2",Lte="Импорт",Bte="Экземпляр",Pte="Экземпляры",Fte="Инструкции",jte="Январь",zte="Январь",Ute="Июль",Hte="Июнь",Wte="Предел",Vte="Март",Gte="Май",qte="Меню",Kte="Сообщение",Jte="Пн",Yte="Модель",Xte="понедельник",Zte="Месяц",Qte="Имя",ene="Ноябрь",tne="Ок",nne="Октябрь",sne="Ok",rne="Пауза",ine="Pushover",one="Pushsafer",ane="Переименовать",lne="Повторение",cne="Перезапустить",une="Результат",dne="Сб",hne="суббота",pne="Сохранить",gne="Расписание",fne="скрипт",mne="Сентябрь",bne="Симулировать",$ne="Stack",vne="Начинать",yne="Состояние",_ne="Вс",wne="Воскресенье",Sne="Telegram",Cne="Чт",Tne="Четверг",Ene="Время",kne="Срабатывает",Ine="Триггеры",xne="Вт",Dne="вторник",One="URL",Rne="Значение",Ane="Громкость",Nne="Ср",Mne="среда",Lne="Напишите",Bne="Да",Pne="подтверждение",Fne="все",jne="и",zne="Астро",Une="в",Hne="контроль",Wne="копия",Vne="CRON",Gne="Рассвет",qne="Это особый режим, в котором состояния и объекты не будут меняться. Но в протоколе будет отображаться только информация о каждом планируемом изменении.",Kne="Отлаживать",Jne="Сумерки",Yne="легкий",Xne="каждые(ый)",Zne="Функция",Qne="ID",ese="Название",tse="Роль",nse="Комната",sse="Золотой час",rse="Конец золотого часа",ise="Код будет выполняться только каждый раз, когда условие истинно. Например. при срабатывании по значению датчика температуры и условию «если температура выше 20°C», действия «затем» будут выполняться каждый раз, когда датчик отправляет значение температуры, и оно превышает 20°C. На 21°С, на 22°С и так далее.",ose="Код будет выполнен только в случае изменения результата условия. Например, при срабатывании по значению датчика температуры и условию «если температура больше 20°C», действия «затем» будут выполнены один раз, когда температура превысит 20°C. В следующий раз действия «затем» будут выполнены, когда температура опустится ниже 20°C, а затем снова поднимается выше 20°C.",ase="час(ов)",lse="содержит",cse="интервал",use="магия",dse="миллисекунды",hse="минут(у)",pse="мс",gse="Надир",fse="Морской рассвет",mse="Морские сумерки",bse="Следующий восход",$se="Следующий закат",vse="Ночь",yse="Конец ночи",_se="нормальный",wse="сдвиг",Sse="один",Cse="или",Tse="тихий",Ese="поиск",kse="секунд",Ise="Солнечный полдень",xse="Восход солнца",Dse="Конец восхода",Ose="Закат солнца",Rse="Начало заката",Ase="тогда",Nse="Подтверждено",Mse="От",Lse="Последнее изменение",Bse="Качественный",Pse="Время",Fse="Пользователь",jse="Значение",zse="два",Use="обновить",Hse="Добавляет вывод отладки в журнал для многих системных команд.",Wse="Подробный протокол",Vse="если",Gse="Мастер",qse={"()":"()","(optional)":"(необязательный)","-":"-",".":".",Ack:nte,Actions:ste,"Actual time of day":"Фактическое время суток",Add:rte,"Add new script":"Добавить новый скрипт",All:ite,"All files will be accepted":"Все файлы будут приняты",Any:ote,"Any month":"В любой месяц",Apply:ate,April:lte,"Are you sure?":"Вы уверены?",Ask:cte,Astronomical:ute,"Astronomical events today":"Астрономические события сегодня",August:dte,"Blockly description":"Создание правил графическими блоками","Body:":"Тело:",Cancel:hte,"Cannot delete non empty item!":"Не удается удалить непустой элемент!","Change layout":"Изменить макет",'Change theme (actual "%s")':'Сменить тему (сейчас - "%s")',"Check blocks":"Проверить блоки","Check is not active, because javascript adapter is disabled":"Проверка неактивна, потому что адаптер Javascript отключен","Clear search input":"Очистить ввод","Click on this icon":"Нажмите на этот значок",Close:pte,"Close all but current":"Закрыть все кроме текущего","Collapse all":"Свернуть все","Compares current time with astronomical event":"Сравнивает текущее время с астрономическим событием","Compares current time with the user specific time":"Сравнивает текущее время с конкретным временем пользователя","Compares the state value with user defined value":"Сравнивает значение состояния с пользовательским значением",Condition:gte,Conditions:fte,"Configuration not saved.":"Конфигурация не сохранена.",Console:mte,"Control or update some state":"Контролировать или обновлять какое-то состояние","Control or update some state with delay":"Контролировать или обновлять какое-либо состояние с задержкой","Convert blockly to javascript for ever.":"Преобразовать blockly в Javascript навсегда.",Copied:bte,"Copy script":"Скопировать скрипт","Copy to clipboard":"Скопировать в буфер обмена","Create new":"Создать новый","Create new folder":"Создать новую папку","Create new script":"Создать новый скрипт","Create or edit CRON or time wizard":"Создание или редактирование CRON или мастера времени","Dark Theme":"Тёмная тема","Dark style":"Темный стиль",Date:"Дата","Debug instance":"Экземпляр отладки","Debug options":"Варианты отладки",December:$te,Default:vte,"Define cron...":"Задать правило ...","Define schedule...":"Задать расписание...",Delay:yte,Delete:_te,"Delete %s":"Удалить %s...","Delete folder":"Удалить папку","Delete script":"Удалить скрипт",Description:wte,"Deselect all":"Снять выбор со всех","Discard changes for %s":"Отменить изменения для %s",Done:Ste,"Double click to write value":"Двойной щелчок для записи значения","Download as file":"Скачать как файл","Drop some files here or click...":"Перетыщите сюда файлы или нажмите ...","Duplicate name":"Повторяющееся имя","Edit script or just double click":"Редактировать скрипт или просто дважды щелкнуть","Empty name is not allowed":"Пустое имя не допускается","End search mode":"Закончить поиск","Enter your question":"Введи свою просьбу",Error:"Ошибка","Error was found":"Ошибка была найдена","Every day":"Каждый день",Exec:Cte,"Executes some shell command":"Выполняет некоторую команду оболочки","Existing scripts will be overwritten.":"Существующие скрипты будут перезаписаны.","Expand all":"Расширить все","Expert mode":"Экспертный режим",Explanation:Tte,Export:Ete,"Export all scripts":"Экспорт всех скриптов","Export blocks":"Экспортировать блоки","Export selected blocks":"Экспортировать выбранные блоки",Februar:kte,February:Ite,Filter:xte,Folder:Dte,Fr:Ote,Friday:Rte,Function:"Функция","Function editor":"Редактор функции","Function: executed":"Функция: выполнено","Go to next line":"Перейти к следующей строке","HTTP Call":"HTTP-вызов","Hide logs":"Скрыть журналы",ID:Ate,ID1:Nte,ID2:Mte,Import:Lte,"Import blocks":"Импортировать блоки","Import error":"Ошибка импорта","Import scripts":"Импорт скриптов","Insert object ID":"Вставить ID объекта",Instance:Bte,"Instance is disabled":"Экземпляр отключен","Instance:":"Пример:",Instances:Pte,Instructions:Fte,"Invalid CRON":"Неправильный CRON","It will not be possible to revert this operation.":"Невозможно вернуть эту операцию.","JS description":"Создание правил путём написания Javascript",Januar:jte,January:zte,July:Ute,June:Hte,"Just check":"Просто проверить","Language:":"Язык:","Learn More":"Узнать больше","Light style":"Светлый стиль",Limit:Wte,"Local time":"Местное время","Locate file":"Показать файл в дереве","Log outputs":"Журнал","Log text":"Текст журнала","Log: %s":"Журнал: %s","Make a HTTP get request":"Сделайте HTTP-запрос на получение","Make a pause between actions":"Сделайте паузу между действиями",March:Vte,"March ":"Март ",May:Gte,Menu:qte,Message:Kte,Mo:Jte,Model:Yte,Monday:Xte,Month:Zte,Name:Qte,"No Chat GPT Key found":"Ключ GPT для чата не найден","No active host found":"Активный host не найден","Nothing found":"Ничего не найдено",November:ene,OK:tne,October:nne,Ok:sne,"On condition change":"При изменении реузльтата условий","On script save or adapter start":"При сохранении скрипта или запуске адаптера","On weekdays":"По дням недели","Open configuration":"Открыть настройки","Operate two states":"Операции над двумя состояниями","Operations with two states":"Операции с двумя состояниями",Pause:rne,"Pause execution":"Приостановить выполнение","Pause script":"Остановить скрипт","Phone:":"Телефон:","Please select object ID...":"Пожалуйста, выберите ID объекта ...","Press Ctrl+Enter to get the answer":"Нажмите Ctrl+Enter, чтобы получить ответ","Print some text in log":"Напечатать текст в журнале","Priority:":"Приоритет:",Pushover:ine,Pushsafer:one,"Read only ID selected: %s":"Выбран идентификатор только для чтения: %s",Rename:ane,"Reorder scripts in folders":"Сортировать скрипты в папках",Repeat:lne,Restart:cne,Result:une,"Resume execution":"Возобновить выполнение","Root folder":"Корневая папка","Rules description":"Создавайте правила с блоками ЕСЛИ, ТО, ИНАЧЕ","Run script":"Запустить скрипт",Sa:dne,Saturday:hne,Save:pne,"Save all":"Сохранить все","Say It":"Say It","Say some text via sayit adapter":"Произнесите текст через адаптер Sayit",Schedule:gne,Script:fne,"Script %s was modified on disk":'Скрипт "%s" был изменен на диске',"Script is not running":"Сценарий не запущен","Search in scripts":"Поиск в скриптах","Search...":"Поиск...","Select all":"Выбрать все","Send email":"Отправить email","Sends an email":"Отправляет электронное письмо","Sends message via Pushsafer":"Отправляет сообщение через Pushsafer","Sends message via pushover":"Отправляет сообщение через пустышку","Sends message via telegram":"Отправляет сообщение в телеграмме","Sends message via whatsapp-cmb":"Отправляет сообщение через whatsapp-cmb",September:mne,"Server time":"Время сервера","Set state action":"Установить состояние","Set with delay":"Установить с задержкой","Shell command":"Команда оболочки","Show astronomical events":"Показать астрономические события","Show javascript code":"Показать код Javascript","Show logs":"Показать журналы","Show only paused scripts":"Показывать только приостановленные сценарии","Show only running scripts":"Показывать только запущенные скрипты","Show only scripts with problems":"Показывать только скрипты с проблемами",Simulate:bne,"Some files will be rejected":"Некоторые файлы будут отклонены","Sound:":"Звук:",Stack:$ne,Start:vne,"Start script":"Старт скрипта",State:yne,"State condition":"Сравнение состояния","Step into function":"Шаг в функционирование","Step out from function":"Выйти из функции","Stop on exception":"Остановить при исключении",Su:_ne,"Subject:":"Предмет:",Sunday:wne,"TS description":"Создание правил путём написания Typescript",Telegram:Sne,"Text:":"Текст:",Th:Cne,"The script will be stopped and must be activated manually after debugging. Continue?":"Cкрипт будет остановлен и должен быть активирован вручную после отладки. Продолжать?","This is advances option. You can write your own code here and it will be executed on trigger":"Это расширеный вариант. Вы можете написать здесь свой код и он будет выполняться по триггеру",Thursday:Tne,Time:Ene,"Time condition":"Условие времени","Title:":"Заголовок:","To:":"К:","Trigger with value":"Триггер со значением",Triggered:kne,Triggers:Ine,"Triggers the on script saving or the javascript instance restart":"Запускает при сохранении скрипта или перезапуске экземпляра javascript","Triggers the rule on update or change of some state":"Запускает правило при обновлении или изменении какого-либо состояния","Triggers the rule periodically or on some specific time":"Срабатывает правило периодически или в определенное время",Tu:xne,Tuesday:Dne,URL:One,"Unknown error":"Неизвестная ошибка","Unknown error!":"Неизвестная ошибка!","Use generated code":"Использовать сгенерированный код","User function":"Функция пользователя","User:":"Пользователь:",Value:Rne,"Vibration:":"Вибрация:",Volume:Ane,We:Nne,Wednesday:Mne,"Whatsapp-cmb":"Whatsapp-cmb",Write:Lne,"Write your own code":"Напишите свой код",Yes:Bne,"Yet exists!":"Имя уже существует!","You can use %s in the URL to use current trigger value or %id to use the triggered object ID":"Вы можете использовать %s в URL-адресе, чтобы использовать текущее значение триггера, %id, чтобы использовать идентификатор инициированного объекта, %name, чтобы показать имя идентификатора инициированного объекта, или %old, чтобы использовать старое значение триггера.","You can use %s in the command to use current trigger value or %id to use the triggered object ID":"Вы можете использовать %s в команде, чтобы использовать текущее значение триггера, %id, чтобы использовать идентификатор сработавшего объекта, %name, чтобы показать имя сработавшего идентификатора объекта, или %old, чтобы использовать старое значение триггера.","You can use %s in the text to display current trigger value or %id to display the triggered object ID":"Вы можете использовать %s в тексте для отображения текущего значения триггера, %id для использования идентификатора сработавшего объекта, %name для отображения имени сработавшего идентификатора объекта или %old для использования старого значения триггера.","You can use %s in the value to use the current trigger value or %id to display the triggered object ID":"Вы можете использовать %s в значении, чтобы использовать текущее значение триггера, %id, чтобы использовать идентификатор инициированного объекта, %name, чтобы показать имя идентификатора инициированного объекта, или %old, чтобы использовать старое значение триггера.","You have to enter OpenAI API key in the configuration of javascript adapter.":"Вы должны ввести ключ OpenAI API в конфигурации адаптера javascript.","[equal]":"[равно]","[greater or equal]":"[больше или равно]","[greater]":"[больше]","[hysteresis]":"[гистерезис]","[includes]":"[содержит]","[less or equal]":"[меньше или равно]","[less]":"[меньше]","[not equal]":"[не равно]",acknowledgment:Pne,all:Fne,and:jne,astro:zne,at:Une,"clear running":"остановить уже бегущие",control:Hne,copy:Wne,cron:Vne,dawn:Gne,debug_help:qne,debug_label:Kne,default:"дефолт",dusk:Jne,easy:Yne,else:"иначе","equal to":"равно",every:Xne,"every hour at 0 minutes":"каждый час через 0 минут",false:"false","file reading has failed: %s":"Ошибка чтения файла: %s","file reading was aborted":"Чтение файла было прервано",filter_func:Zne,filter_id:Qne,filter_name:ese,filter_role:tse,filter_room:nse,"for edit or create script":"для редактирования или создайте новый скрипт","for professionals":"для профессионалов","for programmers":"для программистов",goldenHour:sse,goldenHourEnd:rse,"greater or equal":"больше или равно","greater or equal to":"больше или равно","greater than":"больше чем",help_just_check:ise,help_on_change:ose,"high priority":"высокий приоритет","high-priority":"высокий-приоритет","highest priority":"высший приоритет",hours:ase,includes:lse,interval:cse,"just check":"просто проверить","less or equal":"меньше или равно","less or equal to":"меньше или равно","less than":"меньше, чем","lower priority":"более низкий приоритет","lowest priority":"самый низкий приоритет",magic:use,milliseconds:dse,minutes:hse,ms:pse,nadir:gse,nauticalDawn:fse,nauticalDusk:mse,nextSunrise:bse,nextSunset:$se,night:vse,nightEnd:yse,"no blocks found":"Блоков нет","no group":"Нет группы",normal:_se,"normal priority":"нормальный приоритет","not equal to":"не равно","not properly connected":"Этот блок неправильно соединён или не соединён с другими блоками.",offset:wse,"on change":"по изменению","on condition change":"при изменении результата условия","on update":"при обновлении",one:Sse,or:Cse,quiet:Tse,"reset search":"Cбросить поиск",search:Ese,seconds:kse,solarNoon:Ise,"store in":"сохранить в",sunrise:xse,sunriseEnd:Dse,sunset:Ose,sunsetStart:Rse,then:Ase,"toggle value":"инвертировать текщее значение",tooltip_ack:Nse,tooltip_from:Mse,tooltip_lc:Lse,tooltip_quality:Bse,tooltip_ts:Pse,tooltip_user:Fse,tooltip_value:jse,true:"true",two:zse,undefined:"неопределенный",update:Use,"use seconds":"использовать секунды","use trigger value":"использовать значение триггера",verbose_help:Hse,verbose_label:Wse,when:Vse,with:"с","with date":"с датой","with offset":"со сдвигом",wizard:Gse},Kse="Визнано",Jse="Дії",Yse="додати",Xse="все",Zse="Будь-який",Qse="Застосувати",ere="квітень",tre="Запитуйте",nre="Астрономічний",sre="серпень",rre="Скасувати",ire="Закрити",ore="Хвороба",are="Умови",lre="Консоль",cre="Скопійовано",ure="Грудень",dre="За замовчуванням",hre="Затримка",pre="Видалити",gre="опис",fre="Готово",mre="Виконавча оболонка",bre="Пояснення",$re="Експорт",vre="Лютий",yre="Лютий",_re="фільтр",wre="Папка",Sre="О",Cre="П'ятниця",Tre="ID",Ere="ID1",kre="ID2",Ire="Імпорт",xre="Екземпляр",Dre="Примірники",Ore="Інструкції",Rre="січень",Are="січня",Nre="липень",Mre="червень",Lre="Ліміт",Bre="березень",Pre="Може",Fre="Меню",jre="повідомлення",zre="пн",Ure="Модель",Hre="понеділок",Wre="місяць",Vre="Ім'я",Gre="Листопад",qre="в порядку",Kre="жовтень",Jre="В порядку",Yre="Пауза",Xre="Pushover",Zre="Pushsafer",Qre="Перейменувати",eie="Повторіть",tie="Перезапустіть",nie="Результат",sie="Sa",rie="Субота",iie="зберегти",oie="розклад",aie="Сценарій",lie="Вересень",cie="Симулювати",uie="Стек",die="старт",hie="Держава",pie="Нд",gie="неділя",fie="Телеграма",mie="чт",bie="четвер",$ie="час",vie="Спрацьовує",yie="Тригери",_ie="вт",wie="вівторок",Sie="URL",Cie="Значення",Tie="Обсяг",Eie="ми",kie="Середа",Iie="Напишіть",xie="Так",Die="підтвердження",Oie="все",Rie="і",Aie="Астро",Nie="в",Mie="КОНТРОЛЬ",Lie="копія",Bie="CRON",Pie="Світанок",Fie="Це особливий режим, в якому стану та об'єкти не змінюватимуться. Але в протоколі відображатиметься лише інформація про кожну заплановану зміну.",jie="Відлагоджувати",zie="Сутінки",Uie="легко",Hie="кожен",Wie="функція",Vie="ID",Gie="Ім'я",qie="Роль",Kie="Кімната",Jie="Золота година",Yie="Кінець золотої години",Xie="Код буде виконуватися лише щоразу, коли умова виконується. наприклад якщо спрацьовує значення датчика температури та умова «якщо температура перевищує 20°C», дії «тоді» виконуватимуться щоразу, коли датчик надсилає температуру, і вона перевищує 20°C. На 21°C, на 22°C і так далі.",Zie="Код буде виконано лише у разі зміни результату умови. наприклад якщо спрацьовує значення датчика температури та умова «якщо температура перевищує 20°C», дії «тоді» будуть виконані один раз, коли температура буде вище 20. Наступного разу дії «тоді» буде виконано, коли температура падає нижче 20, а потім знову піднімається вище 20.",Qie="години",eoe="включає в себе",toe="інтервал",noe="магія",soe="мілісекунд",roe="хвилин",ioe="РС",ooe="Надір",aoe="Морський світанок",loe="Морські сутінки",coe="Наступний схід сонця",uoe="Наступний захід сонця",doe="ніч",hoe="Кінець ночі",poe="нормально",goe="зсув",foe="один",moe="або",boe="тихо",$oe="пошук",voe="секунд",yoe="Сонячний полудень",_oe="схід сонця",woe="Кінець сходу сонця",Soe="Захід сонця",Coe="Початок заходу сонця",Toe="потім",Eoe="Визнати",koe="Від",Ioe="Востаннє змінено",xoe="якість",Doe="Мітка часу",Ooe="Користувач",Roe="Значення",Aoe="два",Noe="оновлення",Moe="Додає вихідні дані налагодження до журналу для багатьох системних команд",Loe="Докладні результати журналу",Boe="коли",Poe="майстер",Foe={"()":"()","(optional)":"(необов'язково)","-":"-",".":".",Ack:Kse,Actions:Jse,"Actual time of day":"Фактичний час доби",Add:Yse,"Add new script":"Додати новий сценарій",All:Xse,"All files will be accepted":"Усі файли будуть прийняті",Any:Zse,"Any month":"Будь-який місяць",Apply:Qse,April:ere,"Are you sure?":"Ти впевнений?",Ask:tre,Astronomical:nre,"Astronomical events today":"Астрономічні події сьогодні",August:sre,"Blockly description":"Створення правил за графічними блоками","Body:":"Тіло:",Cancel:rre,"Cannot delete non empty item!":"Неможливо видалити непорожній елемент!","Change layout":"Змінити макет",'Change theme (actual "%s")':'Змінити тему (тепер - "%s")',"Check blocks":"Перевірте блоки","Check is not active, because javascript adapter is disabled":"Перевірка не активна, оскільки адаптер Javascript вимкнено","Clear search input":"Очистити пошуковий запит","Click on this icon":"Натисніть на цей значок",Close:ire,"Close all but current":"Закрити всі, крім поточних","Collapse all":"Закрити всі","Compares current time with astronomical event":"Порівнює поточний час з астрономічною подією","Compares current time with the user specific time":"Порівнює поточний час із конкретним часом користувача","Compares the state value with user defined value":"Порівнює значення стану з визначеним користувачем значенням",Condition:ore,Conditions:are,"Configuration not saved.":"Конфігурація не збережена.",Console:lre,"Control or update some state":"Контролюйте або оновлюйте певний стан","Control or update some state with delay":"Контролюйте або оновлюйте деякий стан із затримкою","Convert blockly to javascript for ever.":"Назавжди конвертуйте Blockly у Javascript.",Copied:cre,"Copy script":"Копіювати сценарій","Copy to clipboard":"Копіювати в буфер обміну","Create new":"Створити новий","Create new folder":"Створити нову папку","Create new script":"Створіть новий сценарій","Create or edit CRON or time wizard":"Створення або редагування CRON або майстра часу","Dark Theme":"Темна тема","Dark style":"Темний стиль",Date:"Дата","Debug instance":"Екземпляр налагодження","Debug options":"Параметри налагодження",December:ure,Default:dre,"Define cron...":"Визначити cron...","Define schedule...":"Визначити розклад...",Delay:hre,Delete:pre,"Delete %s":"Видалити %s...","Delete folder":"Видалити папку","Delete script":"Видалити сценарій",Description:gre,"Deselect all":"Зняти вибір із усіх","Discard changes for %s":"Скасувати зміни для %s",Done:fre,"Double click to write value":"Двічі клацніть, щоб записати значення","Download as file":"Завантажити файл","Drop some files here or click...":"Перетягніть кілька файлів сюди або натисніть...","Duplicate name":"Повторюване ім'я","Edit script or just double click":"Відредагуйте сценарій або просто двічі клацніть","Empty name is not allowed":"Порожнє ім'я не допускається","End search mode":"Завершити режим пошуку","Enter your question":"Введи своє прохання",Error:"Помилка","Error was found":"Виявлено помилку","Every day":"Кожен день",Exec:mre,"Executes some shell command":"Виконує певну команду оболонки","Existing scripts will be overwritten.":"Існуючі сценарії буде перезаписано.","Expand all":"Розгорнути все","Expert mode":"Експертний режим",Explanation:bre,Export:$re,"Export all scripts":"Експортувати всі сценарії","Export blocks":"Експорт блоків","Export selected blocks":"Експортувати вибрані блоки",Februar:vre,February:yre,Filter:_re,Folder:wre,Fr:Sre,Friday:Cre,Function:"функція","Function editor":"Редактор функцій","Function: executed":"Функція: виконано","Go to next line":"Перейти до наступного рядка","HTTP Call":"Виклик HTTP","Hide logs":"Приховати журнали",ID:Tre,ID1:Ere,ID2:kre,Import:Ire,"Import blocks":"Імпорт блоків","Import error":"Помилка імпорту","Import scripts":"Імпорт скриптів","Insert object ID":"Вставте ID об'єкта",Instance:xre,"Instance is disabled":"Примірник вимкнено","Instance:":"екземпляр:",Instances:Dre,Instructions:Ore,"Invalid CRON":"Недійсний CRON","It will not be possible to revert this operation.":"Скасувати цю операцію буде неможливо.","JS description":"Створення правил шляхом написання Javascript",Januar:Rre,January:Are,July:Nre,June:Mre,"Just check":"Просто перевірте","Language:":"Мову:","Learn More":"Вивчайте більше","Light style":"Легкий стиль",Limit:Lre,"Local time":"Місцевий час","Locate file":"Знайти файл","Log outputs":"Виходи журналу","Log text":"Текст журналу","Log: %s":"Журнал: %s","Make a HTTP get request":"Зробіть HTTP-запит на отримання","Make a pause between actions":"Між діями робіть паузу",March:Bre,"March ":"березень",May:Pre,Menu:Fre,Message:jre,Mo:zre,Model:Ure,Monday:Hre,Month:Wre,Name:Vre,"No Chat GPT Key found":"Ключ GPT для чату не знайдено","No active host found":"Активний хост не знайдено","Nothing found":"Нічого не знайдено",November:Gre,OK:qre,October:Kre,Ok:Jre,"On condition change":"За умови зміни результату","On script save or adapter start":"Під час збереження сценарію або запуску адаптера","On weekdays":"В будні дні","Open configuration":"Відкрита конфігурація","Operate two states":"Керуйте двома станами","Operations with two states":"Операції з двома станами",Pause:Yre,"Pause execution":"Призупинити виконання","Pause script":"Призупинити сценарій","Phone:":"телефон:","Please select object ID...":"Виберіть ідентифікатор об'єкта...","Press Ctrl+Enter to get the answer":"Натисніть Ctrl+Enter, щоб отримати відповідь","Print some text in log":"Надрукувати текст у журналі","Priority:":"Пріоритет:",Pushover:Xre,Pushsafer:Zre,"Read only ID selected: %s":"Вибрано ідентифікатор лише для читання: %s",Rename:Qre,"Reorder scripts in folders":"Зміна порядку сценаріїв у папках",Repeat:eie,Restart:tie,Result:nie,"Resume execution":"Відновити виконання","Root folder":"Коренева папка","Rules description":"Створюйте правила з блоками IF, THEN, ELSE","Run script":"Запустіть сценарій",Sa:sie,Saturday:rie,Save:iie,"Save all":"Зберегти все","Say It":"Скажи це","Say some text via sayit adapter":"Скажіть текст через адаптер sayit",Schedule:oie,Script:aie,"Script %s was modified on disk":"Сценарій %s змінено на диску","Script is not running":"Сценарій не працює","Search in scripts":"Пошук у скриптах","Search...":"пошук...","Select all":"Вибрати все","Send email":"Відправити лист","Sends an email":"Надсилає електронний лист","Sends message via Pushsafer":"Надсилає повідомлення через Pushsafer","Sends message via pushover":"Надсилає повідомлення через pushover","Sends message via telegram":"Надсилає повідомлення через телеграм","Sends message via whatsapp-cmb":"Надсилає повідомлення через whatsapp-cmb",September:lie,"Server time":"Час сервера","Set state action":"Встановити дію стану","Set with delay":"Встановити із затримкою","Shell command":"Команда оболонки","Show astronomical events":"Показати астрономічні події","Show javascript code":"Показати код Javascript","Show logs":"Показати журнали","Show only paused scripts":"Показувати лише призупинені сценарії","Show only running scripts":"Показувати лише запущені сценарії","Show only scripts with problems":"Показувати лише сценарії з проблемами",Simulate:cie,"Some files will be rejected":"Деякі файли буде відхилено","Sound:":"звук:",Stack:uie,Start:die,"Start script":"Запустити сценарій",State:hie,"State condition":"Стан стану","Step into function":"Крок у функції","Step out from function":"Вийти з функції","Stop on exception":"Зупинка на винятках",Su:pie,"Subject:":"Тема:",Sunday:gie,"TS description":"Створення правил шляхом написання Typescript",Telegram:fie,"Text:":"Текст:",Th:mie,"The script will be stopped and must be activated manually after debugging. Continue?":"Сценарій буде зупинено, і його необхідно активувати вручну після налагодження. Продовжити?","This is advances option. You can write your own code here and it will be executed on trigger":"Це авансовий варіант. Ви можете написати тут свій власний код, і він буде виконано на тригері",Thursday:bie,Time:$ie,"Time condition":"Умова часу","Title:":"Назва:","To:":"до:","Trigger with value":"Тригер зі значенням",Triggered:vie,Triggers:yie,"Triggers the on script saving or the javascript instance restart":"Ініціює збереження сценарію або перезапуск екземпляра JavaScript","Triggers the rule on update or change of some state":"Запускає правило при оновленні або зміні якогось стану","Triggers the rule periodically or on some specific time":"Спрацьовує правило періодично або в певний час",Tu:_ie,Tuesday:wie,URL:Sie,"Unknown error":"Невідома помилка","Unknown error!":"Невідома помилка!","Use generated code":"Використовуйте згенерований код","User function":"Функція користувача","User:":"Користувач:",Value:Cie,"Vibration:":"Вібрація:",Volume:Tie,We:Eie,Wednesday:kie,"Whatsapp-cmb":"Whatsapp-cmb",Write:Iie,"Write your own code":"Напишіть власний код",Yes:xie,"Yet exists!":"Все ж існує!","You can use %s in the URL to use current trigger value or %id to use the triggered object ID":"Ви можете використовувати %s в URL-адресі, щоб використовувати поточне значення тригера, %id, щоб використовувати ідентифікатор активованого об’єкта, %name, щоб показати назву ідентифікатора активованого об’єкта, або %old, щоб використовувати старе значення тригера","You can use %s in the command to use current trigger value or %id to use the triggered object ID":"Ви можете використовувати %s у команді, щоб використовувати поточне значення тригера, %id, щоб використовувати ідентифікатор активованого об’єкта, %name, щоб показати назву ідентифікатора активованого об’єкта, або %old, щоб використовувати старе значення тригера","You can use %s in the text to display current trigger value or %id to display the triggered object ID":"Ви можете використовувати %s у тексті для відображення поточного значення тригера, %id для використання ідентифікатора активованого об’єкта, %name для відображення імені ідентифікатора активованого об’єкта або %old для використання старого значення тригера","You can use %s in the value to use the current trigger value or %id to display the triggered object ID":"Ви можете використовувати %s у значенні, щоб використовувати поточне значення тригера, %id, щоб використовувати ідентифікатор активованого об’єкта, %name, щоб показати назву ідентифікатора активованого об’єкта, або %old, щоб використовувати старе значення тригера","You have to enter OpenAI API key in the configuration of javascript adapter.":"Ви повинні ввести ключ OpenAI API у конфігурації адаптера JavaScript.","[equal]":"[рівний]","[greater or equal]":"[більше або дорівнює]","[greater]":"[більший]","[hysteresis]":"[гістерезис]","[includes]":"[включає]","[less or equal]":"[менше або рівно]","[less]":"[менше]","[not equal]":"[не дорівнює]",acknowledgment:Die,all:Oie,and:Rie,astro:Aie,at:Nie,"clear running":"чіткий біг",control:Mie,copy:Lie,cron:Bie,dawn:Pie,debug_help:Fie,debug_label:jie,default:"за замовчуванням",dusk:zie,easy:Uie,else:"інше","equal to":"дорівнює",every:Hie,"every hour at 0 minutes":"щогодини о 0 хвилин",false:"помилковий","file reading has failed: %s":"не вдалося прочитати файл: %s","file reading was aborted":"читання файлу було перервано",filter_func:Wie,filter_id:Vie,filter_name:Gie,filter_role:qie,filter_room:Kie,"for edit or create script":"для редагування або створення нового сценарію","for professionals":"для професіоналів","for programmers":"для програмістів",goldenHour:Jie,goldenHourEnd:Yie,"greater or equal":"більший або рівний","greater or equal to":"більше або дорівнює","greater than":"більше, ніж, величніше ніж, крутіший за",help_just_check:Xie,help_on_change:Zie,"high priority":"високий пріоритет","high-priority":"високий пріоритет","highest priority":"найвищий пріоритет",hours:Qie,includes:eoe,interval:toe,"just check":"просто перевірте","less or equal":"менше або дорівнює","less or equal to":"менше або дорівнює","less than":"менше ніж","lower priority":"нижчий пріоритет","lowest priority":"найнижчий пріоритет",magic:noe,milliseconds:soe,minutes:roe,ms:ioe,nadir:ooe,nauticalDawn:aoe,nauticalDusk:loe,nextSunrise:coe,nextSunset:uoe,night:doe,nightEnd:hoe,"no blocks found":"Блоків не знайдено","no group":"НЕМАЄ ГРУПИ",normal:poe,"normal priority":"нормальний пріоритет","not equal to":"не дорівнює","not properly connected":"Цей блок неправильно з’єднаний з іншими блоками.",offset:goe,"on change":"на зміну","on condition change":"про зміну умов","on update":"на оновлення",one:foe,or:moe,quiet:boe,"reset search":"скинути пошук",search:$oe,seconds:voe,solarNoon:yoe,"store in":"зберігати в",sunrise:_oe,sunriseEnd:woe,sunset:Soe,sunsetStart:Coe,then:Toe,"toggle value":"значення перемикання",tooltip_ack:Eoe,tooltip_from:koe,tooltip_lc:Ioe,tooltip_quality:xoe,tooltip_ts:Doe,tooltip_user:Ooe,tooltip_value:Roe,true:"правда",two:Aoe,undefined:"невизначений",update:Noe,"use seconds":"використовуйте секунди","use trigger value":"використовувати значення тригера",verbose_help:Moe,verbose_label:Loe,when:Boe,with:"з","with date":"з датою","with offset":"зі зміщенням",wizard:Poe},joe="确认",zoe="动作",Uoe="添加",Hoe="所有",Woe="任何",Voe="申请",Goe="四月",qoe="问",Koe="天文",Joe="八月",Yoe="取消",Xoe="关闭",Zoe="健康）状况",Qoe="情况",eae="安慰",tae="复制的",nae="十二月",sae="默认",rae="延迟",iae="删除",oae="描述",aae="完成",lae="执行力",cae="解释",uae="导出",dae="二月",hae="二月",pae="筛选",gae="文件夹",fae="r",mae="星期五",bae="ID",$ae="ID1",vae="ID2",yae="导入",_ae="实例",wae="实例",Sae="指示",Cae="亚努尔",Tae="一月",Eae="七月",kae="六月",Iae="限制",xae="三月",Dae="五月",Oae="菜单",Rae="信息",Aae="莫",Nae="模型",Mae="星期一",Lae="月",Bae="名称",Pae="十一月",Fae="好的",jae="十月",zae="确定",Uae="暂停",Hae="俯卧撑",Wae="推安全",Vae="重命名",Gae="重复",qae="重启",Kae="结果",Jae="萨",Yae="星期六",Xae="保存",Zae="日程",Qae="脚本",ele="九月",tle="模拟",nle="堆",sle="开始",rle="状态",ile="苏",ole="星期日",ale="电报",lle="4",cle="星期四",ule="时间",dle="触发",hle="扳机",ple="涂",gle="星期二",fle="网址",mle="价值",ble="体积",$le="3",vle="星期三",yle="写",_le="是的",wle="致谢",Sle="全部",Cle="和",Tle="天文",Ele="在",kle="控制",Ile="复制",xle="克朗",Dle="黎明",Ole="这是一种特殊模式，其中状态和对象不会改变。但只有有关每个计划更改的信息才会显示在协议中。",Rle="调试",Ale="黄昏",Nle="简单的",Mle="每一个",Lle="功能",Ble="ID",Ple="名字",Fle="角色",jle="房间",zle="黄金时段",Ule="黄金时段结束",Hle="仅在条件为真时才执行代码。例如。如果触发温度传感器值并且条件为“如果温度大于20°C”，则每次传感器发送温度且温度超过20°C时，将执行“然后”动作。 21°C，22°C等。",Wle="仅当条件结果更改时，代码才会执行。例如。如果触发温度传感器值且条件为“如果温度大于20°C”，则温度超过20时将执行一次“则”动作，下一次，当温度超过20时将执行“则”动作低于20失败，然后再次超过20。",Vle="小时",Gle="包括",qle="间隔",Kle="魔法",Jle="毫秒",Yle="分钟",Xle="毫秒",Zle="最低点",Qle="航海黎明",ece="航海黄昏",tce="下一个日出",nce="下一个日落",sce="夜晚",rce="夜晚结束",ice="普通的",oce="抵消",ace="一",lce="或",cce="安静的",uce="搜索",dce="秒",hce="星期日正午",pce="日出",gce="日出结束",fce="日落",mce="日落开始",bce="然后",$ce="确认",vce="从",yce="上一次改变",_ce="质量",wce="时间戳",Sce="用户",Cce="值",Tce="二",Ece="更新",kce="将调试输出添加到许多系统命令的日志中",Ice="详细日志输出",xce="什么时候",Dce="巫师",Oce={"()":"()","(optional)":"（选修的）","-":"-",".":".",Ack:joe,Actions:zoe,"Actual time of day":"一天中的实际时间",Add:Uoe,"Add new script":"添加新脚本",All:Hoe,"All files will be accepted":"所有文件都将被接受",Any:Woe,"Any month":"任何月份",Apply:Voe,April:Goe,"Are you sure?":"你确定吗？",Ask:qoe,Astronomical:Koe,"Astronomical events today":"今天的天文事件",August:Joe,"Blockly description":"按图形块创建规则","Body:":"身体：",Cancel:Yoe,"Cannot delete non empty item!":"无法删除非空项目！","Change layout":"变更版面",'Change theme (actual "%s")':"更改主题（现在为“%s”）","Check blocks":"检查块","Check is not active, because javascript adapter is disabled":"检查未激活，因为禁用了Javascript适配器","Clear search input":"清除搜索输入","Click on this icon":"单击此图标",Close:Xoe,"Close all but current":"关闭所有（当前除外）","Collapse all":"全部收缩","Compares current time with astronomical event":"将当前时间与天文事件进行比较","Compares current time with the user specific time":"将当前时间与用户特定时间进行比较","Compares the state value with user defined value":"比较状态值和用户定义的值",Condition:Zoe,Conditions:Qoe,"Configuration not saved.":"配置未保存。",Console:eae,"Control or update some state":"控制或更新某些状态","Control or update some state with delay":"延迟控制或更新某些状态","Convert blockly to javascript for ever.":"立即将blockly转换为Javascript。",Copied:tae,"Copy script":"复制脚本","Copy to clipboard":"复制到剪贴板","Create new":"创建新的","Create new folder":"创建新文件夹","Create new script":"创建新脚本","Create or edit CRON or time wizard":"创建或编辑周期任务或时间向导","Dark Theme":"深色调主题","Dark style":"深色调风格",Date:"日期","Debug instance":"调试实例","Debug options":"调试选项",December:nae,Default:sae,"Define cron...":"定义周期任务...","Define schedule...":"定义调度器......",Delay:rae,Delete:iae,"Delete %s":"删除%s...","Delete folder":"删除文件夹","Delete script":"删除脚本",Description:oae,"Deselect all":"取消全选","Discard changes for %s":"放弃%s的更改",Done:aae,"Double click to write value":"Double click to write value","Download as file":"档案","Drop some files here or click...":"将文件拖拽到这里或单击......","Duplicate name":"重名","Edit script or just double click":"双击编辑脚本","Empty name is not allowed":"不允许使用空名称","End search mode":"结束搜索模式","Enter your question":"输入您的要求",Error:"错误","Error was found":"发现错误","Every day":"每天",Exec:lae,"Executes some shell command":"执行一些shell命令","Existing scripts will be overwritten.":"现有脚本将被覆盖。","Expand all":"展开全部","Expert mode":"专家模式",Explanation:cae,Export:uae,"Export all scripts":"导出所有脚本","Export blocks":"导出块","Export selected blocks":"导出选定的块",Februar:dae,February:hae,Filter:pae,Folder:gae,Fr:fae,Friday:mae,Function:"功能","Function editor":"功能编辑器","Function: executed":"功能：执行","Go to next line":"转到下一行","HTTP Call":"HTTP呼叫","Hide logs":"隐藏日志",ID:bae,ID1:$ae,ID2:vae,Import:yae,"Import blocks":"导入块","Import error":"导入错误","Import scripts":"导入脚本","Insert object ID":"插入对象ID",Instance:_ae,"Instance is disabled":"实例已禁用","Instance:":"实例：",Instances:wae,Instructions:Sae,"Invalid CRON":"无效的周期任务","It will not be possible to revert this operation.":"无法恢复此操作。","JS description":"通过编写Javascript来创建规则",Januar:Cae,January:Tae,July:Eae,June:kae,"Just check":"只是检查","Language:":"语言：","Learn More":"了解更多","Light style":"浅色调风格",Limit:Iae,"Local time":"当地时间","Locate file":"定位文件","Log outputs":"记录输出","Log text":"记录文字","Log: %s":"日志:%s","Make a HTTP get request":"发出HTTP获取请求","Make a pause between actions":"在动作之间暂停",March:xae,"March ":"行进",May:Dae,Menu:Oae,Message:Rae,Mo:Aae,Model:Nae,Monday:Mae,Month:Lae,Name:Bae,"No Chat GPT Key found":"找不到聊天 GPT 密钥","No active host found":"找不到活动主机","Nothing found":"没有发现",November:Pae,OK:Fae,October:jae,Ok:zae,"On condition change":"条件变化时","On script save or adapter start":"在脚本保存或适配器启动时","On weekdays":"在工作日","Open configuration":"开放配置","Operate two states":"操作两种状态","Operations with two states":"具有两种状态的操作",Pause:Uae,"Pause execution":"暂停执行","Pause script":"暂停脚本","Phone:":"电话：","Please select object ID...":"请选择对象ID...","Press Ctrl+Enter to get the answer":"按 Ctrl+Enter 即可得到答案","Print some text in log":"在日志中打印一些文本","Priority:":"优先：",Pushover:Hae,Pushsafer:Wae,"Read only ID selected: %s":"选择的只读ID：%s",Rename:Vae,"Reorder scripts in folders":"重新排序文件夹中的脚本",Repeat:Gae,Restart:qae,Result:Kae,"Resume execution":"恢复执行","Root folder":"根文件夹","Rules description":"使用IF，THEN，ELSE块创建规则","Run script":"运行脚本",Sa:Jae,Saturday:Yae,Save:Xae,"Save all":"保存全部","Say It":"Say It","Say some text via sayit adapter":"通过sayit适配器说一些文字",Schedule:Zae,Script:Qae,"Script %s was modified on disk":"脚本%s已在磁盘上修改","Script is not running":"脚本没有运行","Search in scripts":"在脚本中搜索","Search...":"搜索...","Select all":"全选","Send email":"发送电子邮件","Sends an email":"发送邮件","Sends message via Pushsafer":"通过Pushsafer发送消息","Sends message via pushover":"通过推播发送消息","Sends message via telegram":"通过电报发送消息","Sends message via whatsapp-cmb":"通过whatsapp-cmb发送消息",September:ele,"Server time":"服务器时间","Set state action":"设定状态动作","Set with delay":"延迟设置","Shell command":"Shell命令","Show astronomical events":"显示天文事件","Show javascript code":"显示Javascript代码","Show logs":"显示记录","Show only paused scripts":"仅显示暂停的脚本","Show only running scripts":"仅显示正在运行的脚本","Show only scripts with problems":"仅显示有问题的脚本",Simulate:tle,"Some files will be rejected":"有些文件将被拒绝","Sound:":"声音：",Stack:nle,Start:sle,"Start script":"启动脚本",State:rle,"State condition":"状态条件","Step into function":"进入功能","Step out from function":"退出函数","Stop on exception":"异常停止",Su:ile,"Subject:":"学科：",Sunday:ole,"TS description":"通过编写Typescript来创建规则",Telegram:ale,"Text:":"文本：",Th:lle,"The script will be stopped and must be activated manually after debugging. Continue?":"该脚本将停止，并且必须在调试后手动激活。继续？","This is advances option. You can write your own code here and it will be executed on trigger":"这是高级选项。您可以在此处编写自己的代码，它将在触发器上执行",Thursday:cle,Time:ule,"Time condition":"时间条件","Title:":"标题：","To:":"到：","Trigger with value":"用值触发",Triggered:dle,Triggers:hle,"Triggers the on script saving or the javascript instance restart":"触发脚本保存或javascript实例重启","Triggers the rule on update or change of some state":"在某些状态的更新或更改时触发规则","Triggers the rule periodically or on some specific time":"定期或在特定时间触发规则",Tu:ple,Tuesday:gle,URL:fle,"Unknown error":"未知错误","Unknown error!":"未知错误！","Use generated code":"使用生成的代码","User function":"用户功能","User:":"用户：",Value:mle,"Vibration:":"振动：",Volume:ble,We:$le,Wednesday:vle,"Whatsapp-cmb":"Whatsapp的cmb",Write:yle,"Write your own code":"编写自己的代码",Yes:_le,"Yet exists!":"不存在！","You can use %s in the URL to use current trigger value or %id to use the triggered object ID":"您可以在 URL 中使用 %s 以使用当前触发值，%id 以使用触发对象 ID，%name 以显示触发对象 ID 名称或 %old 以使用旧触发值","You can use %s in the command to use current trigger value or %id to use the triggered object ID":"您可以在命令中使用 %s 以使用当前触发值，%id 使用触发对象 ID，%name 显示触发对象 ID 名称或 %old 使用旧触发值","You can use %s in the text to display current trigger value or %id to display the triggered object ID":"您可以在文本中使用 %s 显示当前触发值，%id 使用触发对象 ID，%name 显示触发对象 ID 名称或 %old 使用旧触发值","You can use %s in the value to use the current trigger value or %id to display the triggered object ID":"您可以在值中使用 %s 以使用当前触发器值，%id 使用触发对象 ID，%name 显示触发对象 ID 名称或 %old 使用旧触发器值","You have to enter OpenAI API key in the configuration of javascript adapter.":"您必须在 javascript 适配器的配置中输入 OpenAI API 密钥。","[equal]":"[平等的]","[greater or equal]":"[大于等于]","[greater]":"[更大]","[hysteresis]":"[磁滞]","[includes]":"[包括]","[less or equal]":"[小于或等于]","[less]":"[较少的]","[not equal]":"[不相等]",acknowledgment:wle,all:Sle,and:Cle,astro:Tle,at:Ele,"clear running":"畅通无阻",control:kle,copy:Ile,cron:xle,dawn:Dle,debug_help:Ole,debug_label:Rle,default:"默认",dusk:Ale,easy:Nle,else:"别的","equal to":"等于",every:Mle,"every hour at 0 minutes":"每小时0分钟",false:"错误的","file reading has failed: %s":"文件读取失败：%s","file reading was aborted":"文件读取中止",filter_func:Lle,filter_id:Ble,filter_name:Ple,filter_role:Fle,filter_room:jle,"for edit or create script":"用于编辑或创建脚本","for professionals":"对于专业人士","for programmers":"对于程序员",goldenHour:zle,goldenHourEnd:Ule,"greater or equal":"大于或等于","greater or equal to":"大于或等于","greater than":"比...更棒",help_just_check:Hle,help_on_change:Wle,"high priority":"高优先级","high-priority":"高优先级","highest priority":"最高优先级",hours:Vle,includes:Gle,interval:qle,"just check":"只是检查","less or equal":"小于或等于","less or equal to":"小于或等于","less than":"少于","lower priority":"低优先级","lowest priority":"最低优先级",magic:Kle,milliseconds:Jle,minutes:Yle,ms:Xle,nadir:Zle,nauticalDawn:Qle,nauticalDusk:ece,nextSunrise:tce,nextSunset:nce,night:sce,nightEnd:rce,"no blocks found":"找不到块","no group":"没有组",normal:ice,"normal priority":"正常优先","not equal to":"不等于","not properly connected":"此块未正确连接到其他块。",offset:oce,"on change":"在变化","on condition change":"在条件变化时","on update":"更新时",one:ace,or:lce,quiet:cce,"reset search":"重置搜索",search:uce,seconds:dce,solarNoon:hce,"store in":"存放在",sunrise:pce,sunriseEnd:gce,sunset:fce,sunsetStart:mce,then:bce,"toggle value":"切换值",tooltip_ack:$ce,tooltip_from:vce,tooltip_lc:yce,tooltip_quality:_ce,tooltip_ts:wce,tooltip_user:Sce,tooltip_value:Cce,true:"真的",two:Tce,undefined:"不明确的",update:Ece,"use seconds":"精确到秒","use trigger value":"使用触发值",verbose_help:kce,verbose_label:Ice,when:xce,with:"和","with date":"有日期","with offset":"带偏移",wizard:Dce},zf={root:{flexGrow:1,display:"flex",width:"100%",height:"100%"},menuDiv:{overflow:"hidden"},splitterDivs:o=>({"&>div":{overflow:"hidden",width:"100%",height:"100%"},"& .layout-splitter":{background:o.palette.mode==="dark"?"#595858":"#ccc;"}}),mainDiv:{width:"100%",height:"100%",overflow:"hidden"},content:o=>({width:"100%",height:"100%",backgroundColor:o.palette.background&&o.palette.background.default,position:"relative"}),splitterDivWithMenu:{width:"calc(100% - 300px)",height:"100%"},menuDivWithoutMenu:{"&>div:first-child":{display:"none"},"&>.layout-splitter":{display:"none"}},progress:{margin:100},menuOpenCloseButton:o=>({position:"absolute",left:0,borderRadius:"0 5px 5px 0",top:6,pt:1,cursor:"pointer",zIndex:1,height:25,width:20,background:o.palette.secondary.main,color:o.palette.primary.main,pl:"3px","&:hover":{color:"white"}}),showLogButton:o=>({position:"absolute",right:3,borderRadius:"5px 5px 0 0",bottom:0,pt:"3px",cursor:"pointer",zIndex:10,height:20,width:25,background:o.palette.secondary.main,color:o.palette.primary.main,pl:1,"&:hover":{color:"white"}})};class Rce extends I.GenericApp{hosts=[];importFile=null;scripts={};confirmCallback=null;constructor(n){super(n,{Connection:I.AdminConnection,translations:{en:sz,de:J3,es:zW,fr:A6,it:T7,nl:bJ,pl:cZ,pt:tte,ru:qse,uk:Foe,"zh-cn":Oce},bottomButtons:!1,socket:{autoSubscribeLog:!0},sentryDSN:window.sentryDSN});const s=window.localStorage.getItem("JS.logSizes");let i=[80,20];if(s)try{i=JSON.parse(s)}catch{}const a=window.localStorage.getItem("JS.splitSizes");let c=[20,80];if(a)try{c=JSON.parse(a)}catch{}Object.assign(this.state,{splitSizes:c,logSizes:i}),window.alert=h=>{console.error(h),this.showJsError(h.toString())}}onScriptsChanged=(n,s)=>{if(!n)return;let i=!1;const a={};n.startsWith("script.js.")&&(s?JSON.stringify(this.scripts[n])!==JSON.stringify(s)&&(this.scripts[n]=s,i=!0,a.scriptsHash=this.state.scriptsHash+1):this.scripts[n]&&(delete this.scripts[n],i=!0,a.scriptsHash=this.state.scriptsHash+1)),i&&this.setState(a)};onInstanceChanged=(n,s)=>{var c;if(!n)return;let i=!1;const a={};if(n.match(/^system\.adapter\.[-_\w\d]+\$/)){if(n.startsWith(`system.adapter.${this.adapterName}.`)){const h=parseInt(n.split(".").pop()||"0",10)||0;if((s==null?void 0:s.type)==="instance")this.state.instances.includes(h)||(a.instances=[...this.state.instances],a.instances.push(h),a.instances.sort(),i=!0,this.socket.subscribeState(`${s._id}.alive`,this.onInstanceAliveChange));else if(!s&&this.state.instances.includes(h)){this.socket.unsubscribeState(`${n}.alive`,this.onInstanceAliveChange),a.instances=[...this.state.instances];const g=a.instances.indexOf(h);a.instances.splice(g,1),i=!0}}(c=s==null?void 0:s.common)!=null&&c.blockly&&(this.confirmCallback=h=>h&&window.location.reload(),a.confirm=I.I18n.t("Some blocks were updated. Reload admin?"),i=!0)}i&&this.setState(a)};onHostChanged=(n,s)=>{if(n&&n.startsWith("system.host.")){if((s==null?void 0:s.type)==="host")this.hosts.includes(n)||(this.hosts.push(n),this.hosts.sort());else if(!s&&this.hosts.includes(n)){const i=this.hosts.indexOf(n);this.hosts.splice(i,1)}}};onConnectionReady(){window.systemLang=this.socket.systemLang,this.setState({ready:!1,scriptsHash:0,instances:[],updating:!1,resizing:!1,selected:null,logMessage:{},editing:[],menuOpened:window.localStorage.getItem("App.menuOpened")!=="false",menuSelectId:"",expertMode:window.localStorage.getItem("App.expertMode")==="true",logHorzLayout:window.localStorage.getItem("App.logHorzLayout")==="true",runningInstances:{},confirm:"",importFile:!1,message:"",searchText:"",hideLog:window.localStorage.getItem("App.hideLog")==="true",debugMode:!1,debugInstance:null,splitSizes:[20,80]},async()=>{const n={},s=await this.subscribeOnInstances();n.instances=s.instances,n.runningInstances=s.runningInstances,await this.readAdaptersWithBlockly();const i=await this.socket.getHosts();this.hosts=i.map(h=>h._id);const a=await this.readAllScripts();window.localStorage.getItem("App.expertMode")!=="true"&&window.localStorage.getItem("App.expertMode")!=="false"&&Object.keys(a).find(h=>h.startsWith("script.js.global.")&&a[h].type==="script")&&(n.expertMode=!0),this.scripts=a;let c=this.state.scriptsHash;this.compareScripts(a)&&c++,n.scriptsHash=c,n.ready=!0,this.setState(n),await this.socket.subscribeObject("script.*",this.onScriptsChanged),await this.socket.subscribeObject("system.adapter.*",this.onInstanceChanged),await this.socket.subscribeObject("system.host.*",this.onHostChanged)})}async subscribeOnInstances(){const s=(await this.socket.getAdapterInstances(this.adapterName)).map(a=>parseInt(a._id.split(".").pop()||"0")).sort(),i={};s.forEach(a=>i[`system.adapter.${this.adapterName}.${a}`]=!1);for(let a=0;a<s.length;a++){const c=`system.adapter.${this.adapterName}.${s[a]}`,h=`${c}.alive`,g=await this.socket.getState(h);i[c]=g?!!g.val:!1,await this.socket.subscribeState(h,this.onInstanceAliveChange)}return{instances:s,runningInstances:i}}async readAllScripts(){const n=await this.socket.getObjectViewSystem("channel","script.js.","script.js.香"),s=await this.socket.getObjectViewSystem("script","script.js.","script.js.香");return Object.keys(s).forEach(i=>n[i]=s[i]),n}async readAdaptersWithBlockly(){const n=await this.socket.getObjectViewSystem("adapter","system.adapter.","system.adapter.香");return new Promise(s=>hn.loadCustomBlockly(n,()=>s()))}onInstanceAliveChange=(n,s)=>{if(n&&(n=n?n.substring(0,n.length-6):"",this.state.runningInstances[n]!==(s?s.val:!1))){const i=JSON.parse(JSON.stringify(this.state.runningInstances));i[n]=s?!!s.val:!1,this.setState({runningInstances:i})}};onToggleExpertMode(n){this.onExpertModeChange(n)}compareScripts(n){const s=Object.keys(this.scripts),i=Object.keys(n);if(s.length!==i.length)return this.scripts=n,!0;if(JSON.stringify(s)!==JSON.stringify(i))return this.scripts=n,!0;for(let a=0;a<s.length;a++){const c=this.scripts[s[a]].common,h=n[s[a]].common;if(c.name!==h.name)return this.scripts=n,!0;if(c.engine!==h.engine)return this.scripts=n,!0;if(c.engineType!==h.engineType)return this.scripts=n,!0;if(c.enabled!==h.enabled)return this.scripts=n,!0}return!1}async onRename(n,s,i,a){var c;s.trim().endsWith(".")&&(s=s.replace(/\.\s*$/,"_")),console.log(`Rename ${n} => ${s}`),this.setState({updating:!0});try{if(((c=this.scripts[n])==null?void 0:c.type)==="script"){const h=JSON.parse(JSON.stringify(this.scripts[n].common));h.name=i||h.name,a!==void 0&&(h.engine=`system.adapter.javascript.${a}`);const g=s.split(".");g.pop();const b=g.join(".");this.scripts[b]&&this.scripts[b].type==="script"&&(g.pop(),s=`${g.join(".")}.${s.split(".").pop()}`),await this.updateScript(n,s,h)}else await this.renameGroup(n,s,i)}catch(h){h.toString().includes("canceled")||this.showJsError(h)}this.setState({updating:!1})}async renameGroup(n,s,i,a){if(a){if(a.length){let c=a.pop();if(c){const h=await this.socket.getObject(c);if(h){try{await this.socket.delObject(c)}catch{}c=s+c.substring(n.length),h._id=c,h.common=h.common||{},h.common.expert=!0,await this.socket.setObject(c,h),await this.renameGroup(n,s,i,a)}}}}else{a=[],a=Object.keys(this.scripts).filter(h=>h.startsWith(`${n}.`));let c=await this.socket.getObject(n);c=c||{common:{},type:"channel"},c.common.name=i||c.common.name||n.split(".").pop()||"",c._id=s;try{await this.socket.delObject(n)}catch{}try{await this.socket.setObject(s,c),await this.renameGroup(n,s,i,a)}catch(h){console.log(h);const g={_id:s,type:"channel",common:{name:i||n.split(".").pop()||"",expert:!0},native:{}};await this.socket.setObject(s,g),await this.renameGroup(n,s,i,a)}}}onUpdateScript(n,s){this.scripts[n]&&this.scripts[n].type==="script"&&this.updateScript(n,n,s).then(()=>{}).catch(i=>!i.toString().includes("canceled")&&this.showJsError(i))}onSelect(n){this.scripts[n]&&this.scripts[n].common&&this.scripts[n].type==="script"&&this.setState({selected:n,menuSelectId:n},()=>setTimeout(()=>this.setState({menuSelectId:""}),300))}onExpertModeChange(n){this.state.expertMode!==n&&(window.localStorage.setItem("App.expertMode",n?"true":"false"),this.setState({expertMode:n}))}showJsError(n){this.setState({errorText:n?n.toString():""})}showMessage(n){this.setState({message:n?n.toString():""})}onDelete(n){this.socket.delObject(n).catch(s=>this.showJsError(s))}onEdit(n){this.state.selected!==n&&this.setState({selected:n})}onAddNew(n,s,i,a,c,h){const g=new RegExp(`^${n}\\.`);if(Object.keys(this.scripts).find(b=>n===b||g.test(n)))return this.showJsError(I.I18n.t("Yet exists!"));i?this.socket.setObject(n,{_id:n,type:"channel",common:{name:s,expert:!0},native:{}}).then(()=>setTimeout(()=>this.setState({menuSelectId:n},()=>setTimeout(()=>this.setState({menuSelectId:""}),300)),1e3)).catch(b=>this.showJsError(b)):(c==="Blockly"&&!h&&(h=`
//${btoa(encodeURIComponent('<xml xmlns="https://developers.google.com/blockly/xml"></xml>'))}`),this.socket.setObject(n,{_id:n,type:"script",common:{name:s,expert:!0,engineType:c||"Javascript/js",enabled:!1,engine:`system.adapter.javascript.${a||0}`,source:h||"",debug:!1,verbose:!1},native:{}}).then(()=>setTimeout(()=>this.onSelect(n),1e3)).catch(b=>this.showJsError(b)))}async updateScript(n,s,i){let a=await this.socket.getObject(n);const c={common:{}};if(i.engine!==void 0&&(c.common.engine=i.engine),i.enabled!==void 0&&(c.common.enabled=i.enabled),i.source!==void 0&&(c.common.source=i.source),i.debug!==void 0&&(c.common.debug=i.debug),i.verbose!==void 0&&(c.common.verbose=i.verbose),c.from="system.adapter.admin.0",n===s&&(a!=null&&a.common)&&i.name===a.common.name)return(!i.engineType||i.engineType!==a.common.engineType)&&i.engineType!==void 0&&(c.common.engineType=i.engineType||"Javascript/js"),c.type="script",this.socket.extendObject(n,c);if(a!=null&&a.common){a.common.engineType=i.engineType||a.common.engineType||"Javascript/js",await this.socket.delObject(n),c.common.engine!==void 0&&(a.common.engine=c.common.engine),c.common.enabled!==void 0&&(a.common.enabled=c.common.enabled),c.common.source!==void 0&&(a.common.source=c.common.source),c.common.name!==void 0&&(a.common.name=c.common.name),c.common.debug!==void 0&&(a.common.debug=c.common.debug),c.common.verbose!==void 0&&(a.common.verbose=c.common.verbose),a._rev!==void 0&&delete a._rev,a.common.name=i.name,a.common.expert=!0,a.type="script",a._id=s,await this.socket.setObject(s,a);return}return a=c,a.common.name=i.name,a.common.expert=!0,a.type="script",a._id=s,this.socket.setObject(s,a)}onEnableDisable(n,s){if(this.scripts[n]&&this.scripts[n].type==="script"){const i=this.scripts[n].common;i.enabled=s,i.expert=!0,this.updateScript(n,n,i).catch(a=>a!=="canceled"&&this.showJsError(a))}}async getLiveHost(){for(let n=0;n<this.hosts.length;n++){const s=this.hosts[n],i=await this.socket.getState(`${s}.alive`);if(i&&(i!=null&&i.val))return s}}async onExport(){const n=await this.getLiveHost();if(!n){this.showJsError(I.I18n.t("No active host found"));return}const s=new Date;let i=s.getFullYear().toString(),a=s.getMonth()+1;a<10&&(a=`0${a}`),i+=`-${a}`,a=s.getDate(),a<10&&(a=`0${a}`),i+=`-${a}-`,this.socket.getRawSocket().emit("sendToHost",n,"readObjectsAsZip",{adapter:"javascript",id:"script.js",link:`${i}scripts.zip`,fileStorageNamespace:`admin.${this.instance}`},c=>{if(typeof c=="string"){const h=document.createElement("a");h.href=`../../files/${c}`,document.body.appendChild(h),h.click(),h.remove()}else if(c.error&&this.showJsError(c.error),c.data){const h=document.createElement("a");h.href=`data: application/zip;base64,${c.data}`,h.download=`${i}scripts.zip`,document.body.appendChild(h),h.click(),h.remove()}})}onImport(n){this.importFile=n||null,n?(this.confirmCallback=this.onImportConfirmed.bind(this),this.setState({importFile:!1,confirm:I.I18n.t("Existing scripts will be overwritten.")})):this.setState({importFile:!1})}async onImportConfirmed(n){let s=this.importFile;if(this.importFile=null,n&&s){s=s.split(",")[1];const i=await this.getLiveHost();if(!i){this.showJsError(I.I18n.t("No active host found"));return}this.socket.getRawSocket().emit("sendToHost",i,"writeObjectsAsZip",{data:s,adapter:"javascript",id:"script.js"},a=>{a==="permissionError"?this.showJsError(I.I18n.t(a)):!a||a.error?this.showJsError(a?I.I18n.t(a.error||""):I.I18n.t("Unknown error")):this.showMessage(I.I18n.t("Done"))})}}toggleLogLayout(){window.localStorage.setItem("App.logHorzLayout",this.state.logHorzLayout?"false":"true"),this.setState({logHorzLayout:!this.state.logHorzLayout})}renderEditor(){const n=Object.keys(this.scripts).reduce((s,i)=>s+(this.scripts[i].common.engineType==="Rules"?1:0),0);return f.jsx(Gh,{debugMode:this.state.debugMode,onDebugModeChange:s=>{s?this.setState({debugMode:!0}):this.setState({debugMode:!1,debugInstance:null})},visible:!this.state.resizing,socket:this.socket,adapterName:this.adapterName,onLocate:s=>this.setState({menuSelectId:s}),runningInstances:this.state.runningInstances,menuOpened:this.state.menuOpened,searchText:this.state.searchText,themeType:this.state.themeType,themeName:this.state.themeName,theme:this.state.theme,expertMode:this.state.expertMode,onChange:(s,i)=>this.onUpdateScript(s,i),isAnyRulesExists:n,debugInstance:this.state.debugInstance,onSelectedChange:(s,i)=>{const a={};let c=!1;s!==this.state.selected&&(c=!0,a.selected=s),JSON.stringify(i)!==JSON.stringify(this.state.editing)&&(c=!0,a.editing=JSON.parse(JSON.stringify(i))),c&&this.setState(a)},onRestart:s=>this.socket.extendObject(s,{common:{enabled:!0}}),selected:this.state.selected&&this.scripts[this.state.selected]&&this.scripts[this.state.selected].type==="script"?this.state.selected:"",objects:this.scripts,resizing:this.state.resizing},"editor")}showLogButton(){return f.jsx(D.Box,{title:I.I18n.t("Show logs"),sx:zf.showLogButton,onClick:()=>{window.localStorage.setItem("App.hideLog","false"),this.setState({hideLog:!1,resizing:!0}),setTimeout(()=>this.setState({resizing:!1}),300)},children:f.jsx(S1,{})},"showLog")}renderErrorDialog(){return this.state.errorText?f.jsx(Sm,{onClose:()=>this.setState({errorText:""}),text:this.state.errorText},"dialogError"):null}renderMain(){let n;return this.state.debugMode||this.state.hideLog?n=f.jsxs(f.Fragment,{children:[!this.state.debugMode&&this.state.hideLog?this.showLogButton():void 0,this.renderEditor()]}):n=f.jsxs(Tv,{direction:this.state.logHorzLayout?Pn.Horizontal:Pn.Vertical,initialSizes:this.state.logSizes,minWidths:[500,100],minHeights:[150,50],onResizeStarted:()=>this.setState({resizing:!0}),onResizeFinished:(s,i)=>{this.setState({logSizes:i,resizing:!1}),window.localStorage.setItem("JS.logSizes",JSON.stringify(i))},gutterClassName:this.state.themeType==="dark"?"Dark visGutter":"Light visGutter",children:[this.renderEditor(),f.jsx(Xw,{verticalLayout:!this.state.logHorzLayout,onLayoutChange:()=>this.toggleLogLayout(),editing:this.state.editing,socket:this.socket,selected:this.state.selected,onHideLog:()=>{window.localStorage.setItem("App.hideLog","true"),this.setState({hideLog:!0,resizing:!0}),setTimeout(()=>this.setState({resizing:!1}),300)}},"log")]}),[this.state.message?f.jsx(I.Message,{onClose:()=>this.setState({message:""}),text:this.state.message},"dialogMessage"):null,this.renderErrorDialog(),this.state.importFile?f.jsx(HS,{onClose:s=>this.onImport(s)},"dialogImportFile"):null,this.state.confirm?f.jsx(I.Confirm,{onClose:s=>{this.state.confirm&&this.setState({confirm:""}),this.confirmCallback&&this.confirmCallback(s),this.confirmCallback=null},text:this.state.confirm},"dialogConfirm"):null,f.jsxs(D.Box,{sx:zf.content,className:"iobVerticalSplitter",children:[f.jsx(D.Box,{sx:zf.menuOpenCloseButton,onClick:()=>{window.localStorage.setItem("App.menuOpened",this.state.menuOpened?"false":"true"),this.setState({menuOpened:!this.state.menuOpened,resizing:!0}),setTimeout(()=>this.setState({resizing:!1}),300)},children:this.state.menuOpened?f.jsx(R1,{}):f.jsx(L1,{})},"closeMenu"),n]},"main")]}render(){if(!this.state.ready)return f.jsx(E0,{injectFirst:!0,children:f.jsx(k0,{theme:this.state.theme,children:f.jsx(I.Loader,{themeType:this.state.themeType})})});let n;return this.state.menuOpened?n=f.jsxs(Tv,{direction:Pn.Horizontal,initialSizes:this.state.splitSizes,minWidths:[270,400],onResizeFinished:(s,i)=>{this.setState({splitSizes:i}),window.localStorage.setItem("JS.splitSizes",JSON.stringify(i))},gutterClassName:this.state.themeType==="dark"?"Dark visGutter":"Light visGutter",children:[f.jsx("div",{style:zf.mainDiv,children:f.jsx(rl,{debugMode:this.state.debugMode,onDebugInstance:s=>this.setState({debugInstance:s,debugMode:!!s}),scripts:this.scripts,scriptsHash:this.state.scriptsHash,instances:this.state.instances,onRename:this.onRename.bind(this),socket:this.socket,selectId:this.state.menuSelectId,onEdit:this.onEdit.bind(this),expertMode:this.state.expertMode,themeName:this.state.themeName,onThemeChange:s=>{I.Utils.setThemeName(s);const i=I.Utils.getThemeType(s);this.setState({themeName:s,themeType:i},()=>this.toggleTheme(s))},runningInstances:this.state.runningInstances,onExpertModeChange:this.onExpertModeChange.bind(this),onDelete:this.onDelete.bind(this),onAddNew:this.onAddNew.bind(this),onEnableDisable:this.onEnableDisable.bind(this),onExport:this.onExport.bind(this),width:500,onImport:()=>this.setState({importFile:!0}),onSearch:s=>this.setState({searchText:s}),version:this.props.version},"sidemenu")},"menu"),this.renderMain()]}):n=this.renderMain(),f.jsx(E0,{injectFirst:!0,children:f.jsx(k0,{theme:this.state.theme,children:f.jsx("div",{style:zf.root,children:f.jsx(MB,{socket:this.socket,children:n})})})})}}window.location.hostname==="localhost"||window.location.hostname==="[::1]"||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/);function Ace(){"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(o=>o.unregister())}const Nce="js",Mce="8.8.3",Lce="module",Bce={"@babel/plugin-proposal-private-property-in-object":"^7.21.11","@blockly/field-colour":"^5.0.12","@blockly/field-multilineinput":"^5.0.13","@blockly/theme-dark":"^7.0.10","@craco/craco":"^7.1.0","@devbookhq/splitter":"^1.4.2","@esbuild-plugins/node-globals-polyfill":"^0.2.3","@iobroker/adapter-react-v5":"^7.4.4","@iobroker/type-detector":"^4.1.0","@module-federation/runtime":"^0.8.2","@module-federation/vite":"^1.1.9","@mui/icons-material":"^6.2.0","@mui/material":"^6.2.0","@mui/x-date-pickers":"^7.23.1","@sentry/browser":"^8.43.0","@types/lodash":"^4.17.13","@types/react":"^18.3.16","@types/react-dom":"^18.3.5","@types/reactour":"^1.18.5","@vitejs/plugin-react":"^4.3.4",blockly:"^11.1.1","craco-module-federation":"^1.1.0",lodash:"^4.17.21","monaco-editor":"~0.52.2",openai:"^4.76.1",react:"^18.3.1","react-ace":"^13.0.0","react-bem-helper":"^1.4.1","react-dnd":"^16.0.1","react-dnd-html5-backend":"^16.0.1","react-dnd-touch-backend":"^16.0.1","react-dom":"^18.3.1","react-dropzone":"^14.3.5","react-fullscreen":"^0.1.0","react-i18next":"^15.1.4","react-icons":"^5.4.0","react-inlinesvg":"^4.1.5","react-json-view":"^1.21.3","react-monaco-editor":"^0.56.2","react-scripts":"^5.0.1","react-splitter-layout":"^4.0.0","react-text-mask":"^5.5.0","react-treeview-mui":"^0.1.2",reactour:"^1.19.4",sass:"^1.82.0","styled-components":"^6.1.13",suncalc2:"^1.8.1",vite:"5.2.10","vite-plugin-commonjs":"^0.10.4","vite-plugin-svgr":"^4.3.0","vite-tsconfig-paths":"^5.1.4"},Pce={start:"vite",lint:"eslint -c eslint.config.mjs",build:"tsc && vite build",preview:"vite preview --port 3000",tsc:"tsc -p tsconfig.json",npm:"npm i -f"},Fce={extends:"react-app"},jce=[">0.2%","not dead","not ie <= 11","not op_mini all"],hx={name:Nce,version:Mce,private:!0,type:Lce,dependencies:Bce,scripts:Pce,eslintConfig:Fce,browserslist:jce};var gc;(function(o){o.mouse="mouse",o.touch="touch",o.keyboard="keyboard"})(gc||(gc={}));class zce{get delay(){var n;return(n=this.args.delay)!==null&&n!==void 0?n:0}get scrollAngleRanges(){return this.args.scrollAngleRanges}get getDropTargetElementsAtPoint(){return this.args.getDropTargetElementsAtPoint}get ignoreContextMenu(){var n;return(n=this.args.ignoreContextMenu)!==null&&n!==void 0?n:!1}get enableHoverOutsideTarget(){var n;return(n=this.args.enableHoverOutsideTarget)!==null&&n!==void 0?n:!1}get enableKeyboardEvents(){var n;return(n=this.args.enableKeyboardEvents)!==null&&n!==void 0?n:!1}get enableMouseEvents(){var n;return(n=this.args.enableMouseEvents)!==null&&n!==void 0?n:!1}get enableTouchEvents(){var n;return(n=this.args.enableTouchEvents)!==null&&n!==void 0?n:!0}get touchSlop(){return this.args.touchSlop||0}get delayTouchStart(){var n,s,i,a;return(a=(i=(n=this.args)===null||n===void 0?void 0:n.delayTouchStart)!==null&&i!==void 0?i:(s=this.args)===null||s===void 0?void 0:s.delay)!==null&&a!==void 0?a:0}get delayMouseStart(){var n,s,i,a;return(a=(i=(n=this.args)===null||n===void 0?void 0:n.delayMouseStart)!==null&&i!==void 0?i:(s=this.args)===null||s===void 0?void 0:s.delay)!==null&&a!==void 0?a:0}get window(){if(this.context&&this.context.window)return this.context.window;if(typeof window<"u")return window}get document(){var n;if(!((n=this.context)===null||n===void 0)&&n.document)return this.context.document;if(this.window)return this.window.document}get rootElement(){var n;return((n=this.args)===null||n===void 0?void 0:n.rootElement)||this.document}constructor(n,s){this.args=n,this.context=s}}function Uce(o,n,s,i){return Math.sqrt(Math.pow(Math.abs(s-o),2)+Math.pow(Math.abs(i-n),2))}function Hce(o,n,s,i,a){if(!a)return!1;const c=Math.atan2(i-n,s-o)*180/Math.PI+180;for(let h=0;h<a.length;++h){const g=a[h];if(g&&(g.start==null||c>=g.start)&&(g.end==null||c<=g.end))return!0}return!1}const Wce={Left:1,Right:2,Center:4},Vce={Left:0,Center:1,Right:2};function V_(o){return o.button===void 0||o.button===Vce.Left}function Gce(o){return o.buttons===void 0||(o.buttons&Wce.Left)===0}function px(o){return!!o.targetTouches}const qce=1;function Kce(o){const n=o.nodeType===qce?o:o.parentElement;if(!n)return;const{top:s,left:i}=n.getBoundingClientRect();return{x:i,y:s}}function Jce(o,n){if(o.targetTouches.length===1)return oy(o.targetTouches[0]);if(n&&o.touches.length===1&&o.touches[0].target===n.target)return oy(o.touches[0])}function oy(o,n){return px(o)?Jce(o,n):{x:o.clientX,y:o.clientY}}const CT=(()=>{let o=!1;try{addEventListener("test",()=>{},Object.defineProperty({},"passive",{get(){return o=!0,!0}}))}catch{}return o})(),Uf={[gc.mouse]:{start:"mousedown",move:"mousemove",end:"mouseup",contextmenu:"contextmenu"},[gc.touch]:{start:"touchstart",move:"touchmove",end:"touchend"},[gc.keyboard]:{keydown:"keydown"}};class im{profile(){var n;return{sourceNodes:this.sourceNodes.size,sourcePreviewNodes:this.sourcePreviewNodes.size,sourcePreviewNodeOptions:this.sourcePreviewNodeOptions.size,targetNodes:this.targetNodes.size,dragOverTargetIds:((n=this.dragOverTargetIds)===null||n===void 0?void 0:n.length)||0}}get document(){return this.options.document}setup(){const n=this.options.rootElement;n&&(Mt(!im.isSetUp,"Cannot have two Touch backends at the same time."),im.isSetUp=!0,this.addEventListener(n,"start",this.getTopMoveStartHandler()),this.addEventListener(n,"start",this.handleTopMoveStartCapture,!0),this.addEventListener(n,"move",this.handleTopMove),this.addEventListener(n,"move",this.handleTopMoveCapture,!0),this.addEventListener(n,"end",this.handleTopMoveEndCapture,!0),this.options.enableMouseEvents&&!this.options.ignoreContextMenu&&this.addEventListener(n,"contextmenu",this.handleTopMoveEndCapture),this.options.enableKeyboardEvents&&this.addEventListener(n,"keydown",this.handleCancelOnEscape,!0))}teardown(){const n=this.options.rootElement;n&&(im.isSetUp=!1,this._mouseClientOffset={},this.removeEventListener(n,"start",this.handleTopMoveStartCapture,!0),this.removeEventListener(n,"start",this.handleTopMoveStart),this.removeEventListener(n,"move",this.handleTopMoveCapture,!0),this.removeEventListener(n,"move",this.handleTopMove),this.removeEventListener(n,"end",this.handleTopMoveEndCapture,!0),this.options.enableMouseEvents&&!this.options.ignoreContextMenu&&this.removeEventListener(n,"contextmenu",this.handleTopMoveEndCapture),this.options.enableKeyboardEvents&&this.removeEventListener(n,"keydown",this.handleCancelOnEscape,!0),this.uninstallSourceNodeRemovalObserver())}addEventListener(n,s,i,a=!1){const c=CT?{capture:a,passive:!1}:a;this.listenerTypes.forEach(function(h){const g=Uf[h][s];g&&n.addEventListener(g,i,c)})}removeEventListener(n,s,i,a=!1){const c=CT?{capture:a,passive:!1}:a;this.listenerTypes.forEach(function(h){const g=Uf[h][s];g&&n.removeEventListener(g,i,c)})}connectDragSource(n,s){const i=this.handleMoveStart.bind(this,n);return this.sourceNodes.set(n,s),this.addEventListener(s,"start",i),()=>{this.sourceNodes.delete(n),this.removeEventListener(s,"start",i)}}connectDragPreview(n,s,i){return this.sourcePreviewNodeOptions.set(n,i),this.sourcePreviewNodes.set(n,s),()=>{this.sourcePreviewNodes.delete(n),this.sourcePreviewNodeOptions.delete(n)}}connectDropTarget(n,s){const i=this.options.rootElement;if(!this.document||!i)return()=>{};const a=c=>{if(!this.document||!i||!this.monitor.isDragging())return;let h;switch(c.type){case Uf.mouse.move:h={x:c.clientX,y:c.clientY};break;case Uf.touch.move:var g,b;h={x:((g=c.touches[0])===null||g===void 0?void 0:g.clientX)||0,y:((b=c.touches[0])===null||b===void 0?void 0:b.clientY)||0};break}const $=h!=null?this.document.elementFromPoint(h.x,h.y):void 0,y=$&&s.contains($);if($===s||y)return this.handleMove(c,n)};return this.addEventListener(this.document.body,"move",a),this.targetNodes.set(n,s),()=>{this.document&&(this.targetNodes.delete(n),this.removeEventListener(this.document.body,"move",a))}}getTopMoveStartHandler(){return!this.options.delayTouchStart&&!this.options.delayMouseStart?this.handleTopMoveStart:this.handleTopMoveStartDelay}installSourceNodeRemovalObserver(n){this.uninstallSourceNodeRemovalObserver(),this.draggedSourceNode=n,this.draggedSourceNodeRemovalObserver=new MutationObserver(()=>{n&&!n.parentElement&&(this.resurrectSourceNode(),this.uninstallSourceNodeRemovalObserver())}),!(!n||!n.parentElement)&&this.draggedSourceNodeRemovalObserver.observe(n.parentElement,{childList:!0})}resurrectSourceNode(){this.document&&this.draggedSourceNode&&(this.draggedSourceNode.style.display="none",this.draggedSourceNode.removeAttribute("data-reactid"),this.document.body.appendChild(this.draggedSourceNode))}uninstallSourceNodeRemovalObserver(){this.draggedSourceNodeRemovalObserver&&this.draggedSourceNodeRemovalObserver.disconnect(),this.draggedSourceNodeRemovalObserver=void 0,this.draggedSourceNode=void 0}constructor(n,s,i){this.getSourceClientOffset=a=>{const c=this.sourceNodes.get(a);return c&&Kce(c)},this.handleTopMoveStartCapture=a=>{V_(a)&&(this.moveStartSourceIds=[])},this.handleMoveStart=a=>{Array.isArray(this.moveStartSourceIds)&&this.moveStartSourceIds.unshift(a)},this.handleTopMoveStart=a=>{if(!V_(a))return;const c=oy(a);c&&(px(a)&&(this.lastTargetTouchFallback=a.targetTouches[0]),this._mouseClientOffset=c),this.waitingForDelay=!1},this.handleTopMoveStartDelay=a=>{if(!V_(a))return;const c=a.type===Uf.touch.start?this.options.delayTouchStart:this.options.delayMouseStart;this.timeout=setTimeout(this.handleTopMoveStart.bind(this,a),c),this.waitingForDelay=!0},this.handleTopMoveCapture=()=>{this.dragOverTargetIds=[]},this.handleMove=(a,c)=>{this.dragOverTargetIds&&this.dragOverTargetIds.unshift(c)},this.handleTopMove=a=>{if(this.timeout&&clearTimeout(this.timeout),!this.document||this.waitingForDelay)return;const{moveStartSourceIds:c,dragOverTargetIds:h}=this,g=this.options.enableHoverOutsideTarget,b=oy(a,this.lastTargetTouchFallback);if(!b)return;if(this._isScrolling||!this.monitor.isDragging()&&Hce(this._mouseClientOffset.x||0,this._mouseClientOffset.y||0,b.x,b.y,this.options.scrollAngleRanges)){this._isScrolling=!0;return}if(!this.monitor.isDragging()&&this._mouseClientOffset.hasOwnProperty("x")&&c&&Uce(this._mouseClientOffset.x||0,this._mouseClientOffset.y||0,b.x,b.y)>(this.options.touchSlop?this.options.touchSlop:0)&&(this.moveStartSourceIds=void 0,this.actions.beginDrag(c,{clientOffset:this._mouseClientOffset,getSourceClientOffset:this.getSourceClientOffset,publishSource:!1})),!this.monitor.isDragging())return;const $=this.sourceNodes.get(this.monitor.getSourceId());this.installSourceNodeRemovalObserver($),this.actions.publishDragSource(),a.cancelable&&a.preventDefault();const y=(h||[]).map(k=>this.targetNodes.get(k)).filter(k=>!!k),w=this.options.getDropTargetElementsAtPoint?this.options.getDropTargetElementsAtPoint(b.x,b.y,y):this.document.elementsFromPoint(b.x,b.y),C=[];for(const k in w){if(!w.hasOwnProperty(k))continue;let E=w[k];for(E!=null&&C.push(E);E;)E=E.parentElement,E&&C.indexOf(E)===-1&&C.push(E)}const S=C.filter(k=>y.indexOf(k)>-1).map(k=>this._getDropTargetId(k)).filter(k=>!!k).filter((k,E,R)=>R.indexOf(k)===E);if(g)for(const k in this.targetNodes){const E=this.targetNodes.get(k);if($&&E&&E.contains($)&&S.indexOf(k)===-1){S.unshift(k);break}}S.reverse(),this.actions.hover(S,{clientOffset:b})},this._getDropTargetId=a=>{const c=this.targetNodes.keys();let h=c.next();for(;h.done===!1;){const g=h.value;if(a===this.targetNodes.get(g))return g;h=c.next()}},this.handleTopMoveEndCapture=a=>{if(this._isScrolling=!1,this.lastTargetTouchFallback=void 0,!!Gce(a)){if(!this.monitor.isDragging()||this.monitor.didDrop()){this.moveStartSourceIds=void 0;return}a.cancelable&&a.preventDefault(),this._mouseClientOffset={},this.uninstallSourceNodeRemovalObserver(),this.actions.drop(),this.actions.endDrag()}},this.handleCancelOnEscape=a=>{a.key==="Escape"&&this.monitor.isDragging()&&(this._mouseClientOffset={},this.uninstallSourceNodeRemovalObserver(),this.actions.endDrag())},this.options=new zce(i,s),this.actions=n.getActions(),this.monitor=n.getMonitor(),this.sourceNodes=new Map,this.sourcePreviewNodes=new Map,this.sourcePreviewNodeOptions=new Map,this.targetNodes=new Map,this.listenerTypes=[],this._mouseClientOffset={},this._isScrolling=!1,this.options.enableMouseEvents&&this.listenerTypes.push(gc.mouse),this.options.enableTouchEvents&&this.listenerTypes.push(gc.touch),this.options.enableKeyboardEvents&&this.listenerTypes.push(gc.keyboard)}}const Yce=function(n,s={},i={}){return new im(n,s,i)};Le.something="test";console.log(Le.something);window.GenericBlock=ln;window.adapterName="javascript";window.sentryDSN="https://504499a725eb4898930d3b9e9da95740@sentry.iobroker.net/56";console.log(`iobroker.${window.adapterName}@${hx.version}`);const Xce=window.innerWidth<600,TT=document.getElementById("root");TT&&DT(TT).render(f.jsx(ZT,{backend:Xce?Yce:hE,children:f.jsx(Rce,{version:hx.version})}));Ace();const av=window.loadDynamicScript;av&&av(window.location.port==="3000"?`${window.location.protocol}//${window.location.hostname}:8081/lib/js/socket.io.js`:"./../../lib/js/socket.io.js",()=>av("vs/loader.js",()=>av("vs/configure.js",()=>typeof window.socketLoadedHandler=="function"&&window.socketLoadedHandler())));
